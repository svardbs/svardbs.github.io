(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();/**
* @vue/shared v3.5.16
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function qu(t){const e=Object.create(null);for(const r of t.split(","))e[r]=1;return r=>r in e}const _t={},Es=[],dn=()=>{},gv=()=>!1,jl=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Xu=t=>t.startsWith("onUpdate:"),xr=Object.assign,Yu=(t,e)=>{const r=t.indexOf(e);r>-1&&t.splice(r,1)},mv=Object.prototype.hasOwnProperty,at=(t,e)=>mv.call(t,e),Me=Array.isArray,ys=t=>Za(t)==="[object Map]",Gl=t=>Za(t)==="[object Set]",Yh=t=>Za(t)==="[object Date]",Ge=t=>typeof t=="function",Mt=t=>typeof t=="string",_n=t=>typeof t=="symbol",Et=t=>t!==null&&typeof t=="object",yp=t=>(Et(t)||Ge(t))&&Ge(t.then)&&Ge(t.catch),Tp=Object.prototype.toString,Za=t=>Tp.call(t),_v=t=>Za(t).slice(8,-1),wp=t=>Za(t)==="[object Object]",Qu=t=>Mt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,ma=qu(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),zl=t=>{const e=Object.create(null);return r=>e[r]||(e[r]=t(r))},vv=/-(\w)/g,ci=zl(t=>t.replace(vv,(e,r)=>r?r.toUpperCase():"")),xv=/\B([A-Z])/g,Ti=zl(t=>t.replace(xv,"-$1").toLowerCase()),Ap=zl(t=>t.charAt(0).toUpperCase()+t.slice(1)),Mc=zl(t=>t?`on${Ap(t)}`:""),ri=(t,e)=>!Object.is(t,e),jo=(t,...e)=>{for(let r=0;r<t.length;r++)t[r](...e)},Sp=(t,e,r,n=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:n,value:r})},el=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Qh;const Kl=()=>Qh||(Qh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Ju(t){if(Me(t)){const e={};for(let r=0;r<t.length;r++){const n=t[r],i=Mt(n)?wv(n):Ju(n);if(i)for(const s in i)e[s]=i[s]}return e}else if(Mt(t)||Et(t))return t}const Ev=/;(?![^(]*\))/g,yv=/:([^]+)/,Tv=/\/\*[^]*?\*\//g;function wv(t){const e={};return t.replace(Tv,"").split(Ev).forEach(r=>{if(r){const n=r.split(yv);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function ql(t){let e="";if(Mt(t))e=t;else if(Me(t))for(let r=0;r<t.length;r++){const n=ql(t[r]);n&&(e+=n+" ")}else if(Et(t))for(const r in t)t[r]&&(e+=r+" ");return e.trim()}const Av="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Sv=qu(Av);function Ip(t){return!!t||t===""}function Iv(t,e){if(t.length!==e.length)return!1;let r=!0;for(let n=0;r&&n<t.length;n++)r=Xl(t[n],e[n]);return r}function Xl(t,e){if(t===e)return!0;let r=Yh(t),n=Yh(e);if(r||n)return r&&n?t.getTime()===e.getTime():!1;if(r=_n(t),n=_n(e),r||n)return t===e;if(r=Me(t),n=Me(e),r||n)return r&&n?Iv(t,e):!1;if(r=Et(t),n=Et(e),r||n){if(!r||!n)return!1;const i=Object.keys(t).length,s=Object.keys(e).length;if(i!==s)return!1;for(const a in t){const o=t.hasOwnProperty(a),c=e.hasOwnProperty(a);if(o&&!c||!o&&c||!Xl(t[a],e[a]))return!1}}return String(t)===String(e)}function Cv(t,e){return t.findIndex(r=>Xl(r,e))}const Cp=t=>!!(t&&t.__v_isRef===!0),Ht=t=>Mt(t)?t:t==null?"":Me(t)||Et(t)&&(t.toString===Tp||!Ge(t.toString))?Cp(t)?Ht(t.value):JSON.stringify(t,Rp,2):String(t),Rp=(t,e)=>Cp(e)?Rp(t,e.value):ys(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((r,[n,i],s)=>(r[Vc(n,s)+" =>"]=i,r),{})}:Gl(e)?{[`Set(${e.size})`]:[...e.values()].map(r=>Vc(r))}:_n(e)?Vc(e):Et(e)&&!Me(e)&&!wp(e)?String(e):e,Vc=(t,e="")=>{var r;return _n(t)?`Symbol(${(r=t.description)!=null?r:e})`:t};/**
* @vue/reactivity v3.5.16
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Rr;class Rv{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Rr,!e&&Rr&&(this.index=(Rr.scopes||(Rr.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,r;if(this.scopes)for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].pause();for(e=0,r=this.effects.length;e<r;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,r;if(this.scopes)for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].resume();for(e=0,r=this.effects.length;e<r;e++)this.effects[e].resume()}}run(e){if(this._active){const r=Rr;try{return Rr=this,e()}finally{Rr=r}}}on(){++this._on===1&&(this.prevScope=Rr,Rr=this)}off(){this._on>0&&--this._on===0&&(Rr=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(this.effects.length=0,r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.cleanups.length=0,this.scopes){for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function Pv(){return Rr}let vt;const Bc=new WeakSet;class Pp{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Rr&&Rr.active&&Rr.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Bc.has(this)&&(Bc.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Dp(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Jh(this),Op(this);const e=vt,r=rn;vt=this,rn=!0;try{return this.fn()}finally{bp(this),vt=e,rn=r,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)tf(e);this.deps=this.depsTail=void 0,Jh(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Bc.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){uu(this)&&this.run()}get dirty(){return uu(this)}}let Fp=0,_a,va;function Dp(t,e=!1){if(t.flags|=8,e){t.next=va,va=t;return}t.next=_a,_a=t}function Zu(){Fp++}function ef(){if(--Fp>0)return;if(va){let e=va;for(va=void 0;e;){const r=e.next;e.next=void 0,e.flags&=-9,e=r}}let t;for(;_a;){let e=_a;for(_a=void 0;e;){const r=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){t||(t=n)}e=r}}if(t)throw t}function Op(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function bp(t){let e,r=t.depsTail,n=r;for(;n;){const i=n.prevDep;n.version===-1?(n===r&&(r=i),tf(n),Fv(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=i}t.deps=e,t.depsTail=r}function uu(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(kp(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function kp(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===ba)||(t.globalVersion=ba,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!uu(t))))return;t.flags|=2;const e=t.dep,r=vt,n=rn;vt=t,rn=!0;try{Op(t);const i=t.fn(t._value);(e.version===0||ri(i,t._value))&&(t.flags|=128,t._value=i,e.version++)}catch(i){throw e.version++,i}finally{vt=r,rn=n,bp(t),t.flags&=-3}}function tf(t,e=!1){const{dep:r,prevSub:n,nextSub:i}=t;if(n&&(n.nextSub=i,t.prevSub=void 0),i&&(i.prevSub=n,t.nextSub=void 0),r.subs===t&&(r.subs=n,!n&&r.computed)){r.computed.flags&=-5;for(let s=r.computed.deps;s;s=s.nextDep)tf(s,!0)}!e&&!--r.sc&&r.map&&r.map.delete(r.key)}function Fv(t){const{prevDep:e,nextDep:r}=t;e&&(e.nextDep=r,t.prevDep=void 0),r&&(r.prevDep=e,t.nextDep=void 0)}let rn=!0;const Np=[];function kn(){Np.push(rn),rn=!1}function Nn(){const t=Np.pop();rn=t===void 0?!0:t}function Jh(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const r=vt;vt=void 0;try{e()}finally{vt=r}}}let ba=0;class Dv{constructor(e,r){this.sub=e,this.dep=r,this.version=r.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class rf{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!vt||!rn||vt===this.computed)return;let r=this.activeLink;if(r===void 0||r.sub!==vt)r=this.activeLink=new Dv(vt,this),vt.deps?(r.prevDep=vt.depsTail,vt.depsTail.nextDep=r,vt.depsTail=r):vt.deps=vt.depsTail=r,Lp(r);else if(r.version===-1&&(r.version=this.version,r.nextDep)){const n=r.nextDep;n.prevDep=r.prevDep,r.prevDep&&(r.prevDep.nextDep=n),r.prevDep=vt.depsTail,r.nextDep=void 0,vt.depsTail.nextDep=r,vt.depsTail=r,vt.deps===r&&(vt.deps=n)}return r}trigger(e){this.version++,ba++,this.notify(e)}notify(e){Zu();try{for(let r=this.subs;r;r=r.prevSub)r.sub.notify()&&r.sub.dep.notify()}finally{ef()}}}function Lp(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)Lp(n)}const r=t.dep.subs;r!==t&&(t.prevSub=r,r&&(r.nextSub=t)),t.dep.subs=t}}const fu=new WeakMap,Bi=Symbol(""),hu=Symbol(""),ka=Symbol("");function gr(t,e,r){if(rn&&vt){let n=fu.get(t);n||fu.set(t,n=new Map);let i=n.get(r);i||(n.set(r,i=new rf),i.map=n,i.key=r),i.track()}}function Pn(t,e,r,n,i,s){const a=fu.get(t);if(!a){ba++;return}const o=c=>{c&&c.trigger()};if(Zu(),e==="clear")a.forEach(o);else{const c=Me(t),u=c&&Qu(r);if(c&&r==="length"){const f=Number(n);a.forEach((d,p)=>{(p==="length"||p===ka||!_n(p)&&p>=f)&&o(d)})}else switch((r!==void 0||a.has(void 0))&&o(a.get(r)),u&&o(a.get(ka)),e){case"add":c?u&&o(a.get("length")):(o(a.get(Bi)),ys(t)&&o(a.get(hu)));break;case"delete":c||(o(a.get(Bi)),ys(t)&&o(a.get(hu)));break;case"set":ys(t)&&o(a.get(Bi));break}}ef()}function os(t){const e=st(t);return e===t?e:(gr(e,"iterate",ka),qr(t)?e:e.map(ir))}function Yl(t){return gr(t=st(t),"iterate",ka),t}const Ov={__proto__:null,[Symbol.iterator](){return Uc(this,Symbol.iterator,ir)},concat(...t){return os(this).concat(...t.map(e=>Me(e)?os(e):e))},entries(){return Uc(this,"entries",t=>(t[1]=ir(t[1]),t))},every(t,e){return Cn(this,"every",t,e,void 0,arguments)},filter(t,e){return Cn(this,"filter",t,e,r=>r.map(ir),arguments)},find(t,e){return Cn(this,"find",t,e,ir,arguments)},findIndex(t,e){return Cn(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Cn(this,"findLast",t,e,ir,arguments)},findLastIndex(t,e){return Cn(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Cn(this,"forEach",t,e,void 0,arguments)},includes(...t){return Hc(this,"includes",t)},indexOf(...t){return Hc(this,"indexOf",t)},join(t){return os(this).join(t)},lastIndexOf(...t){return Hc(this,"lastIndexOf",t)},map(t,e){return Cn(this,"map",t,e,void 0,arguments)},pop(){return la(this,"pop")},push(...t){return la(this,"push",t)},reduce(t,...e){return Zh(this,"reduce",t,e)},reduceRight(t,...e){return Zh(this,"reduceRight",t,e)},shift(){return la(this,"shift")},some(t,e){return Cn(this,"some",t,e,void 0,arguments)},splice(...t){return la(this,"splice",t)},toReversed(){return os(this).toReversed()},toSorted(t){return os(this).toSorted(t)},toSpliced(...t){return os(this).toSpliced(...t)},unshift(...t){return la(this,"unshift",t)},values(){return Uc(this,"values",ir)}};function Uc(t,e,r){const n=Yl(t),i=n[e]();return n!==t&&!qr(t)&&(i._next=i.next,i.next=()=>{const s=i._next();return s.value&&(s.value=r(s.value)),s}),i}const bv=Array.prototype;function Cn(t,e,r,n,i,s){const a=Yl(t),o=a!==t&&!qr(t),c=a[e];if(c!==bv[e]){const d=c.apply(t,s);return o?ir(d):d}let u=r;a!==t&&(o?u=function(d,p){return r.call(this,ir(d),p,t)}:r.length>2&&(u=function(d,p){return r.call(this,d,p,t)}));const f=c.call(a,u,n);return o&&i?i(f):f}function Zh(t,e,r,n){const i=Yl(t);let s=r;return i!==t&&(qr(t)?r.length>3&&(s=function(a,o,c){return r.call(this,a,o,c,t)}):s=function(a,o,c){return r.call(this,a,ir(o),c,t)}),i[e](s,...n)}function Hc(t,e,r){const n=st(t);gr(n,"iterate",ka);const i=n[e](...r);return(i===-1||i===!1)&&of(r[0])?(r[0]=st(r[0]),n[e](...r)):i}function la(t,e,r=[]){kn(),Zu();const n=st(t)[e].apply(t,r);return ef(),Nn(),n}const kv=qu("__proto__,__v_isRef,__isVue"),Mp=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(_n));function Nv(t){_n(t)||(t=String(t));const e=st(this);return gr(e,"has",t),e.hasOwnProperty(t)}class Vp{constructor(e=!1,r=!1){this._isReadonly=e,this._isShallow=r}get(e,r,n){if(r==="__v_skip")return e.__v_skip;const i=this._isReadonly,s=this._isShallow;if(r==="__v_isReactive")return!i;if(r==="__v_isReadonly")return i;if(r==="__v_isShallow")return s;if(r==="__v_raw")return n===(i?s?Gv:$p:s?Hp:Up).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const a=Me(e);if(!i){let c;if(a&&(c=Ov[r]))return c;if(r==="hasOwnProperty")return Nv}const o=Reflect.get(e,r,Wt(e)?e:n);return(_n(r)?Mp.has(r):kv(r))||(i||gr(e,"get",r),s)?o:Wt(o)?a&&Qu(r)?o:o.value:Et(o)?i?Wp(o):sf(o):o}}class Bp extends Vp{constructor(e=!1){super(!1,e)}set(e,r,n,i){let s=e[r];if(!this._isShallow){const c=ui(s);if(!qr(n)&&!ui(n)&&(s=st(s),n=st(n)),!Me(e)&&Wt(s)&&!Wt(n))return c?!1:(s.value=n,!0)}const a=Me(e)&&Qu(r)?Number(r)<e.length:at(e,r),o=Reflect.set(e,r,n,Wt(e)?e:i);return e===st(i)&&(a?ri(n,s)&&Pn(e,"set",r,n):Pn(e,"add",r,n)),o}deleteProperty(e,r){const n=at(e,r);e[r];const i=Reflect.deleteProperty(e,r);return i&&n&&Pn(e,"delete",r,void 0),i}has(e,r){const n=Reflect.has(e,r);return(!_n(r)||!Mp.has(r))&&gr(e,"has",r),n}ownKeys(e){return gr(e,"iterate",Me(e)?"length":Bi),Reflect.ownKeys(e)}}class Lv extends Vp{constructor(e=!1){super(!0,e)}set(e,r){return!0}deleteProperty(e,r){return!0}}const Mv=new Bp,Vv=new Lv,Bv=new Bp(!0);const du=t=>t,Ro=t=>Reflect.getPrototypeOf(t);function Uv(t,e,r){return function(...n){const i=this.__v_raw,s=st(i),a=ys(s),o=t==="entries"||t===Symbol.iterator&&a,c=t==="keys"&&a,u=i[t](...n),f=r?du:e?tl:ir;return!e&&gr(s,"iterate",c?hu:Bi),{next(){const{value:d,done:p}=u.next();return p?{value:d,done:p}:{value:o?[f(d[0]),f(d[1])]:f(d),done:p}},[Symbol.iterator](){return this}}}}function Po(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Hv(t,e){const r={get(i){const s=this.__v_raw,a=st(s),o=st(i);t||(ri(i,o)&&gr(a,"get",i),gr(a,"get",o));const{has:c}=Ro(a),u=e?du:t?tl:ir;if(c.call(a,i))return u(s.get(i));if(c.call(a,o))return u(s.get(o));s!==a&&s.get(i)},get size(){const i=this.__v_raw;return!t&&gr(st(i),"iterate",Bi),Reflect.get(i,"size",i)},has(i){const s=this.__v_raw,a=st(s),o=st(i);return t||(ri(i,o)&&gr(a,"has",i),gr(a,"has",o)),i===o?s.has(i):s.has(i)||s.has(o)},forEach(i,s){const a=this,o=a.__v_raw,c=st(o),u=e?du:t?tl:ir;return!t&&gr(c,"iterate",Bi),o.forEach((f,d)=>i.call(s,u(f),u(d),a))}};return xr(r,t?{add:Po("add"),set:Po("set"),delete:Po("delete"),clear:Po("clear")}:{add(i){!e&&!qr(i)&&!ui(i)&&(i=st(i));const s=st(this);return Ro(s).has.call(s,i)||(s.add(i),Pn(s,"add",i,i)),this},set(i,s){!e&&!qr(s)&&!ui(s)&&(s=st(s));const a=st(this),{has:o,get:c}=Ro(a);let u=o.call(a,i);u||(i=st(i),u=o.call(a,i));const f=c.call(a,i);return a.set(i,s),u?ri(s,f)&&Pn(a,"set",i,s):Pn(a,"add",i,s),this},delete(i){const s=st(this),{has:a,get:o}=Ro(s);let c=a.call(s,i);c||(i=st(i),c=a.call(s,i)),o&&o.call(s,i);const u=s.delete(i);return c&&Pn(s,"delete",i,void 0),u},clear(){const i=st(this),s=i.size!==0,a=i.clear();return s&&Pn(i,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(i=>{r[i]=Uv(i,t,e)}),r}function nf(t,e){const r=Hv(t,e);return(n,i,s)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?n:Reflect.get(at(r,i)&&i in n?r:n,i,s)}const $v={get:nf(!1,!1)},Wv={get:nf(!1,!0)},jv={get:nf(!0,!1)};const Up=new WeakMap,Hp=new WeakMap,$p=new WeakMap,Gv=new WeakMap;function zv(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Kv(t){return t.__v_skip||!Object.isExtensible(t)?0:zv(_v(t))}function sf(t){return ui(t)?t:af(t,!1,Mv,$v,Up)}function qv(t){return af(t,!1,Bv,Wv,Hp)}function Wp(t){return af(t,!0,Vv,jv,$p)}function af(t,e,r,n,i){if(!Et(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const s=Kv(t);if(s===0)return t;const a=i.get(t);if(a)return a;const o=new Proxy(t,s===2?n:r);return i.set(t,o),o}function Ts(t){return ui(t)?Ts(t.__v_raw):!!(t&&t.__v_isReactive)}function ui(t){return!!(t&&t.__v_isReadonly)}function qr(t){return!!(t&&t.__v_isShallow)}function of(t){return t?!!t.__v_raw:!1}function st(t){const e=t&&t.__v_raw;return e?st(e):t}function Xv(t){return!at(t,"__v_skip")&&Object.isExtensible(t)&&Sp(t,"__v_skip",!0),t}const ir=t=>Et(t)?sf(t):t,tl=t=>Et(t)?Wp(t):t;function Wt(t){return t?t.__v_isRef===!0:!1}function zt(t){return Yv(t,!1)}function Yv(t,e){return Wt(t)?t:new Qv(t,e)}class Qv{constructor(e,r){this.dep=new rf,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=r?e:st(e),this._value=r?e:ir(e),this.__v_isShallow=r}get value(){return this.dep.track(),this._value}set value(e){const r=this._rawValue,n=this.__v_isShallow||qr(e)||ui(e);e=n?e:st(e),ri(e,r)&&(this._rawValue=e,this._value=n?e:ir(e),this.dep.trigger())}}function ot(t){return Wt(t)?t.value:t}const Jv={get:(t,e,r)=>e==="__v_raw"?t:ot(Reflect.get(t,e,r)),set:(t,e,r,n)=>{const i=t[e];return Wt(i)&&!Wt(r)?(i.value=r,!0):Reflect.set(t,e,r,n)}};function jp(t){return Ts(t)?t:new Proxy(t,Jv)}class Zv{constructor(e,r,n){this.fn=e,this.setter=r,this._value=void 0,this.dep=new rf(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ba-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!r,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&vt!==this)return Dp(this,!0),!0}get value(){const e=this.dep.track();return kp(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function ex(t,e,r=!1){let n,i;return Ge(t)?n=t:(n=t.get,i=t.set),new Zv(n,i,r)}const Fo={},rl=new WeakMap;let ki;function tx(t,e=!1,r=ki){if(r){let n=rl.get(r);n||rl.set(r,n=[]),n.push(t)}}function rx(t,e,r=_t){const{immediate:n,deep:i,once:s,scheduler:a,augmentJob:o,call:c}=r,u=U=>i?U:qr(U)||i===!1||i===0?Fn(U,1):Fn(U);let f,d,p,g,v=!1,_=!1;if(Wt(t)?(d=()=>t.value,v=qr(t)):Ts(t)?(d=()=>u(t),v=!0):Me(t)?(_=!0,v=t.some(U=>Ts(U)||qr(U)),d=()=>t.map(U=>{if(Wt(U))return U.value;if(Ts(U))return u(U);if(Ge(U))return c?c(U,2):U()})):Ge(t)?e?d=c?()=>c(t,2):t:d=()=>{if(p){kn();try{p()}finally{Nn()}}const U=ki;ki=f;try{return c?c(t,3,[g]):t(g)}finally{ki=U}}:d=dn,e&&i){const U=d,re=i===!0?1/0:i;d=()=>Fn(U(),re)}const E=Pv(),L=()=>{f.stop(),E&&E.active&&Yu(E.effects,f)};if(s&&e){const U=e;e=(...re)=>{U(...re),L()}}let V=_?new Array(t.length).fill(Fo):Fo;const N=U=>{if(!(!(f.flags&1)||!f.dirty&&!U))if(e){const re=f.run();if(i||v||(_?re.some((le,w)=>ri(le,V[w])):ri(re,V))){p&&p();const le=ki;ki=f;try{const w=[re,V===Fo?void 0:_&&V[0]===Fo?[]:V,g];V=re,c?c(e,3,w):e(...w)}finally{ki=le}}}else f.run()};return o&&o(N),f=new Pp(d),f.scheduler=a?()=>a(N,!1):N,g=U=>tx(U,!1,f),p=f.onStop=()=>{const U=rl.get(f);if(U){if(c)c(U,4);else for(const re of U)re();rl.delete(f)}},e?n?N(!0):V=f.run():a?a(N.bind(null,!0),!0):f.run(),L.pause=f.pause.bind(f),L.resume=f.resume.bind(f),L.stop=L,L}function Fn(t,e=1/0,r){if(e<=0||!Et(t)||t.__v_skip||(r=r||new Set,r.has(t)))return t;if(r.add(t),e--,Wt(t))Fn(t.value,e,r);else if(Me(t))for(let n=0;n<t.length;n++)Fn(t[n],e,r);else if(Gl(t)||ys(t))t.forEach(n=>{Fn(n,e,r)});else if(wp(t)){for(const n in t)Fn(t[n],e,r);for(const n of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,n)&&Fn(t[n],e,r)}return t}/**
* @vue/runtime-core v3.5.16
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function eo(t,e,r,n){try{return n?t(...n):t()}catch(i){Ql(i,e,r)}}function vn(t,e,r,n){if(Ge(t)){const i=eo(t,e,r,n);return i&&yp(i)&&i.catch(s=>{Ql(s,e,r)}),i}if(Me(t)){const i=[];for(let s=0;s<t.length;s++)i.push(vn(t[s],e,r,n));return i}}function Ql(t,e,r,n=!0){const i=e?e.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:a}=e&&e.appContext.config||_t;if(e){let o=e.parent;const c=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${r}`;for(;o;){const f=o.ec;if(f){for(let d=0;d<f.length;d++)if(f[d](t,c,u)===!1)return}o=o.parent}if(s){kn(),eo(s,null,10,[t,c,u]),Nn();return}}nx(t,r,i,n,a)}function nx(t,e,r,n=!0,i=!1){if(i)throw t;console.error(t)}const Ar=[];let un=-1;const ws=[];let Qn=null,fs=0;const Gp=Promise.resolve();let nl=null;function zp(t){const e=nl||Gp;return t?e.then(this?t.bind(this):t):e}function ix(t){let e=un+1,r=Ar.length;for(;e<r;){const n=e+r>>>1,i=Ar[n],s=Na(i);s<t||s===t&&i.flags&2?e=n+1:r=n}return e}function lf(t){if(!(t.flags&1)){const e=Na(t),r=Ar[Ar.length-1];!r||!(t.flags&2)&&e>=Na(r)?Ar.push(t):Ar.splice(ix(e),0,t),t.flags|=1,Kp()}}function Kp(){nl||(nl=Gp.then(Xp))}function sx(t){Me(t)?ws.push(...t):Qn&&t.id===-1?Qn.splice(fs+1,0,t):t.flags&1||(ws.push(t),t.flags|=1),Kp()}function e0(t,e,r=un+1){for(;r<Ar.length;r++){const n=Ar[r];if(n&&n.flags&2){if(t&&n.id!==t.uid)continue;Ar.splice(r,1),r--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function qp(t){if(ws.length){const e=[...new Set(ws)].sort((r,n)=>Na(r)-Na(n));if(ws.length=0,Qn){Qn.push(...e);return}for(Qn=e,fs=0;fs<Qn.length;fs++){const r=Qn[fs];r.flags&4&&(r.flags&=-2),r.flags&8||r(),r.flags&=-2}Qn=null,fs=0}}const Na=t=>t.id==null?t.flags&2?-1:1/0:t.id;function Xp(t){try{for(un=0;un<Ar.length;un++){const e=Ar[un];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),eo(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;un<Ar.length;un++){const e=Ar[un];e&&(e.flags&=-2)}un=-1,Ar.length=0,qp(),nl=null,(Ar.length||ws.length)&&Xp()}}let Kr=null,Yp=null;function il(t){const e=Kr;return Kr=t,Yp=t&&t.type.__scopeId||null,e}function ax(t,e=Kr,r){if(!e||t._n)return t;const n=(...i)=>{n._d&&c0(-1);const s=il(e);let a;try{a=t(...i)}finally{il(s),n._d&&c0(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}function Hi(t,e){if(Kr===null)return t;const r=tc(Kr),n=t.dirs||(t.dirs=[]);for(let i=0;i<e.length;i++){let[s,a,o,c=_t]=e[i];s&&(Ge(s)&&(s={mounted:s,updated:s}),s.deep&&Fn(a),n.push({dir:s,instance:r,value:a,oldValue:void 0,arg:o,modifiers:c}))}return t}function Oi(t,e,r,n){const i=t.dirs,s=e&&e.dirs;for(let a=0;a<i.length;a++){const o=i[a];s&&(o.oldValue=s[a].value);let c=o.dir[n];c&&(kn(),vn(c,r,8,[t.el,o,t,e]),Nn())}}const ox=Symbol("_vte"),lx=t=>t.__isTeleport;function cf(t,e){t.shapeFlag&6&&t.component?(t.transition=e,cf(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}/*! #__NO_SIDE_EFFECTS__ */function Hn(t,e){return Ge(t)?xr({name:t.name},e,{setup:t}):t}function Qp(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function sl(t,e,r,n,i=!1){if(Me(t)){t.forEach((v,_)=>sl(v,e&&(Me(e)?e[_]:e),r,n,i));return}if(xa(n)&&!i){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&sl(t,e,r,n.component.subTree);return}const s=n.shapeFlag&4?tc(n.component):n.el,a=i?null:s,{i:o,r:c}=t,u=e&&e.r,f=o.refs===_t?o.refs={}:o.refs,d=o.setupState,p=st(d),g=d===_t?()=>!1:v=>at(p,v);if(u!=null&&u!==c&&(Mt(u)?(f[u]=null,g(u)&&(d[u]=null)):Wt(u)&&(u.value=null)),Ge(c))eo(c,o,12,[a,f]);else{const v=Mt(c),_=Wt(c);if(v||_){const E=()=>{if(t.f){const L=v?g(c)?d[c]:f[c]:c.value;i?Me(L)&&Yu(L,s):Me(L)?L.includes(s)||L.push(s):v?(f[c]=[s],g(c)&&(d[c]=f[c])):(c.value=[s],t.k&&(f[t.k]=c.value))}else v?(f[c]=a,g(c)&&(d[c]=a)):_&&(c.value=a,t.k&&(f[t.k]=a))};a?(E.id=-1,Lr(E,r)):E()}}}Kl().requestIdleCallback;Kl().cancelIdleCallback;const xa=t=>!!t.type.__asyncLoader,Jp=t=>t.type.__isKeepAlive;function cx(t,e){Zp(t,"a",e)}function ux(t,e){Zp(t,"da",e)}function Zp(t,e,r=Sr){const n=t.__wdc||(t.__wdc=()=>{let i=r;for(;i;){if(i.isDeactivated)return;i=i.parent}return t()});if(Jl(e,n,r),r){let i=r.parent;for(;i&&i.parent;)Jp(i.parent.vnode)&&fx(n,e,r,i),i=i.parent}}function fx(t,e,r,n){const i=Jl(e,t,n,!0);t1(()=>{Yu(n[e],i)},r)}function Jl(t,e,r=Sr,n=!1){if(r){const i=r[t]||(r[t]=[]),s=e.__weh||(e.__weh=(...a)=>{kn();const o=to(r),c=vn(e,r,t,a);return o(),Nn(),c});return n?i.unshift(s):i.push(s),s}}const $n=t=>(e,r=Sr)=>{(!Ma||t==="sp")&&Jl(t,(...n)=>e(...n),r)},hx=$n("bm"),e1=$n("m"),dx=$n("bu"),px=$n("u"),gx=$n("bum"),t1=$n("um"),mx=$n("sp"),_x=$n("rtg"),vx=$n("rtc");function xx(t,e=Sr){Jl("ec",t,e)}const Ex=Symbol.for("v-ndc");function nn(t,e,r,n){let i;const s=r,a=Me(t);if(a||Mt(t)){const o=a&&Ts(t);let c=!1,u=!1;o&&(c=!qr(t),u=ui(t),t=Yl(t)),i=new Array(t.length);for(let f=0,d=t.length;f<d;f++)i[f]=e(c?u?tl(ir(t[f])):ir(t[f]):t[f],f,void 0,s)}else if(typeof t=="number"){i=new Array(t);for(let o=0;o<t;o++)i[o]=e(o+1,o,void 0,s)}else if(Et(t))if(t[Symbol.iterator])i=Array.from(t,(o,c)=>e(o,c,void 0,s));else{const o=Object.keys(t);i=new Array(o.length);for(let c=0,u=o.length;c<u;c++){const f=o[c];i[c]=e(t[f],f,c,s)}}else i=[];return i}const pu=t=>t?w1(t)?tc(t):pu(t.parent):null,Ea=xr(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>pu(t.parent),$root:t=>pu(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>n1(t),$forceUpdate:t=>t.f||(t.f=()=>{lf(t.update)}),$nextTick:t=>t.n||(t.n=zp.bind(t.proxy)),$watch:t=>$x.bind(t)}),$c=(t,e)=>t!==_t&&!t.__isScriptSetup&&at(t,e),yx={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:r,setupState:n,data:i,props:s,accessCache:a,type:o,appContext:c}=t;let u;if(e[0]!=="$"){const g=a[e];if(g!==void 0)switch(g){case 1:return n[e];case 2:return i[e];case 4:return r[e];case 3:return s[e]}else{if($c(n,e))return a[e]=1,n[e];if(i!==_t&&at(i,e))return a[e]=2,i[e];if((u=t.propsOptions[0])&&at(u,e))return a[e]=3,s[e];if(r!==_t&&at(r,e))return a[e]=4,r[e];gu&&(a[e]=0)}}const f=Ea[e];let d,p;if(f)return e==="$attrs"&&gr(t.attrs,"get",""),f(t);if((d=o.__cssModules)&&(d=d[e]))return d;if(r!==_t&&at(r,e))return a[e]=4,r[e];if(p=c.config.globalProperties,at(p,e))return p[e]},set({_:t},e,r){const{data:n,setupState:i,ctx:s}=t;return $c(i,e)?(i[e]=r,!0):n!==_t&&at(n,e)?(n[e]=r,!0):at(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(s[e]=r,!0)},has({_:{data:t,setupState:e,accessCache:r,ctx:n,appContext:i,propsOptions:s}},a){let o;return!!r[a]||t!==_t&&at(t,a)||$c(e,a)||(o=s[0])&&at(o,a)||at(n,a)||at(Ea,a)||at(i.config.globalProperties,a)},defineProperty(t,e,r){return r.get!=null?t._.accessCache[e]=0:at(r,"value")&&this.set(t,e,r.value,null),Reflect.defineProperty(t,e,r)}};function t0(t){return Me(t)?t.reduce((e,r)=>(e[r]=null,e),{}):t}let gu=!0;function Tx(t){const e=n1(t),r=t.proxy,n=t.ctx;gu=!1,e.beforeCreate&&r0(e.beforeCreate,t,"bc");const{data:i,computed:s,methods:a,watch:o,provide:c,inject:u,created:f,beforeMount:d,mounted:p,beforeUpdate:g,updated:v,activated:_,deactivated:E,beforeDestroy:L,beforeUnmount:V,destroyed:N,unmounted:U,render:re,renderTracked:le,renderTriggered:w,errorCaptured:T,serverPrefetch:y,expose:I,inheritAttrs:P,components:k,directives:R,filters:We}=e;if(u&&wx(u,n,null),a)for(const Ne in a){const He=a[Ne];Ge(He)&&(n[Ne]=He.bind(r))}if(i){const Ne=i.call(r,r);Et(Ne)&&(t.data=sf(Ne))}if(gu=!0,s)for(const Ne in s){const He=s[Ne],it=Ge(He)?He.bind(r,r):Ge(He.get)?He.get.bind(r,r):dn,Dt=!Ge(He)&&Ge(He.set)?He.set.bind(r):dn,At=S1({get:it,set:Dt});Object.defineProperty(n,Ne,{enumerable:!0,configurable:!0,get:()=>At.value,set:M=>At.value=M})}if(o)for(const Ne in o)r1(o[Ne],n,r,Ne);if(c){const Ne=Ge(c)?c.call(r):c;Reflect.ownKeys(Ne).forEach(He=>{Px(He,Ne[He])})}f&&r0(f,t,"c");function Qe(Ne,He){Me(He)?He.forEach(it=>Ne(it.bind(r))):He&&Ne(He.bind(r))}if(Qe(hx,d),Qe(e1,p),Qe(dx,g),Qe(px,v),Qe(cx,_),Qe(ux,E),Qe(xx,T),Qe(vx,le),Qe(_x,w),Qe(gx,V),Qe(t1,U),Qe(mx,y),Me(I))if(I.length){const Ne=t.exposed||(t.exposed={});I.forEach(He=>{Object.defineProperty(Ne,He,{get:()=>r[He],set:it=>r[He]=it})})}else t.exposed||(t.exposed={});re&&t.render===dn&&(t.render=re),P!=null&&(t.inheritAttrs=P),k&&(t.components=k),R&&(t.directives=R),y&&Qp(t)}function wx(t,e,r=dn){Me(t)&&(t=mu(t));for(const n in t){const i=t[n];let s;Et(i)?"default"in i?s=Go(i.from||n,i.default,!0):s=Go(i.from||n):s=Go(i),Wt(s)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>s.value,set:a=>s.value=a}):e[n]=s}}function r0(t,e,r){vn(Me(t)?t.map(n=>n.bind(e.proxy)):t.bind(e.proxy),e,r)}function r1(t,e,r,n){let i=n.includes(".")?m1(r,n):()=>r[n];if(Mt(t)){const s=e[t];Ge(s)&&Ss(i,s)}else if(Ge(t))Ss(i,t.bind(r));else if(Et(t))if(Me(t))t.forEach(s=>r1(s,e,r,n));else{const s=Ge(t.handler)?t.handler.bind(r):e[t.handler];Ge(s)&&Ss(i,s,t)}}function n1(t){const e=t.type,{mixins:r,extends:n}=e,{mixins:i,optionsCache:s,config:{optionMergeStrategies:a}}=t.appContext,o=s.get(e);let c;return o?c=o:!i.length&&!r&&!n?c=e:(c={},i.length&&i.forEach(u=>al(c,u,a,!0)),al(c,e,a)),Et(e)&&s.set(e,c),c}function al(t,e,r,n=!1){const{mixins:i,extends:s}=e;s&&al(t,s,r,!0),i&&i.forEach(a=>al(t,a,r,!0));for(const a in e)if(!(n&&a==="expose")){const o=Ax[a]||r&&r[a];t[a]=o?o(t[a],e[a]):e[a]}return t}const Ax={data:n0,props:i0,emits:i0,methods:fa,computed:fa,beforeCreate:yr,created:yr,beforeMount:yr,mounted:yr,beforeUpdate:yr,updated:yr,beforeDestroy:yr,beforeUnmount:yr,destroyed:yr,unmounted:yr,activated:yr,deactivated:yr,errorCaptured:yr,serverPrefetch:yr,components:fa,directives:fa,watch:Ix,provide:n0,inject:Sx};function n0(t,e){return e?t?function(){return xr(Ge(t)?t.call(this,this):t,Ge(e)?e.call(this,this):e)}:e:t}function Sx(t,e){return fa(mu(t),mu(e))}function mu(t){if(Me(t)){const e={};for(let r=0;r<t.length;r++)e[t[r]]=t[r];return e}return t}function yr(t,e){return t?[...new Set([].concat(t,e))]:e}function fa(t,e){return t?xr(Object.create(null),t,e):e}function i0(t,e){return t?Me(t)&&Me(e)?[...new Set([...t,...e])]:xr(Object.create(null),t0(t),t0(e??{})):e}function Ix(t,e){if(!t)return e;if(!e)return t;const r=xr(Object.create(null),t);for(const n in e)r[n]=yr(t[n],e[n]);return r}function i1(){return{app:null,config:{isNativeTag:gv,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Cx=0;function Rx(t,e){return function(n,i=null){Ge(n)||(n=xr({},n)),i!=null&&!Et(i)&&(i=null);const s=i1(),a=new WeakSet,o=[];let c=!1;const u=s.app={_uid:Cx++,_component:n,_props:i,_container:null,_context:s,_instance:null,version:c2,get config(){return s.config},set config(f){},use(f,...d){return a.has(f)||(f&&Ge(f.install)?(a.add(f),f.install(u,...d)):Ge(f)&&(a.add(f),f(u,...d))),u},mixin(f){return s.mixins.includes(f)||s.mixins.push(f),u},component(f,d){return d?(s.components[f]=d,u):s.components[f]},directive(f,d){return d?(s.directives[f]=d,u):s.directives[f]},mount(f,d,p){if(!c){const g=u._ceVNode||qt(n,i);return g.appContext=s,p===!0?p="svg":p===!1&&(p=void 0),t(g,f,p),c=!0,u._container=f,f.__vue_app__=u,tc(g.component)}},onUnmount(f){o.push(f)},unmount(){c&&(vn(o,u._instance,16),t(null,u._container),delete u._container.__vue_app__)},provide(f,d){return s.provides[f]=d,u},runWithContext(f){const d=As;As=u;try{return f()}finally{As=d}}};return u}}let As=null;function Px(t,e){if(Sr){let r=Sr.provides;const n=Sr.parent&&Sr.parent.provides;n===r&&(r=Sr.provides=Object.create(n)),r[t]=e}}function Go(t,e,r=!1){const n=Sr||Kr;if(n||As){let i=As?As._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(i&&t in i)return i[t];if(arguments.length>1)return r&&Ge(e)?e.call(n&&n.proxy):e}}const s1={},a1=()=>Object.create(s1),o1=t=>Object.getPrototypeOf(t)===s1;function Fx(t,e,r,n=!1){const i={},s=a1();t.propsDefaults=Object.create(null),l1(t,e,i,s);for(const a in t.propsOptions[0])a in i||(i[a]=void 0);r?t.props=n?i:qv(i):t.type.props?t.props=i:t.props=s,t.attrs=s}function Dx(t,e,r,n){const{props:i,attrs:s,vnode:{patchFlag:a}}=t,o=st(i),[c]=t.propsOptions;let u=!1;if((n||a>0)&&!(a&16)){if(a&8){const f=t.vnode.dynamicProps;for(let d=0;d<f.length;d++){let p=f[d];if(Zl(t.emitsOptions,p))continue;const g=e[p];if(c)if(at(s,p))g!==s[p]&&(s[p]=g,u=!0);else{const v=ci(p);i[v]=_u(c,o,v,g,t,!1)}else g!==s[p]&&(s[p]=g,u=!0)}}}else{l1(t,e,i,s)&&(u=!0);let f;for(const d in o)(!e||!at(e,d)&&((f=Ti(d))===d||!at(e,f)))&&(c?r&&(r[d]!==void 0||r[f]!==void 0)&&(i[d]=_u(c,o,d,void 0,t,!0)):delete i[d]);if(s!==o)for(const d in s)(!e||!at(e,d))&&(delete s[d],u=!0)}u&&Pn(t.attrs,"set","")}function l1(t,e,r,n){const[i,s]=t.propsOptions;let a=!1,o;if(e)for(let c in e){if(ma(c))continue;const u=e[c];let f;i&&at(i,f=ci(c))?!s||!s.includes(f)?r[f]=u:(o||(o={}))[f]=u:Zl(t.emitsOptions,c)||(!(c in n)||u!==n[c])&&(n[c]=u,a=!0)}if(s){const c=st(r),u=o||_t;for(let f=0;f<s.length;f++){const d=s[f];r[d]=_u(i,c,d,u[d],t,!at(u,d))}}return a}function _u(t,e,r,n,i,s){const a=t[r];if(a!=null){const o=at(a,"default");if(o&&n===void 0){const c=a.default;if(a.type!==Function&&!a.skipFactory&&Ge(c)){const{propsDefaults:u}=i;if(r in u)n=u[r];else{const f=to(i);n=u[r]=c.call(null,e),f()}}else n=c;i.ce&&i.ce._setProp(r,n)}a[0]&&(s&&!o?n=!1:a[1]&&(n===""||n===Ti(r))&&(n=!0))}return n}const Ox=new WeakMap;function c1(t,e,r=!1){const n=r?Ox:e.propsCache,i=n.get(t);if(i)return i;const s=t.props,a={},o=[];let c=!1;if(!Ge(t)){const f=d=>{c=!0;const[p,g]=c1(d,e,!0);xr(a,p),g&&o.push(...g)};!r&&e.mixins.length&&e.mixins.forEach(f),t.extends&&f(t.extends),t.mixins&&t.mixins.forEach(f)}if(!s&&!c)return Et(t)&&n.set(t,Es),Es;if(Me(s))for(let f=0;f<s.length;f++){const d=ci(s[f]);s0(d)&&(a[d]=_t)}else if(s)for(const f in s){const d=ci(f);if(s0(d)){const p=s[f],g=a[d]=Me(p)||Ge(p)?{type:p}:xr({},p),v=g.type;let _=!1,E=!0;if(Me(v))for(let L=0;L<v.length;++L){const V=v[L],N=Ge(V)&&V.name;if(N==="Boolean"){_=!0;break}else N==="String"&&(E=!1)}else _=Ge(v)&&v.name==="Boolean";g[0]=_,g[1]=E,(_||at(g,"default"))&&o.push(d)}}const u=[a,o];return Et(t)&&n.set(t,u),u}function s0(t){return t[0]!=="$"&&!ma(t)}const uf=t=>t[0]==="_"||t==="$stable",ff=t=>Me(t)?t.map(hn):[hn(t)],bx=(t,e,r)=>{if(e._n)return e;const n=ax((...i)=>ff(e(...i)),r);return n._c=!1,n},u1=(t,e,r)=>{const n=t._ctx;for(const i in t){if(uf(i))continue;const s=t[i];if(Ge(s))e[i]=bx(i,s,n);else if(s!=null){const a=ff(s);e[i]=()=>a}}},f1=(t,e)=>{const r=ff(e);t.slots.default=()=>r},h1=(t,e,r)=>{for(const n in e)(r||!uf(n))&&(t[n]=e[n])},kx=(t,e,r)=>{const n=t.slots=a1();if(t.vnode.shapeFlag&32){const i=e._;i?(h1(n,e,r),r&&Sp(n,"_",i,!0)):u1(e,n)}else e&&f1(t,e)},Nx=(t,e,r)=>{const{vnode:n,slots:i}=t;let s=!0,a=_t;if(n.shapeFlag&32){const o=e._;o?r&&o===1?s=!1:h1(i,e,r):(s=!e.$stable,u1(e,i)),a=e}else e&&(f1(t,e),a={default:1});if(s)for(const o in i)!uf(o)&&a[o]==null&&delete i[o]},Lr=Xx;function Lx(t){return Mx(t)}function Mx(t,e){const r=Kl();r.__VUE__=!0;const{insert:n,remove:i,patchProp:s,createElement:a,createText:o,createComment:c,setText:u,setElementText:f,parentNode:d,nextSibling:p,setScopeId:g=dn,insertStaticContent:v}=t,_=(b,B,K,ae=null,te=null,z=null,pe=void 0,he=null,fe=!!B.dynamicChildren)=>{if(b===B)return;b&&!ca(b,B)&&(ae=Ae(b),M(b,te,z,!0),b=null),B.patchFlag===-2&&(fe=!1,B.dynamicChildren=null);const{type:oe,ref:Pe,shapeFlag:Ee}=B;switch(oe){case ec:E(b,B,K,ae);break;case fi:L(b,B,K,ae);break;case jc:b==null&&V(B,K,ae,pe);break;case Ft:k(b,B,K,ae,te,z,pe,he,fe);break;default:Ee&1?re(b,B,K,ae,te,z,pe,he,fe):Ee&6?R(b,B,K,ae,te,z,pe,he,fe):(Ee&64||Ee&128)&&oe.process(b,B,K,ae,te,z,pe,he,fe,me)}Pe!=null&&te&&sl(Pe,b&&b.ref,z,B||b,!B)},E=(b,B,K,ae)=>{if(b==null)n(B.el=o(B.children),K,ae);else{const te=B.el=b.el;B.children!==b.children&&u(te,B.children)}},L=(b,B,K,ae)=>{b==null?n(B.el=c(B.children||""),K,ae):B.el=b.el},V=(b,B,K,ae)=>{[b.el,b.anchor]=v(b.children,B,K,ae,b.el,b.anchor)},N=({el:b,anchor:B},K,ae)=>{let te;for(;b&&b!==B;)te=p(b),n(b,K,ae),b=te;n(B,K,ae)},U=({el:b,anchor:B})=>{let K;for(;b&&b!==B;)K=p(b),i(b),b=K;i(B)},re=(b,B,K,ae,te,z,pe,he,fe)=>{B.type==="svg"?pe="svg":B.type==="math"&&(pe="mathml"),b==null?le(B,K,ae,te,z,pe,he,fe):y(b,B,te,z,pe,he,fe)},le=(b,B,K,ae,te,z,pe,he)=>{let fe,oe;const{props:Pe,shapeFlag:Ee,transition:Se,dirs:Oe}=b;if(fe=b.el=a(b.type,z,Pe&&Pe.is,Pe),Ee&8?f(fe,b.children):Ee&16&&T(b.children,fe,null,ae,te,Wc(b,z),pe,he),Oe&&Oi(b,null,ae,"created"),w(fe,b,b.scopeId,pe,ae),Pe){for(const Ve in Pe)Ve!=="value"&&!ma(Ve)&&s(fe,Ve,null,Pe[Ve],z,ae);"value"in Pe&&s(fe,"value",null,Pe.value,z),(oe=Pe.onVnodeBeforeMount)&&on(oe,ae,b)}Oe&&Oi(b,null,ae,"beforeMount");const Fe=Vx(te,Se);Fe&&Se.beforeEnter(fe),n(fe,B,K),((oe=Pe&&Pe.onVnodeMounted)||Fe||Oe)&&Lr(()=>{oe&&on(oe,ae,b),Fe&&Se.enter(fe),Oe&&Oi(b,null,ae,"mounted")},te)},w=(b,B,K,ae,te)=>{if(K&&g(b,K),ae)for(let z=0;z<ae.length;z++)g(b,ae[z]);if(te){let z=te.subTree;if(B===z||v1(z.type)&&(z.ssContent===B||z.ssFallback===B)){const pe=te.vnode;w(b,pe,pe.scopeId,pe.slotScopeIds,te.parent)}}},T=(b,B,K,ae,te,z,pe,he,fe=0)=>{for(let oe=fe;oe<b.length;oe++){const Pe=b[oe]=he?Jn(b[oe]):hn(b[oe]);_(null,Pe,B,K,ae,te,z,pe,he)}},y=(b,B,K,ae,te,z,pe)=>{const he=B.el=b.el;let{patchFlag:fe,dynamicChildren:oe,dirs:Pe}=B;fe|=b.patchFlag&16;const Ee=b.props||_t,Se=B.props||_t;let Oe;if(K&&bi(K,!1),(Oe=Se.onVnodeBeforeUpdate)&&on(Oe,K,B,b),Pe&&Oi(B,b,K,"beforeUpdate"),K&&bi(K,!0),(Ee.innerHTML&&Se.innerHTML==null||Ee.textContent&&Se.textContent==null)&&f(he,""),oe?I(b.dynamicChildren,oe,he,K,ae,Wc(B,te),z):pe||He(b,B,he,null,K,ae,Wc(B,te),z,!1),fe>0){if(fe&16)P(he,Ee,Se,K,te);else if(fe&2&&Ee.class!==Se.class&&s(he,"class",null,Se.class,te),fe&4&&s(he,"style",Ee.style,Se.style,te),fe&8){const Fe=B.dynamicProps;for(let Ve=0;Ve<Fe.length;Ve++){const je=Fe[Ve],Kt=Ee[je],Ot=Se[je];(Ot!==Kt||je==="value")&&s(he,je,Kt,Ot,te,K)}}fe&1&&b.children!==B.children&&f(he,B.children)}else!pe&&oe==null&&P(he,Ee,Se,K,te);((Oe=Se.onVnodeUpdated)||Pe)&&Lr(()=>{Oe&&on(Oe,K,B,b),Pe&&Oi(B,b,K,"updated")},ae)},I=(b,B,K,ae,te,z,pe)=>{for(let he=0;he<B.length;he++){const fe=b[he],oe=B[he],Pe=fe.el&&(fe.type===Ft||!ca(fe,oe)||fe.shapeFlag&198)?d(fe.el):K;_(fe,oe,Pe,null,ae,te,z,pe,!0)}},P=(b,B,K,ae,te)=>{if(B!==K){if(B!==_t)for(const z in B)!ma(z)&&!(z in K)&&s(b,z,B[z],null,te,ae);for(const z in K){if(ma(z))continue;const pe=K[z],he=B[z];pe!==he&&z!=="value"&&s(b,z,he,pe,te,ae)}"value"in K&&s(b,"value",B.value,K.value,te)}},k=(b,B,K,ae,te,z,pe,he,fe)=>{const oe=B.el=b?b.el:o(""),Pe=B.anchor=b?b.anchor:o("");let{patchFlag:Ee,dynamicChildren:Se,slotScopeIds:Oe}=B;Oe&&(he=he?he.concat(Oe):Oe),b==null?(n(oe,K,ae),n(Pe,K,ae),T(B.children||[],K,Pe,te,z,pe,he,fe)):Ee>0&&Ee&64&&Se&&b.dynamicChildren?(I(b.dynamicChildren,Se,K,te,z,pe,he),(B.key!=null||te&&B===te.subTree)&&d1(b,B,!0)):He(b,B,K,Pe,te,z,pe,he,fe)},R=(b,B,K,ae,te,z,pe,he,fe)=>{B.slotScopeIds=he,b==null?B.shapeFlag&512?te.ctx.activate(B,K,ae,pe,fe):We(B,K,ae,te,z,pe,fe):ke(b,B,fe)},We=(b,B,K,ae,te,z,pe)=>{const he=b.component=n2(b,ae,te);if(Jp(b)&&(he.ctx.renderer=me),i2(he,!1,pe),he.asyncDep){if(te&&te.registerDep(he,Qe,pe),!b.el){const fe=he.subTree=qt(fi);L(null,fe,B,K)}}else Qe(he,b,B,K,te,z,pe)},ke=(b,B,K)=>{const ae=B.component=b.component;if(Kx(b,B,K))if(ae.asyncDep&&!ae.asyncResolved){Ne(ae,B,K);return}else ae.next=B,ae.update();else B.el=b.el,ae.vnode=B},Qe=(b,B,K,ae,te,z,pe)=>{const he=()=>{if(b.isMounted){let{next:Ee,bu:Se,u:Oe,parent:Fe,vnode:Ve}=b;{const Bt=p1(b);if(Bt){Ee&&(Ee.el=Ve.el,Ne(b,Ee,pe)),Bt.asyncDep.then(()=>{b.isUnmounted||he()});return}}let je=Ee,Kt;bi(b,!1),Ee?(Ee.el=Ve.el,Ne(b,Ee,pe)):Ee=Ve,Se&&jo(Se),(Kt=Ee.props&&Ee.props.onVnodeBeforeUpdate)&&on(Kt,Fe,Ee,Ve),bi(b,!0);const Ot=o0(b),Er=b.subTree;b.subTree=Ot,_(Er,Ot,d(Er.el),Ae(Er),b,te,z),Ee.el=Ot.el,je===null&&qx(b,Ot.el),Oe&&Lr(Oe,te),(Kt=Ee.props&&Ee.props.onVnodeUpdated)&&Lr(()=>on(Kt,Fe,Ee,Ve),te)}else{let Ee;const{el:Se,props:Oe}=B,{bm:Fe,m:Ve,parent:je,root:Kt,type:Ot}=b,Er=xa(B);bi(b,!1),Fe&&jo(Fe),!Er&&(Ee=Oe&&Oe.onVnodeBeforeMount)&&on(Ee,je,B),bi(b,!0);{Kt.ce&&Kt.ce._injectChildStyle(Ot);const Bt=b.subTree=o0(b);_(null,Bt,K,ae,b,te,z),B.el=Bt.el}if(Ve&&Lr(Ve,te),!Er&&(Ee=Oe&&Oe.onVnodeMounted)){const Bt=B;Lr(()=>on(Ee,je,Bt),te)}(B.shapeFlag&256||je&&xa(je.vnode)&&je.vnode.shapeFlag&256)&&b.a&&Lr(b.a,te),b.isMounted=!0,B=K=ae=null}};b.scope.on();const fe=b.effect=new Pp(he);b.scope.off();const oe=b.update=fe.run.bind(fe),Pe=b.job=fe.runIfDirty.bind(fe);Pe.i=b,Pe.id=b.uid,fe.scheduler=()=>lf(Pe),bi(b,!0),oe()},Ne=(b,B,K)=>{B.component=b;const ae=b.vnode.props;b.vnode=B,b.next=null,Dx(b,B.props,ae,K),Nx(b,B.children,K),kn(),e0(b),Nn()},He=(b,B,K,ae,te,z,pe,he,fe=!1)=>{const oe=b&&b.children,Pe=b?b.shapeFlag:0,Ee=B.children,{patchFlag:Se,shapeFlag:Oe}=B;if(Se>0){if(Se&128){Dt(oe,Ee,K,ae,te,z,pe,he,fe);return}else if(Se&256){it(oe,Ee,K,ae,te,z,pe,he,fe);return}}Oe&8?(Pe&16&&ne(oe,te,z),Ee!==oe&&f(K,Ee)):Pe&16?Oe&16?Dt(oe,Ee,K,ae,te,z,pe,he,fe):ne(oe,te,z,!0):(Pe&8&&f(K,""),Oe&16&&T(Ee,K,ae,te,z,pe,he,fe))},it=(b,B,K,ae,te,z,pe,he,fe)=>{b=b||Es,B=B||Es;const oe=b.length,Pe=B.length,Ee=Math.min(oe,Pe);let Se;for(Se=0;Se<Ee;Se++){const Oe=B[Se]=fe?Jn(B[Se]):hn(B[Se]);_(b[Se],Oe,K,null,te,z,pe,he,fe)}oe>Pe?ne(b,te,z,!0,!1,Ee):T(B,K,ae,te,z,pe,he,fe,Ee)},Dt=(b,B,K,ae,te,z,pe,he,fe)=>{let oe=0;const Pe=B.length;let Ee=b.length-1,Se=Pe-1;for(;oe<=Ee&&oe<=Se;){const Oe=b[oe],Fe=B[oe]=fe?Jn(B[oe]):hn(B[oe]);if(ca(Oe,Fe))_(Oe,Fe,K,null,te,z,pe,he,fe);else break;oe++}for(;oe<=Ee&&oe<=Se;){const Oe=b[Ee],Fe=B[Se]=fe?Jn(B[Se]):hn(B[Se]);if(ca(Oe,Fe))_(Oe,Fe,K,null,te,z,pe,he,fe);else break;Ee--,Se--}if(oe>Ee){if(oe<=Se){const Oe=Se+1,Fe=Oe<Pe?B[Oe].el:ae;for(;oe<=Se;)_(null,B[oe]=fe?Jn(B[oe]):hn(B[oe]),K,Fe,te,z,pe,he,fe),oe++}}else if(oe>Se)for(;oe<=Ee;)M(b[oe],te,z,!0),oe++;else{const Oe=oe,Fe=oe,Ve=new Map;for(oe=Fe;oe<=Se;oe++){const bt=B[oe]=fe?Jn(B[oe]):hn(B[oe]);bt.key!=null&&Ve.set(bt.key,oe)}let je,Kt=0;const Ot=Se-Fe+1;let Er=!1,Bt=0;const Yr=new Array(Ot);for(oe=0;oe<Ot;oe++)Yr[oe]=0;for(oe=Oe;oe<=Ee;oe++){const bt=b[oe];if(Kt>=Ot){M(bt,te,z,!0);continue}let Cr;if(bt.key!=null)Cr=Ve.get(bt.key);else for(je=Fe;je<=Se;je++)if(Yr[je-Fe]===0&&ca(bt,B[je])){Cr=je;break}Cr===void 0?M(bt,te,z,!0):(Yr[Cr-Fe]=oe+1,Cr>=Bt?Bt=Cr:Er=!0,_(bt,B[Cr],K,null,te,z,pe,he,fe),Kt++)}const Gn=Er?Bx(Yr):Es;for(je=Gn.length-1,oe=Ot-1;oe>=0;oe--){const bt=Fe+oe,Cr=B[bt],es=bt+1<Pe?B[bt+1].el:ae;Yr[oe]===0?_(null,Cr,K,es,te,z,pe,he,fe):Er&&(je<0||oe!==Gn[je]?At(Cr,K,es,2):je--)}}},At=(b,B,K,ae,te=null)=>{const{el:z,type:pe,transition:he,children:fe,shapeFlag:oe}=b;if(oe&6){At(b.component.subTree,B,K,ae);return}if(oe&128){b.suspense.move(B,K,ae);return}if(oe&64){pe.move(b,B,K,me);return}if(pe===Ft){n(z,B,K);for(let Ee=0;Ee<fe.length;Ee++)At(fe[Ee],B,K,ae);n(b.anchor,B,K);return}if(pe===jc){N(b,B,K);return}if(ae!==2&&oe&1&&he)if(ae===0)he.beforeEnter(z),n(z,B,K),Lr(()=>he.enter(z),te);else{const{leave:Ee,delayLeave:Se,afterLeave:Oe}=he,Fe=()=>{b.ctx.isUnmounted?i(z):n(z,B,K)},Ve=()=>{Ee(z,()=>{Fe(),Oe&&Oe()})};Se?Se(z,Fe,Ve):Ve()}else n(z,B,K)},M=(b,B,K,ae=!1,te=!1)=>{const{type:z,props:pe,ref:he,children:fe,dynamicChildren:oe,shapeFlag:Pe,patchFlag:Ee,dirs:Se,cacheIndex:Oe}=b;if(Ee===-2&&(te=!1),he!=null&&(kn(),sl(he,null,K,b,!0),Nn()),Oe!=null&&(B.renderCache[Oe]=void 0),Pe&256){B.ctx.deactivate(b);return}const Fe=Pe&1&&Se,Ve=!xa(b);let je;if(Ve&&(je=pe&&pe.onVnodeBeforeUnmount)&&on(je,B,b),Pe&6)H(b.component,K,ae);else{if(Pe&128){b.suspense.unmount(K,ae);return}Fe&&Oi(b,null,B,"beforeUnmount"),Pe&64?b.type.remove(b,B,K,me,ae):oe&&!oe.hasOnce&&(z!==Ft||Ee>0&&Ee&64)?ne(oe,B,K,!1,!0):(z===Ft&&Ee&384||!te&&Pe&16)&&ne(fe,B,K),ae&&G(b)}(Ve&&(je=pe&&pe.onVnodeUnmounted)||Fe)&&Lr(()=>{je&&on(je,B,b),Fe&&Oi(b,null,B,"unmounted")},K)},G=b=>{const{type:B,el:K,anchor:ae,transition:te}=b;if(B===Ft){W(K,ae);return}if(B===jc){U(b);return}const z=()=>{i(K),te&&!te.persisted&&te.afterLeave&&te.afterLeave()};if(b.shapeFlag&1&&te&&!te.persisted){const{leave:pe,delayLeave:he}=te,fe=()=>pe(K,z);he?he(b.el,z,fe):fe()}else z()},W=(b,B)=>{let K;for(;b!==B;)K=p(b),i(b),b=K;i(B)},H=(b,B,K)=>{const{bum:ae,scope:te,job:z,subTree:pe,um:he,m:fe,a:oe,parent:Pe,slots:{__:Ee}}=b;a0(fe),a0(oe),ae&&jo(ae),Pe&&Me(Ee)&&Ee.forEach(Se=>{Pe.renderCache[Se]=void 0}),te.stop(),z&&(z.flags|=8,M(pe,b,B,K)),he&&Lr(he,B),Lr(()=>{b.isUnmounted=!0},B),B&&B.pendingBranch&&!B.isUnmounted&&b.asyncDep&&!b.asyncResolved&&b.suspenseId===B.pendingId&&(B.deps--,B.deps===0&&B.resolve())},ne=(b,B,K,ae=!1,te=!1,z=0)=>{for(let pe=z;pe<b.length;pe++)M(b[pe],B,K,ae,te)},Ae=b=>{if(b.shapeFlag&6)return Ae(b.component.subTree);if(b.shapeFlag&128)return b.suspense.next();const B=p(b.anchor||b.el),K=B&&B[ox];return K?p(K):B};let Re=!1;const Ce=(b,B,K)=>{b==null?B._vnode&&M(B._vnode,null,null,!0):_(B._vnode||null,b,B,null,null,null,K),B._vnode=b,Re||(Re=!0,e0(),qp(),Re=!1)},me={p:_,um:M,m:At,r:G,mt:We,mc:T,pc:He,pbc:I,n:Ae,o:t};return{render:Ce,hydrate:void 0,createApp:Rx(Ce)}}function Wc({type:t,props:e},r){return r==="svg"&&t==="foreignObject"||r==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:r}function bi({effect:t,job:e},r){r?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function Vx(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function d1(t,e,r=!1){const n=t.children,i=e.children;if(Me(n)&&Me(i))for(let s=0;s<n.length;s++){const a=n[s];let o=i[s];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=i[s]=Jn(i[s]),o.el=a.el),!r&&o.patchFlag!==-2&&d1(a,o)),o.type===ec&&(o.el=a.el),o.type===fi&&!o.el&&(o.el=a.el)}}function Bx(t){const e=t.slice(),r=[0];let n,i,s,a,o;const c=t.length;for(n=0;n<c;n++){const u=t[n];if(u!==0){if(i=r[r.length-1],t[i]<u){e[n]=i,r.push(n);continue}for(s=0,a=r.length-1;s<a;)o=s+a>>1,t[r[o]]<u?s=o+1:a=o;u<t[r[s]]&&(s>0&&(e[n]=r[s-1]),r[s]=n)}}for(s=r.length,a=r[s-1];s-- >0;)r[s]=a,a=e[a];return r}function p1(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:p1(e)}function a0(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const Ux=Symbol.for("v-scx"),Hx=()=>Go(Ux);function Ss(t,e,r){return g1(t,e,r)}function g1(t,e,r=_t){const{immediate:n,deep:i,flush:s,once:a}=r,o=xr({},r),c=e&&n||!e&&s!=="post";let u;if(Ma){if(s==="sync"){const g=Hx();u=g.__watcherHandles||(g.__watcherHandles=[])}else if(!c){const g=()=>{};return g.stop=dn,g.resume=dn,g.pause=dn,g}}const f=Sr;o.call=(g,v,_)=>vn(g,f,v,_);let d=!1;s==="post"?o.scheduler=g=>{Lr(g,f&&f.suspense)}:s!=="sync"&&(d=!0,o.scheduler=(g,v)=>{v?g():lf(g)}),o.augmentJob=g=>{e&&(g.flags|=4),d&&(g.flags|=2,f&&(g.id=f.uid,g.i=f))};const p=rx(t,e,o);return Ma&&(u?u.push(p):c&&p()),p}function $x(t,e,r){const n=this.proxy,i=Mt(t)?t.includes(".")?m1(n,t):()=>n[t]:t.bind(n,n);let s;Ge(e)?s=e:(s=e.handler,r=e);const a=to(this),o=g1(i,s.bind(n),r);return a(),o}function m1(t,e){const r=e.split(".");return()=>{let n=t;for(let i=0;i<r.length&&n;i++)n=n[r[i]];return n}}const Wx=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${ci(e)}Modifiers`]||t[`${Ti(e)}Modifiers`];function jx(t,e,...r){if(t.isUnmounted)return;const n=t.vnode.props||_t;let i=r;const s=e.startsWith("update:"),a=s&&Wx(n,e.slice(7));a&&(a.trim&&(i=r.map(f=>Mt(f)?f.trim():f)),a.number&&(i=r.map(el)));let o,c=n[o=Mc(e)]||n[o=Mc(ci(e))];!c&&s&&(c=n[o=Mc(Ti(e))]),c&&vn(c,t,6,i);const u=n[o+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[o])return;t.emitted[o]=!0,vn(u,t,6,i)}}function _1(t,e,r=!1){const n=e.emitsCache,i=n.get(t);if(i!==void 0)return i;const s=t.emits;let a={},o=!1;if(!Ge(t)){const c=u=>{const f=_1(u,e,!0);f&&(o=!0,xr(a,f))};!r&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!s&&!o?(Et(t)&&n.set(t,null),null):(Me(s)?s.forEach(c=>a[c]=null):xr(a,s),Et(t)&&n.set(t,a),a)}function Zl(t,e){return!t||!jl(e)?!1:(e=e.slice(2).replace(/Once$/,""),at(t,e[0].toLowerCase()+e.slice(1))||at(t,Ti(e))||at(t,e))}function o0(t){const{type:e,vnode:r,proxy:n,withProxy:i,propsOptions:[s],slots:a,attrs:o,emit:c,render:u,renderCache:f,props:d,data:p,setupState:g,ctx:v,inheritAttrs:_}=t,E=il(t);let L,V;try{if(r.shapeFlag&4){const U=i||n,re=U;L=hn(u.call(re,U,f,d,g,p,v)),V=o}else{const U=e;L=hn(U.length>1?U(d,{attrs:o,slots:a,emit:c}):U(d,null)),V=e.props?o:Gx(o)}}catch(U){ya.length=0,Ql(U,t,1),L=qt(fi)}let N=L;if(V&&_!==!1){const U=Object.keys(V),{shapeFlag:re}=N;U.length&&re&7&&(s&&U.some(Xu)&&(V=zx(V,s)),N=bs(N,V,!1,!0))}return r.dirs&&(N=bs(N,null,!1,!0),N.dirs=N.dirs?N.dirs.concat(r.dirs):r.dirs),r.transition&&cf(N,r.transition),L=N,il(E),L}const Gx=t=>{let e;for(const r in t)(r==="class"||r==="style"||jl(r))&&((e||(e={}))[r]=t[r]);return e},zx=(t,e)=>{const r={};for(const n in t)(!Xu(n)||!(n.slice(9)in e))&&(r[n]=t[n]);return r};function Kx(t,e,r){const{props:n,children:i,component:s}=t,{props:a,children:o,patchFlag:c}=e,u=s.emitsOptions;if(e.dirs||e.transition)return!0;if(r&&c>=0){if(c&1024)return!0;if(c&16)return n?l0(n,a,u):!!a;if(c&8){const f=e.dynamicProps;for(let d=0;d<f.length;d++){const p=f[d];if(a[p]!==n[p]&&!Zl(u,p))return!0}}}else return(i||o)&&(!o||!o.$stable)?!0:n===a?!1:n?a?l0(n,a,u):!0:!!a;return!1}function l0(t,e,r){const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!0;for(let i=0;i<n.length;i++){const s=n[i];if(e[s]!==t[s]&&!Zl(r,s))return!0}return!1}function qx({vnode:t,parent:e},r){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===t&&(n.el=t.el),n===t)(t=e.vnode).el=r,e=e.parent;else break}}const v1=t=>t.__isSuspense;function Xx(t,e){e&&e.pendingBranch?Me(t)?e.effects.push(...t):e.effects.push(t):sx(t)}const Ft=Symbol.for("v-fgt"),ec=Symbol.for("v-txt"),fi=Symbol.for("v-cmt"),jc=Symbol.for("v-stc"),ya=[];let Hr=null;function Ke(t=!1){ya.push(Hr=t?null:[])}function Yx(){ya.pop(),Hr=ya[ya.length-1]||null}let La=1;function c0(t,e=!1){La+=t,t<0&&Hr&&e&&(Hr.hasOnce=!0)}function x1(t){return t.dynamicChildren=La>0?Hr||Es:null,Yx(),La>0&&Hr&&Hr.push(t),t}function qe(t,e,r,n,i,s){return x1(we(t,e,r,n,i,s,!0))}function Qx(t,e,r,n,i){return x1(qt(t,e,r,n,i,!0))}function E1(t){return t?t.__v_isVNode===!0:!1}function ca(t,e){return t.type===e.type&&t.key===e.key}const y1=({key:t})=>t??null,zo=({ref:t,ref_key:e,ref_for:r})=>(typeof t=="number"&&(t=""+t),t!=null?Mt(t)||Wt(t)||Ge(t)?{i:Kr,r:t,k:e,f:!!r}:t:null);function we(t,e=null,r=null,n=0,i=null,s=t===Ft?0:1,a=!1,o=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&y1(e),ref:e&&zo(e),scopeId:Yp,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Kr};return o?(hf(c,r),s&128&&t.normalize(c)):r&&(c.shapeFlag|=Mt(r)?8:16),La>0&&!a&&Hr&&(c.patchFlag>0||s&6)&&c.patchFlag!==32&&Hr.push(c),c}const qt=Jx;function Jx(t,e=null,r=null,n=0,i=null,s=!1){if((!t||t===Ex)&&(t=fi),E1(t)){const o=bs(t,e,!0);return r&&hf(o,r),La>0&&!s&&Hr&&(o.shapeFlag&6?Hr[Hr.indexOf(t)]=o:Hr.push(o)),o.patchFlag=-2,o}if(l2(t)&&(t=t.__vccOpts),e){e=Zx(e);let{class:o,style:c}=e;o&&!Mt(o)&&(e.class=ql(o)),Et(c)&&(of(c)&&!Me(c)&&(c=xr({},c)),e.style=Ju(c))}const a=Mt(t)?1:v1(t)?128:lx(t)?64:Et(t)?4:Ge(t)?2:0;return we(t,e,r,n,i,a,s,!0)}function Zx(t){return t?of(t)||o1(t)?xr({},t):t:null}function bs(t,e,r=!1,n=!1){const{props:i,ref:s,patchFlag:a,children:o,transition:c}=t,u=e?e2(i||{},e):i,f={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&y1(u),ref:e&&e.ref?r&&s?Me(s)?s.concat(zo(e)):[s,zo(e)]:zo(e):s,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Ft?a===-1?16:a|16:a,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:c,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&bs(t.ssContent),ssFallback:t.ssFallback&&bs(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return c&&n&&cf(f,c.clone(f)),f}function T1(t=" ",e=0){return qt(ec,null,t,e)}function ni(t="",e=!1){return e?(Ke(),Qx(fi,null,t)):qt(fi,null,t)}function hn(t){return t==null||typeof t=="boolean"?qt(fi):Me(t)?qt(Ft,null,t.slice()):E1(t)?Jn(t):qt(ec,null,String(t))}function Jn(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:bs(t)}function hf(t,e){let r=0;const{shapeFlag:n}=t;if(e==null)e=null;else if(Me(e))r=16;else if(typeof e=="object")if(n&65){const i=e.default;i&&(i._c&&(i._d=!1),hf(t,i()),i._c&&(i._d=!0));return}else{r=32;const i=e._;!i&&!o1(e)?e._ctx=Kr:i===3&&Kr&&(Kr.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Ge(e)?(e={default:e,_ctx:Kr},r=32):(e=String(e),n&64?(r=16,e=[T1(e)]):r=8);t.children=e,t.shapeFlag|=r}function e2(...t){const e={};for(let r=0;r<t.length;r++){const n=t[r];for(const i in n)if(i==="class")e.class!==n.class&&(e.class=ql([e.class,n.class]));else if(i==="style")e.style=Ju([e.style,n.style]);else if(jl(i)){const s=e[i],a=n[i];a&&s!==a&&!(Me(s)&&s.includes(a))&&(e[i]=s?[].concat(s,a):a)}else i!==""&&(e[i]=n[i])}return e}function on(t,e,r,n=null){vn(t,e,7,[r,n])}const t2=i1();let r2=0;function n2(t,e,r){const n=t.type,i=(e?e.appContext:t.appContext)||t2,s={uid:r2++,vnode:t,type:n,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Rv(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:c1(n,i),emitsOptions:_1(n,i),emit:null,emitted:null,propsDefaults:_t,inheritAttrs:n.inheritAttrs,ctx:_t,data:_t,props:_t,attrs:_t,slots:_t,refs:_t,setupState:_t,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=jx.bind(null,s),t.ce&&t.ce(s),s}let Sr=null,ol,vu;{const t=Kl(),e=(r,n)=>{let i;return(i=t[r])||(i=t[r]=[]),i.push(n),s=>{i.length>1?i.forEach(a=>a(s)):i[0](s)}};ol=e("__VUE_INSTANCE_SETTERS__",r=>Sr=r),vu=e("__VUE_SSR_SETTERS__",r=>Ma=r)}const to=t=>{const e=Sr;return ol(t),t.scope.on(),()=>{t.scope.off(),ol(e)}},u0=()=>{Sr&&Sr.scope.off(),ol(null)};function w1(t){return t.vnode.shapeFlag&4}let Ma=!1;function i2(t,e=!1,r=!1){e&&vu(e);const{props:n,children:i}=t.vnode,s=w1(t);Fx(t,n,s,e),kx(t,i,r||e);const a=s?s2(t,e):void 0;return e&&vu(!1),a}function s2(t,e){const r=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,yx);const{setup:n}=r;if(n){kn();const i=t.setupContext=n.length>1?o2(t):null,s=to(t),a=eo(n,t,0,[t.props,i]),o=yp(a);if(Nn(),s(),(o||t.sp)&&!xa(t)&&Qp(t),o){if(a.then(u0,u0),e)return a.then(c=>{f0(t,c)}).catch(c=>{Ql(c,t,0)});t.asyncDep=a}else f0(t,a)}else A1(t)}function f0(t,e,r){Ge(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Et(e)&&(t.setupState=jp(e)),A1(t)}function A1(t,e,r){const n=t.type;t.render||(t.render=n.render||dn);{const i=to(t);kn();try{Tx(t)}finally{Nn(),i()}}}const a2={get(t,e){return gr(t,"get",""),t[e]}};function o2(t){const e=r=>{t.exposed=r||{}};return{attrs:new Proxy(t.attrs,a2),slots:t.slots,emit:t.emit,expose:e}}function tc(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(jp(Xv(t.exposed)),{get(e,r){if(r in e)return e[r];if(r in Ea)return Ea[r](t)},has(e,r){return r in e||r in Ea}})):t.proxy}function l2(t){return Ge(t)&&"__vccOpts"in t}const S1=(t,e)=>ex(t,e,Ma),c2="3.5.16";/**
* @vue/runtime-dom v3.5.16
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let xu;const h0=typeof window<"u"&&window.trustedTypes;if(h0)try{xu=h0.createPolicy("vue",{createHTML:t=>t})}catch{}const I1=xu?t=>xu.createHTML(t):t=>t,u2="http://www.w3.org/2000/svg",f2="http://www.w3.org/1998/Math/MathML",Rn=typeof document<"u"?document:null,d0=Rn&&Rn.createElement("template"),h2={insert:(t,e,r)=>{e.insertBefore(t,r||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,r,n)=>{const i=e==="svg"?Rn.createElementNS(u2,t):e==="mathml"?Rn.createElementNS(f2,t):r?Rn.createElement(t,{is:r}):Rn.createElement(t);return t==="select"&&n&&n.multiple!=null&&i.setAttribute("multiple",n.multiple),i},createText:t=>Rn.createTextNode(t),createComment:t=>Rn.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Rn.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,r,n,i,s){const a=r?r.previousSibling:e.lastChild;if(i&&(i===s||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),r),!(i===s||!(i=i.nextSibling)););else{d0.innerHTML=I1(n==="svg"?`<svg>${t}</svg>`:n==="mathml"?`<math>${t}</math>`:t);const o=d0.content;if(n==="svg"||n==="mathml"){const c=o.firstChild;for(;c.firstChild;)o.appendChild(c.firstChild);o.removeChild(c)}e.insertBefore(o,r)}return[a?a.nextSibling:e.firstChild,r?r.previousSibling:e.lastChild]}},d2=Symbol("_vtc");function p2(t,e,r){const n=t[d2];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?t.removeAttribute("class"):r?t.setAttribute("class",e):t.className=e}const p0=Symbol("_vod"),g2=Symbol("_vsh"),m2=Symbol(""),_2=/(^|;)\s*display\s*:/;function v2(t,e,r){const n=t.style,i=Mt(r);let s=!1;if(r&&!i){if(e)if(Mt(e))for(const a of e.split(";")){const o=a.slice(0,a.indexOf(":")).trim();r[o]==null&&Ko(n,o,"")}else for(const a in e)r[a]==null&&Ko(n,a,"");for(const a in r)a==="display"&&(s=!0),Ko(n,a,r[a])}else if(i){if(e!==r){const a=n[m2];a&&(r+=";"+a),n.cssText=r,s=_2.test(r)}}else e&&t.removeAttribute("style");p0 in t&&(t[p0]=s?n.display:"",t[g2]&&(n.display="none"))}const g0=/\s*!important$/;function Ko(t,e,r){if(Me(r))r.forEach(n=>Ko(t,e,n));else if(r==null&&(r=""),e.startsWith("--"))t.setProperty(e,r);else{const n=x2(t,e);g0.test(r)?t.setProperty(Ti(n),r.replace(g0,""),"important"):t[n]=r}}const m0=["Webkit","Moz","ms"],Gc={};function x2(t,e){const r=Gc[e];if(r)return r;let n=ci(e);if(n!=="filter"&&n in t)return Gc[e]=n;n=Ap(n);for(let i=0;i<m0.length;i++){const s=m0[i]+n;if(s in t)return Gc[e]=s}return e}const _0="http://www.w3.org/1999/xlink";function v0(t,e,r,n,i,s=Sv(e)){n&&e.startsWith("xlink:")?r==null?t.removeAttributeNS(_0,e.slice(6,e.length)):t.setAttributeNS(_0,e,r):r==null||s&&!Ip(r)?t.removeAttribute(e):t.setAttribute(e,s?"":_n(r)?String(r):r)}function x0(t,e,r,n,i){if(e==="innerHTML"||e==="textContent"){r!=null&&(t[e]=e==="innerHTML"?I1(r):r);return}const s=t.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const o=s==="OPTION"?t.getAttribute("value")||"":t.value,c=r==null?t.type==="checkbox"?"on":"":String(r);(o!==c||!("_value"in t))&&(t.value=c),r==null&&t.removeAttribute(e),t._value=r;return}let a=!1;if(r===""||r==null){const o=typeof t[e];o==="boolean"?r=Ip(r):r==null&&o==="string"?(r="",a=!0):o==="number"&&(r=0,a=!0)}try{t[e]=r}catch{}a&&t.removeAttribute(i||e)}function Li(t,e,r,n){t.addEventListener(e,r,n)}function E2(t,e,r,n){t.removeEventListener(e,r,n)}const E0=Symbol("_vei");function y2(t,e,r,n,i=null){const s=t[E0]||(t[E0]={}),a=s[e];if(n&&a)a.value=n;else{const[o,c]=T2(e);if(n){const u=s[e]=S2(n,i);Li(t,o,u,c)}else a&&(E2(t,o,a,c),s[e]=void 0)}}const y0=/(?:Once|Passive|Capture)$/;function T2(t){let e;if(y0.test(t)){e={};let n;for(;n=t.match(y0);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Ti(t.slice(2)),e]}let zc=0;const w2=Promise.resolve(),A2=()=>zc||(w2.then(()=>zc=0),zc=Date.now());function S2(t,e){const r=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=r.attached)return;vn(I2(n,r.value),e,5,[n])};return r.value=t,r.attached=A2(),r}function I2(t,e){if(Me(e)){const r=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{r.call(t),t._stopped=!0},e.map(n=>i=>!i._stopped&&n&&n(i))}else return e}const T0=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,C2=(t,e,r,n,i,s)=>{const a=i==="svg";e==="class"?p2(t,n,a):e==="style"?v2(t,r,n):jl(e)?Xu(e)||y2(t,e,r,n,s):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):R2(t,e,n,a))?(x0(t,e,n),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&v0(t,e,n,a,s,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Mt(n))?x0(t,ci(e),n,s,e):(e==="true-value"?t._trueValue=n:e==="false-value"&&(t._falseValue=n),v0(t,e,n,a))};function R2(t,e,r,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in t&&T0(e)&&Ge(r));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=t.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return T0(e)&&Mt(r)?!1:e in t}const ll=t=>{const e=t.props["onUpdate:modelValue"]||!1;return Me(e)?r=>jo(e,r):e};function P2(t){t.target.composing=!0}function w0(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Is=Symbol("_assign"),rc={created(t,{modifiers:{lazy:e,trim:r,number:n}},i){t[Is]=ll(i);const s=n||i.props&&i.props.type==="number";Li(t,e?"change":"input",a=>{if(a.target.composing)return;let o=t.value;r&&(o=o.trim()),s&&(o=el(o)),t[Is](o)}),r&&Li(t,"change",()=>{t.value=t.value.trim()}),e||(Li(t,"compositionstart",P2),Li(t,"compositionend",w0),Li(t,"change",w0))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:r,modifiers:{lazy:n,trim:i,number:s}},a){if(t[Is]=ll(a),t.composing)return;const o=(s||t.type==="number")&&!/^0\d/.test(t.value)?el(t.value):t.value,c=e??"";o!==c&&(document.activeElement===t&&t.type!=="range"&&(n&&e===r||i&&t.value.trim()===c)||(t.value=c))}},Eu={deep:!0,created(t,{value:e,modifiers:{number:r}},n){const i=Gl(e);Li(t,"change",()=>{const s=Array.prototype.filter.call(t.options,a=>a.selected).map(a=>r?el(cl(a)):cl(a));t[Is](t.multiple?i?new Set(s):s:s[0]),t._assigning=!0,zp(()=>{t._assigning=!1})}),t[Is]=ll(n)},mounted(t,{value:e}){A0(t,e)},beforeUpdate(t,e,r){t[Is]=ll(r)},updated(t,{value:e}){t._assigning||A0(t,e)}};function A0(t,e){const r=t.multiple,n=Me(e);if(!(r&&!n&&!Gl(e))){for(let i=0,s=t.options.length;i<s;i++){const a=t.options[i],o=cl(a);if(r)if(n){const c=typeof o;c==="string"||c==="number"?a.selected=e.some(u=>String(u)===String(o)):a.selected=Cv(e,o)>-1}else a.selected=e.has(o);else if(Xl(cl(a),e)){t.selectedIndex!==i&&(t.selectedIndex=i);return}}!r&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function cl(t){return"_value"in t?t._value:t.value}const F2={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},C1=(t,e)=>{const r=t._withKeys||(t._withKeys={}),n=e.join(".");return r[n]||(r[n]=i=>{if(!("key"in i))return;const s=Ti(i.key);if(e.some(a=>a===s||F2[a]===s))return t(i)})},D2=xr({patchProp:C2},h2);let S0;function O2(){return S0||(S0=Lx(D2))}const b2=(...t)=>{const e=O2().createApp(...t),{mount:r}=e;return e.mount=n=>{const i=N2(n);if(!i)return;const s=e._component;!Ge(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const a=r(i,!1,k2(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),a},e};function k2(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function N2(t){return Mt(t)?document.querySelector(t):t}const L2=()=>{};var I0={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R1=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},M2=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],c=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},P1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,f=s>>2,d=(s&3)<<4|o>>4;let p=(o&15)<<2|u>>6,g=u&63;c||(g=64,a||(p=64)),n.push(r[f],r[d],r[p],r[g])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(R1(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):M2(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const u=i<t.length?r[t.charAt(i)]:64;++i;const d=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||u==null||d==null)throw new V2;const p=s<<2|o>>4;if(n.push(p),u!==64){const g=o<<4&240|u>>2;if(n.push(g),d!==64){const v=u<<6&192|d;n.push(v)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class V2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const B2=function(t){const e=R1(t);return P1.encodeByteArray(e,!0)},ul=function(t){return B2(t).replace(/\./g,"")},U2=function(t){try{return P1.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H2(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $2=()=>H2().__FIREBASE_DEFAULTS__,W2=()=>{if(typeof process>"u"||typeof I0>"u")return;const t=I0.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},j2=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&U2(t[1]);return e&&JSON.parse(e)},df=()=>{try{return L2()||$2()||W2()||j2()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},G2=t=>{var e,r;return(r=(e=df())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},z2=t=>{const e=G2(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},F1=()=>{var t;return(t=df())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K2{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pf(t){return t.endsWith(".cloudworkstations.dev")}async function q2(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X2(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[ul(JSON.stringify(r)),ul(JSON.stringify(a)),""].join(".")}const Ta={};function Y2(){const t={prod:[],emulator:[]};for(const e of Object.keys(Ta))Ta[e]?t.emulator.push(e):t.prod.push(e);return t}function Q2(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let C0=!1;function J2(t,e){if(typeof window>"u"||typeof document>"u"||!pf(window.location.host)||Ta[t]===e||Ta[t]||C0)return;Ta[t]=e;function r(p){return`__firebase__banner__${p}`}const n="__firebase__banner",s=Y2().prod.length>0;function a(){const p=document.getElementById(n);p&&p.remove()}function o(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function c(p,g){p.setAttribute("width","24"),p.setAttribute("id",g),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function u(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{C0=!0,a()},p}function f(p,g){p.setAttribute("id",g),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function d(){const p=Q2(n),g=r("text"),v=document.getElementById(g)||document.createElement("span"),_=r("learnmore"),E=document.getElementById(_)||document.createElement("a"),L=r("preprendIcon"),V=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const N=p.element;o(N),f(E,_);const U=u();c(V,L),N.append(V,v,E,U),document.body.appendChild(N)}s?(v.innerText="Preview backend disconnected.",V.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(V.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z2(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function eE(){var t;const e=(t=df())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function tE(){return!eE()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function rE(){try{return typeof indexedDB=="object"}catch{return!1}}function nE(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iE="FirebaseError";class Ws extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=iE,Object.setPrototypeOf(this,Ws.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,D1.prototype.create)}}class D1{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?sE(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Ws(i,o,n)}}function sE(t,e){return t.replace(aE,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const aE=/\{\$([^}]+)}/g;function fl(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(R0(s)&&R0(a)){if(!fl(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function R0(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hi(t){return t&&t._delegate?t._delegate:t}class Va{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ni="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oE{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new K2;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(cE(e))try{this.getOrInitializeService({instanceIdentifier:Ni})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Ni){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ni){return this.instances.has(e)}getOptions(e=Ni){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:lE(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Ni){return this.component?this.component.multipleInstances?e:Ni:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function lE(t){return t===Ni?void 0:t}function cE(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new oE(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ze;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ze||(Ze={}));const fE={debug:Ze.DEBUG,verbose:Ze.VERBOSE,info:Ze.INFO,warn:Ze.WARN,error:Ze.ERROR,silent:Ze.SILENT},hE=Ze.INFO,dE={[Ze.DEBUG]:"log",[Ze.VERBOSE]:"log",[Ze.INFO]:"info",[Ze.WARN]:"warn",[Ze.ERROR]:"error"},pE=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=dE[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class O1{constructor(e){this.name=e,this._logLevel=hE,this._logHandler=pE,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ze))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?fE[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ze.DEBUG,...e),this._logHandler(this,Ze.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ze.VERBOSE,...e),this._logHandler(this,Ze.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ze.INFO,...e),this._logHandler(this,Ze.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ze.WARN,...e),this._logHandler(this,Ze.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ze.ERROR,...e),this._logHandler(this,Ze.ERROR,...e)}}const gE=(t,e)=>e.some(r=>t instanceof r);let P0,F0;function mE(){return P0||(P0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _E(){return F0||(F0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const b1=new WeakMap,yu=new WeakMap,k1=new WeakMap,Kc=new WeakMap,gf=new WeakMap;function vE(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(ii(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&b1.set(r,t)}).catch(()=>{}),gf.set(e,t),e}function xE(t){if(yu.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});yu.set(t,e)}let Tu={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return yu.get(t);if(e==="objectStoreNames")return t.objectStoreNames||k1.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ii(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function EE(t){Tu=t(Tu)}function yE(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(qc(this),e,...r);return k1.set(n,e.sort?e.sort():[e]),ii(n)}:_E().includes(t)?function(...e){return t.apply(qc(this),e),ii(b1.get(this))}:function(...e){return ii(t.apply(qc(this),e))}}function TE(t){return typeof t=="function"?yE(t):(t instanceof IDBTransaction&&xE(t),gE(t,mE())?new Proxy(t,Tu):t)}function ii(t){if(t instanceof IDBRequest)return vE(t);if(Kc.has(t))return Kc.get(t);const e=TE(t);return e!==t&&(Kc.set(t,e),gf.set(e,t)),e}const qc=t=>gf.get(t);function wE(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=ii(a);return n&&a.addEventListener("upgradeneeded",c=>{n(ii(a.result),c.oldVersion,c.newVersion,ii(a.transaction),c)}),r&&a.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),o.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const AE=["get","getKey","getAll","getAllKeys","count"],SE=["put","add","delete","clear"],Xc=new Map;function D0(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Xc.get(e))return Xc.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=SE.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||AE.includes(r)))return;const s=async function(a,...o){const c=this.transaction(a,i?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(o.shift())),(await Promise.all([u[r](...o),i&&c.done]))[0]};return Xc.set(e,s),s}EE(t=>({...t,get:(e,r,n)=>D0(e,r)||t.get(e,r,n),has:(e,r)=>!!D0(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IE{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(CE(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function CE(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const wu="@firebase/app",O0="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ln=new O1("@firebase/app"),RE="@firebase/app-compat",PE="@firebase/analytics-compat",FE="@firebase/analytics",DE="@firebase/app-check-compat",OE="@firebase/app-check",bE="@firebase/auth",kE="@firebase/auth-compat",NE="@firebase/database",LE="@firebase/data-connect",ME="@firebase/database-compat",VE="@firebase/functions",BE="@firebase/functions-compat",UE="@firebase/installations",HE="@firebase/installations-compat",$E="@firebase/messaging",WE="@firebase/messaging-compat",jE="@firebase/performance",GE="@firebase/performance-compat",zE="@firebase/remote-config",KE="@firebase/remote-config-compat",qE="@firebase/storage",XE="@firebase/storage-compat",YE="@firebase/firestore",QE="@firebase/ai",JE="@firebase/firestore-compat",ZE="firebase",ey="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Au="[DEFAULT]",ty={[wu]:"fire-core",[RE]:"fire-core-compat",[FE]:"fire-analytics",[PE]:"fire-analytics-compat",[OE]:"fire-app-check",[DE]:"fire-app-check-compat",[bE]:"fire-auth",[kE]:"fire-auth-compat",[NE]:"fire-rtdb",[LE]:"fire-data-connect",[ME]:"fire-rtdb-compat",[VE]:"fire-fn",[BE]:"fire-fn-compat",[UE]:"fire-iid",[HE]:"fire-iid-compat",[$E]:"fire-fcm",[WE]:"fire-fcm-compat",[jE]:"fire-perf",[GE]:"fire-perf-compat",[zE]:"fire-rc",[KE]:"fire-rc-compat",[qE]:"fire-gcs",[XE]:"fire-gcs-compat",[YE]:"fire-fst",[JE]:"fire-fst-compat",[QE]:"fire-vertex","fire-js":"fire-js",[ZE]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hl=new Map,ry=new Map,Su=new Map;function b0(t,e){try{t.container.addComponent(e)}catch(r){Ln.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function dl(t){const e=t.name;if(Su.has(e))return Ln.debug(`There were multiple attempts to register component ${e}.`),!1;Su.set(e,t);for(const r of hl.values())b0(r,t);for(const r of ry.values())b0(r,t);return!0}function ny(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function iy(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sy={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},si=new D1("app","Firebase",sy);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Va("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw si.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oy=ey;function N1(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:Au,automaticDataCollectionEnabled:!0},e),i=n.name;if(typeof i!="string"||!i)throw si.create("bad-app-name",{appName:String(i)});if(r||(r=F1()),!r)throw si.create("no-options");const s=hl.get(i);if(s){if(fl(r,s.options)&&fl(n,s.config))return s;throw si.create("duplicate-app",{appName:i})}const a=new uE(i);for(const c of Su.values())a.addComponent(c);const o=new ay(r,n,a);return hl.set(i,o),o}function ly(t=Au){const e=hl.get(t);if(!e&&t===Au&&F1())return N1();if(!e)throw si.create("no-app",{appName:t});return e}function Cs(t,e,r){var n;let i=(n=ty[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ln.warn(o.join(" "));return}dl(new Va(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cy="firebase-heartbeat-database",uy=1,Ba="firebase-heartbeat-store";let Yc=null;function L1(){return Yc||(Yc=wE(cy,uy,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ba)}catch(r){console.warn(r)}}}}).catch(t=>{throw si.create("idb-open",{originalErrorMessage:t.message})})),Yc}async function fy(t){try{const r=(await L1()).transaction(Ba),n=await r.objectStore(Ba).get(M1(t));return await r.done,n}catch(e){if(e instanceof Ws)Ln.warn(e.message);else{const r=si.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ln.warn(r.message)}}}async function k0(t,e){try{const n=(await L1()).transaction(Ba,"readwrite");await n.objectStore(Ba).put(e,M1(t)),await n.done}catch(r){if(r instanceof Ws)Ln.warn(r.message);else{const n=si.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Ln.warn(n.message)}}}function M1(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hy=1024,dy=30;class py{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new my(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=N0();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>dy){const a=_y(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Ln.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=N0(),{heartbeatsToSend:n,unsentEntries:i}=gy(this._heartbeatsCache.heartbeats),s=ul(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return Ln.warn(r),""}}}function N0(){return new Date().toISOString().substring(0,10)}function gy(t,e=hy){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),L0(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),L0(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class my{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return rE()?nE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await fy(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return k0(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return k0(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function L0(t){return ul(JSON.stringify({version:2,heartbeats:t})).length}function _y(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vy(t){dl(new Va("platform-logger",e=>new IE(e),"PRIVATE")),dl(new Va("heartbeat",e=>new py(e),"PRIVATE")),Cs(wu,O0,t),Cs(wu,O0,"esm2017"),Cs("fire-js","")}vy("");var xy="firebase",Ey="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Cs(xy,Ey,"app");var M0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ai,V1;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,T){function y(){}y.prototype=T.prototype,w.D=T.prototype,w.prototype=new y,w.prototype.constructor=w,w.C=function(I,P,k){for(var R=Array(arguments.length-2),We=2;We<arguments.length;We++)R[We-2]=arguments[We];return T.prototype[P].apply(I,R)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,T,y){y||(y=0);var I=Array(16);if(typeof T=="string")for(var P=0;16>P;++P)I[P]=T.charCodeAt(y++)|T.charCodeAt(y++)<<8|T.charCodeAt(y++)<<16|T.charCodeAt(y++)<<24;else for(P=0;16>P;++P)I[P]=T[y++]|T[y++]<<8|T[y++]<<16|T[y++]<<24;T=w.g[0],y=w.g[1],P=w.g[2];var k=w.g[3],R=T+(k^y&(P^k))+I[0]+3614090360&4294967295;T=y+(R<<7&4294967295|R>>>25),R=k+(P^T&(y^P))+I[1]+3905402710&4294967295,k=T+(R<<12&4294967295|R>>>20),R=P+(y^k&(T^y))+I[2]+606105819&4294967295,P=k+(R<<17&4294967295|R>>>15),R=y+(T^P&(k^T))+I[3]+3250441966&4294967295,y=P+(R<<22&4294967295|R>>>10),R=T+(k^y&(P^k))+I[4]+4118548399&4294967295,T=y+(R<<7&4294967295|R>>>25),R=k+(P^T&(y^P))+I[5]+1200080426&4294967295,k=T+(R<<12&4294967295|R>>>20),R=P+(y^k&(T^y))+I[6]+2821735955&4294967295,P=k+(R<<17&4294967295|R>>>15),R=y+(T^P&(k^T))+I[7]+4249261313&4294967295,y=P+(R<<22&4294967295|R>>>10),R=T+(k^y&(P^k))+I[8]+1770035416&4294967295,T=y+(R<<7&4294967295|R>>>25),R=k+(P^T&(y^P))+I[9]+2336552879&4294967295,k=T+(R<<12&4294967295|R>>>20),R=P+(y^k&(T^y))+I[10]+4294925233&4294967295,P=k+(R<<17&4294967295|R>>>15),R=y+(T^P&(k^T))+I[11]+2304563134&4294967295,y=P+(R<<22&4294967295|R>>>10),R=T+(k^y&(P^k))+I[12]+1804603682&4294967295,T=y+(R<<7&4294967295|R>>>25),R=k+(P^T&(y^P))+I[13]+4254626195&4294967295,k=T+(R<<12&4294967295|R>>>20),R=P+(y^k&(T^y))+I[14]+2792965006&4294967295,P=k+(R<<17&4294967295|R>>>15),R=y+(T^P&(k^T))+I[15]+1236535329&4294967295,y=P+(R<<22&4294967295|R>>>10),R=T+(P^k&(y^P))+I[1]+4129170786&4294967295,T=y+(R<<5&4294967295|R>>>27),R=k+(y^P&(T^y))+I[6]+3225465664&4294967295,k=T+(R<<9&4294967295|R>>>23),R=P+(T^y&(k^T))+I[11]+643717713&4294967295,P=k+(R<<14&4294967295|R>>>18),R=y+(k^T&(P^k))+I[0]+3921069994&4294967295,y=P+(R<<20&4294967295|R>>>12),R=T+(P^k&(y^P))+I[5]+3593408605&4294967295,T=y+(R<<5&4294967295|R>>>27),R=k+(y^P&(T^y))+I[10]+38016083&4294967295,k=T+(R<<9&4294967295|R>>>23),R=P+(T^y&(k^T))+I[15]+3634488961&4294967295,P=k+(R<<14&4294967295|R>>>18),R=y+(k^T&(P^k))+I[4]+3889429448&4294967295,y=P+(R<<20&4294967295|R>>>12),R=T+(P^k&(y^P))+I[9]+568446438&4294967295,T=y+(R<<5&4294967295|R>>>27),R=k+(y^P&(T^y))+I[14]+3275163606&4294967295,k=T+(R<<9&4294967295|R>>>23),R=P+(T^y&(k^T))+I[3]+4107603335&4294967295,P=k+(R<<14&4294967295|R>>>18),R=y+(k^T&(P^k))+I[8]+1163531501&4294967295,y=P+(R<<20&4294967295|R>>>12),R=T+(P^k&(y^P))+I[13]+2850285829&4294967295,T=y+(R<<5&4294967295|R>>>27),R=k+(y^P&(T^y))+I[2]+4243563512&4294967295,k=T+(R<<9&4294967295|R>>>23),R=P+(T^y&(k^T))+I[7]+1735328473&4294967295,P=k+(R<<14&4294967295|R>>>18),R=y+(k^T&(P^k))+I[12]+2368359562&4294967295,y=P+(R<<20&4294967295|R>>>12),R=T+(y^P^k)+I[5]+4294588738&4294967295,T=y+(R<<4&4294967295|R>>>28),R=k+(T^y^P)+I[8]+2272392833&4294967295,k=T+(R<<11&4294967295|R>>>21),R=P+(k^T^y)+I[11]+1839030562&4294967295,P=k+(R<<16&4294967295|R>>>16),R=y+(P^k^T)+I[14]+4259657740&4294967295,y=P+(R<<23&4294967295|R>>>9),R=T+(y^P^k)+I[1]+2763975236&4294967295,T=y+(R<<4&4294967295|R>>>28),R=k+(T^y^P)+I[4]+1272893353&4294967295,k=T+(R<<11&4294967295|R>>>21),R=P+(k^T^y)+I[7]+4139469664&4294967295,P=k+(R<<16&4294967295|R>>>16),R=y+(P^k^T)+I[10]+3200236656&4294967295,y=P+(R<<23&4294967295|R>>>9),R=T+(y^P^k)+I[13]+681279174&4294967295,T=y+(R<<4&4294967295|R>>>28),R=k+(T^y^P)+I[0]+3936430074&4294967295,k=T+(R<<11&4294967295|R>>>21),R=P+(k^T^y)+I[3]+3572445317&4294967295,P=k+(R<<16&4294967295|R>>>16),R=y+(P^k^T)+I[6]+76029189&4294967295,y=P+(R<<23&4294967295|R>>>9),R=T+(y^P^k)+I[9]+3654602809&4294967295,T=y+(R<<4&4294967295|R>>>28),R=k+(T^y^P)+I[12]+3873151461&4294967295,k=T+(R<<11&4294967295|R>>>21),R=P+(k^T^y)+I[15]+530742520&4294967295,P=k+(R<<16&4294967295|R>>>16),R=y+(P^k^T)+I[2]+3299628645&4294967295,y=P+(R<<23&4294967295|R>>>9),R=T+(P^(y|~k))+I[0]+4096336452&4294967295,T=y+(R<<6&4294967295|R>>>26),R=k+(y^(T|~P))+I[7]+1126891415&4294967295,k=T+(R<<10&4294967295|R>>>22),R=P+(T^(k|~y))+I[14]+2878612391&4294967295,P=k+(R<<15&4294967295|R>>>17),R=y+(k^(P|~T))+I[5]+4237533241&4294967295,y=P+(R<<21&4294967295|R>>>11),R=T+(P^(y|~k))+I[12]+1700485571&4294967295,T=y+(R<<6&4294967295|R>>>26),R=k+(y^(T|~P))+I[3]+2399980690&4294967295,k=T+(R<<10&4294967295|R>>>22),R=P+(T^(k|~y))+I[10]+4293915773&4294967295,P=k+(R<<15&4294967295|R>>>17),R=y+(k^(P|~T))+I[1]+2240044497&4294967295,y=P+(R<<21&4294967295|R>>>11),R=T+(P^(y|~k))+I[8]+1873313359&4294967295,T=y+(R<<6&4294967295|R>>>26),R=k+(y^(T|~P))+I[15]+4264355552&4294967295,k=T+(R<<10&4294967295|R>>>22),R=P+(T^(k|~y))+I[6]+2734768916&4294967295,P=k+(R<<15&4294967295|R>>>17),R=y+(k^(P|~T))+I[13]+1309151649&4294967295,y=P+(R<<21&4294967295|R>>>11),R=T+(P^(y|~k))+I[4]+4149444226&4294967295,T=y+(R<<6&4294967295|R>>>26),R=k+(y^(T|~P))+I[11]+3174756917&4294967295,k=T+(R<<10&4294967295|R>>>22),R=P+(T^(k|~y))+I[2]+718787259&4294967295,P=k+(R<<15&4294967295|R>>>17),R=y+(k^(P|~T))+I[9]+3951481745&4294967295,w.g[0]=w.g[0]+T&4294967295,w.g[1]=w.g[1]+(P+(R<<21&4294967295|R>>>11))&4294967295,w.g[2]=w.g[2]+P&4294967295,w.g[3]=w.g[3]+k&4294967295}n.prototype.u=function(w,T){T===void 0&&(T=w.length);for(var y=T-this.blockSize,I=this.B,P=this.h,k=0;k<T;){if(P==0)for(;k<=y;)i(this,w,k),k+=this.blockSize;if(typeof w=="string"){for(;k<T;)if(I[P++]=w.charCodeAt(k++),P==this.blockSize){i(this,I),P=0;break}}else for(;k<T;)if(I[P++]=w[k++],P==this.blockSize){i(this,I),P=0;break}}this.h=P,this.o+=T},n.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var T=1;T<w.length-8;++T)w[T]=0;var y=8*this.o;for(T=w.length-8;T<w.length;++T)w[T]=y&255,y/=256;for(this.u(w),w=Array(16),T=y=0;4>T;++T)for(var I=0;32>I;I+=8)w[y++]=this.g[T]>>>I&255;return w};function s(w,T){var y=o;return Object.prototype.hasOwnProperty.call(y,w)?y[w]:y[w]=T(w)}function a(w,T){this.h=T;for(var y=[],I=!0,P=w.length-1;0<=P;P--){var k=w[P]|0;I&&k==T||(y[P]=k,I=!1)}this.g=y}var o={};function c(w){return-128<=w&&128>w?s(w,function(T){return new a([T|0],0>T?-1:0)}):new a([w|0],0>w?-1:0)}function u(w){if(isNaN(w)||!isFinite(w))return d;if(0>w)return E(u(-w));for(var T=[],y=1,I=0;w>=y;I++)T[I]=w/y|0,y*=4294967296;return new a(T,0)}function f(w,T){if(w.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(w.charAt(0)=="-")return E(f(w.substring(1),T));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var y=u(Math.pow(T,8)),I=d,P=0;P<w.length;P+=8){var k=Math.min(8,w.length-P),R=parseInt(w.substring(P,P+k),T);8>k?(k=u(Math.pow(T,k)),I=I.j(k).add(u(R))):(I=I.j(y),I=I.add(u(R)))}return I}var d=c(0),p=c(1),g=c(16777216);t=a.prototype,t.m=function(){if(_(this))return-E(this).m();for(var w=0,T=1,y=0;y<this.g.length;y++){var I=this.i(y);w+=(0<=I?I:4294967296+I)*T,T*=4294967296}return w},t.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(v(this))return"0";if(_(this))return"-"+E(this).toString(w);for(var T=u(Math.pow(w,6)),y=this,I="";;){var P=U(y,T).g;y=L(y,P.j(T));var k=((0<y.g.length?y.g[0]:y.h)>>>0).toString(w);if(y=P,v(y))return k+I;for(;6>k.length;)k="0"+k;I=k+I}},t.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function v(w){if(w.h!=0)return!1;for(var T=0;T<w.g.length;T++)if(w.g[T]!=0)return!1;return!0}function _(w){return w.h==-1}t.l=function(w){return w=L(this,w),_(w)?-1:v(w)?0:1};function E(w){for(var T=w.g.length,y=[],I=0;I<T;I++)y[I]=~w.g[I];return new a(y,~w.h).add(p)}t.abs=function(){return _(this)?E(this):this},t.add=function(w){for(var T=Math.max(this.g.length,w.g.length),y=[],I=0,P=0;P<=T;P++){var k=I+(this.i(P)&65535)+(w.i(P)&65535),R=(k>>>16)+(this.i(P)>>>16)+(w.i(P)>>>16);I=R>>>16,k&=65535,R&=65535,y[P]=R<<16|k}return new a(y,y[y.length-1]&-2147483648?-1:0)};function L(w,T){return w.add(E(T))}t.j=function(w){if(v(this)||v(w))return d;if(_(this))return _(w)?E(this).j(E(w)):E(E(this).j(w));if(_(w))return E(this.j(E(w)));if(0>this.l(g)&&0>w.l(g))return u(this.m()*w.m());for(var T=this.g.length+w.g.length,y=[],I=0;I<2*T;I++)y[I]=0;for(I=0;I<this.g.length;I++)for(var P=0;P<w.g.length;P++){var k=this.i(I)>>>16,R=this.i(I)&65535,We=w.i(P)>>>16,ke=w.i(P)&65535;y[2*I+2*P]+=R*ke,V(y,2*I+2*P),y[2*I+2*P+1]+=k*ke,V(y,2*I+2*P+1),y[2*I+2*P+1]+=R*We,V(y,2*I+2*P+1),y[2*I+2*P+2]+=k*We,V(y,2*I+2*P+2)}for(I=0;I<T;I++)y[I]=y[2*I+1]<<16|y[2*I];for(I=T;I<2*T;I++)y[I]=0;return new a(y,0)};function V(w,T){for(;(w[T]&65535)!=w[T];)w[T+1]+=w[T]>>>16,w[T]&=65535,T++}function N(w,T){this.g=w,this.h=T}function U(w,T){if(v(T))throw Error("division by zero");if(v(w))return new N(d,d);if(_(w))return T=U(E(w),T),new N(E(T.g),E(T.h));if(_(T))return T=U(w,E(T)),new N(E(T.g),T.h);if(30<w.g.length){if(_(w)||_(T))throw Error("slowDivide_ only works with positive integers.");for(var y=p,I=T;0>=I.l(w);)y=re(y),I=re(I);var P=le(y,1),k=le(I,1);for(I=le(I,2),y=le(y,2);!v(I);){var R=k.add(I);0>=R.l(w)&&(P=P.add(y),k=R),I=le(I,1),y=le(y,1)}return T=L(w,P.j(T)),new N(P,T)}for(P=d;0<=w.l(T);){for(y=Math.max(1,Math.floor(w.m()/T.m())),I=Math.ceil(Math.log(y)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),k=u(y),R=k.j(T);_(R)||0<R.l(w);)y-=I,k=u(y),R=k.j(T);v(k)&&(k=p),P=P.add(k),w=L(w,R)}return new N(P,w)}t.A=function(w){return U(this,w).h},t.and=function(w){for(var T=Math.max(this.g.length,w.g.length),y=[],I=0;I<T;I++)y[I]=this.i(I)&w.i(I);return new a(y,this.h&w.h)},t.or=function(w){for(var T=Math.max(this.g.length,w.g.length),y=[],I=0;I<T;I++)y[I]=this.i(I)|w.i(I);return new a(y,this.h|w.h)},t.xor=function(w){for(var T=Math.max(this.g.length,w.g.length),y=[],I=0;I<T;I++)y[I]=this.i(I)^w.i(I);return new a(y,this.h^w.h)};function re(w){for(var T=w.g.length+1,y=[],I=0;I<T;I++)y[I]=w.i(I)<<1|w.i(I-1)>>>31;return new a(y,w.h)}function le(w,T){var y=T>>5;T%=32;for(var I=w.g.length-y,P=[],k=0;k<I;k++)P[k]=0<T?w.i(k+y)>>>T|w.i(k+y+1)<<32-T:w.i(k+y);return new a(P,w.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,V1=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=f,ai=a}).apply(typeof M0<"u"?M0:typeof self<"u"?self:typeof window<"u"?window:{});var Do=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var B1,ha,U1,qo,Iu,H1,$1,W1;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,m){return l==Array.prototype||l==Object.prototype||(l[h]=m.value),l};function r(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Do=="object"&&Do];for(var h=0;h<l.length;++h){var m=l[h];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var n=r(this);function i(l,h){if(h)e:{var m=n;l=l.split(".");for(var A=0;A<l.length-1;A++){var j=l[A];if(!(j in m))break e;m=m[j]}l=l[l.length-1],A=m[l],h=h(A),h!=A&&h!=null&&e(m,l,{configurable:!0,writable:!0,value:h})}}function s(l,h){l instanceof String&&(l+="");var m=0,A=!1,j={next:function(){if(!A&&m<l.length){var J=m++;return{value:h(J,l[J]),done:!1}}return A=!0,{done:!0,value:void 0}}};return j[Symbol.iterator]=function(){return j},j}i("Array.prototype.values",function(l){return l||function(){return s(this,function(h,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function c(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function u(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function f(l,h,m){return l.call.apply(l.bind,arguments)}function d(l,h,m){if(!l)throw Error();if(2<arguments.length){var A=Array.prototype.slice.call(arguments,2);return function(){var j=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(j,A),l.apply(h,j)}}return function(){return l.apply(h,arguments)}}function p(l,h,m){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:d,p.apply(null,arguments)}function g(l,h){var m=Array.prototype.slice.call(arguments,1);return function(){var A=m.slice();return A.push.apply(A,arguments),l.apply(this,A)}}function v(l,h){function m(){}m.prototype=h.prototype,l.aa=h.prototype,l.prototype=new m,l.prototype.constructor=l,l.Qb=function(A,j,J){for(var xe=Array(arguments.length-2),mt=2;mt<arguments.length;mt++)xe[mt-2]=arguments[mt];return h.prototype[j].apply(A,xe)}}function _(l){const h=l.length;if(0<h){const m=Array(h);for(let A=0;A<h;A++)m[A]=l[A];return m}return[]}function E(l,h){for(let m=1;m<arguments.length;m++){const A=arguments[m];if(c(A)){const j=l.length||0,J=A.length||0;l.length=j+J;for(let xe=0;xe<J;xe++)l[j+xe]=A[xe]}else l.push(A)}}class L{constructor(h,m){this.i=h,this.j=m,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function V(l){return/^[\s\xa0]*$/.test(l)}function N(){var l=o.navigator;return l&&(l=l.userAgent)?l:""}function U(l){return U[" "](l),l}U[" "]=function(){};var re=N().indexOf("Gecko")!=-1&&!(N().toLowerCase().indexOf("webkit")!=-1&&N().indexOf("Edge")==-1)&&!(N().indexOf("Trident")!=-1||N().indexOf("MSIE")!=-1)&&N().indexOf("Edge")==-1;function le(l,h,m){for(const A in l)h.call(m,l[A],A,l)}function w(l,h){for(const m in l)h.call(void 0,l[m],m,l)}function T(l){const h={};for(const m in l)h[m]=l[m];return h}const y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(l,h){let m,A;for(let j=1;j<arguments.length;j++){A=arguments[j];for(m in A)l[m]=A[m];for(let J=0;J<y.length;J++)m=y[J],Object.prototype.hasOwnProperty.call(A,m)&&(l[m]=A[m])}}function P(l){var h=1;l=l.split(":");const m=[];for(;0<h&&l.length;)m.push(l.shift()),h--;return l.length&&m.push(l.join(":")),m}function k(l){o.setTimeout(()=>{throw l},0)}function R(){var l=it;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class We{constructor(){this.h=this.g=null}add(h,m){const A=ke.get();A.set(h,m),this.h?this.h.next=A:this.g=A,this.h=A}}var ke=new L(()=>new Qe,l=>l.reset());class Qe{constructor(){this.next=this.g=this.h=null}set(h,m){this.h=h,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let Ne,He=!1,it=new We,Dt=()=>{const l=o.Promise.resolve(void 0);Ne=()=>{l.then(At)}};var At=()=>{for(var l;l=R();){try{l.h.call(l.g)}catch(m){k(m)}var h=ke;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}He=!1};function M(){this.s=this.s,this.C=this.C}M.prototype.s=!1,M.prototype.ma=function(){this.s||(this.s=!0,this.N())},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function G(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}G.prototype.h=function(){this.defaultPrevented=!0};var W=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const m=()=>{};o.addEventListener("test",m,h),o.removeEventListener("test",m,h)}catch{}return l}();function H(l,h){if(G.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var m=this.type=l.type,A=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(re){e:{try{U(h.nodeName);var j=!0;break e}catch{}j=!1}j||(h=null)}}else m=="mouseover"?h=l.fromElement:m=="mouseout"&&(h=l.toElement);this.relatedTarget=h,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:ne[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&H.aa.h.call(this)}}v(H,G);var ne={2:"touch",3:"pen",4:"mouse"};H.prototype.h=function(){H.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Ae="closure_listenable_"+(1e6*Math.random()|0),Re=0;function Ce(l,h,m,A,j){this.listener=l,this.proxy=null,this.src=h,this.type=m,this.capture=!!A,this.ha=j,this.key=++Re,this.da=this.fa=!1}function me(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function et(l){this.src=l,this.g={},this.h=0}et.prototype.add=function(l,h,m,A,j){var J=l.toString();l=this.g[J],l||(l=this.g[J]=[],this.h++);var xe=B(l,h,A,j);return-1<xe?(h=l[xe],m||(h.fa=!1)):(h=new Ce(h,this.src,J,!!A,j),h.fa=m,l.push(h)),h};function b(l,h){var m=h.type;if(m in l.g){var A=l.g[m],j=Array.prototype.indexOf.call(A,h,void 0),J;(J=0<=j)&&Array.prototype.splice.call(A,j,1),J&&(me(h),l.g[m].length==0&&(delete l.g[m],l.h--))}}function B(l,h,m,A){for(var j=0;j<l.length;++j){var J=l[j];if(!J.da&&J.listener==h&&J.capture==!!m&&J.ha==A)return j}return-1}var K="closure_lm_"+(1e6*Math.random()|0),ae={};function te(l,h,m,A,j){if(Array.isArray(h)){for(var J=0;J<h.length;J++)te(l,h[J],m,A,j);return null}return m=Oe(m),l&&l[Ae]?l.K(h,m,u(A)?!!A.capture:!1,j):z(l,h,m,!1,A,j)}function z(l,h,m,A,j,J){if(!h)throw Error("Invalid event type");var xe=u(j)?!!j.capture:!!j,mt=Ee(l);if(mt||(l[K]=mt=new et(l)),m=mt.add(h,m,A,xe,J),m.proxy)return m;if(A=pe(),m.proxy=A,A.src=l,A.listener=m,l.addEventListener)W||(j=xe),j===void 0&&(j=!1),l.addEventListener(h.toString(),A,j);else if(l.attachEvent)l.attachEvent(oe(h.toString()),A);else if(l.addListener&&l.removeListener)l.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return m}function pe(){function l(m){return h.call(l.src,l.listener,m)}const h=Pe;return l}function he(l,h,m,A,j){if(Array.isArray(h))for(var J=0;J<h.length;J++)he(l,h[J],m,A,j);else A=u(A)?!!A.capture:!!A,m=Oe(m),l&&l[Ae]?(l=l.i,h=String(h).toString(),h in l.g&&(J=l.g[h],m=B(J,m,A,j),-1<m&&(me(J[m]),Array.prototype.splice.call(J,m,1),J.length==0&&(delete l.g[h],l.h--)))):l&&(l=Ee(l))&&(h=l.g[h.toString()],l=-1,h&&(l=B(h,m,A,j)),(m=-1<l?h[l]:null)&&fe(m))}function fe(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[Ae])b(h.i,l);else{var m=l.type,A=l.proxy;h.removeEventListener?h.removeEventListener(m,A,l.capture):h.detachEvent?h.detachEvent(oe(m),A):h.addListener&&h.removeListener&&h.removeListener(A),(m=Ee(h))?(b(m,l),m.h==0&&(m.src=null,h[K]=null)):me(l)}}}function oe(l){return l in ae?ae[l]:ae[l]="on"+l}function Pe(l,h){if(l.da)l=!0;else{h=new H(h,this);var m=l.listener,A=l.ha||l.src;l.fa&&fe(l),l=m.call(A,h)}return l}function Ee(l){return l=l[K],l instanceof et?l:null}var Se="__closure_events_fn_"+(1e9*Math.random()>>>0);function Oe(l){return typeof l=="function"?l:(l[Se]||(l[Se]=function(h){return l.handleEvent(h)}),l[Se])}function Fe(){M.call(this),this.i=new et(this),this.M=this,this.F=null}v(Fe,M),Fe.prototype[Ae]=!0,Fe.prototype.removeEventListener=function(l,h,m,A){he(this,l,h,m,A)};function Ve(l,h){var m,A=l.F;if(A)for(m=[];A;A=A.F)m.push(A);if(l=l.M,A=h.type||h,typeof h=="string")h=new G(h,l);else if(h instanceof G)h.target=h.target||l;else{var j=h;h=new G(A,l),I(h,j)}if(j=!0,m)for(var J=m.length-1;0<=J;J--){var xe=h.g=m[J];j=je(xe,A,!0,h)&&j}if(xe=h.g=l,j=je(xe,A,!0,h)&&j,j=je(xe,A,!1,h)&&j,m)for(J=0;J<m.length;J++)xe=h.g=m[J],j=je(xe,A,!1,h)&&j}Fe.prototype.N=function(){if(Fe.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var m=l.g[h],A=0;A<m.length;A++)me(m[A]);delete l.g[h],l.h--}}this.F=null},Fe.prototype.K=function(l,h,m,A){return this.i.add(String(l),h,!1,m,A)},Fe.prototype.L=function(l,h,m,A){return this.i.add(String(l),h,!0,m,A)};function je(l,h,m,A){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var j=!0,J=0;J<h.length;++J){var xe=h[J];if(xe&&!xe.da&&xe.capture==m){var mt=xe.listener,er=xe.ha||xe.src;xe.fa&&b(l.i,xe),j=mt.call(er,A)!==!1&&j}}return j&&!A.defaultPrevented}function Kt(l,h,m){if(typeof l=="function")m&&(l=p(l,m));else if(l&&typeof l.handleEvent=="function")l=p(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:o.setTimeout(l,h||0)}function Ot(l){l.g=Kt(()=>{l.g=null,l.i&&(l.i=!1,Ot(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class Er extends M{constructor(h,m){super(),this.m=h,this.l=m,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Ot(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Bt(l){M.call(this),this.h=l,this.g={}}v(Bt,M);var Yr=[];function Gn(l){le(l.g,function(h,m){this.g.hasOwnProperty(m)&&fe(h)},l),l.g={}}Bt.prototype.N=function(){Bt.aa.N.call(this),Gn(this)},Bt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var bt=o.JSON.stringify,Cr=o.JSON.parse,es=class{stringify(l){return o.JSON.stringify(l,void 0)}parse(l){return o.JSON.parse(l,void 0)}};function ts(){}ts.prototype.h=null;function Js(l){return l.h||(l.h=l.i())}function Zs(){}var Ii={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ea(){G.call(this,"d")}v(ea,G);function zn(){G.call(this,"c")}v(zn,G);var Tn={},ho=null;function rs(){return ho=ho||new Fe}Tn.La="serverreachability";function po(l){G.call(this,Tn.La,l)}v(po,G);function Ci(l){const h=rs();Ve(h,new po(h))}Tn.STAT_EVENT="statevent";function go(l,h){G.call(this,Tn.STAT_EVENT,l),this.stat=h}v(go,G);function Zt(l){const h=rs();Ve(h,new go(h,l))}Tn.Ma="timingevent";function mo(l,h){G.call(this,Tn.Ma,l),this.size=h}v(mo,G);function wn(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){l()},h)}function Ri(){this.g=!0}Ri.prototype.xa=function(){this.g=!1};function Pc(l,h,m,A,j,J){l.info(function(){if(l.g)if(J)for(var xe="",mt=J.split("&"),er=0;er<mt.length;er++){var tt=mt[er].split("=");if(1<tt.length){var fr=tt[0];tt=tt[1];var hr=fr.split("_");xe=2<=hr.length&&hr[1]=="type"?xe+(fr+"="+tt+"&"):xe+(fr+"=redacted&")}}else xe=null;else xe=J;return"XMLHTTP REQ ("+A+") [attempt "+j+"]: "+h+`
`+m+`
`+xe})}function Fc(l,h,m,A,j,J,xe){l.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+j+"]: "+h+`
`+m+`
`+J+" "+xe})}function x(l,h,m,A){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+S(l,m)+(A?" "+A:"")})}function F(l,h){l.info(function(){return"TIMEOUT: "+h})}Ri.prototype.info=function(){};function S(l,h){if(!l.g)return h;if(!h)return null;try{var m=JSON.parse(h);if(m){for(l=0;l<m.length;l++)if(Array.isArray(m[l])){var A=m[l];if(!(2>A.length)){var j=A[1];if(Array.isArray(j)&&!(1>j.length)){var J=j[0];if(J!="noop"&&J!="stop"&&J!="close")for(var xe=1;xe<j.length;xe++)j[xe]=""}}}}return bt(m)}catch{return h}}var C={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},D={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},O;function q(){}v(q,ts),q.prototype.g=function(){return new XMLHttpRequest},q.prototype.i=function(){return{}},O=new q;function Z(l,h,m,A){this.j=l,this.i=h,this.l=m,this.R=A||1,this.U=new Bt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new X}function X(){this.i=null,this.g="",this.h=!1}var Y={},Q={};function ue(l,h,m){l.L=1,l.v=xo(Sn(h)),l.m=m,l.P=!0,ve(l,null)}function ve(l,h){l.F=Date.now(),ye(l),l.A=Sn(l.v);var m=l.A,A=l.R;Array.isArray(A)||(A=[String(A)]),Rh(m.i,"t",A),l.C=0,m=l.j.J,l.h=new X,l.g=zh(l.j,m?h:null,!l.m),0<l.O&&(l.M=new Er(p(l.Y,l,l.g),l.O)),h=l.U,m=l.g,A=l.ca;var j="readystatechange";Array.isArray(j)||(j&&(Yr[0]=j.toString()),j=Yr);for(var J=0;J<j.length;J++){var xe=te(m,j[J],A||h.handleEvent,!1,h.h||h);if(!xe)break;h.g[xe.key]=xe}h=l.H?T(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),Ci(),Pc(l.i,l.u,l.A,l.l,l.R,l.m)}Z.prototype.ca=function(l){l=l.target;const h=this.M;h&&In(l)==3?h.j():this.Y(l)},Z.prototype.Y=function(l){try{if(l==this.g)e:{const hr=In(this.g);var h=this.g.Ba();const as=this.g.Z();if(!(3>hr)&&(hr!=3||this.g&&(this.h.h||this.g.oa()||Nh(this.g)))){this.J||hr!=4||h==7||(h==8||0>=as?Ci(3):Ci(2)),gt(this);var m=this.g.Z();this.X=m;t:if(Te(this)){var A=Nh(this.g);l="";var j=A.length,J=In(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Tt(this),ct(this);var xe="";break t}this.h.i=new o.TextDecoder}for(h=0;h<j;h++)this.h.h=!0,l+=this.h.i.decode(A[h],{stream:!(J&&h==j-1)});A.length=0,this.h.g+=l,this.C=0,xe=this.h.g}else xe=this.g.oa();if(this.o=m==200,Fc(this.i,this.u,this.A,this.l,this.R,hr,m),this.o){if(this.T&&!this.K){t:{if(this.g){var mt,er=this.g;if((mt=er.g?er.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!V(mt)){var tt=mt;break t}}tt=null}if(m=tt)x(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,An(this,m);else{this.o=!1,this.s=3,Zt(12),Tt(this),ct(this);break e}}if(this.P){m=!0;let Qr;for(;!this.J&&this.C<xe.length;)if(Qr=de(this,xe),Qr==Q){hr==4&&(this.s=4,Zt(14),m=!1),x(this.i,this.l,null,"[Incomplete Response]");break}else if(Qr==Y){this.s=4,Zt(15),x(this.i,this.l,xe,"[Invalid Chunk]"),m=!1;break}else x(this.i,this.l,Qr,null),An(this,Qr);if(Te(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),hr!=4||xe.length!=0||this.h.h||(this.s=1,Zt(16),m=!1),this.o=this.o&&m,!m)x(this.i,this.l,xe,"[Invalid Chunked Response]"),Tt(this),ct(this);else if(0<xe.length&&!this.W){this.W=!0;var fr=this.j;fr.g==this&&fr.ba&&!fr.M&&(fr.j.info("Great, no buffering proxy detected. Bytes received: "+xe.length),Nc(fr),fr.M=!0,Zt(11))}}else x(this.i,this.l,xe,null),An(this,xe);hr==4&&Tt(this),this.o&&!this.J&&(hr==4?$h(this.j,this):(this.o=!1,ye(this)))}else dv(this.g),m==400&&0<xe.indexOf("Unknown SID")?(this.s=3,Zt(12)):(this.s=0,Zt(13)),Tt(this),ct(this)}}}catch{}finally{}};function Te(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function de(l,h){var m=l.C,A=h.indexOf(`
`,m);return A==-1?Q:(m=Number(h.substring(m,A)),isNaN(m)?Y:(A+=1,A+m>h.length?Q:(h=h.slice(A,A+m),l.C=A+m,h)))}Z.prototype.cancel=function(){this.J=!0,Tt(this)};function ye(l){l.S=Date.now()+l.I,Be(l,l.I)}function Be(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=wn(p(l.ba,l),h)}function gt(l){l.B&&(o.clearTimeout(l.B),l.B=null)}Z.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(F(this.i,this.A),this.L!=2&&(Ci(),Zt(17)),Tt(this),this.s=2,ct(this)):Be(this,this.S-l)};function ct(l){l.j.G==0||l.J||$h(l.j,l)}function Tt(l){gt(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,Gn(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function An(l,h){try{var m=l.j;if(m.G!=0&&(m.g==l||kr(m.h,l))){if(!l.K&&kr(m.h,l)&&m.G==3){try{var A=m.Da.g.parse(h)}catch{A=null}if(Array.isArray(A)&&A.length==3){var j=A;if(j[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<l.F)So(m),wo(m);else break e;kc(m),Zt(18)}}else m.za=j[1],0<m.za-m.T&&37500>j[2]&&m.F&&m.v==0&&!m.C&&(m.C=wn(p(m.Za,m),6e3));if(1>=ns(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else Di(m,11)}else if((l.K||m.g==l)&&So(m),!V(h))for(j=m.Da.g.parse(h),h=0;h<j.length;h++){let tt=j[h];if(m.T=tt[0],tt=tt[1],m.G==2)if(tt[0]=="c"){m.K=tt[1],m.ia=tt[2];const fr=tt[3];fr!=null&&(m.la=fr,m.j.info("VER="+m.la));const hr=tt[4];hr!=null&&(m.Aa=hr,m.j.info("SVER="+m.Aa));const as=tt[5];as!=null&&typeof as=="number"&&0<as&&(A=1.5*as,m.L=A,m.j.info("backChannelRequestTimeoutMs_="+A)),A=m;const Qr=l.g;if(Qr){const Co=Qr.g?Qr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Co){var J=A.h;J.g||Co.indexOf("spdy")==-1&&Co.indexOf("quic")==-1&&Co.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(Dc(J,J.h),J.h=null))}if(A.D){const Lc=Qr.g?Qr.g.getResponseHeader("X-HTTP-Session-Id"):null;Lc&&(A.ya=Lc,xt(A.I,A.D,Lc))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-l.F,m.j.info("Handshake RTT: "+m.R+"ms")),A=m;var xe=l;if(A.qa=Gh(A,A.J?A.ia:null,A.W),xe.K){Eh(A.h,xe);var mt=xe,er=A.L;er&&(mt.I=er),mt.B&&(gt(mt),ye(mt)),A.g=xe}else Uh(A);0<m.i.length&&Ao(m)}else tt[0]!="stop"&&tt[0]!="close"||Di(m,7);else m.G==3&&(tt[0]=="stop"||tt[0]=="close"?tt[0]=="stop"?Di(m,7):bc(m):tt[0]!="noop"&&m.l&&m.l.ta(tt),m.v=0)}}Ci(4)}catch{}}var Pi=class{constructor(l,h){this.g=l,this.map=h}};function Kn(l){this.l=l||10,o.PerformanceNavigationTiming?(l=o.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function an(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function ns(l){return l.h?1:l.g?l.g.size:0}function kr(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function Dc(l,h){l.g?l.g.add(h):l.h=h}function Eh(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}Kn.prototype.cancel=function(){if(this.i=yh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function yh(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const m of l.g.values())h=h.concat(m.D);return h}return _(l.i)}function J_(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(c(l)){for(var h=[],m=l.length,A=0;A<m;A++)h.push(l[A]);return h}h=[],m=0;for(A in l)h[m++]=l[A];return h}function Z_(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(c(l)||typeof l=="string"){var h=[];l=l.length;for(var m=0;m<l;m++)h.push(m);return h}h=[],m=0;for(const A in l)h[m++]=A;return h}}}function Th(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(c(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var m=Z_(l),A=J_(l),j=A.length,J=0;J<j;J++)h.call(void 0,A[J],m&&m[J],l)}var wh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ev(l,h){if(l){l=l.split("&");for(var m=0;m<l.length;m++){var A=l[m].indexOf("="),j=null;if(0<=A){var J=l[m].substring(0,A);j=l[m].substring(A+1)}else J=l[m];h(J,j?decodeURIComponent(j.replace(/\+/g," ")):"")}}}function Fi(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Fi){this.h=l.h,_o(this,l.j),this.o=l.o,this.g=l.g,vo(this,l.s),this.l=l.l;var h=l.i,m=new na;m.i=h.i,h.g&&(m.g=new Map(h.g),m.h=h.h),Ah(this,m),this.m=l.m}else l&&(h=String(l).match(wh))?(this.h=!1,_o(this,h[1]||"",!0),this.o=ta(h[2]||""),this.g=ta(h[3]||"",!0),vo(this,h[4]),this.l=ta(h[5]||"",!0),Ah(this,h[6]||"",!0),this.m=ta(h[7]||"")):(this.h=!1,this.i=new na(null,this.h))}Fi.prototype.toString=function(){var l=[],h=this.j;h&&l.push(ra(h,Sh,!0),":");var m=this.g;return(m||h=="file")&&(l.push("//"),(h=this.o)&&l.push(ra(h,Sh,!0),"@"),l.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&l.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&l.push("/"),l.push(ra(m,m.charAt(0)=="/"?nv:rv,!0))),(m=this.i.toString())&&l.push("?",m),(m=this.m)&&l.push("#",ra(m,sv)),l.join("")};function Sn(l){return new Fi(l)}function _o(l,h,m){l.j=m?ta(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function vo(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function Ah(l,h,m){h instanceof na?(l.i=h,av(l.i,l.h)):(m||(h=ra(h,iv)),l.i=new na(h,l.h))}function xt(l,h,m){l.i.set(h,m)}function xo(l){return xt(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function ta(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function ra(l,h,m){return typeof l=="string"?(l=encodeURI(l).replace(h,tv),m&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function tv(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Sh=/[#\/\?@]/g,rv=/[#\?:]/g,nv=/[#\?]/g,iv=/[#\?@]/g,sv=/#/g;function na(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function qn(l){l.g||(l.g=new Map,l.h=0,l.i&&ev(l.i,function(h,m){l.add(decodeURIComponent(h.replace(/\+/g," ")),m)}))}t=na.prototype,t.add=function(l,h){qn(this),this.i=null,l=is(this,l);var m=this.g.get(l);return m||this.g.set(l,m=[]),m.push(h),this.h+=1,this};function Ih(l,h){qn(l),h=is(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function Ch(l,h){return qn(l),h=is(l,h),l.g.has(h)}t.forEach=function(l,h){qn(this),this.g.forEach(function(m,A){m.forEach(function(j){l.call(h,j,A,this)},this)},this)},t.na=function(){qn(this);const l=Array.from(this.g.values()),h=Array.from(this.g.keys()),m=[];for(let A=0;A<h.length;A++){const j=l[A];for(let J=0;J<j.length;J++)m.push(h[A])}return m},t.V=function(l){qn(this);let h=[];if(typeof l=="string")Ch(this,l)&&(h=h.concat(this.g.get(is(this,l))));else{l=Array.from(this.g.values());for(let m=0;m<l.length;m++)h=h.concat(l[m])}return h},t.set=function(l,h){return qn(this),this.i=null,l=is(this,l),Ch(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},t.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function Rh(l,h,m){Ih(l,h),0<m.length&&(l.i=null,l.g.set(is(l,h),_(m)),l.h+=m.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(var m=0;m<h.length;m++){var A=h[m];const J=encodeURIComponent(String(A)),xe=this.V(A);for(A=0;A<xe.length;A++){var j=J;xe[A]!==""&&(j+="="+encodeURIComponent(String(xe[A]))),l.push(j)}}return this.i=l.join("&")};function is(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function av(l,h){h&&!l.j&&(qn(l),l.i=null,l.g.forEach(function(m,A){var j=A.toLowerCase();A!=j&&(Ih(this,A),Rh(this,j,m))},l)),l.j=h}function ov(l,h){const m=new Ri;if(o.Image){const A=new Image;A.onload=g(Xn,m,"TestLoadImage: loaded",!0,h,A),A.onerror=g(Xn,m,"TestLoadImage: error",!1,h,A),A.onabort=g(Xn,m,"TestLoadImage: abort",!1,h,A),A.ontimeout=g(Xn,m,"TestLoadImage: timeout",!1,h,A),o.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=l}else h(!1)}function lv(l,h){const m=new Ri,A=new AbortController,j=setTimeout(()=>{A.abort(),Xn(m,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:A.signal}).then(J=>{clearTimeout(j),J.ok?Xn(m,"TestPingServer: ok",!0,h):Xn(m,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(j),Xn(m,"TestPingServer: error",!1,h)})}function Xn(l,h,m,A,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),A(m)}catch{}}function cv(){this.g=new es}function uv(l,h,m){const A=m||"";try{Th(l,function(j,J){let xe=j;u(j)&&(xe=bt(j)),h.push(A+J+"="+encodeURIComponent(xe))})}catch(j){throw h.push(A+"type="+encodeURIComponent("_badmap")),j}}function Eo(l){this.l=l.Ub||null,this.j=l.eb||!1}v(Eo,ts),Eo.prototype.g=function(){return new yo(this.l,this.j)},Eo.prototype.i=function(l){return function(){return l}}({});function yo(l,h){Fe.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(yo,Fe),t=yo.prototype,t.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,sa(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||o).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ia(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,sa(this)),this.g&&(this.readyState=3,sa(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ph(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ph(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?ia(this):sa(this),this.readyState==3&&Ph(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,ia(this))},t.Qa=function(l){this.g&&(this.response=l,ia(this))},t.ga=function(){this.g&&ia(this)};function ia(l){l.readyState=4,l.l=null,l.j=null,l.v=null,sa(l)}t.setRequestHeader=function(l,h){this.u.append(l,h)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var m=h.next();!m.done;)m=m.value,l.push(m[0]+": "+m[1]),m=h.next();return l.join(`\r
`)};function sa(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(yo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Fh(l){let h="";return le(l,function(m,A){h+=A,h+=":",h+=m,h+=`\r
`}),h}function Oc(l,h,m){e:{for(A in m){var A=!1;break e}A=!0}A||(m=Fh(m),typeof l=="string"?m!=null&&encodeURIComponent(String(m)):xt(l,h,m))}function It(l){Fe.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(It,Fe);var fv=/^https?$/i,hv=["POST","PUT"];t=It.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,h,m,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():O.g(),this.v=this.o?Js(this.o):Js(O),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(J){Dh(this,J);return}if(l=m||"",m=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var j in A)m.set(j,A[j]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const J of A.keys())m.set(J,A.get(J));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(m.keys()).find(J=>J.toLowerCase()=="content-type"),j=o.FormData&&l instanceof o.FormData,!(0<=Array.prototype.indexOf.call(hv,h,void 0))||A||j||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,xe]of m)this.g.setRequestHeader(J,xe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{kh(this),this.u=!0,this.g.send(l),this.u=!1}catch(J){Dh(this,J)}};function Dh(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,Oh(l),To(l)}function Oh(l){l.A||(l.A=!0,Ve(l,"complete"),Ve(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,Ve(this,"complete"),Ve(this,"abort"),To(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),To(this,!0)),It.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?bh(this):this.bb())},t.bb=function(){bh(this)};function bh(l){if(l.h&&typeof a<"u"&&(!l.v[1]||In(l)!=4||l.Z()!=2)){if(l.u&&In(l)==4)Kt(l.Ea,0,l);else if(Ve(l,"readystatechange"),In(l)==4){l.h=!1;try{const xe=l.Z();e:switch(xe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var m;if(!(m=h)){var A;if(A=xe===0){var j=String(l.D).match(wh)[1]||null;!j&&o.self&&o.self.location&&(j=o.self.location.protocol.slice(0,-1)),A=!fv.test(j?j.toLowerCase():"")}m=A}if(m)Ve(l,"complete"),Ve(l,"success");else{l.m=6;try{var J=2<In(l)?l.g.statusText:""}catch{J=""}l.l=J+" ["+l.Z()+"]",Oh(l)}}finally{To(l)}}}}function To(l,h){if(l.g){kh(l);const m=l.g,A=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||Ve(l,"ready");try{m.onreadystatechange=A}catch{}}}function kh(l){l.I&&(o.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function In(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<In(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),Cr(h)}};function Nh(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function dv(l){const h={};l=(l.g&&2<=In(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<l.length;A++){if(V(l[A]))continue;var m=P(l[A]);const j=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const J=h[j]||[];h[j]=J,J.push(m)}w(h,function(A){return A.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function aa(l,h,m){return m&&m.internalChannelParams&&m.internalChannelParams[l]||h}function Lh(l){this.Aa=0,this.i=[],this.j=new Ri,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=aa("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=aa("baseRetryDelayMs",5e3,l),this.cb=aa("retryDelaySeedMs",1e4,l),this.Wa=aa("forwardChannelMaxRetries",2,l),this.wa=aa("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Kn(l&&l.concurrentRequestLimit),this.Da=new cv,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Lh.prototype,t.la=8,t.G=1,t.connect=function(l,h,m,A){Zt(0),this.W=l,this.H=h||{},m&&A!==void 0&&(this.H.OSID=m,this.H.OAID=A),this.F=this.X,this.I=Gh(this,null,this.W),Ao(this)};function bc(l){if(Mh(l),l.G==3){var h=l.U++,m=Sn(l.I);if(xt(m,"SID",l.K),xt(m,"RID",h),xt(m,"TYPE","terminate"),oa(l,m),h=new Z(l,l.j,h),h.L=2,h.v=xo(Sn(m)),m=!1,o.navigator&&o.navigator.sendBeacon)try{m=o.navigator.sendBeacon(h.v.toString(),"")}catch{}!m&&o.Image&&(new Image().src=h.v,m=!0),m||(h.g=zh(h.j,null),h.g.ea(h.v)),h.F=Date.now(),ye(h)}jh(l)}function wo(l){l.g&&(Nc(l),l.g.cancel(),l.g=null)}function Mh(l){wo(l),l.u&&(o.clearTimeout(l.u),l.u=null),So(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&o.clearTimeout(l.s),l.s=null)}function Ao(l){if(!an(l.h)&&!l.s){l.s=!0;var h=l.Ga;Ne||Dt(),He||(Ne(),He=!0),it.add(h,l),l.B=0}}function pv(l,h){return ns(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=wn(p(l.Ga,l,h),Wh(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const j=new Z(this,this.j,l);let J=this.o;if(this.S&&(J?(J=T(J),I(J,this.S)):J=this.S),this.m!==null||this.O||(j.H=J,J=null),this.P)e:{for(var h=0,m=0;m<this.i.length;m++){t:{var A=this.i[m];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(h+=A,4096<h){h=m;break e}if(h===4096||m===this.i.length-1){h=m+1;break e}}h=1e3}else h=1e3;h=Bh(this,j,h),m=Sn(this.I),xt(m,"RID",l),xt(m,"CVER",22),this.D&&xt(m,"X-HTTP-Session-Id",this.D),oa(this,m),J&&(this.O?h="headers="+encodeURIComponent(String(Fh(J)))+"&"+h:this.m&&Oc(m,this.m,J)),Dc(this.h,j),this.Ua&&xt(m,"TYPE","init"),this.P?(xt(m,"$req",h),xt(m,"SID","null"),j.T=!0,ue(j,m,null)):ue(j,m,h),this.G=2}}else this.G==3&&(l?Vh(this,l):this.i.length==0||an(this.h)||Vh(this))};function Vh(l,h){var m;h?m=h.l:m=l.U++;const A=Sn(l.I);xt(A,"SID",l.K),xt(A,"RID",m),xt(A,"AID",l.T),oa(l,A),l.m&&l.o&&Oc(A,l.m,l.o),m=new Z(l,l.j,m,l.B+1),l.m===null&&(m.H=l.o),h&&(l.i=h.D.concat(l.i)),h=Bh(l,m,1e3),m.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Dc(l.h,m),ue(m,A,h)}function oa(l,h){l.H&&le(l.H,function(m,A){xt(h,A,m)}),l.l&&Th({},function(m,A){xt(h,A,m)})}function Bh(l,h,m){m=Math.min(l.i.length,m);var A=l.l?p(l.l.Na,l.l,l):null;e:{var j=l.i;let J=-1;for(;;){const xe=["count="+m];J==-1?0<m?(J=j[0].g,xe.push("ofs="+J)):J=0:xe.push("ofs="+J);let mt=!0;for(let er=0;er<m;er++){let tt=j[er].g;const fr=j[er].map;if(tt-=J,0>tt)J=Math.max(0,j[er].g-100),mt=!1;else try{uv(fr,xe,"req"+tt+"_")}catch{A&&A(fr)}}if(mt){A=xe.join("&");break e}}}return l=l.i.splice(0,m),h.D=l,A}function Uh(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;Ne||Dt(),He||(Ne(),He=!0),it.add(h,l),l.v=0}}function kc(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=wn(p(l.Fa,l),Wh(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Hh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=wn(p(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Zt(10),wo(this),Hh(this))};function Nc(l){l.A!=null&&(o.clearTimeout(l.A),l.A=null)}function Hh(l){l.g=new Z(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=Sn(l.qa);xt(h,"RID","rpc"),xt(h,"SID",l.K),xt(h,"AID",l.T),xt(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&xt(h,"TO",l.ja),xt(h,"TYPE","xmlhttp"),oa(l,h),l.m&&l.o&&Oc(h,l.m,l.o),l.L&&(l.g.I=l.L);var m=l.g;l=l.ia,m.L=1,m.v=xo(Sn(h)),m.m=null,m.P=!0,ve(m,l)}t.Za=function(){this.C!=null&&(this.C=null,wo(this),kc(this),Zt(19))};function So(l){l.C!=null&&(o.clearTimeout(l.C),l.C=null)}function $h(l,h){var m=null;if(l.g==h){So(l),Nc(l),l.g=null;var A=2}else if(kr(l.h,h))m=h.D,Eh(l.h,h),A=1;else return;if(l.G!=0){if(h.o)if(A==1){m=h.m?h.m.length:0,h=Date.now()-h.F;var j=l.B;A=rs(),Ve(A,new mo(A,m)),Ao(l)}else Uh(l);else if(j=h.s,j==3||j==0&&0<h.X||!(A==1&&pv(l,h)||A==2&&kc(l)))switch(m&&0<m.length&&(h=l.h,h.i=h.i.concat(m)),j){case 1:Di(l,5);break;case 4:Di(l,10);break;case 3:Di(l,6);break;default:Di(l,2)}}}function Wh(l,h){let m=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(m*=2),m*h}function Di(l,h){if(l.j.info("Error code "+h),h==2){var m=p(l.fb,l),A=l.Xa;const j=!A;A=new Fi(A||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||_o(A,"https"),xo(A),j?ov(A.toString(),m):lv(A.toString(),m)}else Zt(2);l.G=0,l.l&&l.l.sa(h),jh(l),Mh(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),Zt(2)):(this.j.info("Failed to ping google.com"),Zt(1))};function jh(l){if(l.G=0,l.ka=[],l.l){const h=yh(l.h);(h.length!=0||l.i.length!=0)&&(E(l.ka,h),E(l.ka,l.i),l.h.i.length=0,_(l.i),l.i.length=0),l.l.ra()}}function Gh(l,h,m){var A=m instanceof Fi?Sn(m):new Fi(m);if(A.g!="")h&&(A.g=h+"."+A.g),vo(A,A.s);else{var j=o.location;A=j.protocol,h=h?h+"."+j.hostname:j.hostname,j=+j.port;var J=new Fi(null);A&&_o(J,A),h&&(J.g=h),j&&vo(J,j),m&&(J.l=m),A=J}return m=l.D,h=l.ya,m&&h&&xt(A,m,h),xt(A,"VER",l.la),oa(l,A),A}function zh(l,h,m){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new It(new Eo({eb:m})):new It(l.pa),h.Ha(l.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Kh(){}t=Kh.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Io(){}Io.prototype.g=function(l,h){return new Nr(l,h)};function Nr(l,h){Fe.call(this),this.g=new Lh(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!V(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!V(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new ss(this)}v(Nr,Fe),Nr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Nr.prototype.close=function(){bc(this.g)},Nr.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var m={};m.__data__=l,l=m}else this.u&&(m={},m.__data__=bt(l),l=m);h.i.push(new Pi(h.Ya++,l)),h.G==3&&Ao(h)},Nr.prototype.N=function(){this.g.l=null,delete this.j,bc(this.g),delete this.g,Nr.aa.N.call(this)};function qh(l){ea.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const m in h){l=m;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}v(qh,ea);function Xh(){zn.call(this),this.status=1}v(Xh,zn);function ss(l){this.g=l}v(ss,Kh),ss.prototype.ua=function(){Ve(this.g,"a")},ss.prototype.ta=function(l){Ve(this.g,new qh(l))},ss.prototype.sa=function(l){Ve(this.g,new Xh)},ss.prototype.ra=function(){Ve(this.g,"b")},Io.prototype.createWebChannel=Io.prototype.g,Nr.prototype.send=Nr.prototype.o,Nr.prototype.open=Nr.prototype.m,Nr.prototype.close=Nr.prototype.close,W1=function(){return new Io},$1=function(){return rs()},H1=Tn,Iu={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},C.NO_ERROR=0,C.TIMEOUT=8,C.HTTP_ERROR=6,qo=C,D.COMPLETE="complete",U1=D,Zs.EventType=Ii,Ii.OPEN="a",Ii.CLOSE="b",Ii.ERROR="c",Ii.MESSAGE="d",Fe.prototype.listen=Fe.prototype.K,ha=Zs,It.prototype.listenOnce=It.prototype.L,It.prototype.getLastError=It.prototype.Ka,It.prototype.getLastErrorCode=It.prototype.Ba,It.prototype.getStatus=It.prototype.Z,It.prototype.getResponseJson=It.prototype.Oa,It.prototype.getResponseText=It.prototype.oa,It.prototype.send=It.prototype.ea,It.prototype.setWithCredentials=It.prototype.Ha,B1=It}).apply(typeof Do<"u"?Do:typeof self<"u"?self:typeof window<"u"?window:{});const V0="@firebase/firestore",B0="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}pr.UNAUTHENTICATED=new pr(null),pr.GOOGLE_CREDENTIALS=new pr("google-credentials-uid"),pr.FIRST_PARTY=new pr("first-party-uid"),pr.MOCK_USER=new pr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let js="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $i=new O1("@firebase/firestore");function hs(){return $i.logLevel}function Ie(t,...e){if($i.logLevel<=Ze.DEBUG){const r=e.map(mf);$i.debug(`Firestore (${js}): ${t}`,...r)}}function Mn(t,...e){if($i.logLevel<=Ze.ERROR){const r=e.map(mf);$i.error(`Firestore (${js}): ${t}`,...r)}}function ks(t,...e){if($i.logLevel<=Ze.WARN){const r=e.map(mf);$i.warn(`Firestore (${js}): ${t}`,...r)}}function mf(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Le(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,j1(t,n,r)}function j1(t,e,r){let n=`FIRESTORE (${js}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Mn(n),new Error(n)}function lt(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||j1(e,i,n)}function $e(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class De extends Ws{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class yy{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(pr.UNAUTHENTICATED))}shutdown(){}}class Ty{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class wy{constructor(e){this.t=e,this.currentUser=pr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){lt(this.o===void 0,42304);let n=this.i;const i=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let s=new oi;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new oi,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},o=c=>{Ie("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(c=>o(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?o(c):(Ie("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new oi)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ie("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(lt(typeof n.accessToken=="string",31837,{l:n}),new G1(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return lt(e===null||typeof e=="string",2055,{h:e}),new pr(e)}}class Ay{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=pr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Sy{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new Ay(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(pr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class U0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Iy{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,iy(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){lt(this.o===void 0,3512);const n=s=>{s.error!=null&&Ie("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,Ie("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Ie("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):Ie("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new U0(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(lt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new U0(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cy(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z1(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=Cy(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%62))}return n}}function Xe(t,e){return t<e?-1:t>e?1:0}function Cu(t,e){let r=0;for(;r<t.length&&r<e.length;){const n=t.codePointAt(r),i=e.codePointAt(r);if(n!==i){if(n<128&&i<128)return Xe(n,i);{const s=z1(),a=Ry(s.encode(H0(t,r)),s.encode(H0(e,r)));return a!==0?a:Xe(n,i)}}r+=n>65535?2:1}return Xe(t.length,e.length)}function H0(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function Ry(t,e){for(let r=0;r<t.length&&r<e.length;++r)if(t[r]!==e[r])return Xe(t[r],e[r]);return Xe(t.length,e.length)}function Ns(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $0=-62135596800,W0=1e6;class jt{static now(){return jt.fromMillis(Date.now())}static fromDate(e){return jt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*W0);return new jt(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new De(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new De(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<$0)throw new De(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new De(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/W0}_compareTo(e){return this.seconds===e.seconds?Xe(this.nanoseconds,e.nanoseconds):Xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-$0;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{static fromTimestamp(e){return new Ue(e)}static min(){return new Ue(new jt(0,0))}static max(){return new Ue(new jt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j0="__name__";class fn{constructor(e,r,n){r===void 0?r=0:r>e.length&&Le(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&Le(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return fn.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof fn?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=fn.compareSegments(e.get(i),r.get(i));if(s!==0)return s}return Xe(e.length,r.length)}static compareSegments(e,r){const n=fn.isNumericId(e),i=fn.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?fn.extractNumericId(e).compare(fn.extractNumericId(r)):Cu(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ai.fromString(e.substring(4,e.length-2))}}class wt extends fn{construct(e,r,n){return new wt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new De(ce.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new wt(r)}static emptyPath(){return new wt([])}}const Py=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class sr extends fn{construct(e,r,n){return new sr(e,r,n)}static isValidIdentifier(e){return Py.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),sr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===j0}static keyField(){return new sr([j0])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new De(ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new De(ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new De(ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new De(ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new sr(r)}static emptyPath(){return new sr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e){this.path=e}static fromPath(e){return new be(wt.fromString(e))}static fromName(e){return new be(wt.fromString(e).popFirst(5))}static empty(){return new be(wt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&wt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return wt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new be(new wt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ua=-1;function Fy(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=Ue.fromTimestamp(n===1e9?new jt(r+1,0):new jt(r,n));return new di(i,be.empty(),e)}function Dy(t){return new di(t.readTime,t.key,Ua)}class di{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new di(Ue.min(),be.empty(),Ua)}static max(){return new di(Ue.max(),be.empty(),Ua)}}function Oy(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=be.comparator(t.documentKey,e.documentKey),r!==0?r:Xe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const by="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ky{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gs(t){if(t.code!==ce.FAILED_PRECONDITION||t.message!==by)throw t;Ie("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Le(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new ie((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof ie?r:ie.resolve(r)}catch(r){return ie.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):ie.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):ie.reject(r)}static resolve(e){return new ie((r,n)=>{r(e)})}static reject(e){return new ie((r,n)=>{n(e)})}static waitFor(e){return new ie((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},c=>n(c))}),a=!0,s===i&&r()})}static or(e){let r=ie.resolve(!1);for(const n of e)r=r.next(i=>i?ie.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new ie((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let c=0;c<s;c++){const u=c;r(e[u]).next(f=>{a[u]=f,++o,o===s&&n(a)},f=>i(f))}})}static doWhile(e,r){return new ie((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function Ny(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function zs(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ue(n),this.ce=n=>r.writeSequenceNumber(n))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}nc.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _f=-1;function ic(t){return t==null}function pl(t){return t===0&&1/t==-1/0}function Ly(t){return typeof t=="number"&&Number.isInteger(t)&&!pl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q1="";function My(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=G0(e)),e=Vy(t.get(r),e);return G0(e)}function Vy(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const s=t.charAt(i);switch(s){case"\0":r+="";break;case q1:r+="";break;default:r+=s}}return r}function G0(t){return t+q1+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z0(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function wi(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function X1(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e,r){this.comparator=e,this.root=r||nr.EMPTY}insert(e,r){return new St(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,nr.BLACK,null,null))}remove(e){return new St(this.comparator,this.root.remove(e,this.comparator).copy(null,null,nr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Oo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Oo(this.root,e,this.comparator,!1)}getReverseIterator(){return new Oo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Oo(this.root,e,this.comparator,!0)}}class Oo{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class nr{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??nr.RED,this.left=i??nr.EMPTY,this.right=s??nr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new nr(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return nr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return nr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,nr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,nr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Le(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Le(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Le(27949);return e+(this.isRed()?0:1)}}nr.EMPTY=null,nr.RED=!0,nr.BLACK=!1;nr.EMPTY=new class{constructor(){this.size=0}get key(){throw Le(57766)}get value(){throw Le(16141)}get color(){throw Le(16727)}get left(){throw Le(29726)}get right(){throw Le(36894)}copy(e,r,n,i,s){return this}insert(e,r,n){return new nr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.comparator=e,this.data=new St(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new K0(this.data.getIterator())}getIteratorFrom(e){return new K0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Gt)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Gt(this.comparator);return r.data=e,r}}class K0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(e){this.fields=e,e.sort(sr.comparator)}static empty(){return new $r([])}unionWith(e){let r=new Gt(sr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new $r(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Ns(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Y1("Invalid base64 string: "+s):s}}(e);return new cr(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new cr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}cr.EMPTY_BYTE_STRING=new cr("");const By=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pi(t){if(lt(!!t,39018),typeof t=="string"){let e=0;const r=By.exec(t);if(lt(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Pt(t.seconds),nanos:Pt(t.nanos)}}function Pt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function gi(t){return typeof t=="string"?cr.fromBase64String(t):cr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q1="server_timestamp",J1="__type__",Z1="__previous_value__",eg="__local_write_time__";function vf(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[J1])===null||r===void 0?void 0:r.stringValue)===Q1}function sc(t){const e=t.mapValue.fields[Z1];return vf(e)?sc(e):e}function Ha(t){const e=pi(t.mapValue.fields[eg].timestampValue);return new jt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy{constructor(e,r,n,i,s,a,o,c,u,f){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=f}}const gl="(default)";class $a{constructor(e,r){this.projectId=e,this.database=r||gl}static empty(){return new $a("","")}get isDefaultDatabase(){return this.database===gl}isEqual(e){return e instanceof $a&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tg="__type__",Hy="__max__",bo={mapValue:{}},rg="__vector__",ml="value";function mi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?vf(t)?4:Wy(t)?9007199254740991:$y(t)?10:11:Le(28295,{value:t})}function xn(t,e){if(t===e)return!0;const r=mi(t);if(r!==mi(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ha(t).isEqual(Ha(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=pi(i.timestampValue),o=pi(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return gi(i.bytesValue).isEqual(gi(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Pt(i.geoPointValue.latitude)===Pt(s.geoPointValue.latitude)&&Pt(i.geoPointValue.longitude)===Pt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Pt(i.integerValue)===Pt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Pt(i.doubleValue),o=Pt(s.doubleValue);return a===o?pl(a)===pl(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return Ns(t.arrayValue.values||[],e.arrayValue.values||[],xn);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(z0(a)!==z0(o))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(o[c]===void 0||!xn(a[c],o[c])))return!1;return!0}(t,e);default:return Le(52216,{left:t})}}function Wa(t,e){return(t.values||[]).find(r=>xn(r,e))!==void 0}function Ls(t,e){if(t===e)return 0;const r=mi(t),n=mi(e);if(r!==n)return Xe(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Xe(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=Pt(s.integerValue||s.doubleValue),c=Pt(a.integerValue||a.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(t,e);case 3:return q0(t.timestampValue,e.timestampValue);case 4:return q0(Ha(t),Ha(e));case 5:return Cu(t.stringValue,e.stringValue);case 6:return function(s,a){const o=gi(s),c=gi(a);return o.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),c=a.split("/");for(let u=0;u<o.length&&u<c.length;u++){const f=Xe(o[u],c[u]);if(f!==0)return f}return Xe(o.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=Xe(Pt(s.latitude),Pt(a.latitude));return o!==0?o:Xe(Pt(s.longitude),Pt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return X0(t.arrayValue,e.arrayValue);case 10:return function(s,a){var o,c,u,f;const d=s.fields||{},p=a.fields||{},g=(o=d[ml])===null||o===void 0?void 0:o.arrayValue,v=(c=p[ml])===null||c===void 0?void 0:c.arrayValue,_=Xe(((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0,((f=v==null?void 0:v.values)===null||f===void 0?void 0:f.length)||0);return _!==0?_:X0(g,v)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===bo.mapValue&&a===bo.mapValue)return 0;if(s===bo.mapValue)return 1;if(a===bo.mapValue)return-1;const o=s.fields||{},c=Object.keys(o),u=a.fields||{},f=Object.keys(u);c.sort(),f.sort();for(let d=0;d<c.length&&d<f.length;++d){const p=Cu(c[d],f[d]);if(p!==0)return p;const g=Ls(o[c[d]],u[f[d]]);if(g!==0)return g}return Xe(c.length,f.length)}(t.mapValue,e.mapValue);default:throw Le(23264,{Pe:r})}}function q0(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Xe(t,e);const r=pi(t),n=pi(e),i=Xe(r.seconds,n.seconds);return i!==0?i:Xe(r.nanos,n.nanos)}function X0(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=Ls(r[i],n[i]);if(s)return s}return Xe(r.length,n.length)}function Ms(t){return Ru(t)}function Ru(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=pi(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return gi(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return be.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=Ru(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${Ru(r.fields[a])}`;return i+"}"}(t.mapValue):Le(61005,{value:t})}function Xo(t){switch(mi(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=sc(t);return e?16+Xo(e):16;case 5:return 2*t.stringValue.length;case 6:return gi(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,s)=>i+Xo(s),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return wi(n.fields,(s,a)=>{i+=s.length+Xo(a)}),i}(t.mapValue);default:throw Le(13486,{value:t})}}function Pu(t){return!!t&&"integerValue"in t}function xf(t){return!!t&&"arrayValue"in t}function Y0(t){return!!t&&"nullValue"in t}function Q0(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Yo(t){return!!t&&"mapValue"in t}function $y(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[tg])===null||r===void 0?void 0:r.stringValue)===rg}function wa(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return wi(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=wa(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=wa(t.arrayValue.values[r]);return e}return Object.assign({},t)}function Wy(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Hy}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e){this.value=e}static empty(){return new Fr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Yo(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=wa(r)}setAll(e){let r=sr.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const c=this.getFieldsMap(r);this.applyChanges(c,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=wa(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());Yo(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return xn(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];Yo(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){wi(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new Fr(wa(this.value))}}function ng(t){const e=[];return wi(t.fields,(r,n)=>{const i=new sr([r]);if(Yo(n)){const s=ng(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new $r(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new mr(e,0,Ue.min(),Ue.min(),Ue.min(),Fr.empty(),0)}static newFoundDocument(e,r,n,i){return new mr(e,1,r,Ue.min(),n,i,0)}static newNoDocument(e,r){return new mr(e,2,r,Ue.min(),Ue.min(),Fr.empty(),0)}static newUnknownDocument(e,r){return new mr(e,3,r,Ue.min(),Ue.min(),Fr.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Fr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Fr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof mr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new mr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(e,r){this.position=e,this.inclusive=r}}function J0(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=be.comparator(be.fromName(a.referenceValue),r.key):n=Ls(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function Z0(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!xn(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl{constructor(e,r="asc"){this.field=e,this.dir=r}}function jy(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{}class $t extends ig{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new zy(e,r,n):r==="array-contains"?new Xy(e,n):r==="in"?new Yy(e,n):r==="not-in"?new Qy(e,n):r==="array-contains-any"?new Jy(e,n):new $t(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new Ky(e,n):new qy(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Ls(r,this.value)):r!==null&&mi(this.value)===mi(r)&&this.matchesComparison(Ls(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Le(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class En extends ig{constructor(e,r){super(),this.filters=e,this.op=r,this.Te=null}static create(e,r){return new En(e,r)}matches(e){return sg(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function sg(t){return t.op==="and"}function ag(t){return Gy(t)&&sg(t)}function Gy(t){for(const e of t.filters)if(e instanceof En)return!1;return!0}function Fu(t){if(t instanceof $t)return t.field.canonicalString()+t.op.toString()+Ms(t.value);if(ag(t))return t.filters.map(e=>Fu(e)).join(",");{const e=t.filters.map(r=>Fu(r)).join(",");return`${t.op}(${e})`}}function og(t,e){return t instanceof $t?function(n,i){return i instanceof $t&&n.op===i.op&&n.field.isEqual(i.field)&&xn(n.value,i.value)}(t,e):t instanceof En?function(n,i){return i instanceof En&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&og(a,i.filters[o]),!0):!1}(t,e):void Le(19439)}function lg(t){return t instanceof $t?function(r){return`${r.field.canonicalString()} ${r.op} ${Ms(r.value)}`}(t):t instanceof En?function(r){return r.op.toString()+" {"+r.getFilters().map(lg).join(" ,")+"}"}(t):"Filter"}class zy extends $t{constructor(e,r,n){super(e,r,n),this.key=be.fromName(n.referenceValue)}matches(e){const r=be.comparator(e.key,this.key);return this.matchesComparison(r)}}class Ky extends $t{constructor(e,r){super(e,"in",r),this.keys=cg("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class qy extends $t{constructor(e,r){super(e,"not-in",r),this.keys=cg("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function cg(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>be.fromName(n.referenceValue))}class Xy extends $t{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return xf(r)&&Wa(r.arrayValue,this.value)}}class Yy extends $t{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Wa(this.value.arrayValue,r)}}class Qy extends $t{constructor(e,r){super(e,"not-in",r)}matches(e){if(Wa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Wa(this.value.arrayValue,r)}}class Jy extends $t{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!xf(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Wa(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zy{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.Ie=null}}function ed(t,e=null,r=[],n=[],i=null,s=null,a=null){return new Zy(t,e,r,n,i,s,a)}function Ef(t){const e=$e(t);if(e.Ie===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Fu(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),ic(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Ms(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Ms(n)).join(",")),e.Ie=r}return e.Ie}function yf(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!jy(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!og(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Z0(t.startAt,e.startAt)&&Z0(t.endAt,e.endAt)}function Du(t){return be.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=c,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function eT(t,e,r,n,i,s,a,o){return new ac(t,e,r,n,i,s,a,o)}function Tf(t){return new ac(t)}function td(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function tT(t){return t.collectionGroup!==null}function Aa(t){const e=$e(t);if(e.Ee===null){e.Ee=[];const r=new Set;for(const s of e.explicitOrderBy)e.Ee.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Gt(sr.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(o=o.add(u.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.Ee.push(new vl(s,n))}),r.has(sr.keyField().canonicalString())||e.Ee.push(new vl(sr.keyField(),n))}return e.Ee}function pn(t){const e=$e(t);return e.de||(e.de=rT(e,Aa(t))),e.de}function rT(t,e){if(t.limitType==="F")return ed(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new vl(i.field,s)});const r=t.endAt?new _l(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new _l(t.startAt.position,t.startAt.inclusive):null;return ed(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Ou(t,e,r){return new ac(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function oc(t,e){return yf(pn(t),pn(e))&&t.limitType===e.limitType}function ug(t){return`${Ef(pn(t))}|lt:${t.limitType}`}function ds(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>lg(i)).join(", ")}]`),ic(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Ms(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Ms(i)).join(",")),`Target(${n})`}(pn(t))}; limitType=${t.limitType})`}function lc(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):be.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of Aa(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,c){const u=J0(a,o,c);return a.inclusive?u<=0:u<0}(n.startAt,Aa(n),i)||n.endAt&&!function(a,o,c){const u=J0(a,o,c);return a.inclusive?u>=0:u>0}(n.endAt,Aa(n),i))}(t,e)}function nT(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function fg(t){return(e,r)=>{let n=!1;for(const i of Aa(t)){const s=iT(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function iT(t,e,r){const n=t.field.isKeyField()?be.comparator(e.key,r.key):function(s,a,o){const c=a.data.field(s),u=o.data.field(s);return c!==null&&u!==null?Ls(c,u):Le(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Le(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){wi(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return X1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sT=new St(be.comparator);function Vn(){return sT}const hg=new St(be.comparator);function da(...t){let e=hg;for(const r of t)e=e.insert(r.key,r);return e}function dg(t){let e=hg;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Vi(){return Sa()}function pg(){return Sa()}function Sa(){return new Ki(t=>t.toString(),(t,e)=>t.isEqual(e))}const aT=new St(be.comparator),oT=new Gt(be.comparator);function Ye(...t){let e=oT;for(const r of t)e=e.add(r);return e}const lT=new Gt(Xe);function cT(){return lT}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wf(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pl(e)?"-0":e}}function gg(t){return{integerValue:""+t}}function uT(t,e){return Ly(e)?gg(e):wf(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(){this._=void 0}}function fT(t,e,r){return t instanceof xl?function(i,s){const a={fields:{[J1]:{stringValue:Q1},[eg]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&vf(s)&&(s=sc(s)),s&&(a.fields[Z1]=s),{mapValue:a}}(r,e):t instanceof ja?_g(t,e):t instanceof Ga?vg(t,e):function(i,s){const a=mg(i,s),o=rd(a)+rd(i.Re);return Pu(a)&&Pu(i.Re)?gg(o):wf(i.serializer,o)}(t,e)}function hT(t,e,r){return t instanceof ja?_g(t,e):t instanceof Ga?vg(t,e):r}function mg(t,e){return t instanceof El?function(n){return Pu(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class xl extends cc{}class ja extends cc{constructor(e){super(),this.elements=e}}function _g(t,e){const r=xg(e);for(const n of t.elements)r.some(i=>xn(i,n))||r.push(n);return{arrayValue:{values:r}}}class Ga extends cc{constructor(e){super(),this.elements=e}}function vg(t,e){let r=xg(e);for(const n of t.elements)r=r.filter(i=>!xn(i,n));return{arrayValue:{values:r}}}class El extends cc{constructor(e,r){super(),this.serializer=e,this.Re=r}}function rd(t){return Pt(t.integerValue||t.doubleValue)}function xg(t){return xf(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function dT(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof ja&&i instanceof ja||n instanceof Ga&&i instanceof Ga?Ns(n.elements,i.elements,xn):n instanceof El&&i instanceof El?xn(n.Re,i.Re):n instanceof xl&&i instanceof xl}(t.transform,e.transform)}class pT{constructor(e,r){this.version=e,this.transformResults=r}}class gn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new gn}static exists(e){return new gn(void 0,e)}static updateTime(e){return new gn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Qo(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class uc{}function Eg(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Tg(t.key,gn.none()):new ro(t.key,t.data,gn.none());{const r=t.data,n=Fr.empty();let i=new Gt(sr.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new Ai(t.key,n,new $r(i.toArray()),gn.none())}}function gT(t,e,r){t instanceof ro?function(i,s,a){const o=i.value.clone(),c=id(i.fieldTransforms,s,a.transformResults);o.setAll(c),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof Ai?function(i,s,a){if(!Qo(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=id(i.fieldTransforms,s,a.transformResults),c=s.data;c.setAll(yg(i)),c.setAll(o),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Ia(t,e,r,n){return t instanceof ro?function(s,a,o,c){if(!Qo(s.precondition,a))return o;const u=s.value.clone(),f=sd(s.fieldTransforms,c,a);return u.setAll(f),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof Ai?function(s,a,o,c){if(!Qo(s.precondition,a))return o;const u=sd(s.fieldTransforms,c,a),f=a.data;return f.setAll(yg(s)),f.setAll(u),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,r,n):function(s,a,o){return Qo(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function mT(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=mg(n.transform,i||null);s!=null&&(r===null&&(r=Fr.empty()),r.set(n.field,s))}return r||null}function nd(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Ns(n,i,(s,a)=>dT(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ro extends uc{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ai extends uc{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function yg(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function id(t,e,r){const n=new Map;lt(t.length===r.length,32656,{Ve:r.length,me:t.length});for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,hT(a,o,r[i]))}return n}function sd(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,fT(s,a,e))}return n}class Tg extends uc{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class _T extends uc{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vT{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&gT(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Ia(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Ia(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=pg();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const c=Eg(a,o);c!==null&&n.set(i.key,c),a.isValidDocument()||a.convertToNoDocument(Ue.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Ye())}isEqual(e){return this.batchId===e.batchId&&Ns(this.mutations,e.mutations,(r,n)=>nd(r,n))&&Ns(this.baseMutations,e.baseMutations,(r,n)=>nd(r,n))}}class Af{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){lt(e.mutations.length===n.length,58842,{fe:e.mutations.length,ge:n.length});let i=function(){return aT}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new Af(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xT{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ET{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nt,Je;function yT(t){switch(t){case ce.OK:return Le(64938);case ce.CANCELLED:case ce.UNKNOWN:case ce.DEADLINE_EXCEEDED:case ce.RESOURCE_EXHAUSTED:case ce.INTERNAL:case ce.UNAVAILABLE:case ce.UNAUTHENTICATED:return!1;case ce.INVALID_ARGUMENT:case ce.NOT_FOUND:case ce.ALREADY_EXISTS:case ce.PERMISSION_DENIED:case ce.FAILED_PRECONDITION:case ce.ABORTED:case ce.OUT_OF_RANGE:case ce.UNIMPLEMENTED:case ce.DATA_LOSS:return!0;default:return Le(15467,{code:t})}}function wg(t){if(t===void 0)return Mn("GRPC error has no .code"),ce.UNKNOWN;switch(t){case Nt.OK:return ce.OK;case Nt.CANCELLED:return ce.CANCELLED;case Nt.UNKNOWN:return ce.UNKNOWN;case Nt.DEADLINE_EXCEEDED:return ce.DEADLINE_EXCEEDED;case Nt.RESOURCE_EXHAUSTED:return ce.RESOURCE_EXHAUSTED;case Nt.INTERNAL:return ce.INTERNAL;case Nt.UNAVAILABLE:return ce.UNAVAILABLE;case Nt.UNAUTHENTICATED:return ce.UNAUTHENTICATED;case Nt.INVALID_ARGUMENT:return ce.INVALID_ARGUMENT;case Nt.NOT_FOUND:return ce.NOT_FOUND;case Nt.ALREADY_EXISTS:return ce.ALREADY_EXISTS;case Nt.PERMISSION_DENIED:return ce.PERMISSION_DENIED;case Nt.FAILED_PRECONDITION:return ce.FAILED_PRECONDITION;case Nt.ABORTED:return ce.ABORTED;case Nt.OUT_OF_RANGE:return ce.OUT_OF_RANGE;case Nt.UNIMPLEMENTED:return ce.UNIMPLEMENTED;case Nt.DATA_LOSS:return ce.DATA_LOSS;default:return Le(39323,{code:t})}}(Je=Nt||(Nt={}))[Je.OK=0]="OK",Je[Je.CANCELLED=1]="CANCELLED",Je[Je.UNKNOWN=2]="UNKNOWN",Je[Je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Je[Je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Je[Je.NOT_FOUND=5]="NOT_FOUND",Je[Je.ALREADY_EXISTS=6]="ALREADY_EXISTS",Je[Je.PERMISSION_DENIED=7]="PERMISSION_DENIED",Je[Je.UNAUTHENTICATED=16]="UNAUTHENTICATED",Je[Je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Je[Je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Je[Je.ABORTED=10]="ABORTED",Je[Je.OUT_OF_RANGE=11]="OUT_OF_RANGE",Je[Je.UNIMPLEMENTED=12]="UNIMPLEMENTED",Je[Je.INTERNAL=13]="INTERNAL",Je[Je.UNAVAILABLE=14]="UNAVAILABLE",Je[Je.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TT=new ai([4294967295,4294967295],0);function ad(t){const e=z1().encode(t),r=new V1;return r.update(e),new Uint8Array(r.digest())}function od(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ai([r,n],0),new ai([i,s],0)]}class Sf{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new pa(`Invalid padding: ${r}`);if(n<0)throw new pa(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new pa(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new pa(`Invalid padding when bitmap length is 0: ${r}`);this.pe=8*e.length-r,this.ye=ai.fromNumber(this.pe)}we(e,r,n){let i=e.add(r.multiply(ai.fromNumber(n)));return i.compare(TT)===1&&(i=new ai([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const r=ad(e),[n,i]=od(r);for(let s=0;s<this.hashCount;s++){const a=this.we(n,i,s);if(!this.be(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Sf(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.pe===0)return;const r=ad(e),[n,i]=od(r);for(let s=0;s<this.hashCount;s++){const a=this.we(n,i,s);this.Se(a)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class pa extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,no.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new fc(Ue.min(),i,new St(Xe),Vn(),Ye())}}class no{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new no(n,r,Ye(),Ye(),Ye())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e,r,n,i){this.De=e,this.removedTargetIds=r,this.key=n,this.ve=i}}class Ag{constructor(e,r){this.targetId=e,this.Ce=r}}class Sg{constructor(e,r,n=cr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class ld{constructor(){this.Fe=0,this.Me=cd(),this.xe=cr.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Ye(),r=Ye(),n=Ye();return this.Me.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:Le(38017,{changeType:s})}}),new no(this.xe,this.Oe,e,r,n)}Qe(){this.Ne=!1,this.Me=cd()}$e(e,r){this.Ne=!0,this.Me=this.Me.insert(e,r)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,lt(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class wT{constructor(e){this.ze=e,this.je=new Map,this.He=Vn(),this.Je=ko(),this.Ye=ko(),this.Ze=new St(Xe)}Xe(e){for(const r of e.De)e.ve&&e.ve.isFoundDocument()?this.et(r,e.ve):this.tt(r,e.key,e.ve);for(const r of e.removedTargetIds)this.tt(r,e.key,e.ve)}nt(e){this.forEachTarget(e,r=>{const n=this.rt(r);switch(e.state){case 0:this.it(r)&&n.ke(e.resumeToken);break;case 1:n.We(),n.Be||n.Qe(),n.ke(e.resumeToken);break;case 2:n.We(),n.Be||this.removeTarget(r);break;case 3:this.it(r)&&(n.Ge(),n.ke(e.resumeToken));break;case 4:this.it(r)&&(this.st(r),n.ke(e.resumeToken));break;default:Le(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.je.forEach((n,i)=>{this.it(i)&&r(i)})}ot(e){const r=e.targetId,n=e.Ce.count,i=this._t(r);if(i){const s=i.target;if(Du(s))if(n===0){const a=new be(s.path);this.tt(r,a,mr.newNoDocument(a,Ue.min()))}else lt(n===1,20013,{expectedCount:n});else{const a=this.ut(r);if(a!==n){const o=this.ct(e),c=o?this.lt(o,e,a):1;if(c!==0){this.st(r);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(r,u)}}}}}ct(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=gi(n).toUint8Array()}catch(c){if(c instanceof Y1)return ks("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{o=new Sf(a,i,s)}catch(c){return ks(c instanceof pa?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return o.pe===0?null:o}lt(e,r,n){return r.Ce.count===n-this.Tt(e,r.targetId)?0:2}Tt(e,r){const n=this.ze.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.ze.Pt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.tt(r,s,null),i++)}),i}It(e){const r=new Map;this.je.forEach((s,a)=>{const o=this._t(a);if(o){if(s.current&&Du(o.target)){const c=new be(o.target.path);this.Et(c).has(a)||this.dt(a,c)||this.tt(a,c,mr.newNoDocument(c,e))}s.Le&&(r.set(a,s.qe()),s.Qe())}});let n=Ye();this.Ye.forEach((s,a)=>{let o=!0;a.forEachWhile(c=>{const u=this._t(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.He.forEach((s,a)=>a.setReadTime(e));const i=new fc(e,r,this.Ze,this.He,n);return this.He=Vn(),this.Je=ko(),this.Ye=ko(),this.Ze=new St(Xe),i}et(e,r){if(!this.it(e))return;const n=this.dt(e,r.key)?2:0;this.rt(e).$e(r.key,n),this.He=this.He.insert(r.key,r),this.Je=this.Je.insert(r.key,this.Et(r.key).add(e)),this.Ye=this.Ye.insert(r.key,this.At(r.key).add(e))}tt(e,r,n){if(!this.it(e))return;const i=this.rt(e);this.dt(e,r)?i.$e(r,1):i.Ue(r),this.Ye=this.Ye.insert(r,this.At(r).delete(e)),this.Ye=this.Ye.insert(r,this.At(r).add(e)),n&&(this.He=this.He.insert(r,n))}removeTarget(e){this.je.delete(e)}ut(e){const r=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let r=this.je.get(e);return r||(r=new ld,this.je.set(e,r)),r}At(e){let r=this.Ye.get(e);return r||(r=new Gt(Xe),this.Ye=this.Ye.insert(e,r)),r}Et(e){let r=this.Je.get(e);return r||(r=new Gt(Xe),this.Je=this.Je.insert(e,r)),r}it(e){const r=this._t(e)!==null;return r||Ie("WatchChangeAggregator","Detected inactive target",e),r}_t(e){const r=this.je.get(e);return r&&r.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new ld),this.ze.getRemoteKeysForTarget(e).forEach(r=>{this.tt(e,r,null)})}dt(e,r){return this.ze.getRemoteKeysForTarget(e).has(r)}}function ko(){return new St(be.comparator)}function cd(){return new St(be.comparator)}const AT={asc:"ASCENDING",desc:"DESCENDING"},ST={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},IT={and:"AND",or:"OR"};class CT{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function bu(t,e){return t.useProto3Json||ic(e)?e:{value:e}}function yl(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ig(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function RT(t,e){return yl(t,e.toTimestamp())}function mn(t){return lt(!!t,49232),Ue.fromTimestamp(function(r){const n=pi(r);return new jt(n.seconds,n.nanos)}(t))}function If(t,e){return ku(t,e).canonicalString()}function ku(t,e){const r=function(i){return new wt(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Cg(t){const e=wt.fromString(t);return lt(Og(e),10190,{key:e.toString()}),e}function Nu(t,e){return If(t.databaseId,e.path)}function Qc(t,e){const r=Cg(e);if(r.get(1)!==t.databaseId.projectId)throw new De(ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new De(ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new be(Pg(r))}function Rg(t,e){return If(t.databaseId,e)}function PT(t){const e=Cg(t);return e.length===4?wt.emptyPath():Pg(e)}function Lu(t){return new wt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Pg(t){return lt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function ud(t,e,r){return{name:Nu(t,e),fields:r.value.mapValue.fields}}function FT(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Le(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(lt(f===void 0||typeof f=="string",58123),cr.fromBase64String(f||"")):(lt(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),cr.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(u){const f=u.code===void 0?ce.UNKNOWN:wg(u.code);return new De(f,u.message||"")}(a);r=new Sg(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Qc(t,n.document.name),s=mn(n.document.updateTime),a=n.document.createTime?mn(n.document.createTime):Ue.min(),o=new Fr({mapValue:{fields:n.document.fields}}),c=mr.newFoundDocument(i,s,a,o),u=n.targetIds||[],f=n.removedTargetIds||[];r=new Jo(u,f,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Qc(t,n.document),s=n.readTime?mn(n.readTime):Ue.min(),a=mr.newNoDocument(i,s),o=n.removedTargetIds||[];r=new Jo([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Qc(t,n.document),s=n.removedTargetIds||[];r=new Jo([],s,i,null)}else{if(!("filter"in e))return Le(11601,{Vt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new ET(i,s),o=n.targetId;r=new Ag(o,a)}}return r}function DT(t,e){let r;if(e instanceof ro)r={update:ud(t,e.key,e.value)};else if(e instanceof Tg)r={delete:Nu(t,e.key)};else if(e instanceof Ai)r={update:ud(t,e.key,e.data),updateMask:UT(e.fieldMask)};else{if(!(e instanceof _T))return Le(16599,{ft:e.type});r={verify:Nu(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof xl)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof ja)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Ga)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof El)return{fieldPath:a.field.canonicalString(),increment:o.Re};throw Le(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:RT(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Le(27497)}(t,e.precondition)),r}function OT(t,e){return t&&t.length>0?(lt(e!==void 0,14353),t.map(r=>function(i,s){let a=i.updateTime?mn(i.updateTime):mn(s);return a.isEqual(Ue.min())&&(a=mn(s)),new pT(a,i.transformResults||[])}(r,e))):[]}function bT(t,e){return{documents:[Rg(t,e.path)]}}function kT(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Rg(t,i);const s=function(u){if(u.length!==0)return Dg(En.create(u,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(u){if(u.length!==0)return u.map(f=>function(p){return{field:ps(p.field),direction:MT(p.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=bu(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{gt:r,parent:i}}function NT(t){let e=PT(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){lt(n===1,65062);const f=r.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];r.where&&(s=function(d){const p=Fg(d);return p instanceof En&&ag(p)?p.getFilters():[p]}(r.where));let a=[];r.orderBy&&(a=function(d){return d.map(p=>function(v){return new vl(gs(v.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(p))}(r.orderBy));let o=null;r.limit&&(o=function(d){let p;return p=typeof d=="object"?d.value:d,ic(p)?null:p}(r.limit));let c=null;r.startAt&&(c=function(d){const p=!!d.before,g=d.values||[];return new _l(g,p)}(r.startAt));let u=null;return r.endAt&&(u=function(d){const p=!d.before,g=d.values||[];return new _l(g,p)}(r.endAt)),eT(e,i,a,s,o,"F",c,u)}function LT(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Le(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Fg(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=gs(r.unaryFilter.field);return $t.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=gs(r.unaryFilter.field);return $t.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=gs(r.unaryFilter.field);return $t.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=gs(r.unaryFilter.field);return $t.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Le(61313);default:return Le(60726)}}(t):t.fieldFilter!==void 0?function(r){return $t.create(gs(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Le(58110);default:return Le(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return En.create(r.compositeFilter.filters.map(n=>Fg(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Le(1026)}}(r.compositeFilter.op))}(t):Le(30097,{filter:t})}function MT(t){return AT[t]}function VT(t){return ST[t]}function BT(t){return IT[t]}function ps(t){return{fieldPath:t.canonicalString()}}function gs(t){return sr.fromServerFormat(t.fieldPath)}function Dg(t){return t instanceof $t?function(r){if(r.op==="=="){if(Q0(r.value))return{unaryFilter:{field:ps(r.field),op:"IS_NAN"}};if(Y0(r.value))return{unaryFilter:{field:ps(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(Q0(r.value))return{unaryFilter:{field:ps(r.field),op:"IS_NOT_NAN"}};if(Y0(r.value))return{unaryFilter:{field:ps(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ps(r.field),op:VT(r.op),value:r.value}}}(t):t instanceof En?function(r){const n=r.getFilters().map(i=>Dg(i));return n.length===1?n[0]:{compositeFilter:{op:BT(r.op),filters:n}}}(t):Le(54877,{filter:t})}function UT(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function Og(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e,r,n,i,s=Ue.min(),a=Ue.min(),o=cr.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=c}withSequenceNumber(e){return new Zn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Zn(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Zn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Zn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT{constructor(e){this.wt=e}}function $T(t){const e=NT({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ou(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(){this.Cn=new jT}addToCollectionParentIndex(e,r){return this.Cn.add(r),ie.resolve()}getCollectionParents(e,r){return ie.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return ie.resolve()}deleteFieldIndex(e,r){return ie.resolve()}deleteAllFieldIndexes(e){return ie.resolve()}createTargetIndexes(e,r){return ie.resolve()}getDocumentsMatchingTarget(e,r){return ie.resolve(null)}getIndexType(e,r){return ie.resolve(0)}getFieldIndexes(e,r){return ie.resolve([])}getNextCollectionGroupToUpdate(e){return ie.resolve(null)}getMinOffset(e,r){return ie.resolve(di.min())}getMinOffsetFromCollectionGroup(e,r){return ie.resolve(di.min())}updateCollectionGroup(e,r,n){return ie.resolve()}updateIndexEntries(e,r){return ie.resolve()}}class jT{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Gt(wt.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Gt(wt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fd={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},bg=41943040;class Pr{static withCacheSize(e){return new Pr(e,Pr.DEFAULT_COLLECTION_PERCENTILE,Pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Pr.DEFAULT_COLLECTION_PERCENTILE=10,Pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Pr.DEFAULT=new Pr(bg,Pr.DEFAULT_COLLECTION_PERCENTILE,Pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Pr.DISABLED=new Pr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new Vs(0)}static lr(){return new Vs(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hd="LruGarbageCollector",GT=1048576;function dd([t,e],[r,n]){const i=Xe(t,r);return i===0?Xe(e,n):i}class zT{constructor(e){this.Er=e,this.buffer=new Gt(dd),this.dr=0}Ar(){return++this.dr}Rr(e){const r=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();dd(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class KT{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){Ie(hd,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){zs(r)?Ie(hd,"Ignoring IndexedDB error during garbage collection: ",r):await Gs(r)}await this.mr(3e5)})}}class qT{constructor(e,r){this.gr=e,this.params=r}calculateTargetCount(e,r){return this.gr.pr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return ie.resolve(nc.le);const n=new zT(r);return this.gr.forEachTarget(e,i=>n.Rr(i.sequenceNumber)).next(()=>this.gr.yr(e,i=>n.Rr(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.gr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.gr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ie("LruGarbageCollector","Garbage collection skipped; disabled"),ie.resolve(fd)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ie("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),fd):this.wr(e,r))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,r){let n,i,s,a,o,c,u;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(Ie("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,a=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(n=d,o=Date.now(),this.removeTargets(e,n,r))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(d=>(u=Date.now(),hs()<=Ze.DEBUG&&Ie("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${i} in `+(o-a)+`ms
	Removed ${s} targets in `+(c-o)+`ms
	Removed ${d} documents in `+(u-c)+`ms
Total Duration: ${u-f}ms`),ie.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}}function XT(t,e){return new qT(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YT{constructor(){this.changes=new Ki(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,mr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?ie.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QT{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JT{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Ia(n.mutation,i,$r.empty(),jt.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Ye()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Ye()){const i=Vi();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=da();return s.forEach((o,c)=>{a=a.insert(o,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Vi();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Ye()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=Vn();const a=Sa(),o=function(){return Sa()}();return r.forEach((c,u)=>{const f=n.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof Ai)?s=s.insert(u.key,u):f!==void 0?(a.set(u.key,f.mutation.getFieldMask()),Ia(f.mutation,u,f.mutation.getFieldMask(),jt.now())):a.set(u.key,$r.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,f)=>a.set(u,f)),r.forEach((u,f)=>{var d;return o.set(u,new QT(f,(d=a.get(u))!==null&&d!==void 0?d:null))}),o))}recalculateAndSaveOverlays(e,r){const n=Sa();let i=new St((a,o)=>a-o),s=Ye();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(c=>{const u=r.get(c);if(u===null)return;let f=n.get(c)||$r.empty();f=o.applyToLocalView(u,f),n.set(c,f);const d=(i.get(o.batchId)||Ye()).add(c);i=i.insert(o.batchId,d)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const c=o.getNext(),u=c.key,f=c.value,d=pg();f.forEach(p=>{if(!s.has(p)){const g=Eg(r.get(p),n.get(p));g!==null&&d.set(p,g),s=s.add(p)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,d))}return ie.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return be.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):tT(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):ie.resolve(Vi());let o=Ua,c=s;return a.next(u=>ie.forEach(u,(f,d)=>(o<d.largestBatchId&&(o=d.largestBatchId),s.get(f)?ie.resolve():this.remoteDocumentCache.getEntry(e,f).next(p=>{c=c.insert(f,p)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,Ye())).next(f=>({batchId:o,changes:dg(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new be(r)).next(n=>{let i=da();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=da();return this.indexManager.getCollectionParents(e,s).next(o=>ie.forEach(o,c=>{const u=function(d,p){return new ac(p,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(r,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,n,i).next(f=>{f.forEach((d,p)=>{a=a.insert(d,p)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((c,u)=>{const f=u.getKey();a.get(f)===null&&(a=a.insert(f,mr.newInvalidDocument(f)))});let o=da();return a.forEach((c,u)=>{const f=s.get(c);f!==void 0&&Ia(f.mutation,u,$r.empty(),jt.now()),lc(r,u)&&(o=o.insert(c,u))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZT{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,r){return ie.resolve(this.kr.get(r))}saveBundleMetadata(e,r){return this.kr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:mn(i.createTime)}}(r)),ie.resolve()}getNamedQuery(e,r){return ie.resolve(this.qr.get(r))}saveNamedQuery(e,r){return this.qr.set(r.name,function(i){return{name:i.name,query:$T(i.bundledQuery),readTime:mn(i.readTime)}}(r)),ie.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ew{constructor(){this.overlays=new St(be.comparator),this.Qr=new Map}getOverlay(e,r){return ie.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Vi();return ie.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.St(e,r,s)}),ie.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Qr.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Qr.delete(n)),ie.resolve()}getOverlaysForCollection(e,r,n){const i=Vi(),s=r.length+1,a=new be(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const c=o.getNext().value,u=c.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>n&&i.set(c.getKey(),c)}return ie.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new St((u,f)=>u-f);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let f=s.get(u.largestBatchId);f===null&&(f=Vi(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const o=Vi(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,f)=>o.set(u,f)),!(o.size()>=i)););return ie.resolve(o)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Qr.get(i.largestBatchId).delete(n.key);this.Qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new xT(r,n));let s=this.Qr.get(r);s===void 0&&(s=Ye(),this.Qr.set(r,s)),this.Qr.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{constructor(){this.sessionToken=cr.EMPTY_BYTE_STRING}getSessionToken(e){return ie.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,ie.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(){this.$r=new Gt(Xt.Ur),this.Kr=new Gt(Xt.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,r){const n=new Xt(e,r);this.$r=this.$r.add(n),this.Kr=this.Kr.add(n)}Gr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.zr(new Xt(e,r))}jr(e,r){e.forEach(n=>this.removeReference(n,r))}Hr(e){const r=new be(new wt([])),n=new Xt(r,e),i=new Xt(r,e+1),s=[];return this.Kr.forEachInRange([n,i],a=>{this.zr(a),s.push(a.key)}),s}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const r=new be(new wt([])),n=new Xt(r,e),i=new Xt(r,e+1);let s=Ye();return this.Kr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new Xt(e,0),n=this.$r.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Xt{constructor(e,r){this.key=e,this.Zr=r}static Ur(e,r){return be.comparator(e.key,r.key)||Xe(e.Zr,r.Zr)}static Wr(e,r){return Xe(e.Zr,r.Zr)||be.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rw{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.nr=1,this.Xr=new Gt(Xt.Ur)}checkEmpty(e){return ie.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new vT(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.Xr=this.Xr.add(new Xt(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return ie.resolve(a)}lookupMutationBatch(e,r){return ie.resolve(this.ei(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ti(n),s=i<0?0:i;return ie.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ie.resolve(this.mutationQueue.length===0?_f:this.nr-1)}getAllMutationBatches(e){return ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Xt(r,0),i=new Xt(r,Number.POSITIVE_INFINITY),s=[];return this.Xr.forEachInRange([n,i],a=>{const o=this.ei(a.Zr);s.push(o)}),ie.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Gt(Xe);return r.forEach(i=>{const s=new Xt(i,0),a=new Xt(i,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([s,a],o=>{n=n.add(o.Zr)})}),ie.resolve(this.ni(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;be.isDocumentKey(s)||(s=s.child(""));const a=new Xt(new be(s),0);let o=new Gt(Xe);return this.Xr.forEachWhile(c=>{const u=c.key.path;return!!n.isPrefixOf(u)&&(u.length===i&&(o=o.add(c.Zr)),!0)},a),ie.resolve(this.ni(o))}ni(e){const r=[];return e.forEach(n=>{const i=this.ei(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){lt(this.ri(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Xr;return ie.forEach(r.mutations,i=>{const s=new Xt(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Xr=n})}sr(e){}containsKey(e,r){const n=new Xt(r,0),i=this.Xr.firstAfterOrEqual(n);return ie.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ie.resolve()}ri(e,r){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const r=this.ti(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{constructor(e){this.ii=e,this.docs=function(){return new St(be.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.ii(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return ie.resolve(n?n.document.mutableCopy():mr.newInvalidDocument(r))}getEntries(e,r){let n=Vn();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():mr.newInvalidDocument(i))}),ie.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=Vn();const a=r.path,o=new be(a.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(o);for(;c.hasNext();){const{key:u,value:{document:f}}=c.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||Oy(Dy(f),n)<=0||(i.has(f.key)||lc(r,f))&&(s=s.insert(f.key,f.mutableCopy()))}return ie.resolve(s)}getAllFromCollectionGroup(e,r,n,i){Le(9500)}si(e,r){return ie.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new iw(this)}getSize(e){return ie.resolve(this.size)}}class iw extends YT{constructor(e){super(),this.Br=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Br.addEntry(e,i)):this.Br.removeEntry(n)}),ie.waitFor(r)}getFromCache(e,r){return this.Br.getEntry(e,r)}getAllFromCache(e,r){return this.Br.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{constructor(e){this.persistence=e,this.oi=new Ki(r=>Ef(r),yf),this.lastRemoteSnapshotVersion=Ue.min(),this.highestTargetId=0,this._i=0,this.ai=new Cf,this.targetCount=0,this.ui=Vs.cr()}forEachTarget(e,r){return this.oi.forEach((n,i)=>r(i)),ie.resolve()}getLastRemoteSnapshotVersion(e){return ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ie.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),ie.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this._i&&(this._i=r),ie.resolve()}Tr(e){this.oi.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ui=new Vs(r),this.highestTargetId=r),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,r){return this.Tr(r),this.targetCount+=1,ie.resolve()}updateTargetData(e,r){return this.Tr(r),ie.resolve()}removeTargetData(e,r){return this.oi.delete(r.target),this.ai.Hr(r.targetId),this.targetCount-=1,ie.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.oi.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.oi.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),ie.waitFor(s).next(()=>i)}getTargetCount(e){return ie.resolve(this.targetCount)}getTargetData(e,r){const n=this.oi.get(r)||null;return ie.resolve(n)}addMatchingKeys(e,r,n){return this.ai.Gr(r,n),ie.resolve()}removeMatchingKeys(e,r,n){this.ai.jr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),ie.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.ai.Hr(r),ie.resolve()}getMatchingKeysForTargetId(e,r){const n=this.ai.Yr(r);return ie.resolve(n)}containsKey(e,r){return ie.resolve(this.ai.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kg{constructor(e,r){this.ci={},this.overlays={},this.li=new nc(0),this.hi=!1,this.hi=!0,this.Pi=new tw,this.referenceDelegate=e(this),this.Ti=new sw(this),this.indexManager=new WT,this.remoteDocumentCache=function(i){return new nw(i)}(n=>this.referenceDelegate.Ii(n)),this.serializer=new HT(r),this.Ei=new ZT(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new ew,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ci[e.toKey()];return n||(n=new rw(r,this.referenceDelegate),this.ci[e.toKey()]=n),n}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,r,n){Ie("MemoryPersistence","Starting transaction:",e);const i=new aw(this.li.next());return this.referenceDelegate.di(),n(i).next(s=>this.referenceDelegate.Ai(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ri(e,r){return ie.or(Object.values(this.ci).map(n=>()=>n.containsKey(e,r)))}}class aw extends ky{constructor(e){super(),this.currentSequenceNumber=e}}class Rf{constructor(e){this.persistence=e,this.Vi=new Cf,this.mi=null}static fi(e){return new Rf(e)}get gi(){if(this.mi)return this.mi;throw Le(60996)}addReference(e,r,n){return this.Vi.addReference(n,r),this.gi.delete(n.toString()),ie.resolve()}removeReference(e,r,n){return this.Vi.removeReference(n,r),this.gi.add(n.toString()),ie.resolve()}markPotentiallyOrphaned(e,r){return this.gi.add(r.toString()),ie.resolve()}removeTarget(e,r){this.Vi.Hr(r.targetId).forEach(i=>this.gi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.gi.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}di(){this.mi=new Set}Ai(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ie.forEach(this.gi,n=>{const i=be.fromPath(n);return this.pi(e,i).next(s=>{s||r.removeEntry(i,Ue.min())})}).next(()=>(this.mi=null,r.apply(e)))}updateLimboDocument(e,r){return this.pi(e,r).next(n=>{n?this.gi.delete(r.toString()):this.gi.add(r.toString())})}Ii(e){return 0}pi(e,r){return ie.or([()=>ie.resolve(this.Vi.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ri(e,r)])}}class Tl{constructor(e,r){this.persistence=e,this.yi=new Ki(n=>My(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=XT(this,r)}static fi(e,r){return new Tl(e,r)}di(){}Ai(e){return ie.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}pr(e){const r=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}br(e){let r=0;return this.yr(e,n=>{r++}).next(()=>r)}yr(e,r){return ie.forEach(this.yi,(n,i)=>this.Dr(e,n,i).next(s=>s?ie.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.si(e,a=>this.Dr(e,a,r).next(o=>{o||(n++,s.removeEntry(a,Ue.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.yi.set(r,e.currentSequenceNumber),ie.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.yi.set(n,e.currentSequenceNumber),ie.resolve()}removeReference(e,r,n){return this.yi.set(n,e.currentSequenceNumber),ie.resolve()}updateLimboDocument(e,r){return this.yi.set(r,e.currentSequenceNumber),ie.resolve()}Ii(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Xo(e.data.value)),r}Dr(e,r,n){return ie.or([()=>this.persistence.Ri(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.yi.get(r);return ie.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pf{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.ds=n,this.As=i}static Rs(e,r){let n=Ye(),i=Ye();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Pf(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ow{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lw{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return tE()?8:Ny(Z2())>0?6:4}()}initialize(e,r){this.ys=e,this.indexManager=r,this.Vs=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.ws(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.bs(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new ow;return this.Ss(e,r,a).next(o=>{if(s.result=o,this.fs)return this.Ds(e,r,a,o.size)})}).next(()=>s.result)}Ds(e,r,n,i){return n.documentReadCount<this.gs?(hs()<=Ze.DEBUG&&Ie("QueryEngine","SDK will not create cache indexes for query:",ds(r),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),ie.resolve()):(hs()<=Ze.DEBUG&&Ie("QueryEngine","Query:",ds(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.ps*i?(hs()<=Ze.DEBUG&&Ie("QueryEngine","The SDK decides to create cache indexes for query:",ds(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,pn(r))):ie.resolve())}ws(e,r){if(td(r))return ie.resolve(null);let n=pn(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Ou(r,null,"F"),n=pn(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=Ye(...s);return this.ys.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(c=>{const u=this.vs(r,o);return this.Cs(r,u,a,c.readTime)?this.ws(e,Ou(r,null,"F")):this.Fs(e,u,r,c)}))})))}bs(e,r,n,i){return td(r)||i.isEqual(Ue.min())?ie.resolve(null):this.ys.getDocuments(e,n).next(s=>{const a=this.vs(r,s);return this.Cs(r,a,n,i)?ie.resolve(null):(hs()<=Ze.DEBUG&&Ie("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ds(r)),this.Fs(e,a,r,Fy(i,Ua)).next(o=>o))})}vs(e,r){let n=new Gt(fg(e));return r.forEach((i,s)=>{lc(e,s)&&(n=n.add(s))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,r,n){return hs()<=Ze.DEBUG&&Ie("QueryEngine","Using full collection scan to execute query:",ds(r)),this.ys.getDocumentsMatchingQuery(e,r,di.min(),n)}Fs(e,r,n,i){return this.ys.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ff="LocalStore",cw=3e8;class uw{constructor(e,r,n,i){this.persistence=e,this.Ms=r,this.serializer=i,this.xs=new St(Xe),this.Os=new Ki(s=>Ef(s),yf),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(n)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new JT(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.xs))}}function fw(t,e,r,n){return new uw(t,e,r,n)}async function Ng(t,e){const r=$e(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.Ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let c=Ye();for(const u of i){a.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}for(const u of s){o.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}return r.localDocuments.getDocuments(n,c).next(u=>({ks:u,removedBatchIds:a,addedBatchIds:o}))})})}function hw(t,e){const r=$e(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.Bs.newChangeBuffer({trackRemovals:!0});return function(o,c,u,f){const d=u.batch,p=d.keys();let g=ie.resolve();return p.forEach(v=>{g=g.next(()=>f.getEntry(c,v)).next(_=>{const E=u.docVersions.get(v);lt(E!==null,48541),_.version.compareTo(E)<0&&(d.applyToRemoteDocument(_,u),_.isValidDocument()&&(_.setReadTime(u.commitVersion),f.addEntry(_)))})}),g.next(()=>o.mutationQueue.removeMutationBatch(c,d))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let c=Ye();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(c=c.add(o.batch.mutations[u].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function Lg(t){const e=$e(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ti.getLastRemoteSnapshotVersion(r))}function dw(t,e){const r=$e(t),n=e.snapshotVersion;let i=r.xs;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.Bs.newChangeBuffer({trackRemovals:!0});i=r.xs;const o=[];e.targetChanges.forEach((f,d)=>{const p=i.get(d);if(!p)return;o.push(r.Ti.removeMatchingKeys(s,f.removedDocuments,d).next(()=>r.Ti.addMatchingKeys(s,f.addedDocuments,d)));let g=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?g=g.withResumeToken(cr.EMPTY_BYTE_STRING,Ue.min()).withLastLimboFreeSnapshotVersion(Ue.min()):f.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(f.resumeToken,n)),i=i.insert(d,g),function(_,E,L){return _.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=cw?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0}(p,g,f)&&o.push(r.Ti.updateTargetData(s,g))});let c=Vn(),u=Ye();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,f))}),o.push(pw(s,a,e.documentUpdates).next(f=>{c=f.qs,u=f.Qs})),!n.isEqual(Ue.min())){const f=r.Ti.getLastRemoteSnapshotVersion(s).next(d=>r.Ti.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(f)}return ie.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(r.xs=i,s))}function pw(t,e,r){let n=Ye(),i=Ye();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=Vn();return r.forEach((o,c)=>{const u=s.get(o);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(o)),c.isNoDocument()&&c.version.isEqual(Ue.min())?(e.removeEntry(o,c.readTime),a=a.insert(o,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),a=a.insert(o,c)):Ie(Ff,"Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",c.version)}),{qs:a,Qs:i}})}function gw(t,e){const r=$e(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=_f),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function mw(t,e){const r=$e(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ti.getTargetData(n,e).next(s=>s?(i=s,ie.resolve(i)):r.Ti.allocateTargetId(n).next(a=>(i=new Zn(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ti.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.xs.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.xs=r.xs.insert(n.targetId,n),r.Os.set(e,n.targetId)),n})}async function Mu(t,e,r){const n=$e(t),i=n.xs.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!zs(a))throw a;Ie(Ff,`Failed to update sequence numbers for target ${e}: ${a}`)}n.xs=n.xs.remove(e),n.Os.delete(i.target)}function pd(t,e,r){const n=$e(t);let i=Ue.min(),s=Ye();return n.persistence.runTransaction("Execute query","readwrite",a=>function(c,u,f){const d=$e(c),p=d.Os.get(f);return p!==void 0?ie.resolve(d.xs.get(p)):d.Ti.getTargetData(u,f)}(n,a,pn(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ti.getMatchingKeysForTargetId(a,o.targetId).next(c=>{s=c})}).next(()=>n.Ms.getDocumentsMatchingQuery(a,e,r?i:Ue.min(),r?s:Ye())).next(o=>(_w(n,nT(e),o),{documents:o,$s:s})))}function _w(t,e,r){let n=t.Ns.get(e)||Ue.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.Ns.set(e,n)}class gd{constructor(){this.activeTargetIds=cT()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class vw{constructor(){this.xo=new gd,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,r,n){this.Oo[e]=r}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new gd,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xw{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const md="ConnectivityMonitor";class _d{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){Ie(md,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){Ie(md,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let No=null;function Vu(){return No===null?No=function(){return 268435456+Math.round(2147483648*Math.random())}():No++,"0x"+No.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jc="RestConnection",Ew={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class yw{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Ko=r+"://"+e.host,this.Wo=`projects/${n}/databases/${i}`,this.Go=this.databaseId.database===gl?`project_id=${n}`:`project_id=${n}&database_id=${i}`}zo(e,r,n,i,s){const a=Vu(),o=this.jo(e,r.toUriEncodedString());Ie(Jc,`Sending RPC '${e}' ${a}:`,o,n);const c={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(c,i,s);const{host:u}=new URL(o),f=pf(u);return this.Jo(e,o,c,n,f).then(d=>(Ie(Jc,`Received RPC '${e}' ${a}: `,d),d),d=>{throw ks(Jc,`RPC '${e}' ${a} failed with error: `,d,"url: ",o,"request:",n),d})}Yo(e,r,n,i,s,a){return this.zo(e,r,n,i,s)}Ho(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+js}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,s)=>e[s]=i),n&&n.headers.forEach((i,s)=>e[s]=i)}jo(e,r){const n=Ew[e];return`${this.Ko}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tw{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dr="WebChannelConnection";class ww extends yw{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,s){const a=Vu();return new Promise((o,c)=>{const u=new B1;u.setWithCredentials(!0),u.listenOnce(U1.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case qo.NO_ERROR:const d=u.getResponseJson();Ie(dr,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(d)),o(d);break;case qo.TIMEOUT:Ie(dr,`RPC '${e}' ${a} timed out`),c(new De(ce.DEADLINE_EXCEEDED,"Request time out"));break;case qo.HTTP_ERROR:const p=u.getStatus();if(Ie(dr,`RPC '${e}' ${a} failed with status:`,p,"response text:",u.getResponseText()),p>0){let g=u.getResponseJson();Array.isArray(g)&&(g=g[0]);const v=g==null?void 0:g.error;if(v&&v.status&&v.message){const _=function(L){const V=L.toLowerCase().replace(/_/g,"-");return Object.values(ce).indexOf(V)>=0?V:ce.UNKNOWN}(v.status);c(new De(_,v.message))}else c(new De(ce.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new De(ce.UNAVAILABLE,"Connection failed."));break;default:Le(9055,{h_:e,streamId:a,P_:u.getLastErrorCode(),T_:u.getLastError()})}}finally{Ie(dr,`RPC '${e}' ${a} completed.`)}});const f=JSON.stringify(i);Ie(dr,`RPC '${e}' ${a} sending request:`,i),u.send(r,"POST",f,n,15)})}I_(e,r,n){const i=Vu(),s=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=W1(),o=$1(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Ho(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const f=s.join("");Ie(dr,`Creating RPC '${e}' stream ${i}: ${f}`,c);const d=a.createWebChannel(f,c);this.E_(d);let p=!1,g=!1;const v=new Tw({Zo:E=>{g?Ie(dr,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(p||(Ie(dr,`Opening RPC '${e}' stream ${i} transport.`),d.open(),p=!0),Ie(dr,`RPC '${e}' stream ${i} sending:`,E),d.send(E))},Xo:()=>d.close()}),_=(E,L,V)=>{E.listen(L,N=>{try{V(N)}catch(U){setTimeout(()=>{throw U},0)}})};return _(d,ha.EventType.OPEN,()=>{g||(Ie(dr,`RPC '${e}' stream ${i} transport opened.`),v.__())}),_(d,ha.EventType.CLOSE,()=>{g||(g=!0,Ie(dr,`RPC '${e}' stream ${i} transport closed`),v.u_(),this.d_(d))}),_(d,ha.EventType.ERROR,E=>{g||(g=!0,ks(dr,`RPC '${e}' stream ${i} transport errored. Name:`,E.name,"Message:",E.message),v.u_(new De(ce.UNAVAILABLE,"The operation could not be completed")))}),_(d,ha.EventType.MESSAGE,E=>{var L;if(!g){const V=E.data[0];lt(!!V,16349);const N=V,U=(N==null?void 0:N.error)||((L=N[0])===null||L===void 0?void 0:L.error);if(U){Ie(dr,`RPC '${e}' stream ${i} received error:`,U);const re=U.status;let le=function(y){const I=Nt[y];if(I!==void 0)return wg(I)}(re),w=U.message;le===void 0&&(le=ce.INTERNAL,w="Unknown error status: "+re+" with message "+U.message),g=!0,v.u_(new De(le,w)),d.close()}else Ie(dr,`RPC '${e}' stream ${i} received:`,V),v.c_(V)}}),_(o,H1.STAT_EVENT,E=>{E.stat===Iu.PROXY?Ie(dr,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===Iu.NOPROXY&&Ie(dr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.a_()},0),v}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(r=>r===e)}}function Zc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hc(t){return new CT(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mg{constructor(e,r,n=1e3,i=1.5,s=6e4){this.xi=e,this.timerId=r,this.A_=n,this.R_=i,this.V_=s,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const r=Math.floor(this.m_+this.w_()),n=Math.max(0,Date.now()-this.g_),i=Math.max(0,r-n);i>0&&Ie("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.m_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,i,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vd="PersistentStream";class Vg{constructor(e,r,n,i,s,a,o,c){this.xi=e,this.S_=n,this.D_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=c,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new Mg(e,r)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,r){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():r&&r.code===ce.RESOURCE_EXHAUSTED?(Mn(r.toString()),Mn("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):r&&r.code===ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(r)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),r=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.v_===r&&this.z_(n,i)},n=>{e(()=>{const i=new De(ce.UNKNOWN,"Fetching auth token failed: "+n.message);return this.j_(i)})})}z_(e,r){const n=this.G_(this.v_);this.stream=this.H_(e,r),this.stream.e_(()=>{n(()=>this.listener.e_())}),this.stream.n_(()=>{n(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(i=>{n(()=>this.j_(i))}),this.stream.onMessage(i=>{n(()=>++this.M_==1?this.J_(i):this.onNext(i))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return Ie(vd,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return r=>{this.xi.enqueueAndForget(()=>this.v_===e?r():(Ie(vd,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Aw extends Vg{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}H_(e,r){return this.connection.I_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const r=FT(this.serializer,e),n=function(s){if(!("targetChange"in s))return Ue.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Ue.min():a.readTime?mn(a.readTime):Ue.min()}(e);return this.listener.Y_(r,n)}Z_(e){const r={};r.database=Lu(this.serializer),r.addTarget=function(s,a){let o;const c=a.target;if(o=Du(c)?{documents:bT(s,c)}:{query:kT(s,c).gt},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=Ig(s,a.resumeToken);const u=bu(s,a.expectedCount);u!==null&&(o.expectedCount=u)}else if(a.snapshotVersion.compareTo(Ue.min())>0){o.readTime=yl(s,a.snapshotVersion.toTimestamp());const u=bu(s,a.expectedCount);u!==null&&(o.expectedCount=u)}return o}(this.serializer,e);const n=LT(this.serializer,e);n&&(r.labels=n),this.Q_(r)}X_(e){const r={};r.database=Lu(this.serializer),r.removeTarget=e,this.Q_(r)}}class Sw extends Vg{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,r){return this.connection.I_("Write",e,r)}J_(e){return lt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,lt(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){lt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const r=OT(e.writeResults,e.commitTime),n=mn(e.commitTime);return this.listener.ra(n,r)}ia(){const e={};e.database=Lu(this.serializer),this.Q_(e)}ta(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>DT(this.serializer,n))};this.Q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{}class Cw extends Iw{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.sa=!1}oa(){if(this.sa)throw new De(ce.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,r,n,i){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.zo(e,ku(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new De(ce.UNKNOWN,s.toString())})}Yo(e,r,n,i,s){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Yo(e,ku(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new De(ce.UNKNOWN,a.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class Rw{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Mn(r),this.ua=!1):Ie("OnlineStateTracker",r)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wi="RemoteStore";class Pw{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=s,this.Ra.No(a=>{n.enqueueAndForget(async()=>{qi(this)&&(Ie(Wi,"Restarting streams for network reachability change."),await async function(c){const u=$e(c);u.da.add(4),await io(u),u.Va.set("Unknown"),u.da.delete(4),await dc(u)}(this))})}),this.Va=new Rw(n,i)}}async function dc(t){if(qi(t))for(const e of t.Aa)await e(!0)}async function io(t){for(const e of t.Aa)await e(!1)}function Bg(t,e){const r=$e(t);r.Ea.has(e.targetId)||(r.Ea.set(e.targetId,e),kf(r)?bf(r):Ks(r).N_()&&Of(r,e))}function Df(t,e){const r=$e(t),n=Ks(r);r.Ea.delete(e),n.N_()&&Ug(r,e),r.Ea.size===0&&(n.N_()?n.k_():qi(r)&&r.Va.set("Unknown"))}function Of(t,e){if(t.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ue.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Ks(t).Z_(e)}function Ug(t,e){t.ma.Ke(e),Ks(t).X_(e)}function bf(t){t.ma=new wT({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>t.Ea.get(e)||null,Pt:()=>t.datastore.serializer.databaseId}),Ks(t).start(),t.Va.ca()}function kf(t){return qi(t)&&!Ks(t).O_()&&t.Ea.size>0}function qi(t){return $e(t).da.size===0}function Hg(t){t.ma=void 0}async function Fw(t){t.Va.set("Online")}async function Dw(t){t.Ea.forEach((e,r)=>{Of(t,e)})}async function Ow(t,e){Hg(t),kf(t)?(t.Va.Pa(e),bf(t)):t.Va.set("Unknown")}async function bw(t,e,r){if(t.Va.set("Online"),e instanceof Sg&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.Ea.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.Ea.delete(o),i.ma.removeTarget(o))}(t,e)}catch(n){Ie(Wi,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await wl(t,n)}else if(e instanceof Jo?t.ma.Xe(e):e instanceof Ag?t.ma.ot(e):t.ma.nt(e),!r.isEqual(Ue.min()))try{const n=await Lg(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.ma.It(a);return o.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const f=s.Ea.get(u);f&&s.Ea.set(u,f.withResumeToken(c.resumeToken,a))}}),o.targetMismatches.forEach((c,u)=>{const f=s.Ea.get(c);if(!f)return;s.Ea.set(c,f.withResumeToken(cr.EMPTY_BYTE_STRING,f.snapshotVersion)),Ug(s,c);const d=new Zn(f.target,c,u,f.sequenceNumber);Of(s,d)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Ie(Wi,"Failed to raise snapshot:",n),await wl(t,n)}}async function wl(t,e,r){if(!zs(e))throw e;t.da.add(1),await io(t),t.Va.set("Offline"),r||(r=()=>Lg(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ie(Wi,"Retrying IndexedDB access"),await r(),t.da.delete(1),await dc(t)})}function $g(t,e){return e().catch(r=>wl(t,r,e))}async function pc(t){const e=$e(t),r=_i(e);let n=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:_f;for(;kw(e);)try{const i=await gw(e.localStore,n);if(i===null){e.Ia.length===0&&r.k_();break}n=i.batchId,Nw(e,i)}catch(i){await wl(e,i)}Wg(e)&&jg(e)}function kw(t){return qi(t)&&t.Ia.length<10}function Nw(t,e){t.Ia.push(e);const r=_i(t);r.N_()&&r.ea&&r.ta(e.mutations)}function Wg(t){return qi(t)&&!_i(t).O_()&&t.Ia.length>0}function jg(t){_i(t).start()}async function Lw(t){_i(t).ia()}async function Mw(t){const e=_i(t);for(const r of t.Ia)e.ta(r.mutations)}async function Vw(t,e,r){const n=t.Ia.shift(),i=Af.from(n,e,r);await $g(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await pc(t)}async function Bw(t,e){e&&_i(t).ea&&await async function(n,i){if(function(a){return yT(a)&&a!==ce.ABORTED}(i.code)){const s=n.Ia.shift();_i(n).L_(),await $g(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await pc(n)}}(t,e),Wg(t)&&jg(t)}async function xd(t,e){const r=$e(t);r.asyncQueue.verifyOperationInProgress(),Ie(Wi,"RemoteStore received new credentials");const n=qi(r);r.da.add(3),await io(r),n&&r.Va.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.da.delete(3),await dc(r)}async function Uw(t,e){const r=$e(t);e?(r.da.delete(2),await dc(r)):e||(r.da.add(2),await io(r),r.Va.set("Unknown"))}function Ks(t){return t.fa||(t.fa=function(r,n,i){const s=$e(r);return s.oa(),new Aw(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{e_:Fw.bind(null,t),n_:Dw.bind(null,t),i_:Ow.bind(null,t),Y_:bw.bind(null,t)}),t.Aa.push(async e=>{e?(t.fa.L_(),kf(t)?bf(t):t.Va.set("Unknown")):(await t.fa.stop(),Hg(t))})),t.fa}function _i(t){return t.ga||(t.ga=function(r,n,i){const s=$e(r);return s.oa(),new Sw(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{e_:()=>Promise.resolve(),n_:Lw.bind(null,t),i_:Bw.bind(null,t),na:Mw.bind(null,t),ra:Vw.bind(null,t)}),t.Aa.push(async e=>{e?(t.ga.L_(),await pc(t)):(await t.ga.stop(),t.Ia.length>0&&(Ie(Wi,`Stopping write stream with ${t.Ia.length} pending writes`),t.Ia=[]))})),t.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new oi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new Nf(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new De(ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Lf(t,e){if(Mn("AsyncQueue",`${e}: ${t}`),zs(t))return new De(ce.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs{static emptySet(e){return new Rs(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||be.comparator(r.key,n.key):(r,n)=>be.comparator(r.key,n.key),this.keyedMap=da(),this.sortedSet=new St(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Rs)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Rs;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(){this.pa=new St(be.comparator)}track(e){const r=e.doc.key,n=this.pa.get(r);n?e.type!==0&&n.type===3?this.pa=this.pa.insert(r,e):e.type===3&&n.type!==1?this.pa=this.pa.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.pa=this.pa.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.pa=this.pa.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.pa=this.pa.remove(r):e.type===1&&n.type===2?this.pa=this.pa.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.pa=this.pa.insert(r,{type:2,doc:e.doc}):Le(63341,{Vt:e,ya:n}):this.pa=this.pa.insert(r,e)}wa(){const e=[];return this.pa.inorderTraversal((r,n)=>{e.push(n)}),e}}class Bs{constructor(e,r,n,i,s,a,o,c,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new Bs(e,r,Rs.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&oc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hw{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class $w{constructor(){this.queries=yd(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=$e(r),s=i.queries;i.queries=yd(),s.forEach((a,o)=>{for(const c of o.Sa)c.onError(n)})})(this,new De(ce.ABORTED,"Firestore shutting down"))}}function yd(){return new Ki(t=>ug(t),oc)}async function Ww(t,e){const r=$e(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.Da()&&e.va()&&(n=2):(s=new Hw,n=e.va()?0:1);try{switch(n){case 0:s.ba=await r.onListen(i,!0);break;case 1:s.ba=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=Lf(a,`Initialization of query '${ds(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.Sa.push(e),e.Fa(r.onlineState),s.ba&&e.Ma(s.ba)&&Mf(r)}async function jw(t,e){const r=$e(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?i=e.va()?0:1:!s.Da()&&e.va()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function Gw(t,e){const r=$e(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.Sa)o.Ma(i)&&(n=!0);a.ba=i}}n&&Mf(r)}function zw(t,e,r){const n=$e(t),i=n.queries.get(e);if(i)for(const s of i.Sa)s.onError(r);n.queries.delete(e)}function Mf(t){t.Ca.forEach(e=>{e.next()})}var Bu,Td;(Td=Bu||(Bu={})).xa="default",Td.Cache="cache";class Kw{constructor(e,r,n){this.query=e,this.Oa=r,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=n||{}}Ma(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Bs(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Na?this.La(e)&&(this.Oa.next(e),r=!0):this.ka(e,this.onlineState)&&(this.qa(e),r=!0),this.Ba=e,r}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let r=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),r=!0),r}ka(e,r){if(!e.fromCache||!this.va())return!0;const n=r!=="Offline";return(!this.options.Qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}La(e){if(e.docChanges.length>0)return!0;const r=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}qa(e){e=Bs.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==Bu.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(e){this.key=e}}class zg{constructor(e){this.key=e}}class qw{constructor(e,r){this.query=e,this.Ha=r,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Ye(),this.mutatedKeys=Ye(),this.Za=fg(e),this.Xa=new Rs(this.Za)}get eu(){return this.Ha}tu(e,r){const n=r?r.nu:new Ed,i=r?r.Xa:this.Xa;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,d)=>{const p=i.get(f),g=lc(this.query,d)?d:null,v=!!p&&this.mutatedKeys.has(p.key),_=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let E=!1;p&&g?p.data.isEqual(g.data)?v!==_&&(n.track({type:3,doc:g}),E=!0):this.ru(p,g)||(n.track({type:2,doc:g}),E=!0,(c&&this.Za(g,c)>0||u&&this.Za(g,u)<0)&&(o=!0)):!p&&g?(n.track({type:0,doc:g}),E=!0):p&&!g&&(n.track({type:1,doc:p}),E=!0,(c||u)&&(o=!0)),E&&(g?(a=a.add(g),s=_?s.add(f):s.delete(f)):(a=a.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{Xa:a,nu:n,Cs:o,mutatedKeys:s}}ru(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const a=e.nu.wa();a.sort((f,d)=>function(g,v){const _=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le(20277,{Vt:E})}};return _(g)-_(v)}(f.type,d.type)||this.Za(f.doc,d.doc)),this.iu(n),i=i!=null&&i;const o=r&&!i?this.su():[],c=this.Ya.size===0&&this.current&&!i?1:0,u=c!==this.Ja;return this.Ja=c,a.length!==0||u?{snapshot:new Bs(this.query,e.Xa,s,a,e.mutatedKeys,c===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),ou:o}:{ou:o}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new Ed,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(r=>this.Ha=this.Ha.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ha=this.Ha.delete(r)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=Ye(),this.Xa.forEach(n=>{this._u(n.key)&&(this.Ya=this.Ya.add(n.key))});const r=[];return e.forEach(n=>{this.Ya.has(n)||r.push(new zg(n))}),this.Ya.forEach(n=>{e.has(n)||r.push(new Gg(n))}),r}au(e){this.Ha=e.$s,this.Ya=Ye();const r=this.tu(e.documents);return this.applyChanges(r,!0)}uu(){return Bs.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const Vf="SyncEngine";class Xw{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class Yw{constructor(e){this.key=e,this.cu=!1}}class Qw{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.lu={},this.hu=new Ki(o=>ug(o),oc),this.Pu=new Map,this.Tu=new Set,this.Iu=new St(be.comparator),this.Eu=new Map,this.du=new Cf,this.Au={},this.Ru=new Map,this.Vu=Vs.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function Jw(t,e,r=!0){const n=Jg(t);let i;const s=n.hu.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.uu()):i=await Kg(n,e,r,!0),i}async function Zw(t,e){const r=Jg(t);await Kg(r,e,!0,!1)}async function Kg(t,e,r,n){const i=await mw(t.localStore,pn(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await eA(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&Bg(t.remoteStore,i),o}async function eA(t,e,r,n,i){t.fu=(d,p,g)=>async function(_,E,L,V){let N=E.view.tu(L);N.Cs&&(N=await pd(_.localStore,E.query,!1).then(({documents:w})=>E.view.tu(w,N)));const U=V&&V.targetChanges.get(E.targetId),re=V&&V.targetMismatches.get(E.targetId)!=null,le=E.view.applyChanges(N,_.isPrimaryClient,U,re);return Ad(_,E.targetId,le.ou),le.snapshot}(t,d,p,g);const s=await pd(t.localStore,e,!0),a=new qw(e,s.$s),o=a.tu(s.documents),c=no.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),u=a.applyChanges(o,t.isPrimaryClient,c);Ad(t,r,u.ou);const f=new Xw(e,r,a);return t.hu.set(e,f),t.Pu.has(r)?t.Pu.get(r).push(e):t.Pu.set(r,[e]),u.snapshot}async function tA(t,e,r){const n=$e(t),i=n.hu.get(e),s=n.Pu.get(i.targetId);if(s.length>1)return n.Pu.set(i.targetId,s.filter(a=>!oc(a,e))),void n.hu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Mu(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Df(n.remoteStore,i.targetId),Uu(n,i.targetId)}).catch(Gs)):(Uu(n,i.targetId),await Mu(n.localStore,i.targetId,!0))}async function rA(t,e){const r=$e(t),n=r.hu.get(e),i=r.Pu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Df(r.remoteStore,n.targetId))}async function nA(t,e,r){const n=uA(t);try{const i=await function(a,o){const c=$e(a),u=jt.now(),f=o.reduce((g,v)=>g.add(v.key),Ye());let d,p;return c.persistence.runTransaction("Locally write mutations","readwrite",g=>{let v=Vn(),_=Ye();return c.Bs.getEntries(g,f).next(E=>{v=E,v.forEach((L,V)=>{V.isValidDocument()||(_=_.add(L))})}).next(()=>c.localDocuments.getOverlayedDocuments(g,v)).next(E=>{d=E;const L=[];for(const V of o){const N=mT(V,d.get(V.key).overlayedDocument);N!=null&&L.push(new Ai(V.key,N,ng(N.value.mapValue),gn.exists(!0)))}return c.mutationQueue.addMutationBatch(g,u,L,o)}).next(E=>{p=E;const L=E.applyToLocalDocumentSet(d,_);return c.documentOverlayCache.saveOverlays(g,E.batchId,L)})}).then(()=>({batchId:p.batchId,changes:dg(d)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,c){let u=a.Au[a.currentUser.toKey()];u||(u=new St(Xe)),u=u.insert(o,c),a.Au[a.currentUser.toKey()]=u}(n,i.batchId,r),await so(n,i.changes),await pc(n.remoteStore)}catch(i){const s=Lf(i,"Failed to persist write");r.reject(s)}}async function qg(t,e){const r=$e(t);try{const n=await dw(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Eu.get(s);a&&(lt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.cu=!0:i.modifiedDocuments.size>0?lt(a.cu,14607):i.removedDocuments.size>0&&(lt(a.cu,42227),a.cu=!1))}),await so(r,n,e)}catch(n){await Gs(n)}}function wd(t,e,r){const n=$e(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.hu.forEach((s,a)=>{const o=a.view.Fa(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const c=$e(a);c.onlineState=o;let u=!1;c.queries.forEach((f,d)=>{for(const p of d.Sa)p.Fa(o)&&(u=!0)}),u&&Mf(c)}(n.eventManager,e),i.length&&n.lu.Y_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function iA(t,e,r){const n=$e(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Eu.get(e),s=i&&i.key;if(s){let a=new St(be.comparator);a=a.insert(s,mr.newNoDocument(s,Ue.min()));const o=Ye().add(s),c=new fc(Ue.min(),new Map,new St(Xe),a,o);await qg(n,c),n.Iu=n.Iu.remove(s),n.Eu.delete(e),Bf(n)}else await Mu(n.localStore,e,!1).then(()=>Uu(n,e,r)).catch(Gs)}async function sA(t,e){const r=$e(t),n=e.batch.batchId;try{const i=await hw(r.localStore,e);Yg(r,n,null),Xg(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await so(r,i)}catch(i){await Gs(i)}}async function aA(t,e,r){const n=$e(t);try{const i=await function(a,o){const c=$e(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return c.mutationQueue.lookupMutationBatch(u,o).next(d=>(lt(d!==null,37113),f=d.keys(),c.mutationQueue.removeMutationBatch(u,d))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,f,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>c.localDocuments.getDocuments(u,f))})}(n.localStore,e);Yg(n,e,r),Xg(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await so(n,i)}catch(i){await Gs(i)}}function Xg(t,e){(t.Ru.get(e)||[]).forEach(r=>{r.resolve()}),t.Ru.delete(e)}function Yg(t,e,r){const n=$e(t);let i=n.Au[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Au[n.currentUser.toKey()]=i}}function Uu(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Pu.get(e))t.hu.delete(n),r&&t.lu.gu(n,r);t.Pu.delete(e),t.isPrimaryClient&&t.du.Hr(e).forEach(n=>{t.du.containsKey(n)||Qg(t,n)})}function Qg(t,e){t.Tu.delete(e.path.canonicalString());const r=t.Iu.get(e);r!==null&&(Df(t.remoteStore,r),t.Iu=t.Iu.remove(e),t.Eu.delete(r),Bf(t))}function Ad(t,e,r){for(const n of r)n instanceof Gg?(t.du.addReference(n.key,e),oA(t,n)):n instanceof zg?(Ie(Vf,"Document no longer in limbo: "+n.key),t.du.removeReference(n.key,e),t.du.containsKey(n.key)||Qg(t,n.key)):Le(19791,{pu:n})}function oA(t,e){const r=e.key,n=r.path.canonicalString();t.Iu.get(r)||t.Tu.has(n)||(Ie(Vf,"New document in limbo: "+r),t.Tu.add(n),Bf(t))}function Bf(t){for(;t.Tu.size>0&&t.Iu.size<t.maxConcurrentLimboResolutions;){const e=t.Tu.values().next().value;t.Tu.delete(e);const r=new be(wt.fromString(e)),n=t.Vu.next();t.Eu.set(n,new Yw(r)),t.Iu=t.Iu.insert(r,n),Bg(t.remoteStore,new Zn(pn(Tf(r.path)),n,"TargetPurposeLimboResolution",nc.le))}}async function so(t,e,r){const n=$e(t),i=[],s=[],a=[];n.hu.isEmpty()||(n.hu.forEach((o,c)=>{a.push(n.fu(c,e,r).then(u=>{var f;if((u||r)&&n.isPrimaryClient){const d=u?!u.fromCache:(f=r==null?void 0:r.targetChanges.get(c.targetId))===null||f===void 0?void 0:f.current;n.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(u){i.push(u);const d=Pf.Rs(c.targetId,u);s.push(d)}}))}),await Promise.all(a),n.lu.Y_(i),await async function(c,u){const f=$e(c);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>ie.forEach(u,p=>ie.forEach(p.ds,g=>f.persistence.referenceDelegate.addReference(d,p.targetId,g)).next(()=>ie.forEach(p.As,g=>f.persistence.referenceDelegate.removeReference(d,p.targetId,g)))))}catch(d){if(!zs(d))throw d;Ie(Ff,"Failed to update sequence numbers: "+d)}for(const d of u){const p=d.targetId;if(!d.fromCache){const g=f.xs.get(p),v=g.snapshotVersion,_=g.withLastLimboFreeSnapshotVersion(v);f.xs=f.xs.insert(p,_)}}}(n.localStore,s))}async function lA(t,e){const r=$e(t);if(!r.currentUser.isEqual(e)){Ie(Vf,"User change. New user:",e.toKey());const n=await Ng(r.localStore,e);r.currentUser=e,function(s,a){s.Ru.forEach(o=>{o.forEach(c=>{c.reject(new De(ce.CANCELLED,a))})}),s.Ru.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await so(r,n.ks)}}function cA(t,e){const r=$e(t),n=r.Eu.get(e);if(n&&n.cu)return Ye().add(n.key);{let i=Ye();const s=r.Pu.get(e);if(!s)return i;for(const a of s){const o=r.hu.get(a);i=i.unionWith(o.view.eu)}return i}}function Jg(t){const e=$e(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=qg.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=cA.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=iA.bind(null,e),e.lu.Y_=Gw.bind(null,e.eventManager),e.lu.gu=zw.bind(null,e.eventManager),e}function uA(t){const e=$e(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=sA.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=aA.bind(null,e),e}class Al{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=hc(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,r){return null}Cu(e,r){return null}Du(e){return fw(this.persistence,new lw,e.initialUser,this.serializer)}Su(e){return new kg(Rf.fi,this.serializer)}bu(e){return new vw}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Al.provider={build:()=>new Al};class fA extends Al{constructor(e){super(),this.cacheSizeBytes=e}vu(e,r){lt(this.persistence.referenceDelegate instanceof Tl,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new KT(n,e.asyncQueue,r)}Su(e){const r=this.cacheSizeBytes!==void 0?Pr.withCacheSize(this.cacheSizeBytes):Pr.DEFAULT;return new kg(n=>Tl.fi(n,r),this.serializer)}}class Hu{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>wd(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=lA.bind(null,this.syncEngine),await Uw(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new $w}()}createDatastore(e){const r=hc(e.databaseInfo.databaseId),n=function(s){return new ww(s)}(e.databaseInfo);return function(s,a,o,c){return new Cw(s,a,o,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new Pw(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>wd(this.syncEngine,r,0),function(){return _d.C()?new _d:new xw}())}createSyncEngine(e,r){return function(i,s,a,o,c,u,f){const d=new Qw(i,s,a,o,c,u);return f&&(d.mu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=$e(i);Ie(Wi,"RemoteStore shutting down."),s.da.add(5),await io(s),s.Ra.shutdown(),s.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Hu.provider={build:()=>new Hu};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):Mn("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vi="FirestoreClient";class dA{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=pr.UNAUTHENTICATED,this.clientId=K1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{Ie(vi,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Ie(vi,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new oi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Lf(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function eu(t,e){t.asyncQueue.verifyOperationInProgress(),Ie(vi,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await Ng(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Sd(t,e){t.asyncQueue.verifyOperationInProgress();const r=await pA(t);Ie(vi,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>xd(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>xd(e.remoteStore,i)),t._onlineComponents=e}async function pA(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ie(vi,"Using user provided OfflineComponentProvider");try{await eu(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===ce.FAILED_PRECONDITION||i.code===ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;ks("Error using user provided cache. Falling back to memory cache: "+r),await eu(t,new Al)}}else Ie(vi,"Using default OfflineComponentProvider"),await eu(t,new fA(void 0));return t._offlineComponents}async function Zg(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ie(vi,"Using user provided OnlineComponentProvider"),await Sd(t,t._uninitializedComponentsProvider._online)):(Ie(vi,"Using default OnlineComponentProvider"),await Sd(t,new Hu))),t._onlineComponents}function gA(t){return Zg(t).then(e=>e.syncEngine)}async function mA(t){const e=await Zg(t),r=e.eventManager;return r.onListen=Jw.bind(null,e.syncEngine),r.onUnlisten=tA.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=Zw.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=rA.bind(null,e.syncEngine),r}function _A(t,e,r={}){const n=new oi;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,c,u){const f=new hA({next:p=>{f.xu(),a.enqueueAndForget(()=>jw(s,d));const g=p.docs.has(o);!g&&p.fromCache?u.reject(new De(ce.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&c&&c.source==="server"?u.reject(new De(ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),d=new Kw(Tf(o.path),f,{includeMetadataChanges:!0,Qa:!0});return Ww(s,d)}(await mA(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function em(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Id=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tm(t,e,r){if(!r)throw new De(ce.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function vA(t,e,r,n){if(e===!0&&n===!0)throw new De(ce.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function Cd(t){if(!be.isDocumentKey(t))throw new De(ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Rd(t){if(be.isDocumentKey(t))throw new De(ce.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Uf(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Le(12329,{type:typeof t})}function Us(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new De(ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Uf(t);throw new De(ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rm="firestore.googleapis.com",Pd=!0;class Fd{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new De(ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=rm,this.ssl=Pd}else this.host=e.host,this.ssl=(r=e.ssl)!==null&&r!==void 0?r:Pd;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=bg;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<GT)throw new De(ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}vA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=em((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new De(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new De(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new De(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class gc{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Fd({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new De(ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new De(ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Fd(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new yy;switch(n.type){case"firstParty":return new Sy(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new De(ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=Id.get(r);n&&(Ie("ComponentProvider","Removing Datastore"),Id.delete(r),n.terminate())}(this),Promise.resolve()}}function xA(t,e,r,n={}){var i;t=Us(t,gc);const s=pf(e),a=t._getSettings(),o=Object.assign(Object.assign({},a),{emulatorOptions:t._getEmulatorOptions()}),c=`${e}:${r}`;s&&(q2(`https://${c}`),J2("Firestore",!0)),a.host!==rm&&a.host!==c&&ks("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u=Object.assign(Object.assign({},a),{host:c,ssl:s,emulatorOptions:n});if(!fl(u,o)&&(t._setSettings(u),n.mockUserToken)){let f,d;if(typeof n.mockUserToken=="string")f=n.mockUserToken,d=pr.MOCK_USER;else{f=X2(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const p=n.mockUserToken.sub||n.mockUserToken.user_id;if(!p)throw new De(ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new pr(p)}t._authCredentials=new Ty(new G1(f,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hf{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Hf(this.firestore,e,this._query)}}class Wr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new li(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Wr(this.firestore,e,this._key)}}class li extends Hf{constructor(e,r,n){super(e,r,Tf(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Wr(this.firestore,null,new be(e))}withConverter(e){return new li(this.firestore,e,this._path)}}function EA(t,e,...r){if(t=hi(t),tm("collection","path",e),t instanceof gc){const n=wt.fromString(e,...r);return Rd(n),new li(t,null,n)}{if(!(t instanceof Wr||t instanceof li))throw new De(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(wt.fromString(e,...r));return Rd(n),new li(t.firestore,null,n)}}function $f(t,e,...r){if(t=hi(t),arguments.length===1&&(e=K1.newId()),tm("doc","path",e),t instanceof gc){const n=wt.fromString(e,...r);return Cd(n),new Wr(t,null,new be(n))}{if(!(t instanceof Wr||t instanceof li))throw new De(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(wt.fromString(e,...r));return Cd(n),new Wr(t.firestore,t instanceof li?t.converter:null,new be(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dd="AsyncQueue";class Od{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new Mg(this,"async_queue_retry"),this.rc=()=>{const n=Zc();n&&Ie(Dd,"Visibility state changed to "+n.visibilityState),this.x_.b_()},this.sc=e;const r=Zc();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const r=Zc();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const r=new oi;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!zs(e))throw e;Ie(Dd,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const r=this.sc.then(()=>(this.ec=!0,e().catch(n=>{throw this.Xu=n,this.ec=!1,Mn("INTERNAL UNHANDLED ERROR: ",bd(n)),n}).then(n=>(this.ec=!1,n))));return this.sc=r,r}enqueueAfterDelay(e,r,n){this.oc(),this.nc.indexOf(e)>-1&&(r=0);const i=Nf.createAndSchedule(this,e,r,n,s=>this.uc(s));return this.Zu.push(i),i}oc(){this.Xu&&Le(47125,{cc:bd(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const r of this.Zu)if(r.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Zu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const r=this.Zu.indexOf(e);this.Zu.splice(r,1)}}function bd(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class mc extends gc{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new Od,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Od(e),this._firestoreClient=void 0,await e}}}function yA(t,e){const r=typeof t=="object"?t:ly(),n=typeof t=="string"?t:gl,i=ny(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=z2("firestore");s&&xA(i,...s)}return i}function nm(t){if(t._terminated)throw new De(ce.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||TA(t),t._firestoreClient}function TA(t){var e,r,n;const i=t._freezeSettings(),s=function(o,c,u,f){return new Uy(o,c,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,em(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new dA(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(o){const c=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Hs(cr.fromBase64String(e))}catch(r){throw new De(ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Hs(cr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new De(ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new sr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new De(ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new De(ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Xe(this._lat,e._lat)||Xe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gf{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wA=/^__.*__$/;class AA{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Ai(e,this.data,this.fieldMask,r,this.fieldTransforms):new ro(e,this.data,r,this.fieldTransforms)}}class im{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Ai(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function sm(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le(40011,{Ic:t})}}class zf{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.Ec(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new zf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.dc({path:n,Rc:!1});return i.Vc(e),i}mc(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.dc({path:n,Rc:!1});return i.Ec(),i}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return Sl(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(sm(this.Ic)&&wA.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class SA{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||hc(e)}bc(e,r,n,i=!1){return new zf({Ic:e,methodName:r,wc:n,path:sr.emptyPath(),Rc:!1,yc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function am(t){const e=t._freezeSettings(),r=hc(t._databaseId);return new SA(t._databaseId,!!e.ignoreUndefinedProperties,r)}function IA(t,e,r,n,i,s={}){const a=t.bc(s.merge||s.mergeFields?2:0,e,r,i);Kf("Data must be an object, but it was:",a,n);const o=om(n,a);let c,u;if(s.merge)c=new $r(a.fieldMask),u=a.fieldTransforms;else if(s.mergeFields){const f=[];for(const d of s.mergeFields){const p=$u(e,d,r);if(!a.contains(p))throw new De(ce.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);cm(f,p)||f.push(p)}c=new $r(f),u=a.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,u=a.fieldTransforms;return new AA(new Fr(o),c,u)}class vc extends Wf{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof vc}}function CA(t,e,r,n){const i=t.bc(1,e,r);Kf("Data must be an object, but it was:",i,n);const s=[],a=Fr.empty();wi(n,(c,u)=>{const f=qf(e,c,r);u=hi(u);const d=i.mc(f);if(u instanceof vc)s.push(f);else{const p=xc(u,d);p!=null&&(s.push(f),a.set(f,p))}});const o=new $r(s);return new im(a,o,i.fieldTransforms)}function RA(t,e,r,n,i,s){const a=t.bc(1,e,r),o=[$u(e,n,r)],c=[i];if(s.length%2!=0)throw new De(ce.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)o.push($u(e,s[p])),c.push(s[p+1]);const u=[],f=Fr.empty();for(let p=o.length-1;p>=0;--p)if(!cm(u,o[p])){const g=o[p];let v=c[p];v=hi(v);const _=a.mc(g);if(v instanceof vc)u.push(g);else{const E=xc(v,_);E!=null&&(u.push(g),f.set(g,E))}}const d=new $r(u);return new im(f,d,a.fieldTransforms)}function xc(t,e){if(lm(t=hi(t)))return Kf("Unsupported field value:",e,t),om(t,e);if(t instanceof Wf)return function(n,i){if(!sm(i.Ic))throw i.gc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.gc(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let c=xc(o,i.fc(a));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=hi(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return uT(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=jt.fromDate(n);return{timestampValue:yl(i.serializer,s)}}if(n instanceof jt){const s=new jt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:yl(i.serializer,s)}}if(n instanceof jf)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Hs)return{bytesValue:Ig(i.serializer,n._byteString)};if(n instanceof Wr){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.gc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:If(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Gf)return function(a,o){return{mapValue:{fields:{[tg]:{stringValue:rg},[ml]:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw o.gc("VectorValues must only contain numeric values.");return wf(o.serializer,u)})}}}}}}(n,i);throw i.gc(`Unsupported field value: ${Uf(n)}`)}(t,e)}function om(t,e){const r={};return X1(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wi(t,(n,i)=>{const s=xc(i,e.Ac(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function lm(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof jt||t instanceof jf||t instanceof Hs||t instanceof Wr||t instanceof Wf||t instanceof Gf)}function Kf(t,e,r){if(!lm(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=Uf(r);throw n==="an object"?e.gc(t+" a custom object"):e.gc(t+" "+n)}}function $u(t,e,r){if((e=hi(e))instanceof _c)return e._internalPath;if(typeof e=="string")return qf(t,e);throw Sl("Field path arguments must be of type string or ",t,!1,void 0,r)}const PA=new RegExp("[~\\*/\\[\\]]");function qf(t,e,r){if(e.search(PA)>=0)throw Sl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new _c(...e.split("."))._internalPath}catch{throw Sl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Sl(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(s||a)&&(c+=" (found",s&&(c+=` in field ${n}`),a&&(c+=` in document ${i}`),c+=")"),new De(ce.INVALID_ARGUMENT,o+t+c)}function cm(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Wr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new FA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(fm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class FA extends um{data(){return super.data()}}function fm(t,e){return typeof e=="string"?qf(t,e):e instanceof _c?e._internalPath:e._delegate._internalPath}class DA{convertValue(e,r="none"){switch(mi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Pt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(gi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Le(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return wi(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,i;const s=(i=(n=(r=e.fields)===null||r===void 0?void 0:r[ml].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>Pt(a.doubleValue));return new Gf(s)}convertGeoPoint(e){return new jf(Pt(e.latitude),Pt(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=sc(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Ha(e));default:return null}}convertTimestamp(e){const r=pi(e);return new jt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=wt.fromString(e);lt(Og(n),9688,{name:e});const i=new $a(n.get(1),n.get(3)),s=new be(n.popFirst(5));return i.isEqual(r)||Mn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OA(t,e,r){let n;return n=t?t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bA{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class hm extends um{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new kA(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(fm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class kA extends hm{data(e={}){return super.data(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NA(t){t=Us(t,Wr);const e=Us(t.firestore,mc);return _A(nm(e),t._key).then(r=>BA(e,t,r))}class LA extends DA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Hs(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Wr(this.firestore,null,r)}}function MA(t,e,r,...n){t=Us(t,Wr);const i=Us(t.firestore,mc),s=am(i);let a;return a=typeof(e=hi(e))=="string"||e instanceof _c?RA(s,"updateDoc",t._key,e,r,n):CA(s,"updateDoc",t._key,e),dm(i,[a.toMutation(t._key,gn.exists(!0))])}function VA(t,e){const r=Us(t.firestore,mc),n=$f(t),i=OA(t.converter,e);return dm(r,[IA(am(t.firestore),"addDoc",n._key,i,t.converter!==null,{}).toMutation(n._key,gn.exists(!1))]).then(()=>n)}function dm(t,e){return function(n,i){const s=new oi;return n.asyncQueue.enqueueAndForget(async()=>nA(await gA(n),i,s)),s.promise}(nm(t),e)}function BA(t,e,r){const n=r.docs.get(e._key),i=new LA(t);return new hm(t,i,e._key,n,new bA(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){js=i})(oy),dl(new Va("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new mc(new wy(n.getProvider("auth-internal")),new Iy(a,n.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new De(ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $a(u.options.projectId,f)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),Cs(V0,B0,e),Cs(V0,B0,"esm2017")})();const UA={apiKey:"AIzaSyBvshs7Bqem_j8pk3K_GZv9rhpt5VUR6qw",authDomain:"team-scheduler-5a7e1.firebaseapp.com",projectId:"team-scheduler-5a7e1",storageBucket:"team-scheduler-5a7e1.firebasestorage.app",messagingSenderId:"236438484699",appId:"1:236438484699:web:739868071555e7da563efe"},HA=N1(UA),Xf=yA(HA),Il=zt([]),Cl=zt([]),_s=zt(1),Rl=zt({}),Ec=zt({}),pm=zt(!1),Zo=zt([]),Wu=zt(""),gm=zt(""),vs=["Måndag","Tisdag","Onsdag","Torsdag","Fredag","Lördag","Söndag"],Yf=zt("Måndag"),Qf=zt(7),mm=zt([]);function $A(t){t.trim()&&Il.value.push(t.trim())}function WA(t){t.trim()&&Cl.value.push(t.trim())}function _m(t,e){const r=vs.indexOf(t);if(r===-1||e<1)return[];const n=[];for(let i=0;i<e;i++){const s=vs[(r+i)%vs.length],a=Math.floor((r+i)/vs.length)+1;n.push(`V${a}-${s}`)}return n}function Jf(t){return t.includes("-")?t.split("-")[1]:t}function jA(){return mm.value=_m(Yf.value,Qf.value),[...new Set(vs.map(Jf))]}function GA(t){const e=t.match(/^V(\d+)-/);return e?Number(e[1]):1}const zA=S1(()=>{const t={};return Object.keys(Ec.value).forEach(e=>{const r=GA(e);t[r]=t[r]||[],t[r].push(e)}),t});function KA(){if(!_s.value||Il.value.length===0){_s.value||(Wu.value="Du måste välja antal lag");return}Wu.value="";const t=[...Il.value].sort(()=>Math.random()-.5),e={};for(let r=0;r<_s.value;r++)e[`Lag ${r+1}`]=[];t.forEach((r,n)=>{const i=n%_s.value;e[`Lag ${i+1}`].push(r)}),Rl.value=e,pm.value=!0,Ec.value={}}async function qA(){if(!_s.value||Cl.value.length===0)return;const t=Object.keys(Rl.value),e=_m(Yf.value,Qf.value),r=[];console.log(Zo.value);for(const a of e){Jf(a);for(const o of Cl.value){const c=Zo.value.some(f=>f.day===a&&!f.activity),u=Zo.value.some(f=>f.day===a&&f.activity===o);!c&&!u&&r.push({day:a,activity:o})}}const n={};t.forEach(a=>n[a]=[]),r.forEach((a,o)=>{const c=t[o%t.length];n[c].push(a)});const i=[];for(const a of e){const o={};for(const c of t)for(const u of n[c])u.day===a&&(o[u.activity]=c);i.push({day:a,tasks:o})}Ec.value=Object.fromEntries(i.map(a=>[a.day,a.tasks]));const s=await VA(EA(Xf,"schedules"),{schedule:i,teams:Rl.value});gm.value=`${location.origin}${location.pathname}?schedule=${s.id}`}function Wn(){return{people:Il,activities:Cl,numberOfTeams:_s,teams:Rl,schedule:Ec,hasGeneratedTeams:pm,blockedAssignments:Zo,teamError:Wu,shareUrl:gm,allDays:vs,scheduleDayCount:Qf,scheduleStartDay:Yf,scheduleDays:mm,addPerson:$A,addActivity:WA,generateTeams:KA,generateSchedule:qA,getAllDisplayDays:jA,getDisplayDay:Jf,groupedSchedule:zA}}const XA={class:"space-y-4"},YA={class:"flex gap-2"},QA={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},JA={class:"truncate"},ZA=["onClick"],eS=Hn({__name:"PeopleInput",setup(t){const{people:e,addPerson:r}=Wn(),n=zt("");function i(){n.value.trim()&&(r(n.value),n.value="")}function s(a){e.value.splice(a,1)}return(a,o)=>(Ke(),qe("div",XA,[o[1]||(o[1]=we("h2",{class:"text-lg font-semibold text-gray-800 dark:text-white mb-2"},"Personer",-1)),we("div",YA,[Hi(we("input",{"onUpdate:modelValue":o[0]||(o[0]=c=>n.value=c),onKeyup:C1(i,["enter"]),placeholder:"Ange namn",class:"flex-1 px-3 py-2 rounded-lg bg-gray-300 dark:bg-gray-800 placeholder-gray-400 text-gray-600 dark:text-gray-300 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544),[[rc,n.value]]),we("button",{onClick:i,class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg shadow-md transition duration-200"}," Lägg till ")]),we("div",QA,[(Ke(!0),qe(Ft,null,nn(ot(e),(c,u)=>(Ke(),qe("div",{key:u,class:"bg-gray-300 dark:bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-sm text-gray-600 dark:text-gray-300 shadow-sm flex justify-between items-center"},[we("span",JA,Ht(c),1),we("button",{onClick:f=>s(u),class:"text-red-400 hover:text-red-200 font-bold ml-4"},"×",8,ZA)]))),128))])]))}}),tS={class:"space-y-4"},rS={class:"flex gap-2"},nS={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},iS={class:"truncate"},sS=["onClick"],aS=Hn({__name:"ActivityInput",setup(t){const{activities:e,addActivity:r}=Wn(),n=zt("");function i(){n.value.trim()&&(r(n.value),n.value="")}function s(a){e.value.splice(a,1)}return(a,o)=>(Ke(),qe("div",tS,[o[1]||(o[1]=we("h2",{class:"text-lg font-semibold text-gray-800 dark:text-white mb-2"},"Aktiviteter",-1)),we("div",rS,[Hi(we("input",{"onUpdate:modelValue":o[0]||(o[0]=c=>n.value=c),onKeyup:C1(i,["enter"]),placeholder:"Ange aktivitet (Lunch, middag, diska osv.)",class:"flex-1 px-3 py-2 rounded-lg bg-gray-300 dark:bg-gray-800 text-gray-600 dark:text-gray-300 placeholder-gray-400 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-purple-500"},null,544),[[rc,n.value]]),we("button",{onClick:i,class:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg shadow-md transition duration-200"}," Lägg till ")]),we("div",nS,[(Ke(!0),qe(Ft,null,nn(ot(e),(c,u)=>(Ke(),qe("div",{key:u,class:"bg-gray-300 dark:bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-sm text-gray-600 dark:text-gray-300 shadow-sm flex justify-between items-center"},[we("span",iS,Ht(c),1),we("button",{onClick:f=>s(u),class:"text-red-400 hover:text-red-200 font-bold ml-4"},"×",8,sS)]))),128))])]))}}),oS={class:"space-y-2"},lS={key:0,class:"text-red-500 text-sm mt-1"},cS=Hn({__name:"TeamSelector",setup(t){const{numberOfTeams:e,teamError:r}=Wn();return(n,i)=>(Ke(),qe("div",oS,[i[1]||(i[1]=we("label",{for:"teams",class:"block text-sm font-medium text-gray-600 dark:text-gray-300"},"Antal lag:",-1)),Hi(we("input",{id:"teams",type:"number","onUpdate:modelValue":i[0]||(i[0]=s=>Wt(e)?e.value=s:null),min:"1",required:"",class:"w-full px-3 py-2 rounded-lg bg-gray-300 dark:bg-gray-800 text-gray-600 dark:text-gray-300 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-cyan-500"},null,512),[[rc,ot(e),void 0,{number:!0}]]),ot(r)?(Ke(),qe("p",lS,Ht(ot(r)),1)):ni("",!0)]))}}),uS={class:"flex flex-col items-center gap-6"},fS={key:0,class:"w-full max-w-lg"},hS={class:"space-y-2"},dS={class:"block text-blue-800 dark:text-blue-300"},pS=["onClick"],gS={class:"text-sm text-gray-600 dark:text-gray-300"},mS=Hn({__name:"GenerateButton",setup(t){const{hasGeneratedTeams:e,generateTeams:r,generateSchedule:n,teams:i}=Wn();function s(a){const o=prompt("Ange nytt namn för "+a,a);if(!o||o===a)return;const c={};for(const[u,f]of Object.entries(i.value))c[u===a?o:u]=f;i.value=c}return(a,o)=>(Ke(),qe("div",uS,[we("button",{onClick:o[0]||(o[0]=(...c)=>ot(r)&&ot(r)(...c)),class:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg shadow-md transition duration-200"}," Generera lag "),ot(e)?(Ke(),qe("div",fS,[o[2]||(o[2]=we("h2",{class:"text-xl font-semibold text-center mb-4 text-gray-600 dark:text-gray-300"},"Lag",-1)),we("ul",hS,[(Ke(!0),qe(Ft,null,nn(ot(i),(c,u)=>(Ke(),qe("li",{key:u,class:"bg-gray-300 dark:bg-gray-800 p-3 rounded-lg border border-gray-700 relative"},[we("strong",dS,Ht(u),1),we("button",{onClick:f=>s(u),class:"absolute top-2 right-2 text-blue-600 hover:text-blue-400 text-sm underline"},"Byt namn",8,pS),we("span",gS,Ht(c.join(", ")),1)]))),128))]),we("button",{onClick:o[1]||(o[1]=(...c)=>ot(n)&&ot(n)(...c)),class:"mt-6 w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-6 rounded-lg shadow-md transition duration-200"}," Generera schema ")])):ni("",!0)]))}});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Pl={};Pl.version="0.18.5";var vm=1252,_S=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],xm=function(t){_S.indexOf(t)!=-1&&(vm=t)};function vS(){xm(1252)}var za=function(t){xm(t)};function xS(){za(1200),vS()}var Lo=function(e){return String.fromCharCode(e)},kd=function(e){return String.fromCharCode(e)},Fl,ei="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ka(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,c=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),a=(r&3)<<4|n>>4,i=t.charCodeAt(u++),o=(n&15)<<2|i>>6,c=i&63,isNaN(n)?o=c=64:isNaN(i)&&(c=64),e+=ei.charAt(s)+ei.charAt(a)+ei.charAt(o)+ei.charAt(c);return e}function Bn(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=ei.indexOf(t.charAt(u++)),a=ei.indexOf(t.charAt(u++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=ei.indexOf(t.charAt(u++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),c=ei.indexOf(t.charAt(u++)),i=(o&3)<<6|c,c!==64&&(e+=String.fromCharCode(i));return e}var nt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),jn=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function ji(t){return nt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Nd(t){return nt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var en=function(e){return nt?jn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function yc(t){if(typeof ArrayBuffer>"u")return en(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function ao(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function ES(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var ar=nt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:jn(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function yS(t){for(var e=[],r=0,n=t.length+250,i=ji(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=ji(65535),n=65530)}return e.push(i.slice(0,r)),ar(e)}var Ca=/\u0000/g,Mo=/[\u0001-\u0006]/g;function Ps(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function tn(t,e){var r=""+t;return r.length>=e?r:Ct("0",e-r.length)+r}function Zf(t,e){var r=""+t;return r.length>=e?r:Ct(" ",e-r.length)+r}function Dl(t,e){var r=""+t;return r.length>=e?r:r+Ct(" ",e-r.length)}function TS(t,e){var r=""+Math.round(t);return r.length>=e?r:Ct("0",e-r.length)+r}function wS(t,e){var r=""+t;return r.length>=e?r:Ct("0",e-r.length)+r}var Ld=Math.pow(2,32);function ls(t,e){if(t>Ld||t<-Ld)return TS(t,e);var r=Math.round(t);return wS(r,e)}function Ol(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Md=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],tu=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function AS(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t}var Rt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Vd={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SS={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function bl(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,c=1,u=0,f=0,d=Math.floor(i);u<e&&(d=Math.floor(i),o=d*a+s,f=d*u+c,!(i-d<5e-8));)i=1/(i-d),s=a,a=o,c=u,u=f;if(f>e&&(u>e?(f=c,o=s):(f=u,o=a)),!r)return[0,n*o,f];var p=Math.floor(n*o/f);return[p,n*o-p*f,f]}function Vo(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=OS(c,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var Em=new Date(1899,11,31,0,0,0),IS=Em.getTime(),CS=new Date(1900,2,1,0,0,0);function ym(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=CS&&(r+=24*60*60*1e3),(r-(IS+(t.getTimezoneOffset()-Em.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function eh(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function RS(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function PS(t){var e=t<0?12:11,r=eh(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function FS(t){var e=eh(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function DS(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=PS(t):e===10?r=t.toFixed(10).substr(0,12):r=FS(t),eh(RS(r.toUpperCase()))}function ju(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):DS(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return xi(14,ym(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function OS(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function bS(t,e,r,n){var i="",s=0,a=0,o=r.y,c,u=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,u=e.length;break;case 3:return tu[r.m-1][1];case 5:return tu[r.m-1][0];default:return tu[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,u=e.length;break;case 3:return Md[r.q][0];default:return Md[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?tn(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=tn(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:c=o,u=1;break}var f=u>0?tn(c,u):"";return f}function ti(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var Tm=/%/g;function kS(t,e,r){var n=e.replace(Tm,""),i=e.length-n.length;return Dn(t,n,r*Math.pow(10,2*i))+Ct("%",i)}function NS(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Dn(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function wm(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+wm(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,f){return c+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Am=/# (\?+)( ?)\/( ?)(\d+)/;function LS(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Ct(" ",t[1].length+1+t[4].length):Zf(a,t[1].length)+t[2]+"/"+t[3]+tn(o,t[4].length))}function MS(t,e,r){return r+(e===0?"":""+e)+Ct(" ",t[1].length+2+t[4].length)}var Sm=/^#*0*\.([0#]+)/,Im=/\).*[0#]/,Cm=/\(###\) ###\\?-####/;function Tr(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Bd(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Ud(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function VS(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function BS(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Gr(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Im)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Gr("n",n,r):"("+Gr("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return NS(t,e,r);if(e.indexOf("%")!==-1)return kS(t,e,r);if(e.indexOf("E")!==-1)return wm(e,r);if(e.charCodeAt(0)===36)return"$"+Gr(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,c=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+ls(c,e.length);if(e.match(/^[#?]+$/))return i=ls(r,0),i==="0"&&(i=""),i.length>e.length?i:Tr(e.substr(0,e.length-i.length))+i;if(s=e.match(Am))return LS(s,c,u);if(e.match(/^#+0+$/))return u+ls(c,e.length-e.indexOf("0"));if(s=e.match(Sm))return i=Bd(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Tr(s[1])).replace(/\.$/,"."+Tr(s[1])).replace(/\.(\d*)$/,function(v,_){return"."+_+Ct("0",Tr(s[1]).length-_.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+Bd(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+ti(ls(c,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Gr(t,e,-r):ti(""+(Math.floor(r)+VS(r,s[1].length)))+"."+tn(Ud(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Gr(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ps(Gr(t,e.replace(/[\\-]/g,""),r)),a=0,Ps(Ps(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(Cm))return i=Gr(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=bl(c,Math.pow(10,a)-1,!1),i=""+u,f=Dn("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Dl(o[2],a),f.length<s[4].length&&(f=Tr(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=bl(c,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Zf(o[1],a)+s[2]+"/"+s[3]+Dl(o[2],a):Ct(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=ls(r,0),e.length<=i.length?i:Tr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var d=e.indexOf(".")-a,p=e.length-i.length-d;return Tr(e.substr(0,d)+i+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=Ud(r,s[1].length),r<0?"-"+Gr(t,e,-r):ti(BS(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?tn(0,3-v.length):"")+v})+"."+tn(a,s[1].length);switch(e){case"###,##0.00":return Gr(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=ti(ls(c,0));return g!=="0"?u+g:"";case"###,###.00":return Gr(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Gr(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function US(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Dn(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function HS(t,e,r){var n=e.replace(Tm,""),i=e.length-n.length;return Dn(t,n,r*Math.pow(10,2*i))+Ct("%",i)}function Rm(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Rm(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,f){return c+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ln(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Im)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ln("n",n,r):"("+ln("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return US(t,e,r);if(e.indexOf("%")!==-1)return HS(t,e,r);if(e.indexOf("E")!==-1)return Rm(e,r);if(e.charCodeAt(0)===36)return"$"+ln(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,c=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+tn(c,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Tr(e.substr(0,e.length-i.length))+i;if(s=e.match(Am))return MS(s,c,u);if(e.match(/^#+0+$/))return u+tn(c,e.length-e.indexOf("0"));if(s=e.match(Sm))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Tr(s[1])).replace(/\.$/,"."+Tr(s[1])),i=i.replace(/\.(\d*)$/,function(v,_){return"."+_+Ct("0",Tr(s[1]).length-_.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+ti(""+c);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ln(t,e,-r):ti(""+r)+"."+Ct("0",s[1].length);if(s=e.match(/^#,#*,#0/))return ln(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ps(ln(t,e.replace(/[\\-]/g,""),r)),a=0,Ps(Ps(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(Cm))return i=ln(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=bl(c,Math.pow(10,a)-1,!1),i=""+u,f=Dn("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Dl(o[2],a),f.length<s[4].length&&(f=Tr(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=bl(c,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Zf(o[1],a)+s[2]+"/"+s[3]+Dl(o[2],a):Ct(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Tr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var d=e.indexOf(".")-a,p=e.length-i.length-d;return Tr(e.substr(0,d)+i+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ln(t,e,-r):ti(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?tn(0,3-v.length):"")+v})+"."+tn(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=ti(""+c);return g!=="0"?u+g:"";default:if(e.match(/\.[0#?]*$/))return ln(t,e.slice(0,e.lastIndexOf(".")),r)+Tr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Dn(t,e,r){return(r|0)===r?ln(t,e,r):Gr(t,e,r)}function $S(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var Pm=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Fm(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Ol(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(Pm))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function WS(t,e,r,n){for(var i=[],s="",a=0,o="",c="t",u,f,d,p="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Ol(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(d=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(d);i[i.length]={t:"t",v:s},++a;break;case"\\":var g=t.charAt(++a),v=g==="("||g===")"?g:"t";i[i.length]={t:v,v:g},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(u==null&&(u=Vo(e,r,t.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},c=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=Vo(e,r),u==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),i[i.length]={t:o,v:s},c=o;break;case"A":case"a":case"上":var _={t:o,v:o};if(u==null&&(u=Vo(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(_.v=u.H>=12?"P":"A"),_.t="T",p="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(_.v=u.H>=12?"PM":"AM"),_.t="T",a+=5,p="h"):t.substr(a,5).toUpperCase()==="上午/下午"?(u!=null&&(_.v=u.H>=12?"下午":"上午"),_.t="T",a+=5,p="h"):(_.t="t",++a),u==null&&_.t==="T")return"";i[i.length]=_,c=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Pm)){if(u==null&&(u=Vo(e,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Fm(t)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},c=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var E=0,L=0,V;for(a=i.length-1,c="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=p,c="h",E<1&&(E=1);break;case"s":(V=i[a].v.match(/\.0+$/))&&(L=Math.max(L,V[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":c=i[a].t;break;case"m":c==="s"&&(i[a].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[a].v.match(/[Hh]/)&&(E=1),E<2&&i[a].v.match(/[Mm]/)&&(E=2),E<3&&i[a].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var N="",U;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=bS(i[a].t.charCodeAt(0),i[a].v,u,L),i[a].t="t";break;case"n":case"?":for(U=a+1;i[U]!=null&&((o=i[U].t)==="?"||o==="D"||(o===" "||o==="t")&&i[U+1]!=null&&(i[U+1].t==="?"||i[U+1].t==="t"&&i[U+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[U].v==="/"||i[U].v===" "&&i[U+1]!=null&&i[U+1].t=="?"));)i[a].v+=i[U].v,i[U]={v:"",t:";"},++U;N+=i[a].v,a=U-1;break;case"G":i[a].t="t",i[a].v=ju(e,r);break}var re="",le,w;if(N.length>0){N.charCodeAt(0)==40?(le=e<0&&N.charCodeAt(0)===45?-e:e,w=Dn("n",N,le)):(le=e<0&&n>1?-e:e,w=Dn("n",N,le),le<0&&i[0]&&i[0].t=="t"&&(w=w.substr(1),i[0].v="-"+i[0].v)),U=w.length-1;var T=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){T=a;break}var y=i.length;if(T===i.length&&w.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(U>=i[a].v.length-1?(U-=i[a].v.length,i[a].v=w.substr(U+1,i[a].v.length)):U<0?i[a].v="":(i[a].v=w.substr(0,U+1),U=-1),i[a].t="t",y=a);U>=0&&y<i.length&&(i[y].v=w.substr(0,U+1)+i[y].v)}else if(T!==i.length&&w.indexOf("E")===-1){for(U=w.indexOf(".")-1,a=T;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(f=i[a].v.indexOf(".")>-1&&a===T?i[a].v.indexOf(".")-1:i[a].v.length-1,re=i[a].v.substr(f+1);f>=0;--f)U>=0&&(i[a].v.charAt(f)==="0"||i[a].v.charAt(f)==="#")&&(re=w.charAt(U--)+re);i[a].v=re,i[a].t="t",y=a}for(U>=0&&y<i.length&&(i[y].v=w.substr(0,U+1)+i[y].v),U=w.indexOf(".")+1,a=T;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==T)){for(f=i[a].v.indexOf(".")>-1&&a===T?i[a].v.indexOf(".")+1:0,re=i[a].v.substr(0,f);f<i[a].v.length;++f)U<w.length&&(re+=w.charAt(U++));i[a].v=re,i[a].t="t",y=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(le=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Dn(i[a].t,i[a].v,le),i[a].t="t");var I="";for(a=0;a!==i.length;++a)i[a]!=null&&(I+=i[a].v);return I}var Hd=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function $d(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function jS(t,e){var r=$S(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Hd),o=r[1].match(Hd);return $d(e,a)?[n,r[0]]:$d(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function xi(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Rt)[t],n==null&&(n=r.table&&r.table[Vd[t]]||Rt[Vd[t]]),n==null&&(n=SS[t]||"General");break}if(Ol(n,0))return ju(e,r);e instanceof Date&&(e=ym(e,r.date1904));var i=jS(n,e);if(Ol(i[1]))return ju(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return WS(i[1],e,r,i[0])}function Dm(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Rt[r]==null){e<0&&(e=r);continue}if(Rt[r]==t){e=r;break}}e<0&&(e=391)}return Rt[e]=t,e}function Tc(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Dm(t[e],e)}function wc(){Rt=AS()}var Om=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function GS(t){var e=typeof t=="number"?Rt[t]:t;return e=e.replace(Om,"(\\d+)"),new RegExp("^"+e+"$")}function zS(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,c=-1;(e.match(Om)||[]).forEach(function(d,p){var g=parseInt(r[p+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=g;break;case"d":s=g;break;case"h":a=g;break;case"s":c=g;break;case"m":a>=0?o=g:i=g;break}}),c>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&o==-1&&c==-1?u:n==-1&&i==-1&&s==-1?f:u+"T"+f}var KS=function(){var t={};t.version="1.2.0";function e(){for(var w=0,T=new Array(256),y=0;y!=256;++y)w=y,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,T[y]=w;return typeof Int32Array<"u"?new Int32Array(T):T}var r=e();function n(w){var T=0,y=0,I=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)P[I]=w[I];for(I=0;I!=256;++I)for(y=w[I],T=256+I;T<4096;T+=256)y=P[T]=y>>>8^w[y&255];var k=[];for(I=1;I!=16;++I)k[I-1]=typeof Int32Array<"u"?P.subarray(I*256,I*256+256):P.slice(I*256,I*256+256);return k}var i=n(r),s=i[0],a=i[1],o=i[2],c=i[3],u=i[4],f=i[5],d=i[6],p=i[7],g=i[8],v=i[9],_=i[10],E=i[11],L=i[12],V=i[13],N=i[14];function U(w,T){for(var y=T^-1,I=0,P=w.length;I<P;)y=y>>>8^r[(y^w.charCodeAt(I++))&255];return~y}function re(w,T){for(var y=T^-1,I=w.length-15,P=0;P<I;)y=N[w[P++]^y&255]^V[w[P++]^y>>8&255]^L[w[P++]^y>>16&255]^E[w[P++]^y>>>24]^_[w[P++]]^v[w[P++]]^g[w[P++]]^p[w[P++]]^d[w[P++]]^f[w[P++]]^u[w[P++]]^c[w[P++]]^o[w[P++]]^a[w[P++]]^s[w[P++]]^r[w[P++]];for(I+=15;P<I;)y=y>>>8^r[(y^w[P++])&255];return~y}function le(w,T){for(var y=T^-1,I=0,P=w.length,k=0,R=0;I<P;)k=w.charCodeAt(I++),k<128?y=y>>>8^r[(y^k)&255]:k<2048?(y=y>>>8^r[(y^(192|k>>6&31))&255],y=y>>>8^r[(y^(128|k&63))&255]):k>=55296&&k<57344?(k=(k&1023)+64,R=w.charCodeAt(I++)&1023,y=y>>>8^r[(y^(240|k>>8&7))&255],y=y>>>8^r[(y^(128|k>>2&63))&255],y=y>>>8^r[(y^(128|R>>6&15|(k&3)<<4))&255],y=y>>>8^r[(y^(128|R&63))&255]):(y=y>>>8^r[(y^(224|k>>12&15))&255],y=y>>>8^r[(y^(128|k>>6&63))&255],y=y>>>8^r[(y^(128|k&63))&255]);return~y}return t.table=r,t.bstr=U,t.buf=re,t.str=le,t}(),pt=function(){var e={};e.version="1.2.1";function r(x,F){for(var S=x.split("/"),C=F.split("/"),D=0,O=0,q=Math.min(S.length,C.length);D<q;++D){if(O=S[D].length-C[D].length)return O;if(S[D]!=C[D])return S[D]<C[D]?-1:1}return S.length-C.length}function n(x){if(x.charAt(x.length-1)=="/")return x.slice(0,-1).indexOf("/")===-1?x:n(x.slice(0,-1));var F=x.lastIndexOf("/");return F===-1?x:x.slice(0,F+1)}function i(x){if(x.charAt(x.length-1)=="/")return i(x.slice(0,-1));var F=x.lastIndexOf("/");return F===-1?x:x.slice(F+1)}function s(x,F){typeof F=="string"&&(F=new Date(F));var S=F.getHours();S=S<<6|F.getMinutes(),S=S<<5|F.getSeconds()>>>1,x.write_shift(2,S);var C=F.getFullYear()-1980;C=C<<4|F.getMonth()+1,C=C<<5|F.getDate(),x.write_shift(2,C)}function a(x){var F=x.read_shift(2)&65535,S=x.read_shift(2)&65535,C=new Date,D=S&31;S>>>=5;var O=S&15;S>>>=4,C.setMilliseconds(0),C.setFullYear(S+1980),C.setMonth(O-1),C.setDate(D);var q=F&31;F>>>=5;var Z=F&63;return F>>>=6,C.setHours(F),C.setMinutes(Z),C.setSeconds(q<<1),C}function o(x){Vr(x,0);for(var F={},S=0;x.l<=x.length-4;){var C=x.read_shift(2),D=x.read_shift(2),O=x.l+D,q={};switch(C){case 21589:S=x.read_shift(1),S&1&&(q.mtime=x.read_shift(4)),D>5&&(S&2&&(q.atime=x.read_shift(4)),S&4&&(q.ctime=x.read_shift(4))),q.mtime&&(q.mt=new Date(q.mtime*1e3));break}x.l=O,F[C]=q}return F}var c;function u(){return c||(c={})}function f(x,F){if(x[0]==80&&x[1]==75)return Zs(x,F);if((x[0]|32)==109&&(x[1]|32)==105)return go(x,F);if(x.length<512)throw new Error("CFB file size "+x.length+" < 512");var S=3,C=512,D=0,O=0,q=0,Z=0,X=0,Y=[],Q=x.slice(0,512);Vr(Q,0);var ue=d(Q);switch(S=ue[0],S){case 3:C=512;break;case 4:C=4096;break;case 0:if(ue[1]==0)return Zs(x,F);default:throw new Error("Major Version: Expected 3 or 4 saw "+S)}C!==512&&(Q=x.slice(0,C),Vr(Q,28));var ve=x.slice(0,C);p(Q,S);var Te=Q.read_shift(4,"i");if(S===3&&Te!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Te);Q.l+=4,q=Q.read_shift(4,"i"),Q.l+=4,Q.chk("00100000","Mini Stream Cutoff Size: "),Z=Q.read_shift(4,"i"),D=Q.read_shift(4,"i"),X=Q.read_shift(4,"i"),O=Q.read_shift(4,"i");for(var de=-1,ye=0;ye<109&&(de=Q.read_shift(4,"i"),!(de<0));++ye)Y[ye]=de;var Be=g(x,C);E(X,O,Be,C,Y);var gt=V(Be,q,Y,C);gt[q].name="!Directory",D>0&&Z!==R&&(gt[Z].name="!MiniFAT"),gt[Y[0]].name="!FAT",gt.fat_addrs=Y,gt.ssz=C;var ct={},Tt=[],An=[],Pi=[];N(q,gt,Be,Tt,D,ct,An,Z),v(An,Pi,Tt),Tt.shift();var Kn={FileIndex:An,FullPaths:Pi};return F&&F.raw&&(Kn.raw={header:ve,sectors:Be}),Kn}function d(x){if(x[x.l]==80&&x[x.l+1]==75)return[0,0];x.chk(We,"Header Signature: "),x.l+=16;var F=x.read_shift(2,"u");return[x.read_shift(2,"u"),F]}function p(x,F){var S=9;switch(x.l+=2,S=x.read_shift(2)){case 9:if(F!=3)throw new Error("Sector Shift: Expected 9 saw "+S);break;case 12:if(F!=4)throw new Error("Sector Shift: Expected 12 saw "+S);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+S)}x.chk("0600","Mini Sector Shift: "),x.chk("000000000000","Reserved: ")}function g(x,F){for(var S=Math.ceil(x.length/F)-1,C=[],D=1;D<S;++D)C[D-1]=x.slice(D*F,(D+1)*F);return C[S-1]=x.slice(S*F),C}function v(x,F,S){for(var C=0,D=0,O=0,q=0,Z=0,X=S.length,Y=[],Q=[];C<X;++C)Y[C]=Q[C]=C,F[C]=S[C];for(;Z<Q.length;++Z)C=Q[Z],D=x[C].L,O=x[C].R,q=x[C].C,Y[C]===C&&(D!==-1&&Y[D]!==D&&(Y[C]=Y[D]),O!==-1&&Y[O]!==O&&(Y[C]=Y[O])),q!==-1&&(Y[q]=C),D!==-1&&C!=Y[C]&&(Y[D]=Y[C],Q.lastIndexOf(D)<Z&&Q.push(D)),O!==-1&&C!=Y[C]&&(Y[O]=Y[C],Q.lastIndexOf(O)<Z&&Q.push(O));for(C=1;C<X;++C)Y[C]===C&&(O!==-1&&Y[O]!==O?Y[C]=Y[O]:D!==-1&&Y[D]!==D&&(Y[C]=Y[D]));for(C=1;C<X;++C)if(x[C].type!==0){if(Z=C,Z!=Y[Z])do Z=Y[Z],F[C]=F[Z]+"/"+F[C];while(Z!==0&&Y[Z]!==-1&&Z!=Y[Z]);Y[C]=-1}for(F[0]+="/",C=1;C<X;++C)x[C].type!==2&&(F[C]+="/")}function _(x,F,S){for(var C=x.start,D=x.size,O=[],q=C;S&&D>0&&q>=0;)O.push(F.slice(q*k,q*k+k)),D-=k,q=Mi(S,q*4);return O.length===0?ee(0):ar(O).slice(0,x.size)}function E(x,F,S,C,D){var O=R;if(x===R){if(F!==0)throw new Error("DIFAT chain shorter than expected")}else if(x!==-1){var q=S[x],Z=(C>>>2)-1;if(!q)return;for(var X=0;X<Z&&(O=Mi(q,X*4))!==R;++X)D.push(O);E(Mi(q,C-4),F-1,S,C,D)}}function L(x,F,S,C,D){var O=[],q=[];D||(D=[]);var Z=C-1,X=0,Y=0;for(X=F;X>=0;){D[X]=!0,O[O.length]=X,q.push(x[X]);var Q=S[Math.floor(X*4/C)];if(Y=X*4&Z,C<4+Y)throw new Error("FAT boundary crossed: "+X+" 4 "+C);if(!x[Q])break;X=Mi(x[Q],Y)}return{nodes:O,data:Yd([q])}}function V(x,F,S,C){var D=x.length,O=[],q=[],Z=[],X=[],Y=C-1,Q=0,ue=0,ve=0,Te=0;for(Q=0;Q<D;++Q)if(Z=[],ve=Q+F,ve>=D&&(ve-=D),!q[ve]){X=[];var de=[];for(ue=ve;ue>=0;){de[ue]=!0,q[ue]=!0,Z[Z.length]=ue,X.push(x[ue]);var ye=S[Math.floor(ue*4/C)];if(Te=ue*4&Y,C<4+Te)throw new Error("FAT boundary crossed: "+ue+" 4 "+C);if(!x[ye]||(ue=Mi(x[ye],Te),de[ue]))break}O[ve]={nodes:Z,data:Yd([X])}}return O}function N(x,F,S,C,D,O,q,Z){for(var X=0,Y=C.length?2:0,Q=F[x].data,ue=0,ve=0,Te;ue<Q.length;ue+=128){var de=Q.slice(ue,ue+128);Vr(de,64),ve=de.read_shift(2),Te=sh(de,0,ve-Y),C.push(Te);var ye={name:Te,type:de.read_shift(1),color:de.read_shift(1),L:de.read_shift(4,"i"),R:de.read_shift(4,"i"),C:de.read_shift(4,"i"),clsid:de.read_shift(16),state:de.read_shift(4,"i"),start:0,size:0},Be=de.read_shift(2)+de.read_shift(2)+de.read_shift(2)+de.read_shift(2);Be!==0&&(ye.ct=U(de,de.l-8));var gt=de.read_shift(2)+de.read_shift(2)+de.read_shift(2)+de.read_shift(2);gt!==0&&(ye.mt=U(de,de.l-8)),ye.start=de.read_shift(4,"i"),ye.size=de.read_shift(4,"i"),ye.size<0&&ye.start<0&&(ye.size=ye.type=0,ye.start=R,ye.name=""),ye.type===5?(X=ye.start,D>0&&X!==R&&(F[X].name="!StreamData")):ye.size>=4096?(ye.storage="fat",F[ye.start]===void 0&&(F[ye.start]=L(S,ye.start,F.fat_addrs,F.ssz)),F[ye.start].name=ye.name,ye.content=F[ye.start].data.slice(0,ye.size)):(ye.storage="minifat",ye.size<0?ye.size=0:X!==R&&ye.start!==R&&F[X]&&(ye.content=_(ye,F[X].data,(F[Z]||{}).data))),ye.content&&Vr(ye.content,0),O[Te]=ye,q.push(ye)}}function U(x,F){return new Date((Ur(x,F+4)/1e7*Math.pow(2,32)+Ur(x,F)/1e7-11644473600)*1e3)}function re(x,F){return u(),f(c.readFileSync(x),F)}function le(x,F){var S=F&&F.type;switch(S||nt&&Buffer.isBuffer(x)&&(S="buffer"),S||"base64"){case"file":return re(x,F);case"base64":return f(en(Bn(x)),F);case"binary":return f(en(x),F)}return f(x,F)}function w(x,F){var S=F||{},C=S.root||"Root Entry";if(x.FullPaths||(x.FullPaths=[]),x.FileIndex||(x.FileIndex=[]),x.FullPaths.length!==x.FileIndex.length)throw new Error("inconsistent CFB structure");x.FullPaths.length===0&&(x.FullPaths[0]=C+"/",x.FileIndex[0]={name:C,type:5}),S.CLSID&&(x.FileIndex[0].clsid=S.CLSID),T(x)}function T(x){var F="Sh33tJ5";if(!pt.find(x,"/"+F)){var S=ee(4);S[0]=55,S[1]=S[3]=50,S[2]=54,x.FileIndex.push({name:F,type:2,content:S,size:4,L:69,R:69,C:69}),x.FullPaths.push(x.FullPaths[0]+F),y(x)}}function y(x,F){w(x);for(var S=!1,C=!1,D=x.FullPaths.length-1;D>=0;--D){var O=x.FileIndex[D];switch(O.type){case 0:C?S=!0:(x.FileIndex.pop(),x.FullPaths.pop());break;case 1:case 2:case 5:C=!0,isNaN(O.R*O.L*O.C)&&(S=!0),O.R>-1&&O.L>-1&&O.R==O.L&&(S=!0);break;default:S=!0;break}}if(!(!S&&!F)){var q=new Date(1987,1,19),Z=0,X=Object.create?Object.create(null):{},Y=[];for(D=0;D<x.FullPaths.length;++D)X[x.FullPaths[D]]=!0,x.FileIndex[D].type!==0&&Y.push([x.FullPaths[D],x.FileIndex[D]]);for(D=0;D<Y.length;++D){var Q=n(Y[D][0]);C=X[Q],C||(Y.push([Q,{name:i(Q).replace("/",""),type:1,clsid:Qe,ct:q,mt:q,content:null}]),X[Q]=!0)}for(Y.sort(function(Te,de){return r(Te[0],de[0])}),x.FullPaths=[],x.FileIndex=[],D=0;D<Y.length;++D)x.FullPaths[D]=Y[D][0],x.FileIndex[D]=Y[D][1];for(D=0;D<Y.length;++D){var ue=x.FileIndex[D],ve=x.FullPaths[D];if(ue.name=i(ve).replace("/",""),ue.L=ue.R=ue.C=-(ue.color=1),ue.size=ue.content?ue.content.length:0,ue.start=0,ue.clsid=ue.clsid||Qe,D===0)ue.C=Y.length>1?1:-1,ue.size=0,ue.type=5;else if(ve.slice(-1)=="/"){for(Z=D+1;Z<Y.length&&n(x.FullPaths[Z])!=ve;++Z);for(ue.C=Z>=Y.length?-1:Z,Z=D+1;Z<Y.length&&n(x.FullPaths[Z])!=n(ve);++Z);ue.R=Z>=Y.length?-1:Z,ue.type=1}else n(x.FullPaths[D+1]||"")==n(ve)&&(ue.R=D+1),ue.type=2}}}function I(x,F){var S=F||{};if(S.fileType=="mad")return Zt(x,S);switch(y(x),S.fileType){case"zip":return ea(x,S)}var C=function(Te){for(var de=0,ye=0,Be=0;Be<Te.FileIndex.length;++Be){var gt=Te.FileIndex[Be];if(gt.content){var ct=gt.content.length;ct>0&&(ct<4096?de+=ct+63>>6:ye+=ct+511>>9)}}for(var Tt=Te.FullPaths.length+3>>2,An=de+7>>3,Pi=de+127>>7,Kn=An+ye+Tt+Pi,an=Kn+127>>7,ns=an<=109?0:Math.ceil((an-109)/127);Kn+an+ns+127>>7>an;)ns=++an<=109?0:Math.ceil((an-109)/127);var kr=[1,ns,an,Pi,Tt,ye,de,0];return Te.FileIndex[0].size=de<<6,kr[7]=(Te.FileIndex[0].start=kr[0]+kr[1]+kr[2]+kr[3]+kr[4]+kr[5])+(kr[6]+7>>3),kr}(x),D=ee(C[7]<<9),O=0,q=0;{for(O=0;O<8;++O)D.write_shift(1,ke[O]);for(O=0;O<8;++O)D.write_shift(2,0);for(D.write_shift(2,62),D.write_shift(2,3),D.write_shift(2,65534),D.write_shift(2,9),D.write_shift(2,6),O=0;O<3;++O)D.write_shift(2,0);for(D.write_shift(4,0),D.write_shift(4,C[2]),D.write_shift(4,C[0]+C[1]+C[2]+C[3]-1),D.write_shift(4,0),D.write_shift(4,4096),D.write_shift(4,C[3]?C[0]+C[1]+C[2]-1:R),D.write_shift(4,C[3]),D.write_shift(-4,C[1]?C[0]-1:R),D.write_shift(4,C[1]),O=0;O<109;++O)D.write_shift(-4,O<C[2]?C[1]+O:-1)}if(C[1])for(q=0;q<C[1];++q){for(;O<236+q*127;++O)D.write_shift(-4,O<C[2]?C[1]+O:-1);D.write_shift(-4,q===C[1]-1?R:q+1)}var Z=function(Te){for(q+=Te;O<q-1;++O)D.write_shift(-4,O+1);Te&&(++O,D.write_shift(-4,R))};for(q=O=0,q+=C[1];O<q;++O)D.write_shift(-4,Ne.DIFSECT);for(q+=C[2];O<q;++O)D.write_shift(-4,Ne.FATSECT);Z(C[3]),Z(C[4]);for(var X=0,Y=0,Q=x.FileIndex[0];X<x.FileIndex.length;++X)Q=x.FileIndex[X],Q.content&&(Y=Q.content.length,!(Y<4096)&&(Q.start=q,Z(Y+511>>9)));for(Z(C[6]+7>>3);D.l&511;)D.write_shift(-4,Ne.ENDOFCHAIN);for(q=O=0,X=0;X<x.FileIndex.length;++X)Q=x.FileIndex[X],Q.content&&(Y=Q.content.length,!(!Y||Y>=4096)&&(Q.start=q,Z(Y+63>>6)));for(;D.l&511;)D.write_shift(-4,Ne.ENDOFCHAIN);for(O=0;O<C[4]<<2;++O){var ue=x.FullPaths[O];if(!ue||ue.length===0){for(X=0;X<17;++X)D.write_shift(4,0);for(X=0;X<3;++X)D.write_shift(4,-1);for(X=0;X<12;++X)D.write_shift(4,0);continue}Q=x.FileIndex[O],O===0&&(Q.start=Q.size?Q.start-1:R);var ve=O===0&&S.root||Q.name;if(Y=2*(ve.length+1),D.write_shift(64,ve,"utf16le"),D.write_shift(2,Y),D.write_shift(1,Q.type),D.write_shift(1,Q.color),D.write_shift(-4,Q.L),D.write_shift(-4,Q.R),D.write_shift(-4,Q.C),Q.clsid)D.write_shift(16,Q.clsid,"hex");else for(X=0;X<4;++X)D.write_shift(4,0);D.write_shift(4,Q.state||0),D.write_shift(4,0),D.write_shift(4,0),D.write_shift(4,0),D.write_shift(4,0),D.write_shift(4,Q.start),D.write_shift(4,Q.size),D.write_shift(4,0)}for(O=1;O<x.FileIndex.length;++O)if(Q=x.FileIndex[O],Q.size>=4096)if(D.l=Q.start+1<<9,nt&&Buffer.isBuffer(Q.content))Q.content.copy(D,D.l,0,Q.size),D.l+=Q.size+511&-512;else{for(X=0;X<Q.size;++X)D.write_shift(1,Q.content[X]);for(;X&511;++X)D.write_shift(1,0)}for(O=1;O<x.FileIndex.length;++O)if(Q=x.FileIndex[O],Q.size>0&&Q.size<4096)if(nt&&Buffer.isBuffer(Q.content))Q.content.copy(D,D.l,0,Q.size),D.l+=Q.size+63&-64;else{for(X=0;X<Q.size;++X)D.write_shift(1,Q.content[X]);for(;X&63;++X)D.write_shift(1,0)}if(nt)D.l=D.length;else for(;D.l<D.length;)D.write_shift(1,0);return D}function P(x,F){var S=x.FullPaths.map(function(X){return X.toUpperCase()}),C=S.map(function(X){var Y=X.split("/");return Y[Y.length-(X.slice(-1)=="/"?2:1)]}),D=!1;F.charCodeAt(0)===47?(D=!0,F=S[0].slice(0,-1)+F):D=F.indexOf("/")!==-1;var O=F.toUpperCase(),q=D===!0?S.indexOf(O):C.indexOf(O);if(q!==-1)return x.FileIndex[q];var Z=!O.match(Mo);for(O=O.replace(Ca,""),Z&&(O=O.replace(Mo,"!")),q=0;q<S.length;++q)if((Z?S[q].replace(Mo,"!"):S[q]).replace(Ca,"")==O||(Z?C[q].replace(Mo,"!"):C[q]).replace(Ca,"")==O)return x.FileIndex[q];return null}var k=64,R=-2,We="d0cf11e0a1b11ae1",ke=[208,207,17,224,161,177,26,225],Qe="00000000000000000000000000000000",Ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:We,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Qe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function He(x,F,S){u();var C=I(x,S);c.writeFileSync(F,C)}function it(x){for(var F=new Array(x.length),S=0;S<x.length;++S)F[S]=String.fromCharCode(x[S]);return F.join("")}function Dt(x,F){var S=I(x,F);switch(F&&F.type||"buffer"){case"file":return u(),c.writeFileSync(F.filename,S),S;case"binary":return typeof S=="string"?S:it(S);case"base64":return Ka(typeof S=="string"?S:it(S));case"buffer":if(nt)return Buffer.isBuffer(S)?S:jn(S);case"array":return typeof S=="string"?en(S):S}return S}var At;function M(x){try{var F=x.InflateRaw,S=new F;if(S._processChunk(new Uint8Array([3,0]),S._finishFlushFlag),S.bytesRead)At=x;else throw new Error("zlib does not expose bytesRead")}catch(C){console.error("cannot use native zlib: "+(C.message||C))}}function G(x,F){if(!At)return ts(x,F);var S=At.InflateRaw,C=new S,D=C._processChunk(x.slice(x.l),C._finishFlushFlag);return x.l+=C.bytesRead,D}function W(x){return At?At.deflateRawSync(x):Ot(x)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ae=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Re(x){var F=(x<<1|x<<11)&139536|(x<<5|x<<15)&558144;return(F>>16|F>>8|F)&255}for(var Ce=typeof Uint8Array<"u",me=Ce?new Uint8Array(256):[],et=0;et<256;++et)me[et]=Re(et);function b(x,F){var S=me[x&255];return F<=8?S>>>8-F:(S=S<<8|me[x>>8&255],F<=16?S>>>16-F:(S=S<<8|me[x>>16&255],S>>>24-F))}function B(x,F){var S=F&7,C=F>>>3;return(x[C]|(S<=6?0:x[C+1]<<8))>>>S&3}function K(x,F){var S=F&7,C=F>>>3;return(x[C]|(S<=5?0:x[C+1]<<8))>>>S&7}function ae(x,F){var S=F&7,C=F>>>3;return(x[C]|(S<=4?0:x[C+1]<<8))>>>S&15}function te(x,F){var S=F&7,C=F>>>3;return(x[C]|(S<=3?0:x[C+1]<<8))>>>S&31}function z(x,F){var S=F&7,C=F>>>3;return(x[C]|(S<=1?0:x[C+1]<<8))>>>S&127}function pe(x,F,S){var C=F&7,D=F>>>3,O=(1<<S)-1,q=x[D]>>>C;return S<8-C||(q|=x[D+1]<<8-C,S<16-C)||(q|=x[D+2]<<16-C,S<24-C)||(q|=x[D+3]<<24-C),q&O}function he(x,F,S){var C=F&7,D=F>>>3;return C<=5?x[D]|=(S&7)<<C:(x[D]|=S<<C&255,x[D+1]=(S&7)>>8-C),F+3}function fe(x,F,S){var C=F&7,D=F>>>3;return S=(S&1)<<C,x[D]|=S,F+1}function oe(x,F,S){var C=F&7,D=F>>>3;return S<<=C,x[D]|=S&255,S>>>=8,x[D+1]=S,F+8}function Pe(x,F,S){var C=F&7,D=F>>>3;return S<<=C,x[D]|=S&255,S>>>=8,x[D+1]=S&255,x[D+2]=S>>>8,F+16}function Ee(x,F){var S=x.length,C=2*S>F?2*S:F+5,D=0;if(S>=F)return x;if(nt){var O=Nd(C);if(x.copy)x.copy(O);else for(;D<x.length;++D)O[D]=x[D];return O}else if(Ce){var q=new Uint8Array(C);if(q.set)q.set(x);else for(;D<S;++D)q[D]=x[D];return q}return x.length=C,x}function Se(x){for(var F=new Array(x),S=0;S<x;++S)F[S]=0;return F}function Oe(x,F,S){var C=1,D=0,O=0,q=0,Z=0,X=x.length,Y=Ce?new Uint16Array(32):Se(32);for(O=0;O<32;++O)Y[O]=0;for(O=X;O<S;++O)x[O]=0;X=x.length;var Q=Ce?new Uint16Array(X):Se(X);for(O=0;O<X;++O)Y[D=x[O]]++,C<D&&(C=D),Q[O]=0;for(Y[0]=0,O=1;O<=C;++O)Y[O+16]=Z=Z+Y[O-1]<<1;for(O=0;O<X;++O)Z=x[O],Z!=0&&(Q[O]=Y[Z+16]++);var ue=0;for(O=0;O<X;++O)if(ue=x[O],ue!=0)for(Z=b(Q[O],C)>>C-ue,q=(1<<C+4-ue)-1;q>=0;--q)F[Z|q<<ue]=ue&15|O<<4;return C}var Fe=Ce?new Uint16Array(512):Se(512),Ve=Ce?new Uint16Array(32):Se(32);if(!Ce){for(var je=0;je<512;++je)Fe[je]=0;for(je=0;je<32;++je)Ve[je]=0}(function(){for(var x=[],F=0;F<32;F++)x.push(5);Oe(x,Ve,32);var S=[];for(F=0;F<=143;F++)S.push(8);for(;F<=255;F++)S.push(9);for(;F<=279;F++)S.push(7);for(;F<=287;F++)S.push(8);Oe(S,Fe,288)})();var Kt=function(){for(var F=Ce?new Uint8Array(32768):[],S=0,C=0;S<Ae.length-1;++S)for(;C<Ae[S+1];++C)F[C]=S;for(;C<32768;++C)F[C]=29;var D=Ce?new Uint8Array(259):[];for(S=0,C=0;S<ne.length-1;++S)for(;C<ne[S+1];++C)D[C]=S;function O(Z,X){for(var Y=0;Y<Z.length;){var Q=Math.min(65535,Z.length-Y),ue=Y+Q==Z.length;for(X.write_shift(1,+ue),X.write_shift(2,Q),X.write_shift(2,~Q&65535);Q-- >0;)X[X.l++]=Z[Y++]}return X.l}function q(Z,X){for(var Y=0,Q=0,ue=Ce?new Uint16Array(32768):[];Q<Z.length;){var ve=Math.min(65535,Z.length-Q);if(ve<10){for(Y=he(X,Y,+(Q+ve==Z.length)),Y&7&&(Y+=8-(Y&7)),X.l=Y/8|0,X.write_shift(2,ve),X.write_shift(2,~ve&65535);ve-- >0;)X[X.l++]=Z[Q++];Y=X.l*8;continue}Y=he(X,Y,+(Q+ve==Z.length)+2);for(var Te=0;ve-- >0;){var de=Z[Q];Te=(Te<<5^de)&32767;var ye=-1,Be=0;if((ye=ue[Te])&&(ye|=Q&-32768,ye>Q&&(ye-=32768),ye<Q))for(;Z[ye+Be]==Z[Q+Be]&&Be<250;)++Be;if(Be>2){de=D[Be],de<=22?Y=oe(X,Y,me[de+1]>>1)-1:(oe(X,Y,3),Y+=5,oe(X,Y,me[de-23]>>5),Y+=3);var gt=de<8?0:de-4>>2;gt>0&&(Pe(X,Y,Be-ne[de]),Y+=gt),de=F[Q-ye],Y=oe(X,Y,me[de]>>3),Y-=3;var ct=de<4?0:de-2>>1;ct>0&&(Pe(X,Y,Q-ye-Ae[de]),Y+=ct);for(var Tt=0;Tt<Be;++Tt)ue[Te]=Q&32767,Te=(Te<<5^Z[Q])&32767,++Q;ve-=Be-1}else de<=143?de=de+48:Y=fe(X,Y,1),Y=oe(X,Y,me[de]),ue[Te]=Q&32767,++Q}Y=oe(X,Y,0)-1}return X.l=(Y+7)/8|0,X.l}return function(X,Y){return X.length<8?O(X,Y):q(X,Y)}}();function Ot(x){var F=ee(50+Math.floor(x.length*1.1)),S=Kt(x,F);return F.slice(0,S)}var Er=Ce?new Uint16Array(32768):Se(32768),Bt=Ce?new Uint16Array(32768):Se(32768),Yr=Ce?new Uint16Array(128):Se(128),Gn=1,bt=1;function Cr(x,F){var S=te(x,F)+257;F+=5;var C=te(x,F)+1;F+=5;var D=ae(x,F)+4;F+=4;for(var O=0,q=Ce?new Uint8Array(19):Se(19),Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],X=1,Y=Ce?new Uint8Array(8):Se(8),Q=Ce?new Uint8Array(8):Se(8),ue=q.length,ve=0;ve<D;++ve)q[H[ve]]=O=K(x,F),X<O&&(X=O),Y[O]++,F+=3;var Te=0;for(Y[0]=0,ve=1;ve<=X;++ve)Q[ve]=Te=Te+Y[ve-1]<<1;for(ve=0;ve<ue;++ve)(Te=q[ve])!=0&&(Z[ve]=Q[Te]++);var de=0;for(ve=0;ve<ue;++ve)if(de=q[ve],de!=0){Te=me[Z[ve]]>>8-de;for(var ye=(1<<7-de)-1;ye>=0;--ye)Yr[Te|ye<<de]=de&7|ve<<3}var Be=[];for(X=1;Be.length<S+C;)switch(Te=Yr[z(x,F)],F+=Te&7,Te>>>=3){case 16:for(O=3+B(x,F),F+=2,Te=Be[Be.length-1];O-- >0;)Be.push(Te);break;case 17:for(O=3+K(x,F),F+=3;O-- >0;)Be.push(0);break;case 18:for(O=11+z(x,F),F+=7;O-- >0;)Be.push(0);break;default:Be.push(Te),X<Te&&(X=Te);break}var gt=Be.slice(0,S),ct=Be.slice(S);for(ve=S;ve<286;++ve)gt[ve]=0;for(ve=C;ve<30;++ve)ct[ve]=0;return Gn=Oe(gt,Er,286),bt=Oe(ct,Bt,30),F}function es(x,F){if(x[0]==3&&!(x[1]&3))return[ji(F),2];for(var S=0,C=0,D=Nd(F||1<<18),O=0,q=D.length>>>0,Z=0,X=0;(C&1)==0;){if(C=K(x,S),S+=3,C>>>1)C>>1==1?(Z=9,X=5):(S=Cr(x,S),Z=Gn,X=bt);else{S&7&&(S+=8-(S&7));var Y=x[S>>>3]|x[(S>>>3)+1]<<8;if(S+=32,Y>0)for(!F&&q<O+Y&&(D=Ee(D,O+Y),q=D.length);Y-- >0;)D[O++]=x[S>>>3],S+=8;continue}for(;;){!F&&q<O+32767&&(D=Ee(D,O+32767),q=D.length);var Q=pe(x,S,Z),ue=C>>>1==1?Fe[Q]:Er[Q];if(S+=ue&15,ue>>>=4,(ue>>>8&255)===0)D[O++]=ue;else{if(ue==256)break;ue-=257;var ve=ue<8?0:ue-4>>2;ve>5&&(ve=0);var Te=O+ne[ue];ve>0&&(Te+=pe(x,S,ve),S+=ve),Q=pe(x,S,X),ue=C>>>1==1?Ve[Q]:Bt[Q],S+=ue&15,ue>>>=4;var de=ue<4?0:ue-2>>1,ye=Ae[ue];for(de>0&&(ye+=pe(x,S,de),S+=de),!F&&q<Te&&(D=Ee(D,Te+100),q=D.length);O<Te;)D[O]=D[O-ye],++O}}}return F?[D,S+7>>>3]:[D.slice(0,O),S+7>>>3]}function ts(x,F){var S=x.slice(x.l||0),C=es(S,F);return x.l+=C[1],C[0]}function Js(x,F){if(x)typeof console<"u"&&console.error(F);else throw new Error(F)}function Zs(x,F){var S=x;Vr(S,0);var C=[],D=[],O={FileIndex:C,FullPaths:D};w(O,{root:F.root});for(var q=S.length-4;(S[q]!=80||S[q+1]!=75||S[q+2]!=5||S[q+3]!=6)&&q>=0;)--q;S.l=q+4,S.l+=4;var Z=S.read_shift(2);S.l+=6;var X=S.read_shift(4);for(S.l=X,q=0;q<Z;++q){S.l+=20;var Y=S.read_shift(4),Q=S.read_shift(4),ue=S.read_shift(2),ve=S.read_shift(2),Te=S.read_shift(2);S.l+=8;var de=S.read_shift(4),ye=o(S.slice(S.l+ue,S.l+ue+ve));S.l+=ue+ve+Te;var Be=S.l;S.l=de+4,Ii(S,Y,Q,O,ye),S.l=Be}return O}function Ii(x,F,S,C,D){x.l+=2;var O=x.read_shift(2),q=x.read_shift(2),Z=a(x);if(O&8257)throw new Error("Unsupported ZIP encryption");for(var X=x.read_shift(4),Y=x.read_shift(4),Q=x.read_shift(4),ue=x.read_shift(2),ve=x.read_shift(2),Te="",de=0;de<ue;++de)Te+=String.fromCharCode(x[x.l++]);if(ve){var ye=o(x.slice(x.l,x.l+ve));(ye[21589]||{}).mt&&(Z=ye[21589].mt),((D||{})[21589]||{}).mt&&(Z=D[21589].mt)}x.l+=ve;var Be=x.slice(x.l,x.l+Y);switch(q){case 8:Be=G(x,Q);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+q)}var gt=!1;O&8&&(X=x.read_shift(4),X==134695760&&(X=x.read_shift(4),gt=!0),Y=x.read_shift(4),Q=x.read_shift(4)),Y!=F&&Js(gt,"Bad compressed size: "+F+" != "+Y),Q!=S&&Js(gt,"Bad uncompressed size: "+S+" != "+Q),wn(C,Te,Be,{unsafe:!0,mt:Z})}function ea(x,F){var S=F||{},C=[],D=[],O=ee(1),q=S.compression?8:0,Z=0,X=0,Y=0,Q=0,ue=0,ve=x.FullPaths[0],Te=ve,de=x.FileIndex[0],ye=[],Be=0;for(X=1;X<x.FullPaths.length;++X)if(Te=x.FullPaths[X].slice(ve.length),de=x.FileIndex[X],!(!de.size||!de.content||Te=="Sh33tJ5")){var gt=Q,ct=ee(Te.length);for(Y=0;Y<Te.length;++Y)ct.write_shift(1,Te.charCodeAt(Y)&127);ct=ct.slice(0,ct.l),ye[ue]=KS.buf(de.content,0);var Tt=de.content;q==8&&(Tt=W(Tt)),O=ee(30),O.write_shift(4,67324752),O.write_shift(2,20),O.write_shift(2,Z),O.write_shift(2,q),de.mt?s(O,de.mt):O.write_shift(4,0),O.write_shift(-4,ye[ue]),O.write_shift(4,Tt.length),O.write_shift(4,de.content.length),O.write_shift(2,ct.length),O.write_shift(2,0),Q+=O.length,C.push(O),Q+=ct.length,C.push(ct),Q+=Tt.length,C.push(Tt),O=ee(46),O.write_shift(4,33639248),O.write_shift(2,0),O.write_shift(2,20),O.write_shift(2,Z),O.write_shift(2,q),O.write_shift(4,0),O.write_shift(-4,ye[ue]),O.write_shift(4,Tt.length),O.write_shift(4,de.content.length),O.write_shift(2,ct.length),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(4,0),O.write_shift(4,gt),Be+=O.l,D.push(O),Be+=ct.length,D.push(ct),++ue}return O=ee(22),O.write_shift(4,101010256),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,ue),O.write_shift(2,ue),O.write_shift(4,Be),O.write_shift(4,Q),O.write_shift(2,0),ar([ar(C),ar(D),O])}var zn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Tn(x,F){if(x.ctype)return x.ctype;var S=x.name||"",C=S.match(/\.([^\.]+)$/);return C&&zn[C[1]]||F&&(C=(S=F).match(/[\.\\]([^\.\\])+$/),C&&zn[C[1]])?zn[C[1]]:"application/octet-stream"}function ho(x){for(var F=Ka(x),S=[],C=0;C<F.length;C+=76)S.push(F.slice(C,C+76));return S.join(`\r
`)+`\r
`}function rs(x){var F=x.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Y){var Q=Y.charCodeAt(0).toString(16).toUpperCase();return"="+(Q.length==1?"0"+Q:Q)});F=F.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),F.charAt(0)==`
`&&(F="=0D"+F.slice(1)),F=F.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var S=[],C=F.split(`\r
`),D=0;D<C.length;++D){var O=C[D];if(O.length==0){S.push("");continue}for(var q=0;q<O.length;){var Z=76,X=O.slice(q,q+Z);X.charAt(Z-1)=="="?Z--:X.charAt(Z-2)=="="?Z-=2:X.charAt(Z-3)=="="&&(Z-=3),X=O.slice(q,q+Z),q+=Z,q<O.length&&(X+="="),S.push(X)}}return S.join(`\r
`)}function po(x){for(var F=[],S=0;S<x.length;++S){for(var C=x[S];S<=x.length&&C.charAt(C.length-1)=="=";)C=C.slice(0,C.length-1)+x[++S];F.push(C)}for(var D=0;D<F.length;++D)F[D]=F[D].replace(/[=][0-9A-Fa-f]{2}/g,function(O){return String.fromCharCode(parseInt(O.slice(1),16))});return en(F.join(`\r
`))}function Ci(x,F,S){for(var C="",D="",O="",q,Z=0;Z<10;++Z){var X=F[Z];if(!X||X.match(/^\s*$/))break;var Y=X.match(/^(.*?):\s*([^\s].*)$/);if(Y)switch(Y[1].toLowerCase()){case"content-location":C=Y[2].trim();break;case"content-type":O=Y[2].trim();break;case"content-transfer-encoding":D=Y[2].trim();break}}switch(++Z,D.toLowerCase()){case"base64":q=en(Bn(F.slice(Z).join("")));break;case"quoted-printable":q=po(F.slice(Z));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+D)}var Q=wn(x,C.slice(S.length),q,{unsafe:!0});O&&(Q.ctype=O)}function go(x,F){if(it(x.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var S=F&&F.root||"",C=(nt&&Buffer.isBuffer(x)?x.toString("binary"):it(x)).split(`\r
`),D=0,O="";for(D=0;D<C.length;++D)if(O=C[D],!!/^Content-Location:/i.test(O)&&(O=O.slice(O.indexOf("file")),S||(S=O.slice(0,O.lastIndexOf("/")+1)),O.slice(0,S.length)!=S))for(;S.length>0&&(S=S.slice(0,S.length-1),S=S.slice(0,S.lastIndexOf("/")+1),O.slice(0,S.length)!=S););var q=(C[1]||"").match(/boundary="(.*?)"/);if(!q)throw new Error("MAD cannot find boundary");var Z="--"+(q[1]||""),X=[],Y=[],Q={FileIndex:X,FullPaths:Y};w(Q);var ue,ve=0;for(D=0;D<C.length;++D){var Te=C[D];Te!==Z&&Te!==Z+"--"||(ve++&&Ci(Q,C.slice(ue,D),S),ue=D)}return Q}function Zt(x,F){var S=F||{},C=S.boundary||"SheetJS";C="------="+C;for(var D=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+C.slice(2)+'"',"","",""],O=x.FullPaths[0],q=O,Z=x.FileIndex[0],X=1;X<x.FullPaths.length;++X)if(q=x.FullPaths[X].slice(O.length),Z=x.FileIndex[X],!(!Z.size||!Z.content||q=="Sh33tJ5")){q=q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Be){return"_x"+Be.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Be){return"_u"+Be.charCodeAt(0).toString(16)+"_"});for(var Y=Z.content,Q=nt&&Buffer.isBuffer(Y)?Y.toString("binary"):it(Y),ue=0,ve=Math.min(1024,Q.length),Te=0,de=0;de<=ve;++de)(Te=Q.charCodeAt(de))>=32&&Te<128&&++ue;var ye=ue>=ve*4/5;D.push(C),D.push("Content-Location: "+(S.root||"file:///C:/SheetJS/")+q),D.push("Content-Transfer-Encoding: "+(ye?"quoted-printable":"base64")),D.push("Content-Type: "+Tn(Z,q)),D.push(""),D.push(ye?rs(Q):ho(Q))}return D.push(C+`--\r
`),D.join(`\r
`)}function mo(x){var F={};return w(F,x),F}function wn(x,F,S,C){var D=C&&C.unsafe;D||w(x);var O=!D&&pt.find(x,F);if(!O){var q=x.FullPaths[0];F.slice(0,q.length)==q?q=F:(q.slice(-1)!="/"&&(q+="/"),q=(q+F).replace("//","/")),O={name:i(F),type:2},x.FileIndex.push(O),x.FullPaths.push(q),D||pt.utils.cfb_gc(x)}return O.content=S,O.size=S?S.length:0,C&&(C.CLSID&&(O.clsid=C.CLSID),C.mt&&(O.mt=C.mt),C.ct&&(O.ct=C.ct)),O}function Ri(x,F){w(x);var S=pt.find(x,F);if(S){for(var C=0;C<x.FileIndex.length;++C)if(x.FileIndex[C]==S)return x.FileIndex.splice(C,1),x.FullPaths.splice(C,1),!0}return!1}function Pc(x,F,S){w(x);var C=pt.find(x,F);if(C){for(var D=0;D<x.FileIndex.length;++D)if(x.FileIndex[D]==C)return x.FileIndex[D].name=i(S),x.FullPaths[D]=S,!0}return!1}function Fc(x){y(x,!0)}return e.find=P,e.read=le,e.parse=f,e.write=Dt,e.writeFile=He,e.utils={cfb_new:mo,cfb_add:wn,cfb_del:Ri,cfb_mov:Pc,cfb_gc:Fc,ReadShift:Pa,CheckField:Ym,prep_blob:Vr,bconcat:ar,use_zlib:M,_deflateRaw:Ot,_inflateRaw:ts,consts:Ne},e}();function qS(t){return typeof t=="string"?yc(t):Array.isArray(t)?ES(t):t}function oo(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=yc(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Xa(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([qS(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=ao(e)),o.write(e),o.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function ur(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Wd(t,e){for(var r=[],n=ur(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function th(t){for(var e=[],r=ur(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Ac(t){for(var e=[],r=ur(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function XS(t){for(var e=[],r=ur(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var kl=new Date(1899,11,30,0,0,0);function Or(t,e){var r=t.getTime(),n=kl.getTime()+(t.getTimezoneOffset()-kl.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var bm=new Date,YS=kl.getTime()+(bm.getTimezoneOffset()-kl.getTimezoneOffset())*6e4,jd=bm.getTimezoneOffset();function km(t){var e=new Date;return e.setTime(t*24*60*60*1e3+YS),e.getTimezoneOffset()!==jd&&e.setTime(e.getTime()+(e.getTimezoneOffset()-jd)*6e4),e}var Gd=new Date("2017-02-19T19:06:09.000Z"),Nm=isNaN(Gd.getFullYear())?new Date("2/19/17"):Gd,QS=Nm.getFullYear()==2017;function Ir(t,e){var r=new Date(t);if(QS)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(Nm.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Sc(t,e){if(nt&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function br(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=br(t[r]));return e}function Ct(t,e){for(var r="";r.length<e;)r+=t;return r}function On(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var JS=["january","february","march","april","may","june","july","august","september","october","november","december"];function qa(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&JS.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}function ze(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return nt?n=jn(r):n=yS(r),pt.utils.cfb_add(t,e,n)}pt.utils.cfb_add(t,e,r)}else t.file(e,r)}function rh(){return pt.utils.cfb_new()}var Vt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,ZS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},nh=th(ZS),ih=/[&<>'"]/g,e4=/[\u0000-\u0008\u000b-\u001f]/g;function ht(t){var e=t+"";return e.replace(ih,function(r){return nh[r]}).replace(e4,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function zd(t){return ht(t).replace(/ /g,"_x0020_")}var Lm=/[\u0000-\u001f]/g;function t4(t){var e=t+"";return e.replace(ih,function(r){return nh[r]}).replace(/\n/g,"<br/>").replace(Lm,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function r4(t){var e=t+"";return e.replace(ih,function(r){return nh[r]}).replace(Lm,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function n4(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function i4(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ru(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Kd(t){var e=ji(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function qd(t){return jn(t,"binary").toString("utf8")}var Bo="foo bar bazâð£",Ra=nt&&(qd(Bo)==ru(Bo)&&qd||Kd(Bo)==ru(Bo)&&Kd)||ru,Xa=nt?function(t){return jn(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},s4=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),Mm=/(^\s|\s$|\n)/;function or(t,e){return"<"+t+(e.match(Mm)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Ya(t){return ur(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function ge(t,e,r){return"<"+t+(r!=null?Ya(r):"")+(e!=null?(e.match(Mm)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Gu(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function a4(t,e){switch(typeof t){case"string":var r=ge("vt:lpwstr",ht(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ge((t|0)==t?"vt:i4":"vt:r8",ht(String(t)));case"boolean":return ge("vt:bool",t?"true":"false")}if(t instanceof Date)return ge("vt:filetime",Gu(t));throw new Error("Unable to serialize "+t)}var Yt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},qs=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Br={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function o4(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function l4(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var Xd=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},Yd=nt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:jn(e)})):Xd(t)}:Xd,Qd=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(ga(t,i)));return n.join("").replace(Ca,"")},sh=nt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Ca,""):Qd(t,e,r)}:Qd,Jd=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},Vm=nt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Jd(t,e,r)}:Jd,Zd=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(ms(t,i)));return n.join("")},lo=nt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):Zd(e,r,n)}:Zd,Bm=function(t,e){var r=Ur(t,e);return r>0?lo(t,e+4,e+4+r-1):""},Um=Bm,Hm=function(t,e){var r=Ur(t,e);return r>0?lo(t,e+4,e+4+r-1):""},$m=Hm,Wm=function(t,e){var r=2*Ur(t,e);return r>0?lo(t,e+4,e+4+r-1):""},jm=Wm,Gm=function(e,r){var n=Ur(e,r);return n>0?sh(e,r+4,r+4+n):""},zm=Gm,Km=function(t,e){var r=Ur(t,e);return r>0?lo(t,e+4,e+4+r):""},qm=Km,Xm=function(t,e){return o4(t,e)},Nl=Xm,ah=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};nt&&(Um=function(e,r){if(!Buffer.isBuffer(e))return Bm(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},$m=function(e,r){if(!Buffer.isBuffer(e))return Hm(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},jm=function(e,r){if(!Buffer.isBuffer(e))return Wm(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},zm=function(e,r){if(!Buffer.isBuffer(e))return Gm(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},qm=function(e,r){if(!Buffer.isBuffer(e))return Km(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Nl=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):Xm(e,r)},ah=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var ms=function(t,e){return t[e]},ga=function(t,e){return t[e+1]*256+t[e]},c4=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Ur=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Mi=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},u4=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Pa(t,e){var r="",n,i,s=[],a,o,c,u;switch(e){case"dbcs":if(u=this.l,nt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(ga(this,u)),u+=2;t*=2;break;case"utf8":r=lo(this,this.l,this.l+t);break;case"utf16le":t*=2,r=sh(this,this.l,this.l+t);break;case"wstr":return Pa.call(this,t,"dbcs");case"lpstr-ansi":r=Um(this,this.l),t=4+Ur(this,this.l);break;case"lpstr-cp":r=$m(this,this.l),t=4+Ur(this,this.l);break;case"lpwstr":r=jm(this,this.l),t=4+2*Ur(this,this.l);break;case"lpp4":t=4+Ur(this,this.l),r=zm(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Ur(this,this.l),r=qm(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=ms(this,this.l+t++))!==0;)s.push(Lo(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=ga(this,this.l+t))!==0;)s.push(Lo(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return a=ms(this,u),this.l=u+1,o=Pa.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Lo(ga(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return a=ms(this,u),this.l=u+1,o=Pa.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Lo(ms(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=ms(this,this.l),this.l++,n;case 2:return n=(e==="i"?c4:ga)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?Mi:u4)(this,this.l),this.l+=4,n):(i=Ur(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Nl(this,this.l):i=Nl([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=Vm(this,this.l,t);break}}return this.l+=t,r}var f4=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},h4=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},d4=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function p4(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)d4(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,f4(this,e,this.l);break;case 8:if(n=8,r==="f"){l4(this,e,this.l);break}case 16:break;case-4:n=4,h4(this,e,this.l);break}return this.l+=n,this}function Ym(t,e){var r=Vm(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Vr(t,e){t.l=e,t.read_shift=Pa,t.chk=Ym,t.write_shift=p4}function yn(t,e){t.l+=e}function ee(t){var e=ji(t);return Vr(e,0),e}function Dr(){var t=[],e=nt?256:2048,r=function(u){var f=ee(u);return Vr(f,0),f},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,e)))},a=function(){return i(),ar(t)},o=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function se(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=oF[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&ah(r)&&t.push(r)}}function Fa(t,e,r){var n=br(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function ep(t,e,r){var n=br(t);return n.s=Fa(n.s,e.s,r),n.e=Fa(n.e,e.s,r),n}function Da(t,e){if(t.cRel&&t.c<0)for(t=br(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=br(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=dt(t);return!t.cRel&&t.cRel!=null&&(r=_4(r)),!t.rRel&&t.rRel!=null&&(r=g4(r)),r}function nu(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+_r(t.s.c)+":"+(t.e.cRel?"":"$")+_r(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+lr(t.s.r)+":"+(t.e.rRel?"":"$")+lr(t.e.r):Da(t.s,e.biff)+":"+Da(t.e,e.biff)}function oh(t){return parseInt(m4(t),10)-1}function lr(t){return""+(t+1)}function g4(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function m4(t){return t.replace(/\$(\d+)$/,"$1")}function lh(t){for(var e=v4(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function _r(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function _4(t){return t.replace(/^([A-Z])/,"$$$1")}function v4(t){return t.replace(/^\$([A-Z])/,"$1")}function x4(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Qt(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function dt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function jr(t){var e=t.indexOf(":");return e==-1?{s:Qt(t),e:Qt(t)}:{s:Qt(t.slice(0,e)),e:Qt(t.slice(e+1))}}function Lt(t,e){return typeof e>"u"||typeof e=="number"?Lt(t.s,t.e):(typeof t!="string"&&(t=dt(t)),typeof e!="string"&&(e=dt(e)),t==e?t:t+":"+e)}function yt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function tp(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=xi(t.z,r?Or(e):e)}catch{}try{return t.w=xi((t.XF||{}).numFmtId||(r?14:0),r?Or(e):e)}catch{return""+e}}function Un(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?co[t.v]||t.v:e==null?tp(t,t.v):tp(t,e))}function Xi(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function Qm(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Qt(n.origin):n.origin;a=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=yt(s["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(u.e.r=a=f.e.r+1)}for(var d=0;d!=e.length;++d)if(e[d]){if(!Array.isArray(e[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=e[d].length;++p)if(!(typeof e[d][p]>"u")){var g={v:e[d][p]},v=a+d,_=o+p;if(u.s.r>v&&(u.s.r=v),u.s.c>_&&(u.s.c=_),u.e.r<v&&(u.e.r=v),u.e.c<_&&(u.e.c=_),e[d][p]&&typeof e[d][p]=="object"&&!Array.isArray(e[d][p])&&!(e[d][p]instanceof Date))g=e[d][p];else if(Array.isArray(g.v)&&(g.f=e[d][p][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||Rt[14],n.cellDates?(g.t="d",g.w=xi(g.z,Or(g.v))):(g.t="n",g.v=Or(g.v),g.w=xi(g.z,g.v))):g.t="s";if(i)s[v]||(s[v]=[]),s[v][_]&&s[v][_].z&&(g.z=s[v][_].z),s[v][_]=g;else{var E=dt({c:_,r:v});s[E]&&s[E].z&&(g.z=s[E].z),s[E]=g}}}return u.s.c<1e7&&(s["!ref"]=Lt(u)),s}function Xs(t,e){return Qm(null,t,e)}function E4(t){return t.read_shift(4,"i")}function sn(t,e){return e||(e=ee(4)),e.write_shift(4,t),e}function vr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Jt(t,e){var r=!1;return e==null&&(r=!0,e=ee(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function y4(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function T4(t,e){return e||(e=ee(4)),e.write_shift(2,0),e.write_shift(2,0),e}function ch(t,e){var r=t.l,n=t.read_shift(1),i=vr(t),s=[],a={t:i,h:i};if((n&1)!==0){for(var o=t.read_shift(4),c=0;c!=o;++c)s.push(y4(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function w4(t,e){var r=!1;return e==null&&(r=!0,e=ee(15+4*t.t.length)),e.write_shift(1,0),Jt(t.t,e),r?e.slice(0,e.l):e}var A4=ch;function S4(t,e){var r=!1;return e==null&&(r=!0,e=ee(23+4*t.t.length)),e.write_shift(1,1),Jt(t.t,e),e.write_shift(4,1),T4({},e),r?e.slice(0,e.l):e}function Xr(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Yi(t,e){return e==null&&(e=ee(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Qi(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Ji(t,e){return e==null&&(e=ee(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var I4=vr,Jm=Jt;function uh(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Ll(t,e){var r=!1;return e==null&&(r=!0,e=ee(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var C4=vr,zu=uh,fh=Ll;function Zm(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Nl([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Mi(e,0)>>2;return r?i/100:i}function e_(t,e){e==null&&(e=ee(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function t_(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function R4(t,e){return e||(e=ee(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Zi=t_,Ys=R4;function Qs(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Gi(t,e){return(e||ee(8)).write_shift(8,t,"f")}function P4(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var u=V4[i];u&&(e.rgb=hp(u));break;case 2:e.rgb=hp([a,o,c]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Ml(t,e){if(e||(e=ee(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function F4(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function D4(t,e){e||(e=ee(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}var r_=2,Mr=3,Uo=11,Vl=19,Ho=64,O4=65,b4=71,k4=4108,N4=4126,rr=80,rp={1:{n:"CodePage",t:r_},2:{n:"Category",t:rr},3:{n:"PresentationFormat",t:rr},4:{n:"ByteCount",t:Mr},5:{n:"LineCount",t:Mr},6:{n:"ParagraphCount",t:Mr},7:{n:"SlideCount",t:Mr},8:{n:"NoteCount",t:Mr},9:{n:"HiddenCount",t:Mr},10:{n:"MultimediaClipCount",t:Mr},11:{n:"ScaleCrop",t:Uo},12:{n:"HeadingPairs",t:k4},13:{n:"TitlesOfParts",t:N4},14:{n:"Manager",t:rr},15:{n:"Company",t:rr},16:{n:"LinksUpToDate",t:Uo},17:{n:"CharacterCount",t:Mr},19:{n:"SharedDoc",t:Uo},22:{n:"HyperlinksChanged",t:Uo},23:{n:"AppVersion",t:Mr,p:"version"},24:{n:"DigSig",t:O4},26:{n:"ContentType",t:rr},27:{n:"ContentStatus",t:rr},28:{n:"Language",t:rr},29:{n:"Version",t:rr},255:{},2147483648:{n:"Locale",t:Vl},2147483651:{n:"Behavior",t:Vl},1919054434:{}},np={1:{n:"CodePage",t:r_},2:{n:"Title",t:rr},3:{n:"Subject",t:rr},4:{n:"Author",t:rr},5:{n:"Keywords",t:rr},6:{n:"Comments",t:rr},7:{n:"Template",t:rr},8:{n:"LastAuthor",t:rr},9:{n:"RevNumber",t:rr},10:{n:"EditTime",t:Ho},11:{n:"LastPrinted",t:Ho},12:{n:"CreatedDate",t:Ho},13:{n:"ModifiedDate",t:Ho},14:{n:"PageCount",t:Mr},15:{n:"WordCount",t:Mr},16:{n:"CharCount",t:Mr},17:{n:"Thumbnail",t:b4},18:{n:"Application",t:rr},19:{n:"DocSecurity",t:Mr},255:{},2147483648:{n:"Locale",t:Vl},2147483651:{n:"Behavior",t:Vl},1919054434:{}};function L4(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var M4=L4([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),V4=br(M4),co={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},B4={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},$o={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function n_(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function i_(t,e){var r=XS(B4),n=[],i;n[n.length]=Vt,n[n.length]=ge("Types",null,{xmlns:Yt.CT,"xmlns:xsd":Yt.xsd,"xmlns:xsi":Yt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ge("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){t[c]&&t[c].length>0&&(i=t[c][0],n[n.length]=ge("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:$o[c][e.bookType]||$o[c].xlsx}))},a=function(c){(t[c]||[]).forEach(function(u){n[n.length]=ge("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:$o[c][e.bookType]||$o[c].xlsx})})},o=function(c){(t[c]||[]).forEach(function(u){n[n.length]=ge("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var rt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function s_(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Fs(t){var e=[Vt,ge("Relationships",null,{xmlns:Yt.RELS})];return ur(t["!id"]).forEach(function(r){e[e.length]=ge("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function ft(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[rt.HLINK,rt.XPATH,rt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}function U4(t){var e=[Vt];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function ip(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function H4(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function $4(t){var e=[Vt];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(ip(t[r][0],t[r][1])),e.push(H4("",t[r][0]));return e.push(ip("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function a_(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Pl.version+"</meta:generator></office:meta></office:document-meta>"}var Ui=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function iu(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=ht(e),n[n.length]=r?ge(t,e,r):or(t,e))}function o_(t,e){var r=e||{},n=[Vt,ge("cp:coreProperties",null,{"xmlns:cp":Yt.CORE_PROPS,"xmlns:dc":Yt.dc,"xmlns:dcterms":Yt.dcterms,"xmlns:dcmitype":Yt.dcmitype,"xmlns:xsi":Yt.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&iu("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Gu(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&iu("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Gu(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Ui.length;++s){var a=Ui[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&iu(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ds=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],l_=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function c_(t){var e=[],r=ge;return t||(t={}),t.Application="SheetJS",e[e.length]=Vt,e[e.length]=ge("Properties",null,{xmlns:Yt.EXT_PROPS,"xmlns:vt":Yt.vt}),Ds.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=ht(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+ht(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function u_(t){var e=[Vt,ge("Properties",null,{xmlns:Yt.CUST_PROPS,"xmlns:vt":Yt.vt})];if(!t)return e.join("");var r=1;return ur(t).forEach(function(i){++r,e[e.length]=ge("property",a4(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ht(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var sp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function W4(t,e){var r=[];return ur(sp).map(function(n){for(var i=0;i<Ui.length;++i)if(Ui[i][1]==n)return Ui[i];for(i=0;i<Ds.length;++i)if(Ds[i][1]==n)return Ds[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(or(sp[n[1]]||n[1],i))}}),ge("DocumentProperties",r.join(""),{xmlns:Br.o})}function j4(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&ur(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<Ui.length;++a)if(s==Ui[a][1])return;for(a=0;a<Ds.length;++a)if(s==Ds[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),i.push(ge(zd(s),o,{"dt:dt":c}))}}),e&&ur(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(ge(zd(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Br.o+'">'+i.join("")+"</"+n+">"}function G4(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=ee(8);return a.write_shift(4,n),a.write_shift(4,i),a}function ap(t,e){var r=ee(4),n=ee(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ee(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=G4(e);break;case 31:case 80:for(n=ee(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return ar([r,n])}var f_=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function z4(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function op(t,e,r){var n=ee(8),i=[],s=[],a=8,o=0,c=ee(8),u=ee(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),i.push(u),a+=8+c.length,!e){u=ee(8),u.write_shift(4,0),i.unshift(u);var f=[ee(4)];for(f[0].write_shift(4,t.length),o=0;o<t.length;++o){var d=t[o][0];for(c=ee(8+2*(d.length+1)+(d.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,d.length+1),c.write_shift(0,d,"dbcs");c.l!=c.length;)c.write_shift(1,0);f.push(c)}c=ar(f),s.unshift(c),a+=8+c.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(f_.indexOf(t[o][0])>-1||l_.indexOf(t[o][0])>-1)&&t[o][1]!=null){var p=t[o][1],g=0;if(e){g=+e[t[o][0]];var v=r[g];if(v.p=="version"&&typeof p=="string"){var _=p.split(".");p=(+_[0]<<16)+(+_[1]||0)}c=ap(v.t,p)}else{var E=z4(p);E==-1&&(E=31,p=String(p)),c=ap(E,p)}s.push(c),u=ee(8),u.write_shift(4,e?g:2+o),i.push(u),a+=8+c.length}var L=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,L),L+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),ar([n].concat(i).concat(s))}function lp(t,e,r,n,i,s){var a=ee(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,pt.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var c=op(t,r,n);if(o.push(c),i){var u=op(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+c.length),o.push(u)}return ar(o)}function K4(t,e){e||(e=ee(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function q4(t,e){return t.read_shift(e)===1}function wr(t,e){return e||(e=ee(2)),e.write_shift(2,+!!t),e}function h_(t){return t.read_shift(2,"u")}function zr(t,e){return e||(e=ee(2)),e.write_shift(2,t),e}function d_(t,e,r){return r||(r=ee(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function p_(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function X4(t){var e=t.t||"",r=ee(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=ee(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return ar(i)}function Y4(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Q4(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Y4(t,n,r)}function J4(t,e,r){if(r.biff>5)return Q4(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function g_(t,e,r){return r||(r=ee(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function cp(t,e){e||(e=ee(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function Z4(t){var e=ee(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),cp(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&cp(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)e.write_shift(1,n.charCodeAt(r+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function zi(t,e,r,n){return n||(n=ee(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function eI(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function tI(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function m_(t,e){return e||(e=ee(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function hh(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ee(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function rI(t,e){var r=!e||e.biff==8,n=ee(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function nI(t,e){var r=!e||e.biff>=8?2:1,n=ee(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function iI(t,e){var r=ee(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=X4(t[i]);var s=ar([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function sI(){var t=ee(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function aI(t){var e=ee(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function oI(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=ee(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function lI(t,e,r,n){var i=ee(10);return zi(t,e,n,i),i.write_shift(4,r),i}function cI(t,e,r,n,i){var s=!i||i.biff==8,a=ee(8+ +s+(1+s)*r.length);return zi(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function uI(t,e,r,n){var i=r&&r.biff==5;n||(n=ee(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function fI(t,e){var r=e.biff==8||!e.biff?4:2,n=ee(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function up(t,e,r,n){var i=r&&r.biff==5;n||(n=ee(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function hI(t){var e=ee(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function dI(t,e,r,n,i,s){var a=ee(8);return zi(t,e,n,a),d_(r,s,a),a}function pI(t,e,r,n){var i=ee(14);return zi(t,e,n,i),Gi(r,i),i}function gI(t,e,r){if(r.biff<8)return mI(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(eI(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function mI(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=p_(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function _I(t){var e=ee(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)m_(t[r],e);return e}function vI(t){var e=ee(24),r=Qt(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return ar([e,Z4(t[1])])}function xI(t){var e=t[1].Tooltip,r=ee(10+2*(e.length+1));r.write_shift(2,2048);var n=Qt(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function EI(t){return t||(t=ee(4)),t.write_shift(2,1),t.write_shift(2,1),t}function yI(t,e,r){if(!r.cellStyles)return yn(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function TI(t,e){var r=ee(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function wI(t){for(var e=ee(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}function AI(t,e,r){var n=ee(15);return fo(n,t,e),n.write_shift(8,r,"f"),n}function SI(t,e,r){var n=ee(9);return fo(n,t,e),n.write_shift(2,r),n}var II=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=th({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],f=ji(1);switch(c.type){case"base64":f=en(Bn(o));break;case"binary":f=en(o);break;case"buffer":case"array":f=o;break}Vr(f,0);var d=f.read_shift(1),p=!!(d&136),g=!1,v=!1;switch(d){case 2:break;case 3:break;case 48:g=!0,p=!0;break;case 49:g=!0,p=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var _=0,E=521;d==2&&(_=f.read_shift(2)),f.l+=3,d!=2&&(_=f.read_shift(4)),_>1048576&&(_=1e6),d!=2&&(E=f.read_shift(2));var L=f.read_shift(2),V=c.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(V=t[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var N=[],U={},re=Math.min(f.length,d==2?521:E-10-(g?264:0)),le=v?32:11;f.l<re&&f[f.l]!=13;)switch(U={},U.name=Fl.utils.decode(V,f.slice(f.l,f.l+le)).replace(/[\u0000\r\n].*$/g,""),f.l+=le,U.type=String.fromCharCode(f.read_shift(1)),d!=2&&!v&&(U.offset=f.read_shift(4)),U.len=f.read_shift(1),d==2&&(U.offset=f.read_shift(2)),U.dec=f.read_shift(1),U.name.length&&N.push(U),d!=2&&(f.l+=v?13:14),U.type){case"B":(!g||U.len!=8)&&c.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+U.type)}if(f[f.l]!==13&&(f.l=E-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=E;var w=0,T=0;for(u[0]=[],T=0;T!=N.length;++T)u[0][T]=N[T].name;for(;_-- >0;){if(f[f.l]===42){f.l+=L;continue}for(++f.l,u[++w]=[],T=0,T=0;T!=N.length;++T){var y=f.slice(f.l,f.l+N[T].len);f.l+=N[T].len,Vr(y,0);var I=Fl.utils.decode(V,y);switch(N[T].type){case"C":I.trim().length&&(u[w][T]=I.replace(/\s+$/,""));break;case"D":I.length===8?u[w][T]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):u[w][T]=I;break;case"F":u[w][T]=parseFloat(I.trim());break;case"+":case"I":u[w][T]=v?y.read_shift(-4,"i")^2147483648:y.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":u[w][T]=!0;break;case"N":case"F":u[w][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[w][T]="##MEMO##"+(v?parseInt(I.trim(),10):y.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(u[w][T]=+I||0);break;case"@":u[w][T]=new Date(y.read_shift(-8,"f")-621356832e5);break;case"T":u[w][T]=new Date((y.read_shift(4)-2440588)*864e5+y.read_shift(4));break;case"Y":u[w][T]=y.read_shift(4,"i")/1e4+y.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[w][T]=-y.read_shift(-8,"f");break;case"B":if(g&&N[T].len==8){u[w][T]=y.read_shift(8,"f");break}case"G":case"P":y.l+=N[T].len;break;case"0":if(N[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[T].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=N,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Xs(r(o,u),u);return f["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,f}function i(o,c){try{return Xi(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,c){var u=c||{};if(+u.codepage>=0&&za(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=Dr(),d=Wl(o,{header:1,raw:!0,cellDates:!0}),p=d[0],g=d.slice(1),v=o["!cols"]||[],_=0,E=0,L=0,V=1;for(_=0;_<p.length;++_){if(((v[_]||{}).DBF||{}).name){p[_]=v[_].DBF.name,++L;continue}if(p[_]!=null){if(++L,typeof p[_]=="number"&&(p[_]=p[_].toString(10)),typeof p[_]!="string")throw new Error("DBF Invalid column name "+p[_]+" |"+typeof p[_]+"|");if(p.indexOf(p[_])!==_){for(E=0;E<1024;++E)if(p.indexOf(p[_]+"_"+E)==-1){p[_]+="_"+E;break}}}}var N=yt(o["!ref"]),U=[],re=[],le=[];for(_=0;_<=N.e.c-N.s.c;++_){var w="",T="",y=0,I=[];for(E=0;E<g.length;++E)g[E][_]!=null&&I.push(g[E][_]);if(I.length==0||p[_]==null){U[_]="?";continue}for(E=0;E<I.length;++E){switch(typeof I[E]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=I[E]instanceof Date?"D":"C";break;default:T="C"}y=Math.max(y,String(I[E]).length),w=w&&w!=T?"C":T}y>250&&(y=250),T=((v[_]||{}).DBF||{}).type,T=="C"&&v[_].DBF.len>y&&(y=v[_].DBF.len),w=="B"&&T=="N"&&(w="N",le[_]=v[_].DBF.dec,y=v[_].DBF.len),re[_]=w=="C"||T=="N"?y:s[w]||0,V+=re[_],U[_]=w}var P=f.next(32);for(P.write_shift(4,318902576),P.write_shift(4,g.length),P.write_shift(2,296+32*L),P.write_shift(2,V),_=0;_<4;++_)P.write_shift(4,0);for(P.write_shift(4,0|(+e[vm]||3)<<8),_=0,E=0;_<p.length;++_)if(p[_]!=null){var k=f.next(32),R=(p[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);k.write_shift(1,R,"sbcs"),k.write_shift(1,U[_]=="?"?"C":U[_],"sbcs"),k.write_shift(4,E),k.write_shift(1,re[_]||s[U[_]]||0),k.write_shift(1,le[_]||0),k.write_shift(1,2),k.write_shift(4,0),k.write_shift(1,0),k.write_shift(4,0),k.write_shift(4,0),E+=re[_]||s[U[_]]||0}var We=f.next(264);for(We.write_shift(4,13),_=0;_<65;++_)We.write_shift(4,0);for(_=0;_<g.length;++_){var ke=f.next(V);for(ke.write_shift(1,0),E=0;E<p.length;++E)if(p[E]!=null)switch(U[E]){case"L":ke.write_shift(1,g[_][E]==null?63:g[_][E]?84:70);break;case"B":ke.write_shift(8,g[_][E]||0,"f");break;case"N":var Qe="0";for(typeof g[_][E]=="number"&&(Qe=g[_][E].toFixed(le[E]||0)),L=0;L<re[E]-Qe.length;++L)ke.write_shift(1,32);ke.write_shift(1,Qe,"sbcs");break;case"D":g[_][E]?(ke.write_shift(4,("0000"+g[_][E].getFullYear()).slice(-4),"sbcs"),ke.write_shift(2,("00"+(g[_][E].getMonth()+1)).slice(-2),"sbcs"),ke.write_shift(2,("00"+g[_][E].getDate()).slice(-2),"sbcs")):ke.write_shift(8,"00000000","sbcs");break;case"C":var Ne=String(g[_][E]!=null?g[_][E]:"").slice(0,re[E]);for(ke.write_shift(1,Ne,"sbcs"),L=0;L<re[E]-Ne.length;++L)ke.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),CI=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+ur(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,g){var v=t[g];return typeof v=="number"?kd(v):v},n=function(p,g,v){var _=g.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return _==59?p:kd(_)};t["|"]=254;function i(p,g){switch(g.type){case"base64":return s(Bn(p),g);case"binary":return s(p,g);case"buffer":return s(nt&&Buffer.isBuffer(p)?p.toString("binary"):ao(p),g);case"array":return s(Sc(p),g)}throw new Error("Unrecognized type "+g.type)}function s(p,g){var v=p.split(/[\n\r]+/),_=-1,E=-1,L=0,V=0,N=[],U=[],re=null,le={},w=[],T=[],y=[],I=0,P;for(+g.codepage>=0&&za(+g.codepage);L!==v.length;++L){I=0;var k=v[L].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),R=k.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),We=R[0],ke;if(k.length>0)switch(We){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":R[1].charAt(0)=="P"&&U.push(k.slice(3).replace(/;;/g,";"));break;case"C":var Qe=!1,Ne=!1,He=!1,it=!1,Dt=-1,At=-1;for(V=1;V<R.length;++V)switch(R[V].charAt(0)){case"A":break;case"X":E=parseInt(R[V].slice(1))-1,Ne=!0;break;case"Y":for(_=parseInt(R[V].slice(1))-1,Ne||(E=0),P=N.length;P<=_;++P)N[P]=[];break;case"K":ke=R[V].slice(1),ke.charAt(0)==='"'?ke=ke.slice(1,ke.length-1):ke==="TRUE"?ke=!0:ke==="FALSE"?ke=!1:isNaN(On(ke))?isNaN(qa(ke).getDate())||(ke=Ir(ke)):(ke=On(ke),re!==null&&Fm(re)&&(ke=km(ke))),Qe=!0;break;case"E":it=!0;var M=SC(R[V].slice(1),{r:_,c:E});N[_][E]=[N[_][E],M];break;case"S":He=!0,N[_][E]=[N[_][E],"S5S"];break;case"G":break;case"R":Dt=parseInt(R[V].slice(1))-1;break;case"C":At=parseInt(R[V].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+k)}if(Qe&&(N[_][E]&&N[_][E].length==2?N[_][E][0]=ke:N[_][E]=ke,re=null),He){if(it)throw new Error("SYLK shared formula cannot have own formula");var G=Dt>-1&&N[Dt][At];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");N[_][E][1]=IC(G[1],{r:_-Dt,c:E-At})}break;case"F":var W=0;for(V=1;V<R.length;++V)switch(R[V].charAt(0)){case"X":E=parseInt(R[V].slice(1))-1,++W;break;case"Y":for(_=parseInt(R[V].slice(1))-1,P=N.length;P<=_;++P)N[P]=[];break;case"M":I=parseInt(R[V].slice(1))/20;break;case"F":break;case"G":break;case"P":re=U[parseInt(R[V].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(y=R[V].slice(1).split(" "),P=parseInt(y[0],10);P<=parseInt(y[1],10);++P)I=parseInt(y[2],10),T[P-1]=I===0?{hidden:!0}:{wch:I},dh(T[P-1]);break;case"C":E=parseInt(R[V].slice(1))-1,T[E]||(T[E]={});break;case"R":_=parseInt(R[V].slice(1))-1,w[_]||(w[_]={}),I>0?(w[_].hpt=I,w[_].hpx=y_(I)):I===0&&(w[_].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+k)}W<1&&(re=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+k)}}return w.length>0&&(le["!rows"]=w),T.length>0&&(le["!cols"]=T),g&&g.sheetRows&&(N=N.slice(0,g.sheetRows)),[N,le]}function a(p,g){var v=i(p,g),_=v[0],E=v[1],L=Xs(_,g);return ur(E).forEach(function(V){L[V]=E[V]}),L}function o(p,g){return Xi(a(p,g),g)}function c(p,g,v,_){var E="C;Y"+(v+1)+";X"+(_+1)+";K";switch(p.t){case"n":E+=p.v||0,p.f&&!p.F&&(E+=";E"+gh(p.f,{r:v,c:_}));break;case"b":E+=p.v?"TRUE":"FALSE";break;case"e":E+=p.w||p.v;break;case"d":E+='"'+(p.w||p.v)+'"';break;case"s":E+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function u(p,g){g.forEach(function(v,_){var E="F;W"+(_+1)+" "+(_+1)+" ";v.hidden?E+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Bl(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=Ul(v.wpx)),typeof v.wch=="number"&&(E+=Math.round(v.wch))),E.charAt(E.length-1)!=" "&&p.push(E)})}function f(p,g){g.forEach(function(v,_){var E="F;";v.hidden?E+="M0;":v.hpt?E+="M"+20*v.hpt+";":v.hpx&&(E+="M"+20*Hl(v.hpx)+";"),E.length>2&&p.push(E+"R"+(_+1))})}function d(p,g){var v=["ID;PWXL;N;E"],_=[],E=yt(p["!ref"]),L,V=Array.isArray(p),N=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),p["!cols"]&&u(v,p["!cols"]),p["!rows"]&&f(v,p["!rows"]),v.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var U=E.s.r;U<=E.e.r;++U)for(var re=E.s.c;re<=E.e.c;++re){var le=dt({r:U,c:re});L=V?(p[U]||[])[re]:p[le],!(!L||L.v==null&&(!L.f||L.F))&&_.push(c(L,p,U,re))}return v.join(N)+N+_.join(N)+N+"E"+N}return{to_workbook:o,to_sheet:a,from_sheet:d}}(),RI=function(){function t(s,a){switch(a.type){case"base64":return e(Bn(s),a);case"binary":return e(s,a);case"buffer":return e(nt&&Buffer.isBuffer(s)?s.toString("binary"):ao(s),a);case"array":return e(Sc(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),c=-1,u=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++c]=[],u=0;continue}if(!(c<0)){var p=o[f].trim().split(","),g=p[0],v=p[1];++f;for(var _=o[f]||"";(_.match(/["]/g)||[]).length&1&&f<o.length-1;)_+=`
`+o[++f];switch(_=_.trim(),+g){case-1:if(_==="BOT"){d[++c]=[],u=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?d[c][u]=!0:_==="FALSE"?d[c][u]=!1:isNaN(On(v))?isNaN(qa(v).getDate())?d[c][u]=v:d[c][u]=Ir(v):d[c][u]=On(v),++u;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),d[c][u++]=_!==""?_:null;break}if(_==="EOD")break}}return a&&a.sheetRows&&(d=d.slice(0,a.sheetRows)),d}function r(s,a){return Xs(t(s,a),a)}function n(s,a){return Xi(r(s,a),a)}var i=function(){var s=function(c,u,f,d,p){c.push(u),c.push(f+","+d),c.push('"'+p.replace(/"/g,'""')+'"')},a=function(c,u,f,d){c.push(u+","+f),c.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(c){var u=[],f=yt(c["!ref"]),d,p=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,f.e.r-f.s.r+1,""),s(u,"TUPLES",0,f.e.c-f.s.c+1,""),s(u,"DATA",0,0,"");for(var g=f.s.r;g<=f.e.r;++g){a(u,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var _=dt({r:g,c:v});if(d=p?(c[g]||[])[v]:c[_],!d){a(u,1,0,"");continue}switch(d.t){case"n":var E=d.w;!E&&d.v!=null&&(E=d.v),E==null?d.f&&!d.F?a(u,1,0,"="+d.f):a(u,1,0,""):a(u,0,E,"V");break;case"b":a(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=xi(d.z||Rt[14],Or(Ir(d.v)))),a(u,0,d.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var L=`\r
`,V=u.join(L);return V}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),__=function(){function t(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,p){for(var g=d.split(`
`),v=-1,_=-1,E=0,L=[];E!==g.length;++E){var V=g[E].trim().split(":");if(V[0]==="cell"){var N=Qt(V[1]);if(L.length<=N.r)for(v=L.length;v<=N.r;++v)L[v]||(L[v]=[]);switch(v=N.r,_=N.c,V[2]){case"t":L[v][_]=t(V[3]);break;case"v":L[v][_]=+V[3];break;case"vtf":var U=V[V.length-1];case"vtc":switch(V[3]){case"nl":L[v][_]=!!+V[4];break;default:L[v][_]=+V[4];break}V[2]=="vtf"&&(L[v][_]=[L[v][_],U])}}}return p&&p.sheetRows&&(L=L.slice(0,p.sheetRows)),L}function n(d,p){return Xs(r(d,p),p)}function i(d,p){return Xi(n(d,p),p)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var p=[],g=[],v,_="",E=jr(d["!ref"]),L=Array.isArray(d),V=E.s.r;V<=E.e.r;++V)for(var N=E.s.c;N<=E.e.c;++N)if(_=dt({r:V,c:N}),v=L?(d[V]||[])[N]:d[_],!(!v||v.v==null||v.t==="z")){switch(g=["cell",_,"t"],v.t){case"s":case"str":g.push(e(v.v));break;case"n":v.f?(g[2]="vtf",g[3]="n",g[4]=v.v,g[5]=e(v.f)):(g[2]="v",g[3]=v.v);break;case"b":g[2]="vt"+(v.f?"f":"c"),g[3]="nl",g[4]=v.v?"1":"0",g[5]=e(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var U=Or(Ir(v.v));g[2]="vtc",g[3]="nd",g[4]=""+U,g[5]=v.w||xi(v.z||Rt[14],U);break;case"e":continue}p.push(g.join(":"))}return p.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function f(d){return[s,a,o,a,u(d),c].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),PI=function(){function t(f,d,p,g,v){v.raw?d[p][g]=f:f===""||(f==="TRUE"?d[p][g]=!0:f==="FALSE"?d[p][g]=!1:isNaN(On(f))?isNaN(qa(f).getDate())?d[p][g]=f:d[p][g]=Ir(f):d[p][g]=On(f))}function e(f,d){var p=d||{},g=[];if(!f||f.length===0)return g;for(var v=f.split(/[\r\n]/),_=v.length-1;_>=0&&v[_].length===0;)--_;for(var E=10,L=0,V=0;V<=_;++V)L=v[V].indexOf(" "),L==-1?L=v[V].length:L++,E=Math.max(E,L);for(V=0;V<=_;++V){g[V]=[];var N=0;for(t(v[V].slice(0,E).trim(),g,V,N,p),N=1;N<=(v[V].length-E)/10+1;++N)t(v[V].slice(E+(N-1)*10,E+N*10).trim(),g,V,N,p)}return p.sheetRows&&(g=g.slice(0,p.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var d={},p=!1,g=0,v=0;g<f.length;++g)(v=f.charCodeAt(g))==34?p=!p:!p&&v in r&&(d[v]=(d[v]||0)+1);v=[];for(g in d)Object.prototype.hasOwnProperty.call(d,g)&&v.push([d[g],g]);if(!v.length){d=n;for(g in d)Object.prototype.hasOwnProperty.call(d,g)&&v.push([d[g],g])}return v.sort(function(_,E){return _[0]-E[0]||n[_[1]]-n[E[1]]}),r[v.pop()[1]]||44}function s(f,d){var p=d||{},g="",v=p.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(g=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(g=f.charAt(4),f=f.slice(6)):g=i(f.slice(0,1024)):p&&p.FS?g=p.FS:g=i(f.slice(0,1024));var E=0,L=0,V=0,N=0,U=0,re=g.charCodeAt(0),le=!1,w=0,T=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var y=p.dateNF!=null?GS(p.dateNF):null;function I(){var P=f.slice(N,U),k={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)k.t="z";else if(p.raw)k.t="s",k.v=P;else if(P.trim().length===0)k.t="s",k.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(k.t="s",k.v=P.slice(2,-1).replace(/""/g,'"')):CC(P)?(k.t="n",k.f=P.slice(1)):(k.t="s",k.v=P);else if(P=="TRUE")k.t="b",k.v=!0;else if(P=="FALSE")k.t="b",k.v=!1;else if(!isNaN(V=On(P)))k.t="n",p.cellText!==!1&&(k.w=P),k.v=V;else if(!isNaN(qa(P).getDate())||y&&P.match(y)){k.z=p.dateNF||Rt[14];var R=0;y&&P.match(y)&&(P=zS(P,p.dateNF,P.match(y)||[]),R=1),p.cellDates?(k.t="d",k.v=Ir(P,R)):(k.t="n",k.v=Or(Ir(P,R))),p.cellText!==!1&&(k.w=xi(k.z,k.v instanceof Date?Or(k.v):k.v)),p.cellNF||delete k.z}else k.t="s",k.v=P;if(k.t=="z"||(p.dense?(v[E]||(v[E]=[]),v[E][L]=k):v[dt({c:L,r:E})]=k),N=U+1,T=f.charCodeAt(N),_.e.c<L&&(_.e.c=L),_.e.r<E&&(_.e.r=E),w==re)++L;else if(L=0,++E,p.sheetRows&&p.sheetRows<=E)return!0}e:for(;U<f.length;++U)switch(w=f.charCodeAt(U)){case 34:T===34&&(le=!le);break;case re:case 10:case 13:if(!le&&I())break e;break}return U-N>0&&I(),v["!ref"]=Lt(_),v}function a(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,d):Xs(e(f,d),d)}function o(f,d){var p="",g=d.type=="string"?[0,0,0,0]:HF(f,d);switch(d.type){case"base64":p=Bn(f);break;case"binary":p=f;break;case"buffer":d.codepage==65001?p=f.toString("utf8"):d.codepage&&typeof Fl<"u"||(p=nt&&Buffer.isBuffer(f)?f.toString("binary"):ao(f));break;case"array":p=Sc(f);break;case"string":p=f;break;default:throw new Error("Unrecognized type "+d.type)}return g[0]==239&&g[1]==187&&g[2]==191?p=Ra(p.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?p=Ra(p):d.type=="binary"&&typeof Fl<"u",p.slice(0,19)=="socialcalc:version:"?__.to_sheet(d.type=="string"?p:Ra(p),d):a(p,d)}function c(f,d){return Xi(o(f,d),d)}function u(f){for(var d=[],p=yt(f["!ref"]),g,v=Array.isArray(f),_=p.s.r;_<=p.e.r;++_){for(var E=[],L=p.s.c;L<=p.e.c;++L){var V=dt({r:_,c:L});if(g=v?(f[_]||[])[L]:f[V],!g||g.v==null){E.push("          ");continue}for(var N=(g.w||(Un(g),g.w)||"").slice(0,10);N.length<10;)N+=" ";E.push(N+(L===0?" ":""))}d.push(E.join(""))}return d.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}(),fp=function(){function t(M,G,W){if(M){Vr(M,M.l||0);for(var H=W.Enum||Dt;M.l<M.length;){var ne=M.read_shift(2),Ae=H[ne]||H[65535],Re=M.read_shift(2),Ce=M.l+Re,me=Ae.f&&Ae.f(M,Re,W);if(M.l=Ce,G(me,Ae,ne))return}}}function e(M,G){switch(G.type){case"base64":return r(en(Bn(M)),G);case"binary":return r(en(M),G);case"buffer":case"array":return r(M,G)}throw"Unsupported type "+G.type}function r(M,G){if(!M)return M;var W=G||{},H=W.dense?[]:{},ne="Sheet1",Ae="",Re=0,Ce={},me=[],et=[],b={s:{r:0,c:0},e:{r:0,c:0}},B=W.sheetRows||0;if(M[2]==0&&(M[3]==8||M[3]==9)&&M.length>=16&&M[14]==5&&M[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(M[2]==2)W.Enum=Dt,t(M,function(z,pe,he){switch(he){case 0:W.vers=z,z>=4096&&(W.qpro=!0);break;case 6:b=z;break;case 204:z&&(Ae=z);break;case 222:Ae=z;break;case 15:case 51:W.qpro||(z[1].v=z[1].v.slice(1));case 13:case 14:case 16:he==14&&(z[2]&112)==112&&(z[2]&15)>1&&(z[2]&15)<15&&(z[1].z=W.dateNF||Rt[14],W.cellDates&&(z[1].t="d",z[1].v=km(z[1].v))),W.qpro&&z[3]>Re&&(H["!ref"]=Lt(b),Ce[ne]=H,me.push(ne),H=W.dense?[]:{},b={s:{r:0,c:0},e:{r:0,c:0}},Re=z[3],ne=Ae||"Sheet"+(Re+1),Ae="");var fe=W.dense?(H[z[0].r]||[])[z[0].c]:H[dt(z[0])];if(fe){fe.t=z[1].t,fe.v=z[1].v,z[1].z!=null&&(fe.z=z[1].z),z[1].f!=null&&(fe.f=z[1].f);break}W.dense?(H[z[0].r]||(H[z[0].r]=[]),H[z[0].r][z[0].c]=z[1]):H[dt(z[0])]=z[1];break}},W);else if(M[2]==26||M[2]==14)W.Enum=At,M[2]==14&&(W.qpro=!0,M.l=0),t(M,function(z,pe,he){switch(he){case 204:ne=z;break;case 22:z[1].v=z[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(z[3]>Re&&(H["!ref"]=Lt(b),Ce[ne]=H,me.push(ne),H=W.dense?[]:{},b={s:{r:0,c:0},e:{r:0,c:0}},Re=z[3],ne="Sheet"+(Re+1)),B>0&&z[0].r>=B)break;W.dense?(H[z[0].r]||(H[z[0].r]=[]),H[z[0].r][z[0].c]=z[1]):H[dt(z[0])]=z[1],b.e.c<z[0].c&&(b.e.c=z[0].c),b.e.r<z[0].r&&(b.e.r=z[0].r);break;case 27:z[14e3]&&(et[z[14e3][0]]=z[14e3][1]);break;case 1537:et[z[0]]=z[1],z[0]==Re&&(ne=z[1]);break}},W);else throw new Error("Unrecognized LOTUS BOF "+M[2]);if(H["!ref"]=Lt(b),Ce[Ae||ne]=H,me.push(Ae||ne),!et.length)return{SheetNames:me,Sheets:Ce};for(var K={},ae=[],te=0;te<et.length;++te)Ce[me[te]]?(ae.push(et[te]||me[te]),K[et[te]]=Ce[et[te]]||Ce[me[te]]):(ae.push(et[te]),K[et[te]]={"!ref":"A1"});return{SheetNames:ae,Sheets:K}}function n(M,G){var W=G||{};if(+W.codepage>=0&&za(+W.codepage),W.type=="string")throw new Error("Cannot write WK1 to JS string");var H=Dr(),ne=yt(M["!ref"]),Ae=Array.isArray(M),Re=[];_e(H,0,s(1030)),_e(H,6,c(ne));for(var Ce=Math.min(ne.e.r,8191),me=ne.s.r;me<=Ce;++me)for(var et=lr(me),b=ne.s.c;b<=ne.e.c;++b){me===ne.s.r&&(Re[b]=_r(b));var B=Re[b]+et,K=Ae?(M[me]||[])[b]:M[B];if(!(!K||K.t=="z"))if(K.t=="n")(K.v|0)==K.v&&K.v>=-32768&&K.v<=32767?_e(H,13,g(me,b,K.v)):_e(H,14,_(me,b,K.v));else{var ae=Un(K);_e(H,15,d(me,b,ae.slice(0,239)))}}return _e(H,1),H.end()}function i(M,G){var W=G||{};if(+W.codepage>=0&&za(+W.codepage),W.type=="string")throw new Error("Cannot write WK3 to JS string");var H=Dr();_e(H,0,a(M));for(var ne=0,Ae=0;ne<M.SheetNames.length;++ne)(M.Sheets[M.SheetNames[ne]]||{})["!ref"]&&_e(H,27,it(M.SheetNames[ne],Ae++));var Re=0;for(ne=0;ne<M.SheetNames.length;++ne){var Ce=M.Sheets[M.SheetNames[ne]];if(!(!Ce||!Ce["!ref"])){for(var me=yt(Ce["!ref"]),et=Array.isArray(Ce),b=[],B=Math.min(me.e.r,8191),K=me.s.r;K<=B;++K)for(var ae=lr(K),te=me.s.c;te<=me.e.c;++te){K===me.s.r&&(b[te]=_r(te));var z=b[te]+ae,pe=et?(Ce[K]||[])[te]:Ce[z];if(!(!pe||pe.t=="z"))if(pe.t=="n")_e(H,23,I(K,te,Re,pe.v));else{var he=Un(pe);_e(H,22,w(K,te,Re,he.slice(0,239)))}}++Re}}return _e(H,1),H.end()}function s(M){var G=ee(2);return G.write_shift(2,M),G}function a(M){var G=ee(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var W=0,H=0,ne=0,Ae=0;Ae<M.SheetNames.length;++Ae){var Re=M.SheetNames[Ae],Ce=M.Sheets[Re];if(!(!Ce||!Ce["!ref"])){++ne;var me=jr(Ce["!ref"]);W<me.e.r&&(W=me.e.r),H<me.e.c&&(H=me.e.c)}}return W>8191&&(W=8191),G.write_shift(2,W),G.write_shift(1,ne),G.write_shift(1,H),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function o(M,G,W){var H={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&W.qpro?(H.s.c=M.read_shift(1),M.l++,H.s.r=M.read_shift(2),H.e.c=M.read_shift(1),M.l++,H.e.r=M.read_shift(2),H):(H.s.c=M.read_shift(2),H.s.r=M.read_shift(2),G==12&&W.qpro&&(M.l+=2),H.e.c=M.read_shift(2),H.e.r=M.read_shift(2),G==12&&W.qpro&&(M.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function c(M){var G=ee(8);return G.write_shift(2,M.s.c),G.write_shift(2,M.s.r),G.write_shift(2,M.e.c),G.write_shift(2,M.e.r),G}function u(M,G,W){var H=[{c:0,r:0},{t:"n",v:0},0,0];return W.qpro&&W.vers!=20768?(H[0].c=M.read_shift(1),H[3]=M.read_shift(1),H[0].r=M.read_shift(2),M.l+=2):(H[2]=M.read_shift(1),H[0].c=M.read_shift(2),H[0].r=M.read_shift(2)),H}function f(M,G,W){var H=M.l+G,ne=u(M,G,W);if(ne[1].t="s",W.vers==20768){M.l++;var Ae=M.read_shift(1);return ne[1].v=M.read_shift(Ae,"utf8"),ne}return W.qpro&&M.l++,ne[1].v=M.read_shift(H-M.l,"cstr"),ne}function d(M,G,W){var H=ee(7+W.length);H.write_shift(1,255),H.write_shift(2,G),H.write_shift(2,M),H.write_shift(1,39);for(var ne=0;ne<H.length;++ne){var Ae=W.charCodeAt(ne);H.write_shift(1,Ae>=128?95:Ae)}return H.write_shift(1,0),H}function p(M,G,W){var H=u(M,G,W);return H[1].v=M.read_shift(2,"i"),H}function g(M,G,W){var H=ee(7);return H.write_shift(1,255),H.write_shift(2,G),H.write_shift(2,M),H.write_shift(2,W,"i"),H}function v(M,G,W){var H=u(M,G,W);return H[1].v=M.read_shift(8,"f"),H}function _(M,G,W){var H=ee(13);return H.write_shift(1,255),H.write_shift(2,G),H.write_shift(2,M),H.write_shift(8,W,"f"),H}function E(M,G,W){var H=M.l+G,ne=u(M,G,W);if(ne[1].v=M.read_shift(8,"f"),W.qpro)M.l=H;else{var Ae=M.read_shift(2);U(M.slice(M.l,M.l+Ae),ne),M.l+=Ae}return ne}function L(M,G,W){var H=G&32768;return G&=-32769,G=(H?M:0)+(G>=8192?G-16384:G),(H?"":"$")+(W?_r(G):lr(G))}var V={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function U(M,G){Vr(M,0);for(var W=[],H=0,ne="",Ae="",Re="",Ce="";M.l<M.length;){var me=M[M.l++];switch(me){case 0:W.push(M.read_shift(8,"f"));break;case 1:Ae=L(G[0].c,M.read_shift(2),!0),ne=L(G[0].r,M.read_shift(2),!1),W.push(Ae+ne);break;case 2:{var et=L(G[0].c,M.read_shift(2),!0),b=L(G[0].r,M.read_shift(2),!1);Ae=L(G[0].c,M.read_shift(2),!0),ne=L(G[0].r,M.read_shift(2),!1),W.push(et+b+":"+Ae+ne)}break;case 3:if(M.l<M.length){console.error("WK1 premature formula end");return}break;case 4:W.push("("+W.pop()+")");break;case 5:W.push(M.read_shift(2));break;case 6:{for(var B="";me=M[M.l++];)B+=String.fromCharCode(me);W.push('"'+B.replace(/"/g,'""')+'"')}break;case 8:W.push("-"+W.pop());break;case 23:W.push("+"+W.pop());break;case 22:W.push("NOT("+W.pop()+")");break;case 20:case 21:Ce=W.pop(),Re=W.pop(),W.push(["AND","OR"][me-20]+"("+Re+","+Ce+")");break;default:if(me<32&&N[me])Ce=W.pop(),Re=W.pop(),W.push(Re+N[me]+Ce);else if(V[me]){if(H=V[me][1],H==69&&(H=M[M.l++]),H>W.length){console.error("WK1 bad formula parse 0x"+me.toString(16)+":|"+W.join("|")+"|");return}var K=W.slice(-H);W.length-=H,W.push(V[me][0]+"("+K.join(",")+")")}else return me<=7?console.error("WK1 invalid opcode "+me.toString(16)):me<=24?console.error("WK1 unsupported op "+me.toString(16)):me<=30?console.error("WK1 invalid opcode "+me.toString(16)):me<=115?console.error("WK1 unsupported function opcode "+me.toString(16)):console.error("WK1 unrecognized opcode "+me.toString(16))}}W.length==1?G[1].f=""+W[0]:console.error("WK1 bad formula parse |"+W.join("|")+"|")}function re(M){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=M.read_shift(2),G[3]=M[M.l++],G[0].c=M[M.l++],G}function le(M,G){var W=re(M);return W[1].t="s",W[1].v=M.read_shift(G-4,"cstr"),W}function w(M,G,W,H){var ne=ee(6+H.length);ne.write_shift(2,M),ne.write_shift(1,W),ne.write_shift(1,G),ne.write_shift(1,39);for(var Ae=0;Ae<H.length;++Ae){var Re=H.charCodeAt(Ae);ne.write_shift(1,Re>=128?95:Re)}return ne.write_shift(1,0),ne}function T(M,G){var W=re(M);W[1].v=M.read_shift(2);var H=W[1].v>>1;if(W[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return W[1].v=H,W}function y(M,G){var W=re(M),H=M.read_shift(4),ne=M.read_shift(4),Ae=M.read_shift(2);if(Ae==65535)return H===0&&ne===3221225472?(W[1].t="e",W[1].v=15):H===0&&ne===3489660928?(W[1].t="e",W[1].v=42):W[1].v=0,W;var Re=Ae&32768;return Ae=(Ae&32767)-16446,W[1].v=(1-Re*2)*(ne*Math.pow(2,Ae+32)+H*Math.pow(2,Ae)),W}function I(M,G,W,H){var ne=ee(14);if(ne.write_shift(2,M),ne.write_shift(1,W),ne.write_shift(1,G),H==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var Ae=0,Re=0,Ce=0,me=0;return H<0&&(Ae=1,H=-H),Re=Math.log2(H)|0,H/=Math.pow(2,Re-31),me=H>>>0,(me&2147483648)==0&&(H/=2,++Re,me=H>>>0),H-=me,me|=2147483648,me>>>=0,H*=Math.pow(2,32),Ce=H>>>0,ne.write_shift(4,Ce),ne.write_shift(4,me),Re+=16383+(Ae?32768:0),ne.write_shift(2,Re),ne}function P(M,G){var W=y(M);return M.l+=G-14,W}function k(M,G){var W=re(M),H=M.read_shift(4);return W[1].v=H>>6,W}function R(M,G){var W=re(M),H=M.read_shift(8,"f");return W[1].v=H,W}function We(M,G){var W=R(M);return M.l+=G-10,W}function ke(M,G){return M[M.l+G-1]==0?M.read_shift(G,"cstr"):""}function Qe(M,G){var W=M[M.l++];W>G-1&&(W=G-1);for(var H="";H.length<W;)H+=String.fromCharCode(M[M.l++]);return H}function Ne(M,G,W){if(!(!W.qpro||G<21)){var H=M.read_shift(1);M.l+=17,M.l+=1,M.l+=2;var ne=M.read_shift(G-21,"cstr");return[H,ne]}}function He(M,G){for(var W={},H=M.l+G;M.l<H;){var ne=M.read_shift(2);if(ne==14e3){for(W[ne]=[0,""],W[ne][0]=M.read_shift(2);M[M.l];)W[ne][1]+=String.fromCharCode(M[M.l]),M.l++;M.l++}}return W}function it(M,G){var W=ee(5+M.length);W.write_shift(2,14e3),W.write_shift(2,G);for(var H=0;H<M.length;++H){var ne=M.charCodeAt(H);W[W.l++]=ne>127?95:ne}return W[W.l++]=0,W}var Dt={0:{n:"BOF",f:h_},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ke},222:{n:"SHEETNAMELP",f:Qe},65535:{n:""}},At={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:le},23:{n:"NUMBER17",f:y},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:He},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:k},38:{n:"??"},39:{n:"NUMBER27",f:R},40:{n:"FORMULA28",f:We},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ke},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}(),FI=/^\s|\s$|[\t\n\r]/;function v_(t,e){if(!e.bookSST)return"";var r=[Vt];r[r.length]=ge("sst",null,{xmlns:qs[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(FI)&&(s+=' xml:space="preserve"'),s+=">"+ht(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function DI(t){return[t.read_shift(4),t.read_shift(4)]}function OI(t,e){return e||(e=ee(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var bI=w4;function kI(t){var e=Dr();se(e,159,OI(t));for(var r=0;r<t.length;++r)se(e,19,bI(t[r]));return se(e,160),e.end()}function NI(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function x_(t){var e=0,r,n=NI(t),i=n.length+1,s,a,o,c,u;for(r=ji(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=(e&16384)===0?0:1,c=e<<1&32767,u=o|c,e=u^a;return e^52811}var LI=function(){function t(i,s){switch(s.type){case"base64":return e(Bn(i),s);case"binary":return e(i,s);case"buffer":return e(nt&&Buffer.isBuffer(i)?i.toString("binary"):ao(i),s);case"array":return e(Sc(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var p=/\\\w+\b/g,g=0,v,_=-1;v=p.exec(f);){switch(v[0]){case"\\cell":var E=f.slice(g,p.lastIndex-v[0].length);if(E[0]==" "&&(E=E.slice(1)),++_,E.length){var L={v:E,t:"s"};Array.isArray(o)?o[d][_]=L:o[dt({r:d,c:_})]=L}break}g=p.lastIndex}_>u.e.c&&(u.e.c=_)}),o["!ref"]=Lt(u),o}function r(i,s){return Xi(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=yt(i["!ref"]),o,c=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var d=dt({r:u,c:f});o=c?(i[u]||[])[f]:i[d],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Un(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function hp(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}var MI=6,bn=MI;function Bl(t){return Math.floor((t+Math.round(128/bn)/256)*bn)}function Ul(t){return Math.floor((t-5)/bn*100+.5)/100}function Ku(t){return Math.round((t*bn+5)/bn*256)/256}function dh(t){t.width?(t.wpx=Bl(t.width),t.wch=Ul(t.wpx),t.MDW=bn):t.wpx?(t.wch=Ul(t.wpx),t.width=Ku(t.wch),t.MDW=bn):typeof t.wch=="number"&&(t.width=Ku(t.wch),t.wpx=Bl(t.width),t.MDW=bn),t.customWidth&&delete t.customWidth}var VI=96,E_=VI;function Hl(t){return t*96/E_}function y_(t){return t*E_/96}function BI(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=ge("numFmt",null,{numFmtId:n,formatCode:ht(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=ge("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function UI(t){var e=[];return e[e.length]=ge("cellXfs",null),t.forEach(function(r){e[e.length]=ge("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=ge("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function T_(t,e){var r=[Vt,ge("styleSheet",null,{xmlns:qs[0],"xmlns:vt":Yt.vt})],n;return t.SSF&&(n=BI(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=UI(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function HI(t,e){var r=t.read_shift(2),n=vr(t);return[r,n]}function $I(t,e,r){r||(r=ee(6+4*e.length)),r.write_shift(2,t),Jt(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function WI(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=F4(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=P4(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=vr(t),n}function jI(t,e){e||(e=ee(25+4*32)),e.write_shift(2,t.sz*20),D4(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Ml(t.color,e);var n=0;return n=2,e.write_shift(1,n),Jt(t.name,e),e.length>e.l?e.slice(0,e.l):e}var GI=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],su,zI=yn;function dp(t,e){e||(e=ee(4*3+8*7+16*1)),su||(su=th(GI));var r=su[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Ml({auto:1},e),Ml({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function KI(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function w_(t,e,r){r||(r=ee(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ua(t,e){return e||(e=ee(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var qI=yn;function XI(t,e){return e||(e=ee(51)),e.write_shift(1,0),ua(null,e),ua(null,e),ua(null,e),ua(null,e),ua(null,e),e.length>e.l?e.slice(0,e.l):e}function YI(t,e){return e||(e=ee(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Ll(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function QI(t,e,r){var n=ee(2052);return n.write_shift(4,t),Ll(e,n),Ll(r,n),n.length>n.l?n.slice(0,n.l):n}function JI(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(se(t,615,sn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&se(t,44,$I(i,e[i]))}),se(t,616))}}function ZI(t){var e=1;se(t,611,sn(e)),se(t,43,jI({sz:12,color:{theme:1},name:"Calibri",family:2})),se(t,612)}function eC(t){var e=2;se(t,603,sn(e)),se(t,45,dp({patternType:"none"})),se(t,45,dp({patternType:"gray125"})),se(t,604)}function tC(t){var e=1;se(t,613,sn(e)),se(t,46,XI()),se(t,614)}function rC(t){var e=1;se(t,626,sn(e)),se(t,47,w_({numFmtId:0},65535)),se(t,627)}function nC(t,e){se(t,617,sn(e.length)),e.forEach(function(r){se(t,47,w_(r,0))}),se(t,618)}function iC(t){var e=1;se(t,619,sn(e)),se(t,48,YI({xfId:0,name:"Normal"})),se(t,620)}function sC(t){var e=0;se(t,505,sn(e)),se(t,506)}function aC(t){var e=0;se(t,508,QI(e,"TableStyleMedium9","PivotStyleMedium4")),se(t,509)}function oC(t,e){var r=Dr();return se(r,278),JI(r,t.SSF),ZI(r),eC(r),tC(r),rC(r),nC(r,e.cellXfs),iC(r),sC(r),aC(r),se(r,279),r.end()}function A_(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Vt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function lC(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:vr(t)}}function cC(t){var e=ee(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Jt(t.name,e),e.slice(0,e.l)}function uC(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function fC(t){var e=ee(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function hC(t,e){var r=ee(8+2*e.length);return r.write_shift(4,t),Jt(e,r),r.slice(0,r.l)}function dC(t){return t.l+=4,t.read_shift(4)!=0}function pC(t,e){var r=ee(8);return r.write_shift(4,t),r.write_shift(4,1),r}function gC(){var t=Dr();return se(t,332),se(t,334,sn(1)),se(t,335,cC({name:"XLDAPR",version:12e4,flags:3496657072})),se(t,336),se(t,339,hC(1,"XLDAPR")),se(t,52),se(t,35,sn(514)),se(t,4096,sn(0)),se(t,4097,zr(1)),se(t,36),se(t,53),se(t,340),se(t,337,pC(1)),se(t,51,fC([[1,0]])),se(t,338),se(t,333),t.end()}function S_(){var t=[Vt];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function mC(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=dt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}var xs=1024;function I_(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[ge("xml",null,{"xmlns:v":Br.v,"xmlns:o":Br.o,"xmlns:x":Br.x,"xmlns:mv":Br.mv}).replace(/\/>/,">"),ge("o:shapelayout",ge("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),ge("v:shapetype",[ge("v:stroke",null,{joinstyle:"miter"}),ge("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];xs<t*1e3;)xs+=1e3;return e.forEach(function(s){var a=Qt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?ge("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=ge("v:fill",c,o),f={on:"t",obscured:"t"};++xs,i=i.concat(["<v:shape"+Ya({id:"_x0000_s"+xs,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,ge("v:shadow",null,f),ge("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",or("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),or("x:AutoFill","False"),or("x:Row",String(a.r)),or("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function C_(t){var e=[Vt,ge("comments",null,{xmlns:qs[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=ht(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(i=r.indexOf(ht(c.a))),s.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(or("t",ht(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(or("t",ht(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function _C(t,e,r){var n=[Vt,ge("ThreadedComments",null,{xmlns:Yt.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var c={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=c.id:c.parentId=s,a.ID=c.id,a.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(ge("threadedComment",or("text",a.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function vC(t){var e=[Vt,ge("personList",null,{xmlns:Yt.TCMNT,"xmlns:x":qs[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(ge("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function xC(t){var e={};e.iauthor=t.read_shift(4);var r=Zi(t);return e.rfx=r.s,e.ref=dt(r.s),t.l+=16,e}function EC(t,e){return e==null&&(e=ee(36)),e.write_shift(4,t[1].iauthor),Ys(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var yC=vr;function TC(t){return Jt(t.slice(0,54))}function wC(t){var e=Dr(),r=[];return se(e,628),se(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),se(e,632,TC(i.a)))})}),se(e,631),se(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Qt(n[0]),e:Qt(n[0])};se(e,635,EC([s,i])),i.t&&i.t.length>0&&se(e,637,S4(i)),se(e,636),delete i.iauthor})}),se(e,634),se(e,629),e.end()}function AC(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&pt.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var R_=["xlsb","xlsm","xlam","biff8","xla"],SC=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=e.c:--f,c?u+=e.r:--u,i+(o?"":"$")+_r(f)+(c?"":"$")+lr(u)}return function(i,s){return e=s,i.replace(t,r)}}(),ph=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,gh=function(){return function(e,r){return e.replace(ph,function(n,i,s,a,o,c){var u=lh(a)-(s?0:r.c),f=oh(c)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",p=u==0?"":s?u+1:"["+u+"]";return i+"R"+d+"C"+p})}}();function IC(t,e){return t.replace(ph,function(r,n,i,s,a,o){return n+(i=="$"?i+s:_r(lh(s)+e.c))+(a=="$"?a+o:lr(oh(o)+e.r))})}function CC(t){return t.length!=1}function kt(t){t.l+=1}function Ei(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function P_(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return F_(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=Ei(t),o=Ei(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function F_(t){var e=Ei(t),r=Ei(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function RC(t,e,r){if(r.biff<8)return F_(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=Ei(t),a=Ei(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function D_(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return PC(t);var n=t.read_shift(r&&r.biff==12?4:2),i=Ei(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function PC(t){var e=Ei(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function FC(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function DC(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return OC(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function OC(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function bC(t,e,r){var n=(t[t.l++]&96)>>5,i=P_(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function kC(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=P_(t,s,r);return[n,i,a]}function NC(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function LC(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function MC(t,e,r){var n=(t[t.l++]&96)>>5,i=RC(t,e-1,r);return[n,i]}function VC(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function pp(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function BC(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function UC(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function HC(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function $C(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function WC(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function O_(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function jC(t){return t.read_shift(2),O_(t)}function GC(t){return t.read_shift(2),O_(t)}function zC(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=D_(t,0,r);return[n,i]}function KC(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=DC(t,0,r);return[n,i]}function qC(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=D_(t,0,r);return[n,i,s]}function XC(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[XR[i],N_[i],n]}function YC(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:QC(t);return[i,(s[0]===0?N_:qR)[s[1]]]}function QC(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function JC(t,e,r){t.l+=r&&r.biff==2?3:4}function ZC(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function eR(t){return t.l++,co[t.read_shift(1)]}function tR(t){return t.l++,t.read_shift(2)}function rR(t){return t.l++,t.read_shift(1)!==0}function nR(t){return t.l++,Qs(t)}function iR(t,e,r){return t.l++,p_(t,e-1,r)}function sR(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=q4(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=co[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Qs(t);break;case 2:r[1]=J4(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function aR(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Zi:tI)(t));return i}function oR(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=sR(t,r.biff);return a}function lR(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function cR(t,e,r){if(r.biff==5)return uR(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function uR(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function fR(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function hR(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function dR(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function pR(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var gR=yn,mR=yn,_R=yn;function uo(t,e,r){return t.l+=2,[FC(t)]}function mh(t){return t.l+=6,[]}var vR=uo,xR=mh,ER=mh,yR=uo;function b_(t){return t.l+=2,[h_(t),t.read_shift(2)&1]}var TR=uo,wR=b_,AR=mh,SR=uo,IR=uo,CR=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function RR(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=CR[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function PR(t){return t.l+=2,[t.read_shift(4)]}function FR(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function DR(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function OR(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function bR(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function kR(t){return t.l+=4,[0,0]}var gp={1:{n:"PtgExp",f:ZC},2:{n:"PtgTbl",f:_R},3:{n:"PtgAdd",f:kt},4:{n:"PtgSub",f:kt},5:{n:"PtgMul",f:kt},6:{n:"PtgDiv",f:kt},7:{n:"PtgPower",f:kt},8:{n:"PtgConcat",f:kt},9:{n:"PtgLt",f:kt},10:{n:"PtgLe",f:kt},11:{n:"PtgEq",f:kt},12:{n:"PtgGe",f:kt},13:{n:"PtgGt",f:kt},14:{n:"PtgNe",f:kt},15:{n:"PtgIsect",f:kt},16:{n:"PtgUnion",f:kt},17:{n:"PtgRange",f:kt},18:{n:"PtgUplus",f:kt},19:{n:"PtgUminus",f:kt},20:{n:"PtgPercent",f:kt},21:{n:"PtgParen",f:kt},22:{n:"PtgMissArg",f:kt},23:{n:"PtgStr",f:iR},26:{n:"PtgSheet",f:FR},27:{n:"PtgEndSheet",f:DR},28:{n:"PtgErr",f:eR},29:{n:"PtgBool",f:rR},30:{n:"PtgInt",f:tR},31:{n:"PtgNum",f:nR},32:{n:"PtgArray",f:VC},33:{n:"PtgFunc",f:XC},34:{n:"PtgFuncVar",f:YC},35:{n:"PtgName",f:lR},36:{n:"PtgRef",f:zC},37:{n:"PtgArea",f:bC},38:{n:"PtgMemArea",f:fR},39:{n:"PtgMemErr",f:gR},40:{n:"PtgMemNoMem",f:mR},41:{n:"PtgMemFunc",f:hR},42:{n:"PtgRefErr",f:dR},43:{n:"PtgAreaErr",f:NC},44:{n:"PtgRefN",f:KC},45:{n:"PtgAreaN",f:MC},46:{n:"PtgMemAreaN",f:OR},47:{n:"PtgMemNoMemN",f:bR},57:{n:"PtgNameX",f:cR},58:{n:"PtgRef3d",f:qC},59:{n:"PtgArea3d",f:kC},60:{n:"PtgRefErr3d",f:pR},61:{n:"PtgAreaErr3d",f:LC},255:{}},NR={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},LR={1:{n:"PtgElfLel",f:b_},2:{n:"PtgElfRw",f:SR},3:{n:"PtgElfCol",f:vR},6:{n:"PtgElfRwV",f:IR},7:{n:"PtgElfColV",f:yR},10:{n:"PtgElfRadical",f:TR},11:{n:"PtgElfRadicalS",f:AR},13:{n:"PtgElfColS",f:xR},15:{n:"PtgElfColSV",f:ER},16:{n:"PtgElfRadicalLel",f:wR},25:{n:"PtgList",f:RR},29:{n:"PtgSxName",f:PR},255:{}},MR={0:{n:"PtgAttrNoop",f:kR},1:{n:"PtgAttrSemi",f:WC},2:{n:"PtgAttrIf",f:HC},4:{n:"PtgAttrChoose",f:BC},8:{n:"PtgAttrGoto",f:UC},16:{n:"PtgAttrSum",f:JC},32:{n:"PtgAttrBaxcel",f:pp},33:{n:"PtgAttrBaxcel",f:pp},64:{n:"PtgAttrSpace",f:jC},65:{n:"PtgAttrSpaceSemi",f:GC},128:{n:"PtgAttrIfError",f:$C},255:{}};function VR(t,e,r,n){if(n.biff<8)return yn(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=oR(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=aR(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(yn(t,e)),s}function BR(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=gp[s]||gp[NR[s]],(s===24||s===25)&&(i=(s===24?LR:MR)[t[t.l+1]]),!i||!i.f?yn(t,e):a.push([i.n,i.f(t,e,r)]);return a}function UR(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var HR={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function $R(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function k_(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function mp(t,e,r){var n=k_(t,e,r);return n=="#REF"?n:$R(n,r)}function $s(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],c,u,f,d=0,p=0,g,v="";if(!t[0]||!t[0][0])return"";for(var _=-1,E="",L=0,V=t[0].length;L<V;++L){var N=t[0][L];switch(N[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),_>=0){switch(t[0][_][1][0]){case 0:E=Ct(" ",t[0][_][1][1]);break;case 1:E=Ct("\r",t[0][_][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][_][1][0])}u=u+E,_=-1}o.push(u+HR[N[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Fa(N[1][1],a,i),o.push(Da(f,s));break;case"PtgRefN":f=r?Fa(N[1][1],r,i):N[1][1],o.push(Da(f,s));break;case"PtgRef3d":d=N[1][1],f=Fa(N[1][2],a,i),v=mp(n,d,i),o.push(v+"!"+Da(f,s));break;case"PtgFunc":case"PtgFuncVar":var U=N[1][0],re=N[1][1];U||(U=0),U&=127;var le=U==0?[]:o.slice(-U);o.length-=U,re==="User"&&(re=le.shift()),o.push(re+"("+le.join(",")+")");break;case"PtgBool":o.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(N[1]);break;case"PtgNum":o.push(String(N[1]));break;case"PtgStr":o.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(N[1]);break;case"PtgAreaN":g=ep(N[1][1],r?{s:r}:a,i),o.push(nu(g,i));break;case"PtgArea":g=ep(N[1][1],a,i),o.push(nu(g,i));break;case"PtgArea3d":d=N[1][1],g=N[1][2],v=mp(n,d,i),o.push(v+"!"+nu(g,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=N[1][2];var w=(n.names||[])[p-1]||(n[0]||[])[p],T=w?w.Name:"SH33TJSNAME"+String(p);T&&T.slice(0,6)=="_xlfn."&&!i.xlfn&&(T=T.slice(6)),o.push(T);break;case"PtgNameX":var y=N[1][1];p=N[1][2];var I;if(i.biff<=5)y<0&&(y=-y),n[y]&&(I=n[y][p]);else{var P="";if(((n[y]||[])[0]||[])[0]==14849||(((n[y]||[])[0]||[])[0]==1025?n[y][p]&&n[y][p].itab>0&&(P=n.SheetNames[n[y][p].itab-1]+"!"):P=n.SheetNames[p-1]+"!"),n[y]&&n[y][p])P+=n[y][p].Name;else if(n[0]&&n[0][p])P+=n[0][p].Name;else{var k=(k_(n,y,i)||"").split(";;");k[p-1]?P=k[p-1]:P+="SH33TJSERRX"}o.push(P);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var R="(",We=")";if(_>=0){switch(E="",t[0][_][1][0]){case 2:R=Ct(" ",t[0][_][1][1])+R;break;case 3:R=Ct("\r",t[0][_][1][1])+R;break;case 4:We=Ct(" ",t[0][_][1][1])+We;break;case 5:We=Ct("\r",t[0][_][1][1])+We;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][_][1][0])}_=-1}o.push(R+o.pop()+We);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:N[1][1],r:N[1][0]};var ke={c:r.c,r:r.r};if(n.sharedf[dt(f)]){var Qe=n.sharedf[dt(f)];o.push($s(Qe,a,ke,n,i))}else{var Ne=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push($s(u[1],a,ke,n,i)),Ne=!0;break}Ne||o.push(N[1])}break;case"PtgArray":o.push("{"+UR(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=L;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var He=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&_>=0&&He.indexOf(t[0][L][0])==-1){N=t[0][_];var it=!0;switch(N[1][0]){case 4:it=!1;case 0:E=Ct(" ",N[1][1]);break;case 5:it=!1;case 1:E=Ct("\r",N[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}o.push((it?E:"")+o.pop()+(it?"":E)),_=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function WR(t){if(t==null){var e=ee(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Gi(t);return Gi(0)}function jR(t,e,r,n,i){var s=zi(e,r,i),a=WR(t.v),o=ee(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=ee(t.bf.length),f=0;f<t.bf.length;++f)u[f]=t.bf[f];var d=ar([s,a,o,u]);return d}function Ic(t,e,r){var n=t.read_shift(4),i=BR(t,n,r),s=t.read_shift(4),a=s>0?VR(t,s,i,r):null;return[i,a]}var GR=Ic,Cc=Ic,zR=Ic,KR=Ic,qR={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},N_={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},XR={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function YR(t){var e="of:="+t.replace(ph,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function QR(t){return t.replace(/\./,"!")}var Oa=typeof Map<"u";function _h(t,e,r){var n=0,i=t.length;if(r){if(Oa?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Oa?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(Oa?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function Rc(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(bn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Ul(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Ku(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function L_(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Si(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Dm(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function JR(t,e,r){if(t&&t["!ref"]){var n=yt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function ZR(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Lt(t[r])+'"/>';return e+"</mergeCells>"}function e3(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[r];try{e.Workbook&&(c=e.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,a.codeName=Xa(ht(c))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),o=(o||"")+ge("outlinePr",null,u)}!s&&!o||(i[i.length]=ge("sheetPr",o,a))}var t3=["objects","scenarios","selectLockedCells","selectUnlockedCells"],r3=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function n3(t){var e={sheet:1};return t3.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),r3.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=x_(t.password).toString(16).toUpperCase()),ge("sheetProtection",null,e)}function i3(t){return L_(t),ge("pageMargins",null,t)}function s3(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=ge("col",null,Rc(i,n)));return r[r.length]="</cols>",r.join("")}function a3(t,e,r,n){var i=typeof t.ref=="string"?t.ref:Lt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=jr(i);a.s.r==a.e.r&&(a.e.r=jr(e["!ref"]).e.r,i=Lt(a));for(var o=0;o<s.length;++o){var c=s[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ge("autoFilter",null,{ref:i})}function o3(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ge("sheetViews",ge("sheetView",null,i),{})}function l3(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=co[t.v];break;case"d":n&&n.cellDates?i=Ir(t.v,-1).toISOString():(t=br(t),t.t="n",i=""+(t.v=Or(Ir(t.v)))),typeof t.z>"u"&&(t.z=Rt[14]);break;default:i=t.v;break}var o=or("v",ht(i)),c={r:e},u=Si(n.cellXfs,t,n);switch(u!==0&&(c.s=u),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=or("v",""+_h(n.Strings,t.v,n.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var f=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=ge("f",ht(t.f),f)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(c.cm=1),ge("c",o,c)}function c3(t,e,r,n){var i=[],s=[],a=yt(t["!ref"]),o="",c,u="",f=[],d=0,p=0,g=t["!rows"],v=Array.isArray(t),_={r:u},E,L=-1;for(p=a.s.c;p<=a.e.c;++p)f[p]=_r(p);for(d=a.s.r;d<=a.e.r;++d){for(s=[],u=lr(d),p=a.s.c;p<=a.e.c;++p){c=f[p]+u;var V=v?(t[d]||[])[p]:t[c];V!==void 0&&(o=l3(V,c,t,e))!=null&&s.push(o)}(s.length>0||g&&g[d])&&(_={r:u},g&&g[d]&&(E=g[d],E.hidden&&(_.hidden=1),L=-1,E.hpx?L=Hl(E.hpx):E.hpt&&(L=E.hpt),L>-1&&(_.ht=L,_.customHeight=1),E.level&&(_.outlineLevel=E.level)),i[i.length]=ge("row",s.join(""),_))}if(g)for(;d<g.length;++d)g&&g[d]&&(_={r:d+1},E=g[d],E.hidden&&(_.hidden=1),L=-1,E.hpx?L=Hl(E.hpx):E.hpt&&(L=E.hpt),L>-1&&(_.ht=L,_.customHeight=1),E.level&&(_.outlineLevel=E.level),i[i.length]=ge("row","",_));return i.join("")}function M_(t,e,r,n){var i=[Vt,ge("worksheet",null,{xmlns:qs[0],"xmlns:r":Yt.r})],s=r.SheetNames[t],a=0,o="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",f=yt(u);if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=Lt(f)}n||(n={}),c["!comments"]=[];var d=[];e3(c,r,t,e,i),i[i.length]=ge("dimension",null,{ref:u}),i[i.length]=o3(c,e,t,r),e.sheetFormat&&(i[i.length]=ge("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(i[i.length]=s3(c,c["!cols"])),i[a=i.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=c3(c,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),c["!protect"]&&(i[i.length]=n3(c["!protect"])),c["!autofilter"]!=null&&(i[i.length]=a3(c["!autofilter"],c,r,t)),c["!merges"]!=null&&c["!merges"].length>0&&(i[i.length]=ZR(c["!merges"]));var p=-1,g,v=-1;return c["!links"].length>0&&(i[i.length]="<hyperlinks>",c["!links"].forEach(function(_){_[1].Target&&(g={ref:_[0]},_[1].Target.charAt(0)!="#"&&(v=ft(n,-1,ht(_[1].Target).replace(/#.*$/,""),rt.HLINK),g["r:id"]="rId"+v),(p=_[1].Target.indexOf("#"))>-1&&(g.location=ht(_[1].Target.slice(p+1))),_[1].Tooltip&&(g.tooltip=ht(_[1].Tooltip)),i[i.length]=ge("hyperlink",null,g))}),i[i.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(i[i.length]=i3(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=or("ignoredErrors",ge("ignoredError",null,{numberStoredAsText:1,sqref:u}))),d.length>0&&(v=ft(n,-1,"../drawings/drawing"+(t+1)+".xml",rt.DRAW),i[i.length]=ge("drawing",null,{"r:id":"rId"+v}),c["!drawing"]=d),c["!comments"].length>0&&(v=ft(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",rt.VML),i[i.length]=ge("legacyDrawing",null,{"r:id":"rId"+v}),c["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function u3(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function f3(t,e,r){var n=ee(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=Hl(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:t,c:0},f=0;f<16;++f)if(!(e.s.c>f+1<<10||e.e.c<f<<10)){for(var d=-1,p=-1,g=f<<10;g<f+1<<10;++g){u.c=g;var v=Array.isArray(r)?(r[u.r]||[])[u.c]:r[dt(u)];v&&(d<0&&(d=g),p=g)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,p))}var _=n.l;return n.l=c,n.write_shift(4,o),n.l=_,n.length>n.l?n.slice(0,n.l):n}function h3(t,e,r,n){var i=f3(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&se(t,0,i)}var d3=Zi,p3=Ys;function g3(){}function m3(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=I4(t),r}function _3(t,e,r){r==null&&(r=ee(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Ml({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Jm(t,r),r.slice(0,r.l)}function v3(t){var e=Xr(t);return[e]}function x3(t,e,r){return r==null&&(r=ee(8)),Yi(e,r)}function E3(t){var e=Qi(t);return[e]}function y3(t,e,r){return r==null&&(r=ee(4)),Ji(e,r)}function T3(t){var e=Xr(t),r=t.read_shift(1);return[e,r,"b"]}function w3(t,e,r){return r==null&&(r=ee(9)),Yi(e,r),r.write_shift(1,t.v?1:0),r}function A3(t){var e=Qi(t),r=t.read_shift(1);return[e,r,"b"]}function S3(t,e,r){return r==null&&(r=ee(5)),Ji(e,r),r.write_shift(1,t.v?1:0),r}function I3(t){var e=Xr(t),r=t.read_shift(1);return[e,r,"e"]}function C3(t,e,r){return r==null&&(r=ee(9)),Yi(e,r),r.write_shift(1,t.v),r}function R3(t){var e=Qi(t),r=t.read_shift(1);return[e,r,"e"]}function P3(t,e,r){return r==null&&(r=ee(8)),Ji(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function F3(t){var e=Xr(t),r=t.read_shift(4);return[e,r,"s"]}function D3(t,e,r){return r==null&&(r=ee(12)),Yi(e,r),r.write_shift(4,e.v),r}function O3(t){var e=Qi(t),r=t.read_shift(4);return[e,r,"s"]}function b3(t,e,r){return r==null&&(r=ee(8)),Ji(e,r),r.write_shift(4,e.v),r}function k3(t){var e=Xr(t),r=Qs(t);return[e,r,"n"]}function N3(t,e,r){return r==null&&(r=ee(16)),Yi(e,r),Gi(t.v,r),r}function L3(t){var e=Qi(t),r=Qs(t);return[e,r,"n"]}function M3(t,e,r){return r==null&&(r=ee(12)),Ji(e,r),Gi(t.v,r),r}function V3(t){var e=Xr(t),r=Zm(t);return[e,r,"n"]}function B3(t,e,r){return r==null&&(r=ee(12)),Yi(e,r),e_(t.v,r),r}function U3(t){var e=Qi(t),r=Zm(t);return[e,r,"n"]}function H3(t,e,r){return r==null&&(r=ee(8)),Ji(e,r),e_(t.v,r),r}function $3(t){var e=Xr(t),r=ch(t);return[e,r,"is"]}function W3(t){var e=Xr(t),r=vr(t);return[e,r,"str"]}function j3(t,e,r){return r==null&&(r=ee(12+4*t.v.length)),Yi(e,r),Jt(t.v,r),r.length>r.l?r.slice(0,r.l):r}function G3(t){var e=Qi(t),r=vr(t);return[e,r,"str"]}function z3(t,e,r){return r==null&&(r=ee(8+4*t.v.length)),Ji(e,r),Jt(t.v,r),r.length>r.l?r.slice(0,r.l):r}function K3(t,e,r){var n=t.l+e,i=Xr(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=Cc(t,n-t.l,r);a[3]=$s(o,null,i,r.supbooks,r)}else t.l=n;return a}function q3(t,e,r){var n=t.l+e,i=Xr(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=Cc(t,n-t.l,r);a[3]=$s(o,null,i,r.supbooks,r)}else t.l=n;return a}function X3(t,e,r){var n=t.l+e,i=Xr(t);i.r=r["!row"];var s=Qs(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=Cc(t,n-t.l,r);a[3]=$s(o,null,i,r.supbooks,r)}else t.l=n;return a}function Y3(t,e,r){var n=t.l+e,i=Xr(t);i.r=r["!row"];var s=vr(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=Cc(t,n-t.l,r);a[3]=$s(o,null,i,r.supbooks,r)}else t.l=n;return a}var Q3=Zi,J3=Ys;function Z3(t,e){return e==null&&(e=ee(4)),e.write_shift(4,t),e}function eP(t,e){var r=t.l+e,n=Zi(t),i=uh(t),s=vr(t),a=vr(t),o=vr(t);t.l=r;var c={rfx:n,relId:i,loc:s,display:o};return a&&(c.Tooltip=a),c}function tP(t,e){var r=ee(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Ys({s:Qt(t[0]),e:Qt(t[0])},r),fh("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return Jt(i||"",r),Jt(t[1].Tooltip||"",r),Jt("",r),r.slice(0,r.l)}function rP(){}function nP(t,e,r){var n=t.l+e,i=t_(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=GR(t,n-t.l,r);a[1]=o}else t.l=n;return a}function iP(t,e,r){var n=t.l+e,i=Zi(t),s=[i];if(r.cellFormula){var a=KR(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function sP(t,e,r){r==null&&(r=ee(18));var n=Rc(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var V_=["left","right","top","bottom","header","footer"];function aP(t){var e={};return V_.forEach(function(r){e[r]=Qs(t)}),e}function oP(t,e){return e==null&&(e=ee(6*8)),L_(t),V_.forEach(function(r){Gi(t[r],e)}),e}function lP(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function cP(t,e,r){r==null&&(r=ee(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function uP(t){var e=ee(24);return e.write_shift(4,4),e.write_shift(4,1),Ys(t,e),e}function fP(t,e){return e==null&&(e=ee(16*4+2)),e.write_shift(2,t.password?x_(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function hP(){}function dP(){}function pP(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=br(e),e.z=e.z||Rt[14],e.v=Or(Ir(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var c={r,c:n};switch(c.s=Si(i.cellXfs,e,i),e.l&&s["!links"].push([dt(c),e.l]),e.c&&s["!comments"].push([dt(c),e.c]),e.t){case"s":case"str":return i.bookSST?(o=_h(i.Strings,e.v,i.revStrings),c.t="s",c.v=o,a?se(t,18,b3(e,c)):se(t,7,D3(e,c))):(c.t="str",a?se(t,17,z3(e,c)):se(t,6,j3(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?se(t,13,H3(e,c)):se(t,2,B3(e,c)):a?se(t,16,M3(e,c)):se(t,5,N3(e,c)),!0;case"b":return c.t="b",a?se(t,15,S3(e,c)):se(t,4,w3(e,c)),!0;case"e":return c.t="e",a?se(t,14,P3(e,c)):se(t,3,C3(e,c)),!0}return a?se(t,12,y3(e,c)):se(t,1,x3(e,c)),!0}function gP(t,e,r,n){var i=yt(e["!ref"]||"A1"),s,a="",o=[];se(t,145);var c=Array.isArray(e),u=i.e.r;e["!rows"]&&(u=Math.max(i.e.r,e["!rows"].length-1));for(var f=i.s.r;f<=u;++f){a=lr(f),h3(t,e,i,f);var d=!1;if(f<=i.e.r)for(var p=i.s.c;p<=i.e.c;++p){f===i.s.r&&(o[p]=_r(p)),s=o[p]+a;var g=c?(e[f]||[])[p]:e[s];if(!g){d=!1;continue}d=pP(t,g,f,p,n,e,d)}}se(t,146)}function mP(t,e){!e||!e["!merges"]||(se(t,177,Z3(e["!merges"].length)),e["!merges"].forEach(function(r){se(t,176,J3(r))}),se(t,178))}function _P(t,e){!e||!e["!cols"]||(se(t,390),e["!cols"].forEach(function(r,n){r&&se(t,60,sP(n,r))}),se(t,391))}function vP(t,e){!e||!e["!ref"]||(se(t,648),se(t,649,uP(yt(e["!ref"]))),se(t,650))}function xP(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=ft(r,-1,n[1].Target.replace(/#.*$/,""),rt.HLINK);se(t,494,tP(n,i))}}),delete e["!links"]}function EP(t,e,r,n){if(e["!comments"].length>0){var i=ft(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",rt.VML);se(t,551,fh("rId"+i)),e["!legacy"]=i}}function yP(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:Lt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=jr(s);o.s.r==o.e.r&&(o.e.r=jr(e["!ref"]).e.r,s=Lt(o));for(var c=0;c<a.length;++c){var u=a[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),se(t,161,Ys(yt(s))),se(t,162)}}function TP(t,e,r){se(t,133),se(t,137,cP(e,r)),se(t,138),se(t,134)}function wP(t,e){e["!protect"]&&se(t,535,fP(e["!protect"]))}function AP(t,e,r,n){var i=Dr(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var c=yt(a["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],se(i,129),(r.vbaraw||a["!outline"])&&se(i,147,_3(o,a["!outline"])),se(i,148,p3(c)),TP(i,a,r.Workbook),_P(i,a),gP(i,a,t,e),wP(i,a),yP(i,a,r,t),mP(i,a),xP(i,a,n),a["!margins"]&&se(i,476,oP(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&vP(i,a),EP(i,a,t,n),se(i,130),i.end()}function SP(t,e){t.l+=10;var r=vr(t);return{name:r}}var IP=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function CP(t){return!t.Workbook||!t.Workbook.WBProps?"false":i4(t.Workbook.WBProps.date1904)?"true":"false"}var RP="][*?/\\".split("");function B_(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return RP.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function PP(t,e,r){t.forEach(function(n,i){B_(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function FP(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];PP(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)JR(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}function U_(t){var e=[Vt];e[e.length]=ge("workbook",null,{xmlns:qs[0],"xmlns:r":Yt.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(IP.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=ge("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:ht(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=ge("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(e[e.length]=ge("definedName",ht(o.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function DP(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=zu(t),r.name=vr(t),r}function OP(t,e){return e||(e=ee(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),fh(t.strRelID,e),Jt(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function bP(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?vr(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function kP(t,e){e||(e=ee(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),Jm(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function NP(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=C4(t),a=zR(t,0,r),o=uh(t);t.l=n;var c={Name:s,Ptg:a};return i<268435455&&(c.Sheet=i),o&&(c.Comment=o),c}function LP(t,e){se(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};se(t,156,OP(i))}se(t,144)}function MP(t,e){e||(e=ee(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Jt("SheetJS",e),Jt(Pl.version,e),Jt(Pl.version,e),Jt("7262",e),e.length>e.l?e.slice(0,e.l):e}function VP(t,e){e||(e=ee(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function BP(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(se(t,135),se(t,158,VP(i)),se(t,136))}}function UP(t,e){var r=Dr();return se(r,131),se(r,128,MP()),se(r,153,kP(t.Workbook&&t.Workbook.WBProps||null)),BP(r,t),LP(r,t),se(r,132),r.end()}function HP(t,e,r){return(e.slice(-4)===".bin"?UP:U_)(t)}function $P(t,e,r,n,i){return(e.slice(-4)===".bin"?AP:M_)(t,r,n,i)}function WP(t,e,r){return(e.slice(-4)===".bin"?oC:T_)(t,r)}function jP(t,e,r){return(e.slice(-4)===".bin"?kI:v_)(t,r)}function GP(t,e,r){return(e.slice(-4)===".bin"?wC:C_)(t)}function zP(t){return(t.slice(-4)===".bin"?gC:S_)()}function KP(t,e){var r=[];return t.Props&&r.push(W4(t.Props,e)),t.Custprops&&r.push(j4(t.Props,t.Custprops)),r.join("")}function qP(){return""}function XP(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(ge("NumberFormat",null,{"ss:Format":ht(Rt[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(ge("Style",s.join(""),a))}),ge("Styles",r.join(""))}function H_(t){return ge("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+gh(t.Ref,{r:0,c:0})})}function YP(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(H_(i)))}return ge("Names",r.join(""))}function QP(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(H_(o)))}return s.join("")}function JP(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(ge("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(ge("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(ge("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(ge("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(or("ProtectContents","True")),t["!protect"].objects&&i.push(or("ProtectObjects","True")),t["!protect"].scenarios&&i.push(or("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(or("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(or("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":ge("WorksheetOptions",i.join(""),{xmlns:Br.x})}function ZP(t){return t.map(function(e){var r=n4(e.t||""),n=ge("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ge("Comment",n,{"ss:Author":e.a})}).join("")}function eF(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+ht(gh(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var c=Qt(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==a.r?"":"["+(c.r-a.r)+"]")+"C"+(c.c==a.c?"":"["+(c.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=ht(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=ht(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=a.c||u[f].s.r!=a.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var d="",p="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",p=String(t.v);break;case"b":d="Boolean",p=t.v?"1":"0";break;case"e":d="Error",p=co[t.v];break;case"d":d="DateTime",p=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Rt[14]);break;case"s":d="String",p=r4(t.v||"");break}var g=Si(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+g),o["ss:Index"]=a.c+1;var v=t.v!=null?p:"",_=t.t=="z"?"":'<Data ss:Type="'+d+'">'+v+"</Data>";return(t.c||[]).length>0&&(_+=ZP(t.c)),ge("Cell",_,o)}function tF(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=y_(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function rF(t,e,r,n){if(!t["!ref"])return"";var i=yt(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(E,L){dh(E);var V=!!E.width,N=Rc(L,E),U={"ss:Index":L+1};V&&(U["ss:Width"]=Bl(N.width)),E.hidden&&(U["ss:Hidden"]="1"),o.push(ge("Column",null,U))});for(var c=Array.isArray(t),u=i.s.r;u<=i.e.r;++u){for(var f=[tF(u,(t["!rows"]||[])[u])],d=i.s.c;d<=i.e.c;++d){var p=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>d)&&!(s[a].s.r>u)&&!(s[a].e.c<d)&&!(s[a].e.r<u)){(s[a].s.c!=d||s[a].s.r!=u)&&(p=!0);break}if(!p){var g={r:u,c:d},v=dt(g),_=c?(t[u]||[])[d]:t[v];f.push(eF(_,v,t,e,r,n,g))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function nF(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?QP(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?rF(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(JP(s,e,t,r)),n.join("")}function iF(t,e){e||(e={}),t.SSF||(t.SSF=br(Rt)),t.SSF&&(wc(),Tc(t.SSF),e.revssf=Ac(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Si(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(KP(t,e)),r.push(qP()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(ge("Worksheet",nF(n,e,t),{"ss:Name":ht(t.SheetNames[n])}));return r[2]=XP(t,e),r[3]=YP(t),Vt+ge("Workbook",r.join(""),{xmlns:Br.ss,"xmlns:o":Br.o,"xmlns:x":Br.x,"xmlns:ss":Br.ss,"xmlns:dt":Br.dt,"xmlns:html":Br.html})}var au={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function sF(t,e){var r=[],n=[],i=[],s=0,a,o=Wd(rp,"n"),c=Wd(np,"n");if(t.Props)for(a=ur(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(c,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=ur(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(c,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)f_.indexOf(i[s][0])>-1||l_.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&pt.utils.cfb_add(e,"/SummaryInformation",lp(n,au.SI,c,np)),(r.length||u.length)&&pt.utils.cfb_add(e,"/DocumentSummaryInformation",lp(r,au.DSI,o,rp,u.length?u:null,au.UDI))}function aF(t,e){var r=e||{},n=pt.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return pt.utils.cfb_add(n,i,$_(t,r)),r.biff==8&&(t.Props||t.Custprops)&&sF(t,n),r.biff==8&&t.vbaraw&&AC(n,pt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var oF={0:{f:u3},1:{f:v3},2:{f:V3},3:{f:I3},4:{f:T3},5:{f:k3},6:{f:W3},7:{f:F3},8:{f:Y3},9:{f:X3},10:{f:K3},11:{f:q3},12:{f:E3},13:{f:U3},14:{f:R3},15:{f:A3},16:{f:L3},17:{f:G3},18:{f:O3},19:{f:ch},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:NP},40:{},42:{},43:{f:WI},44:{f:HI},45:{f:zI},46:{f:qI},47:{f:KI},48:{},49:{f:E4},50:{},51:{f:uC},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:yI},62:{f:$3},63:{f:mC},64:{f:hP},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:yn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:lP},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:m3},148:{f:d3,p:16},151:{f:rP},152:{},153:{f:bP},154:{},155:{},156:{f:DP},157:{},158:{},159:{T:1,f:DI},160:{T:-1},161:{T:1,f:Zi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Q3},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:lC},336:{T:-1},337:{f:dC,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:zu},357:{},358:{},359:{},360:{T:1},361:{},362:{f:gI},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:nP},427:{f:iP},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:aP},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:g3},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:eP},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:zu},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:yC},633:{T:1},634:{T:-1},635:{T:1,f:xC},636:{T:-1},637:{f:A4},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:SP},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:dP},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function _e(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&ah(r)&&t.push(r)}}function lF(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return _e(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,c=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var f=t.next(4);for(f.write_shift(2,s),f.write_shift(2,u),t.push(r.slice(c,c+u)),c+=u;c<i;){for(f=t.next(4),f.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;f.write_shift(2,u),t.push(r.slice(c,c+u)),c+=u}}}function fo(t,e,r){return t||(t=ee(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function cF(t,e,r,n){var i=ee(9);return fo(i,t,e),d_(r,n||"b",i),i}function uF(t,e,r){var n=ee(8+2*r.length);return fo(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function fF(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Or(Ir(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?_e(t,2,SI(r,n,i)):_e(t,3,AI(r,n,i));return;case"b":case"e":_e(t,5,cF(r,n,e.v,e.t));return;case"s":case"str":_e(t,4,uF(r,n,(e.v||"").slice(0,255)));return}_e(t,1,fo(null,r,n))}function hF(t,e,r,n){var i=Array.isArray(e),s=yt(e["!ref"]||"A1"),a,o="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Lt(s)}for(var u=s.s.r;u<=s.e.r;++u){o=lr(u);for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(c[f]=_r(f)),a=c[f]+o;var d=i?(e[u]||[])[f]:e[a];d&&fF(t,d,u,f)}}}function dF(t,e){for(var r=e||{},n=Dr(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return _e(n,r.biff==4?1033:r.biff==3?521:9,hh(t,16,r)),hF(n,t.Sheets[t.SheetNames[i]],i,r),_e(n,10),n.end()}function pF(t,e,r){_e(t,49,oI({sz:12,name:"Arial"},r))}function gF(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&_e(t,1054,uI(i,e[i],r))})}function mF(t,e){var r=ee(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),_e(t,2151,r),r=ee(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),m_(yt(e["!ref"]||"A1"),r),r.write_shift(4,4),_e(t,2152,r)}function _F(t,e){for(var r=0;r<16;++r)_e(t,224,up({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){_e(t,224,up(n,0,e))})}function vF(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];_e(t,440,vI(n)),n[1].Tooltip&&_e(t,2048,xI(n))}delete e["!links"]}function xF(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&_e(t,125,TI(Rc(i,n),i))})}}function EF(t,e,r,n,i){var s=16+Si(i.cellXfs,e,i);if(e.v==null&&!e.bf){_e(t,513,zi(r,n,s));return}if(e.bf)_e(t,6,jR(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Or(Ir(e.v)):e.v;_e(t,515,pI(r,n,a,s));break;case"b":case"e":_e(t,517,dI(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=_h(i.Strings,e.v,i.revStrings);_e(t,253,lI(r,n,o,s))}else _e(t,516,cI(r,n,(e.v||"").slice(0,255),s,i));break;default:_e(t,513,zi(r,n,s))}}function yF(t,e,r){var n=Dr(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},c=Array.isArray(s),u=e.biff==8,f,d="",p=[],g=yt(s["!ref"]||"A1"),v=u?65536:16384;if(g.e.c>255||g.e.r>=v){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,v-1)}_e(n,2057,hh(r,16,e)),_e(n,13,zr(1)),_e(n,12,zr(100)),_e(n,15,wr(!0)),_e(n,17,wr(!1)),_e(n,16,Gi(.001)),_e(n,95,wr(!0)),_e(n,42,wr(!1)),_e(n,43,wr(!1)),_e(n,130,zr(1)),_e(n,128,hI()),_e(n,131,wr(!1)),_e(n,132,wr(!1)),u&&xF(n,s["!cols"]),_e(n,512,fI(g,e)),u&&(s["!links"]=[]);for(var _=g.s.r;_<=g.e.r;++_){d=lr(_);for(var E=g.s.c;E<=g.e.c;++E){_===g.s.r&&(p[E]=_r(E)),f=p[E]+d;var L=c?(s[_]||[])[E]:s[f];L&&(EF(n,L,_,E,e),u&&L.l&&s["!links"].push([f,L.l]))}}var V=o.CodeName||o.name||i;return u&&_e(n,574,aI((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&_e(n,229,_I(s["!merges"])),u&&vF(n,s),_e(n,442,g_(V)),u&&mF(n,s),_e(n,10),n.end()}function TF(t,e,r){var n=Dr(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,c=r.biff==5;if(_e(n,2057,hh(t,5,r)),r.bookType=="xla"&&_e(n,135),_e(n,225,o?zr(1200):null),_e(n,193,K4(2)),c&&_e(n,191),c&&_e(n,192),_e(n,226),_e(n,92,rI("SheetJS",r)),_e(n,66,zr(o?1200:1252)),o&&_e(n,353,zr(0)),o&&_e(n,448),_e(n,317,wI(t.SheetNames.length)),o&&t.vbaraw&&_e(n,211),o&&t.vbaraw){var u=a.CodeName||"ThisWorkbook";_e(n,442,g_(u))}_e(n,156,zr(17)),_e(n,25,wr(!1)),_e(n,18,wr(!1)),_e(n,19,zr(0)),o&&_e(n,431,wr(!1)),o&&_e(n,444,zr(0)),_e(n,61,sI()),_e(n,64,wr(!1)),_e(n,141,zr(0)),_e(n,34,wr(CP(t)=="true")),_e(n,14,wr(!0)),o&&_e(n,439,wr(!1)),_e(n,218,zr(0)),pF(n,t,r),gF(n,t.SSF,r),_F(n,r),o&&_e(n,352,wr(!1));var f=n.end(),d=Dr();o&&_e(d,140,EI()),o&&r.Strings&&lF(d,252,iI(r.Strings)),_e(d,10);var p=d.end(),g=Dr(),v=0,_=0;for(_=0;_<t.SheetNames.length;++_)v+=(o?12:11)+(o?2:1)*t.SheetNames[_].length;var E=f.length+v+p.length;for(_=0;_<t.SheetNames.length;++_){var L=s[_]||{};_e(g,133,nI({pos:E,hs:L.Hidden||0,dt:0,name:t.SheetNames[_]},r)),E+=e[_].length}var V=g.end();if(v!=V.length)throw new Error("BS8 "+v+" != "+V.length);var N=[];return f.length&&N.push(f),V.length&&N.push(V),p.length&&N.push(p),ar(N)}function wF(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=br(Rt)),t&&t.SSF&&(wc(),Tc(t.SSF),r.revssf=Ac(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,vh(r),r.cellXfs=[],Si(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=yF(i,r,t);return n.unshift(TF(t,n,r)),ar(n)}function $_(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=jr(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return wF(t,e);case 4:case 3:case 2:return dF(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function AF(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,c=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>a)&&!(i[u].e.r<r||i[u].e.c<a)){if(i[u].s.r<r||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,c=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var f=dt({r,c:a}),d=n.dense?(t[r]||[])[a]:t[f],p=d&&d.v!=null&&(d.h||t4(d.w||(Un(d),d.w)||""))||"",g={};o>1&&(g.rowspan=o),c>1&&(g.colspan=c),n.editable?p='<span contenteditable="true">'+p+"</span>":d&&(g["data-t"]=d&&d.t||"z",d.v!=null&&(g["data-v"]=d.v),d.z!=null&&(g["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+d.l.Target+'">'+p+"</a>")),g.id=(n.id||"sjs")+"-"+f,s.push(ge("td",p,g))}}var v="<tr>";return v+s.join("")+"</tr>"}var SF='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',IF="</body></html>";function CF(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function W_(t,e){var r=e||{},n=r.header!=null?r.header:SF,i=r.footer!=null?r.footer:IF,s=[n],a=jr(t["!ref"]);r.dense=Array.isArray(t),s.push(CF(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(AF(t,a,o,r));return s.push("</table>"+i),s.join("")}function j_(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Qt(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var f=jr(t["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),i==-1&&(u.e.r=i=f.e.r+1)}var d=[],p=0,g=t["!rows"]||(t["!rows"]=[]),v=0,_=0,E=0,L=0,V=0,N=0;for(t["!cols"]||(t["!cols"]=[]);v<o.length&&_<c;++v){var U=o[v];if(_p(U)){if(n.display)continue;g[_]={hidden:!0}}var re=U.children;for(E=L=0;E<re.length;++E){var le=re[E];if(!(n.display&&_p(le))){var w=le.hasAttribute("data-v")?le.getAttribute("data-v"):le.hasAttribute("v")?le.getAttribute("v"):s4(le.innerHTML),T=le.getAttribute("data-z")||le.getAttribute("z");for(p=0;p<d.length;++p){var y=d[p];y.s.c==L+s&&y.s.r<_+i&&_+i<=y.e.r&&(L=y.e.c+1-s,p=-1)}N=+le.getAttribute("colspan")||1,((V=+le.getAttribute("rowspan")||1)>1||N>1)&&d.push({s:{r:_+i,c:L+s},e:{r:_+i+(V||1)-1,c:L+s+(N||1)-1}});var I={t:"s",v:w},P=le.getAttribute("data-t")||le.getAttribute("t")||"";w!=null&&(w.length==0?I.t=P||"z":n.raw||w.trim().length==0||P=="s"||(w==="TRUE"?I={t:"b",v:!0}:w==="FALSE"?I={t:"b",v:!1}:isNaN(On(w))?isNaN(qa(w).getDate())||(I={t:"d",v:Ir(w)},n.cellDates||(I={t:"n",v:Or(I.v)}),I.z=n.dateNF||Rt[14]):I={t:"n",v:On(w)})),I.z===void 0&&T!=null&&(I.z=T);var k="",R=le.getElementsByTagName("A");if(R&&R.length)for(var We=0;We<R.length&&!(R[We].hasAttribute("href")&&(k=R[We].getAttribute("href"),k.charAt(0)!="#"));++We);k&&k.charAt(0)!="#"&&(I.l={Target:k}),n.dense?(t[_+i]||(t[_+i]=[]),t[_+i][L+s]=I):t[dt({c:L+s,r:_+i})]=I,u.e.c<L+s&&(u.e.c=L+s),L+=N}}++_}return d.length&&(t["!merges"]=(t["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,_-1+i),t["!ref"]=Lt(u),_>=c&&(t["!fullref"]=Lt((u.e.r=o.length-v+_-1+i,u))),t}function G_(t,e){var r=e||{},n=r.dense?[]:{};return j_(n,t,e)}function RF(t,e){return Xi(G_(t,e),e)}function _p(t){var e="",r=PF(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function PF(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var FF=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Ya({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Vt+e}}(),vp=function(){var t=function(s){return ht(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var c=[];c.push('      <table:table table:name="'+ht(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,d=jr(s["!ref"]||"A1"),p=s["!merges"]||[],g=0,v=Array.isArray(s);if(s["!cols"])for(f=0;f<=d.e.c;++f)c.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var _="",E=s["!rows"]||[];for(u=0;u<d.s.r;++u)_=E[u]?' table:style-name="ro'+E[u].ods+'"':"",c.push("        <table:table-row"+_+`></table:table-row>
`);for(;u<=d.e.r;++u){for(_=E[u]?' table:style-name="ro'+E[u].ods+'"':"",c.push("        <table:table-row"+_+`>
`),f=0;f<d.s.c;++f)c.push(e);for(;f<=d.e.c;++f){var L=!1,V={},N="";for(g=0;g!=p.length;++g)if(!(p[g].s.c>f)&&!(p[g].s.r>u)&&!(p[g].e.c<f)&&!(p[g].e.r<u)){(p[g].s.c!=f||p[g].s.r!=u)&&(L=!0),V["table:number-columns-spanned"]=p[g].e.c-p[g].s.c+1,V["table:number-rows-spanned"]=p[g].e.r-p[g].s.r+1;break}if(L){c.push(r);continue}var U=dt({r:u,c:f}),re=v?(s[u]||[])[f]:s[U];if(re&&re.f&&(V["table:formula"]=ht(YR(re.f)),re.F&&re.F.slice(0,U.length)==U)){var le=jr(re.F);V["table:number-matrix-columns-spanned"]=le.e.c-le.s.c+1,V["table:number-matrix-rows-spanned"]=le.e.r-le.s.r+1}if(!re){c.push(e);continue}switch(re.t){case"b":N=re.v?"TRUE":"FALSE",V["office:value-type"]="boolean",V["office:boolean-value"]=re.v?"true":"false";break;case"n":N=re.w||String(re.v||0),V["office:value-type"]="float",V["office:value"]=re.v||0;break;case"s":case"str":N=re.v==null?"":re.v,V["office:value-type"]="string";break;case"d":N=re.w||Ir(re.v).toISOString(),V["office:value-type"]="date",V["office:date-value"]=Ir(re.v).toISOString(),V["table:style-name"]="ce1";break;default:c.push(e);continue}var w=t(N);if(re.l&&re.l.Target){var T=re.l.Target;T=T.charAt(0)=="#"?"#"+QR(T.slice(1)):T,T.charAt(0)!="#"&&!T.match(/^\w+:/)&&(T="../"+T),w=ge("text:a",w,{"xlink:href":T.replace(/&/g,"&amp;")})}c.push("          "+ge("table:table-cell",ge("text:p",w,{}),V)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var d=u["!cols"][f];if(d.width==null&&d.wpx==null&&d.wch==null)continue;dh(d),d.ods=o;var p=u["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),s.push(`  </style:style>
`),++o}}});var c=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=c;var d=u["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var c=[Vt],u=Ya({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Ya({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+f+`>
`),c.push(a_().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),i(c,a),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var d=0;d!=a.SheetNames.length;++d)c.push(n(a.Sheets[a.SheetNames[d]],a,d));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function z_(t,e){if(e.bookType=="fods")return vp(t,e);var r=rh(),n="",i=[],s=[];return n="mimetype",ze(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ze(r,n,vp(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",ze(r,n,FF(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",ze(r,n,Vt+a_()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",ze(r,n,$4(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ze(r,n,U4(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function $l(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function DF(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):en(Xa(t))}function OF(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function yi(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function bF(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function Qa(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function ut(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Os(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Ut(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=Qa(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var c=r[0];t[r[0]++]>=128;);o=t.slice(c,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Qa(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:o,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function tr(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(ut(n*8+i.type)),i.type==2&&e.push(ut(i.data.length)),e.push(i.data))})}),yi(e)}function Jr(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=Qa(t,n),s=Ut(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:Os(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=Ut(o.data),u=Os(c[3][0].data);a.messages.push({meta:c,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(a.merge=Os(s[3][0].data)>>>0>0),r.push(a)}return r}function cs(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:ut(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:ut(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:ut(a.data.length)}],n[2].push({data:tr(a.meta),type:2})});var s=tr(n);e.push(ut(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),yi(e)}function kF(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Qa(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var c=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[yi(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(i.push(i[0].slice(-c)),u-=c;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-c,-c+u))}}var f=yi(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Zr(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(kF(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return yi(e)}function us(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=ut(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return yi(e)}function ou(t,e){var r=new Uint8Array(32),n=$l(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,bF(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function lu(t,e){var r=new Uint8Array(32),n=$l(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function Yn(t){var e=Ut(t);return Qa(e[1][0].data)}function NF(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&Os(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=$l(t[7][0].data),f=0,d=[],p=$l(t[4][0].data),g=0,v=[],_=0;_<e.length;++_){if(e[_]==null){u.setUint16(_*2,65535,!0),p.setUint16(_*2,65535);continue}u.setUint16(_*2,f,!0),p.setUint16(_*2,g,!0);var E,L;switch(typeof e[_]){case"string":E=ou({t:"s",v:e[_]},r),L=lu({t:"s",v:e[_]},r);break;case"number":E=ou({t:"n",v:e[_]},r),L=lu({t:"n",v:e[_]},r);break;case"boolean":E=ou({t:"b",v:e[_]},r),L=lu({t:"b",v:e[_]},r);break;default:throw new Error("Unsupported value "+e[_])}d.push(E),f+=E.length,v.push(L),g+=L.length,++c}for(t[2][0].data=ut(c);_<t[7][0].data.length/2;++_)u.setUint16(_*2,65535,!0),p.setUint16(_*2,65535,!0);return t[6][0].data=yi(d),t[3][0].data=yi(v),c}function LF(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=jr(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Lt(n)));var s=Wl(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(G){return G.forEach(function(W){typeof W=="string"&&a.push(W)})});var o={},c=[],u=pt.read(e.numbers,{type:"base64"});u.FileIndex.map(function(G,W){return[G,u.FullPaths[W]]}).forEach(function(G){var W=G[0],H=G[1];if(W.type==2&&W.name.match(/\.iwa/)){var ne=W.content,Ae=Zr(ne),Re=Jr(Ae);Re.forEach(function(Ce){c.push(Ce.id),o[Ce.id]={deps:[],location:H,type:Os(Ce.messages[0].meta[1][0].data)}})}}),c.sort(function(G,W){return G-W});var f=c.filter(function(G){return G>1}).map(function(G){return[G,ut(G)]});u.FileIndex.map(function(G,W){return[G,u.FullPaths[W]]}).forEach(function(G){var W=G[0];if(G[1],!!W.name.match(/\.iwa/)){var H=Jr(Zr(W.content));H.forEach(function(ne){ne.messages.forEach(function(Ae){f.forEach(function(Re){ne.messages.some(function(Ce){return Os(Ce.meta[1][0].data)!=11006&&OF(Ce.data,Re[1])})&&o[Re[0]].deps.push(ne.id)})})})}});for(var d=pt.find(u,o[1].location),p=Jr(Zr(d.content)),g,v=0;v<p.length;++v){var _=p[v];_.id==1&&(g=_)}var E=Yn(Ut(g.messages[0].data)[1][0].data);for(d=pt.find(u,o[E].location),p=Jr(Zr(d.content)),v=0;v<p.length;++v)_=p[v],_.id==E&&(g=_);for(E=Yn(Ut(g.messages[0].data)[2][0].data),d=pt.find(u,o[E].location),p=Jr(Zr(d.content)),v=0;v<p.length;++v)_=p[v],_.id==E&&(g=_);for(E=Yn(Ut(g.messages[0].data)[2][0].data),d=pt.find(u,o[E].location),p=Jr(Zr(d.content)),v=0;v<p.length;++v)_=p[v],_.id==E&&(g=_);var L=Ut(g.messages[0].data);{L[6][0].data=ut(n.e.r+1),L[7][0].data=ut(n.e.c+1);var V=Yn(L[46][0].data),N=pt.find(u,o[V].location),U=Jr(Zr(N.content));{for(var re=0;re<U.length&&U[re].id!=V;++re);if(U[re].id!=V)throw"Bad ColumnRowUIDMapArchive";var le=Ut(U[re].messages[0].data);le[1]=[],le[2]=[],le[3]=[];for(var w=0;w<=n.e.c;++w){var T=[];T[1]=T[2]=[{type:0,data:ut(w+420690)}],le[1].push({type:2,data:tr(T)}),le[2].push({type:0,data:ut(w)}),le[3].push({type:0,data:ut(w)})}le[4]=[],le[5]=[],le[6]=[];for(var y=0;y<=n.e.r;++y)T=[],T[1]=T[2]=[{type:0,data:ut(y+726270)}],le[4].push({type:2,data:tr(T)}),le[5].push({type:0,data:ut(y)}),le[6].push({type:0,data:ut(y)});U[re].messages[0].data=tr(le)}N.content=us(cs(U)),N.size=N.content.length,delete L[46];var I=Ut(L[4][0].data);{I[7][0].data=ut(n.e.r+1);var P=Ut(I[1][0].data),k=Yn(P[2][0].data);N=pt.find(u,o[k].location),U=Jr(Zr(N.content));{if(U[0].id!=k)throw"Bad HeaderStorageBucket";var R=Ut(U[0].messages[0].data);for(y=0;y<s.length;++y){var We=Ut(R[2][0].data);We[1][0].data=ut(y),We[4][0].data=ut(s[y].length),R[2][y]={type:R[2][0].type,data:tr(We)}}U[0].messages[0].data=tr(R)}N.content=us(cs(U)),N.size=N.content.length;var ke=Yn(I[2][0].data);N=pt.find(u,o[ke].location),U=Jr(Zr(N.content));{if(U[0].id!=ke)throw"Bad HeaderStorageBucket";for(R=Ut(U[0].messages[0].data),w=0;w<=n.e.c;++w)We=Ut(R[2][0].data),We[1][0].data=ut(w),We[4][0].data=ut(n.e.r+1),R[2][w]={type:R[2][0].type,data:tr(We)};U[0].messages[0].data=tr(R)}N.content=us(cs(U)),N.size=N.content.length;var Qe=Yn(I[4][0].data);(function(){for(var G=pt.find(u,o[Qe].location),W=Jr(Zr(G.content)),H,ne=0;ne<W.length;++ne){var Ae=W[ne];Ae.id==Qe&&(H=Ae)}var Re=Ut(H.messages[0].data);{Re[3]=[];var Ce=[];a.forEach(function(b,B){Ce[1]=[{type:0,data:ut(B)}],Ce[2]=[{type:0,data:ut(1)}],Ce[3]=[{type:2,data:DF(b)}],Re[3].push({type:2,data:tr(Ce)})})}H.messages[0].data=tr(Re);var me=cs(W),et=us(me);G.content=et,G.size=G.content.length})();var Ne=Ut(I[3][0].data);{var He=Ne[1][0];delete Ne[2];var it=Ut(He.data);{var Dt=Yn(it[2][0].data);(function(){for(var G=pt.find(u,o[Dt].location),W=Jr(Zr(G.content)),H,ne=0;ne<W.length;++ne){var Ae=W[ne];Ae.id==Dt&&(H=Ae)}var Re=Ut(H.messages[0].data);{delete Re[6],delete Ne[7];var Ce=new Uint8Array(Re[5][0].data);Re[5]=[];for(var me=0,et=0;et<=n.e.r;++et){var b=Ut(Ce);me+=NF(b,s[et],a),b[1][0].data=ut(et),Re[5].push({data:tr(b),type:2})}Re[1]=[{type:0,data:ut(n.e.c+1)}],Re[2]=[{type:0,data:ut(n.e.r+1)}],Re[3]=[{type:0,data:ut(me)}],Re[4]=[{type:0,data:ut(n.e.r+1)}]}H.messages[0].data=tr(Re);var B=cs(W),K=us(B);G.content=K,G.size=G.content.length})()}He.data=tr(it)}I[3][0].data=tr(Ne)}L[4][0].data=tr(I)}g.messages[0].data=tr(L);var At=cs(p),M=us(At);return d.content=M,d.size=d.content.length,u}function MF(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function vh(t){MF([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function VF(t,e){return e.bookType=="ods"?z_(t,e):e.bookType=="numbers"?LF(t,e):e.bookType=="xlsb"?BF(t,e):UF(t,e)}function BF(t,e){xs=1024,t&&!t.SSF&&(t.SSF=br(Rt)),t&&t.SSF&&(wc(),Tc(t.SSF),e.revssf=Ac(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Oa?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=R_.indexOf(e.bookType)>-1,i=n_();vh(e=e||{});var s=rh(),a="",o=0;if(e.cellXfs=[],Si(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",ze(s,a,o_(t.Props,e)),i.coreprops.push(a),ft(e.rels,2,a,rt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(t.SheetNames[u]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,ze(s,a,c_(t.Props)),i.extprops.push(a),ft(e.rels,3,a,rt.EXT_PROPS),t.Custprops!==t.Props&&ur(t.Custprops||{}).length>0&&(a="docProps/custom.xml",ze(s,a,u_(t.Custprops)),i.custprops.push(a),ft(e.rels,4,a,rt.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var f={"!id":{}},d=t.Sheets[t.SheetNames[o-1]],p=(d||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,ze(s,a,$P(o-1,a,e,t,f)),i.sheets.push(a),ft(e.wbrels,-1,"worksheets/sheet"+o+"."+r,rt.WS[0])}if(d){var g=d["!comments"],v=!1,_="";g&&g.length>0&&(_="xl/comments"+o+"."+r,ze(s,_,GP(g,_)),i.comments.push(_),ft(f,-1,"../comments"+o+"."+r,rt.CMNT),v=!0),d["!legacy"]&&v&&ze(s,"xl/drawings/vmlDrawing"+o+".vml",I_(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&ze(s,s_(a),Fs(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,ze(s,a,jP(e.Strings,a,e)),i.strs.push(a),ft(e.wbrels,-1,"sharedStrings."+r,rt.SST)),a="xl/workbook."+r,ze(s,a,HP(t,a)),i.workbooks.push(a),ft(e.rels,1,a,rt.WB),a="xl/theme/theme1.xml",ze(s,a,A_(t.Themes,e)),i.themes.push(a),ft(e.wbrels,-1,"theme/theme1.xml",rt.THEME),a="xl/styles."+r,ze(s,a,WP(t,a,e)),i.styles.push(a),ft(e.wbrels,-1,"styles."+r,rt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",ze(s,a,t.vbaraw),i.vba.push(a),ft(e.wbrels,-1,"vbaProject.bin",rt.VBA)),a="xl/metadata."+r,ze(s,a,zP(a)),i.metadata.push(a),ft(e.wbrels,-1,"metadata."+r,rt.XLMETA),ze(s,"[Content_Types].xml",i_(i,e)),ze(s,"_rels/.rels",Fs(e.rels)),ze(s,"xl/_rels/workbook."+r+".rels",Fs(e.wbrels)),delete e.revssf,delete e.ssf,s}function UF(t,e){xs=1024,t&&!t.SSF&&(t.SSF=br(Rt)),t&&t.SSF&&(wc(),Tc(t.SSF),e.revssf=Ac(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Oa?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=R_.indexOf(e.bookType)>-1,i=n_();vh(e=e||{});var s=rh(),a="",o=0;if(e.cellXfs=[],Si(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",ze(s,a,o_(t.Props,e)),i.coreprops.push(a),ft(e.rels,2,a,rt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(t.SheetNames[u]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,ze(s,a,c_(t.Props)),i.extprops.push(a),ft(e.rels,3,a,rt.EXT_PROPS),t.Custprops!==t.Props&&ur(t.Custprops||{}).length>0&&(a="docProps/custom.xml",ze(s,a,u_(t.Custprops)),i.custprops.push(a),ft(e.rels,4,a,rt.CUST_PROPS));var f=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var d={"!id":{}},p=t.Sheets[t.SheetNames[o-1]],g=(p||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,ze(s,a,M_(o-1,e,t,d)),i.sheets.push(a),ft(e.wbrels,-1,"worksheets/sheet"+o+"."+r,rt.WS[0])}if(p){var v=p["!comments"],_=!1,E="";if(v&&v.length>0){var L=!1;v.forEach(function(V){V[1].forEach(function(N){N.T==!0&&(L=!0)})}),L&&(E="xl/threadedComments/threadedComment"+o+"."+r,ze(s,E,_C(v,f,e)),i.threadedcomments.push(E),ft(d,-1,"../threadedComments/threadedComment"+o+"."+r,rt.TCMNT)),E="xl/comments"+o+"."+r,ze(s,E,C_(v)),i.comments.push(E),ft(d,-1,"../comments"+o+"."+r,rt.CMNT),_=!0}p["!legacy"]&&_&&ze(s,"xl/drawings/vmlDrawing"+o+".vml",I_(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}d["!id"].rId1&&ze(s,s_(a),Fs(d))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,ze(s,a,v_(e.Strings,e)),i.strs.push(a),ft(e.wbrels,-1,"sharedStrings."+r,rt.SST)),a="xl/workbook."+r,ze(s,a,U_(t)),i.workbooks.push(a),ft(e.rels,1,a,rt.WB),a="xl/theme/theme1.xml",ze(s,a,A_(t.Themes,e)),i.themes.push(a),ft(e.wbrels,-1,"theme/theme1.xml",rt.THEME),a="xl/styles."+r,ze(s,a,T_(t,e)),i.styles.push(a),ft(e.wbrels,-1,"styles."+r,rt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",ze(s,a,t.vbaraw),i.vba.push(a),ft(e.wbrels,-1,"vbaProject.bin",rt.VBA)),a="xl/metadata."+r,ze(s,a,S_()),i.metadata.push(a),ft(e.wbrels,-1,"metadata."+r,rt.XLMETA),f.length>1&&(a="xl/persons/person.xml",ze(s,a,vC(f)),i.people.push(a),ft(e.wbrels,-1,"persons/person.xml",rt.PEOPLE)),ze(s,"[Content_Types].xml",i_(i,e)),ze(s,"_rels/.rels",Fs(e.rels)),ze(s,"xl/_rels/workbook."+r+".rels",Fs(e.wbrels)),delete e.revssf,delete e.ssf,s}function HF(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Bn(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function K_(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return oo(e.file,pt.write(t,{type:nt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return pt.write(t,e)}function $F(t,e){var r=br(e||{}),n=VF(t,r);return WF(n,r)}function WF(t,e){var r={},n=nt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?pt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(yc(i))}return e.password&&typeof encrypt_agile<"u"?K_(encrypt_agile(i,e.password),e):e.type==="file"?oo(e.file,i):e.type=="string"?Ra(i):i}function jF(t,e){var r=e||{},n=aF(t,r);return K_(n,r)}function cn(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Ka(Xa(n));case"binary":return Xa(n);case"string":return t;case"file":return oo(e.file,n,"utf8");case"buffer":return nt?jn(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):cn(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function GF(t,e){switch(e.type){case"base64":return Ka(t);case"binary":return t;case"string":return t;case"file":return oo(e.file,t,"binary");case"buffer":return nt?jn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Wo(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Ka(r):e.type=="string"?Ra(r):r;case"file":return oo(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function q_(t,e){xS(),FP(t);var r=br(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=q_(t,r);return r.type="array",yc(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return cn(iF(t,r),r);case"slk":case"sylk":return cn(CI.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return cn(W_(t.Sheets[t.SheetNames[i]],r),r);case"txt":return GF(X_(t.Sheets[t.SheetNames[i]],r),r);case"csv":return cn(xh(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return cn(RI.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return Wo(II.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return cn(PI.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return cn(LI.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return cn(__.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return cn(z_(t,r),r);case"wk1":return Wo(fp.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return Wo(fp.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Wo($_(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),jF(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return $F(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function zF(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function KF(t,e,r){var n={};return n.type="file",n.file=e,zF(n),q_(t,n)}function qF(t,e,r,n,i,s,a,o){var c=lr(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,p=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!a||t[r])for(var g=e.s.c;g<=e.e.c;++g){var v=a?t[r][g]:t[n[g]+c];if(v===void 0||v.t===void 0){if(u===void 0)continue;s[g]!=null&&(p[s[g]]=u);continue}var _=v.v;switch(v.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[g]!=null){if(_==null)if(v.t=="e"&&_===null)p[s[g]]=null;else if(u!==void 0)p[s[g]]=u;else if(f&&_===null)p[s[g]]=null;else continue;else p[s[g]]=f&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?_:Un(v,_,o);_!=null&&(d=!1)}}return{row:p,isempty:d}}function Wl(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},f=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":c=yt(f);break;case"number":c=yt(t["!ref"]),c.s.r=f;break;default:c=f}n>0&&(i=0);var d=lr(c.s.r),p=[],g=[],v=0,_=0,E=Array.isArray(t),L=c.s.r,V=0,N={};E&&!t[L]&&(t[L]=[]);var U=u.skipHidden&&t["!cols"]||[],re=u.skipHidden&&t["!rows"]||[];for(V=c.s.c;V<=c.e.c;++V)if(!(U[V]||{}).hidden)switch(p[V]=_r(V),r=E?t[L][V]:t[p[V]+d],n){case 1:s[V]=V-c.s.c;break;case 2:s[V]=p[V];break;case 3:s[V]=u.header[V-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Un(r,null,u),_=N[a]||0,!_)N[a]=1;else{do o=a+"_"+_++;while(N[o]);N[a]=_,N[o]=1}s[V]=o}for(L=c.s.r+i;L<=c.e.r;++L)if(!(re[L]||{}).hidden){var le=qF(t,c,L,p,n,s,E,u);(le.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(g[v++]=le.row)}return g.length=v,g}var xp=/"/g;function XF(t,e,r,n,i,s,a,o){for(var c=!0,u=[],f="",d=lr(r),p=e.s.c;p<=e.e.c;++p)if(n[p]){var g=o.dense?(t[r]||[])[p]:t[n[p]+d];if(g==null)f="";else if(g.v!=null){c=!1,f=""+(o.rawNumbers&&g.t=="n"?g.v:Un(g,null,o));for(var v=0,_=0;v!==f.length;++v)if((_=f.charCodeAt(v))===i||_===s||_===34||o.forceQuotes){f='"'+f.replace(xp,'""')+'"';break}f=="ID"&&(f='"ID"')}else g.f!=null&&!g.F?(c=!1,f="="+g.f,f.indexOf(",")>=0&&(f='"'+f.replace(xp,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&c?null:u.join(a)}function xh(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=yt(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),f="",d=[];n.dense=Array.isArray(t);for(var p=n.skipHidden&&t["!cols"]||[],g=n.skipHidden&&t["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(p[v]||{}).hidden||(d[v]=_r(v));for(var _=0,E=i.s.r;E<=i.e.r;++E)(g[E]||{}).hidden||(f=XF(t,i,E,d,a,c,s,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((_++?o:"")+f)));return delete n.dense,r.join("")}function X_(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=xh(t,e);return r}function YF(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=yt(t["!ref"]),s="",a=[],o,c=[],u=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=_r(o);for(var f=i.s.r;f<=i.e.r;++f)for(s=lr(f),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=u?(t[f]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function Y_(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Qt(n.origin):n.origin;a=c.r,o=c.c}var u,f={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var d=yt(s["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),a==-1&&(a=d.e.r+1,f.e.r=a+e.length-1+i)}else a==-1&&(a=0,f.e.r=e.length-1+i);var p=n.header||[],g=0;e.forEach(function(_,E){ur(_).forEach(function(L){(g=p.indexOf(L))==-1&&(p[g=p.length]=L);var V=_[L],N="z",U="",re=dt({c:o+g,r:a+E+i});u=Ja(s,re),V&&typeof V=="object"&&!(V instanceof Date)?s[re]=V:(typeof V=="number"?N="n":typeof V=="boolean"?N="b":typeof V=="string"?N="s":V instanceof Date?(N="d",n.cellDates||(N="n",V=Or(V)),U=n.dateNF||Rt[14]):V===null&&n.nullError&&(N="e",V=0),u?(u.t=N,u.v=V,delete u.w,delete u.R,U&&(u.z=U)):s[re]=u={t:N,v:V},U&&(u.z=U))})}),f.e.c=Math.max(f.e.c,o+p.length-1);var v=lr(a);if(i)for(g=0;g<p.length;++g)s[_r(g+o)+v]={t:"s",v:p[g]};return s["!ref"]=Lt(f),s}function QF(t,e){return Y_(null,t,e)}function Ja(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Qt(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Ja(t,dt(e)):Ja(t,dt({r:e,c:r||0}))}function JF(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function ZF(){return{SheetNames:[],Sheets:{}}}function e6(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(B_(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function t6(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=JF(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function r6(t,e){return t.z=e,t}function Q_(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function n6(t,e,r){return Q_(t,"#"+e,r)}function i6(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function s6(t,e,r,n){for(var i=typeof e!="string"?e:yt(e),s=typeof e=="string"?e:Lt(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var c=Ja(t,a,o);c.t="n",c.F=s,delete c.v,a==i.s.r&&o==i.s.c&&(c.f=r,n&&(c.D=!0))}return t}var cu={encode_col:_r,encode_row:lr,encode_cell:dt,encode_range:Lt,decode_col:lh,decode_row:oh,split_cell:x4,decode_cell:Qt,decode_range:jr,format_cell:Un,sheet_add_aoa:Qm,sheet_add_json:Y_,sheet_add_dom:j_,aoa_to_sheet:Xs,json_to_sheet:QF,table_to_sheet:G_,table_to_book:RF,sheet_to_csv:xh,sheet_to_txt:X_,sheet_to_json:Wl,sheet_to_html:W_,sheet_to_formulae:YF,sheet_to_row_object_array:Wl,sheet_get_cell:Ja,book_new:ZF,book_append_sheet:e6,book_set_sheet_visibility:t6,cell_set_number_format:r6,cell_set_hyperlink:Q_,cell_set_internal_link:n6,cell_add_comment:i6,sheet_set_array_formula:s6,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const a6={key:0,class:"w-full mt-10"},o6={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},l6={class:"text-lg font-bold text-emerald-600 dark:text-emerald-400 mb-2"},c6={class:"font-semibold text-gray-800 dark:text-gray-200"},u6={class:"text-sm text-gray-600 dark:text-gray-300 pl-4 list-disc"},f6={class:"mt-4 flex flex-wrap justify-between items-center"},h6={key:0,class:"flex items-center bg-gray-100 dark:bg-gray-800 rounded-full px-3 py-1"},d6=["href"],p6={key:0,class:"text-green-600 text-sm"},Ep=Hn({__name:"WeeklySchedule",setup(t){const{activities:e,schedule:r,teams:n,shareUrl:i,getDisplayDay:s,groupedSchedule:a}=Wn();function o(d){return n.value[d]||[]}const c=zt(!1);function u(){i.value&&navigator.clipboard.writeText(i.value).then(()=>{c.value=!0,setTimeout(()=>c.value=!1,2e3)})}function f(){const d=cu.book_new(),p=[],g=a.value;Object.entries(g).forEach(([L,V])=>{p.push([`Vecka ${L}`]);const N=V.map(U=>s(U));p.push(["Aktivitet",...N]),e.value.forEach(U=>{const re=[U];V.forEach(le=>{var w;re.push(((w=r.value[le])==null?void 0:w[U])??"--------------------")}),p.push(re)}),p.push([])});const v=p.length+2;let _=1;Object.entries(n.value).forEach(([L,V])=>{p[v]=p[v]||[],p[v][_]=L,V.forEach((N,U)=>{p[v+1+U]=p[v+1+U]||[],p[v+1+U][_]=N}),_+=2});const E=cu.aoa_to_sheet(p);E["!cols"]=[{wch:30}],cu.book_append_sheet(d,E,"Schema"),KF(d,"schema.xlsx")}return(d,p)=>Object.keys(ot(r)).length?(Ke(),qe("div",a6,[p[0]||(p[0]=we("h2",{class:"text-2xl font-semibold text-center mb-4 text-gray-600 dark:text-gray-300"},"Veckoschema",-1)),we("div",o6,[(Ke(!0),qe(Ft,null,nn(ot(a),(g,v)=>(Ke(),qe("div",{key:v,class:"bg-gray-300 dark:bg-gray-800 border border-gray-700 rounded-lg p-4 shadow-md"},[we("h3",l6," Vecka "+Ht(v),1),(Ke(!0),qe(Ft,null,nn(g,_=>(Ke(),qe("div",{key:_,class:"mb-4"},[we("h4",c6,Ht(ot(s)(_)),1),we("ul",u6,[(Ke(!0),qe(Ft,null,nn(ot(r)[_],(E,L)=>(Ke(),qe("li",{key:L},[T1(Ht(L)+": ",1),we("span",null,Ht(E)+" ("+Ht(o(E).join(", "))+") ",1)]))),128))])]))),128))]))),128))]),we("div",f6,[ot(i)?(Ke(),qe("div",h6,[we("a",{href:ot(i),target:"_blank",title:"Delningslänk",class:"text-sm truncate max-w-[200px] text-gray-800 dark:text-white hover:underline"},Ht(ot(i)),9,d6),we("button",{onClick:u,class:"ml-2 text-blue-600 hover:text-blue-800"}," 📋 "),c.value?(Ke(),qe("span",p6,"Länk kopierad!")):ni("",!0)])):ni("",!0),we("button",{onClick:f,class:"bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-lg shadow-md"}," Exportera till Excel ")])])):ni("",!0)}}),g6={key:0,class:"my-6"},m6={class:"flex gap-4 items-center mb-4"},_6={key:0,class:"text-sm text-gray-600 dark:text-gray-300"},v6={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},x6={class:"truncate"},E6=["onClick"],y6=Hn({__name:"BlockActivity",setup(t){const{activities:e,blockedAssignments:r,scheduleDays:n}=Wn(),i=zt(""),s=zt("");function a(){i.value&&(r.value.push({day:i.value,activity:s.value}),i.value="",s.value="")}function o(c){r.value.splice(c,1)}return(c,u)=>ot(n)&&ot(n).length>0?(Ke(),qe("div",g6,[u[5]||(u[5]=we("h2",{class:"text-lg font-semibold text-gray-800 dark:text-white mb-2"},"Blockera aktivitet",-1)),u[6]||(u[6]=we("p",{class:"text-sm text-gray-600 dark:text-gray-300 mb-4"},"Välj att blockera en hel dag eller en specifik aktivitet",-1)),we("div",m6,[Hi(we("select",{"onUpdate:modelValue":u[0]||(u[0]=f=>i.value=f),class:"bg-gray-300 dark:bg-gray-800 border border-gray-400 dark:border-gray-600 text-gray-600 dark:text-gray-300 px-3 py-2 rounded-md"},[u[2]||(u[2]=we("option",{disabled:"",value:""},"Välj dag",-1)),(Ke(!0),qe(Ft,null,nn(ot(n),f=>(Ke(),qe("option",{key:f},Ht(f),1))),128))],512),[[Eu,i.value]]),Hi(we("select",{"onUpdate:modelValue":u[1]||(u[1]=f=>s.value=f),class:"bg-gray-300 dark:bg-gray-800 border border-gray-400 dark:border-gray-600 text-gray-600 dark:text-gray-300 px-3 py-2 rounded-md"},[u[3]||(u[3]=we("option",{disabled:"",value:""},"Välj aktivitet",-1)),(Ke(!0),qe(Ft,null,nn(ot(e),f=>(Ke(),qe("option",{key:f},Ht(f),1))),128))],512),[[Eu,s.value]]),we("button",{onClick:a,class:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-md"},"Lägg till")]),ot(r).length?(Ke(),qe("div",_6,[u[4]||(u[4]=we("p",{class:"mb-1 font-medium"},"Blockerade aktiviteter:",-1)),we("div",v6,[(Ke(!0),qe(Ft,null,nn(ot(r),(f,d)=>(Ke(),qe("div",{key:d,class:"bg-gray-300 dark:bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-sm text-gray-600 dark:text-gray-300 shadow-sm flex justify-between items-center"},[we("span",x6,Ht(f.activity?f.day+" - "+f.activity:f.day+" - Heldag"),1),we("button",{onClick:p=>o(d),class:"text-red-400 hover:text-red-200 font-bold ml-4"},"×",8,E6)]))),128))])])):ni("",!0)])):ni("",!0)}}),T6={class:"space-y-2"},w6={class:"block text-blue-800 dark:text-blue-300"},A6=["onClick"],S6={class:"text-sm text-gray-600 dark:text-gray-300"},I6=Hn({__name:"GeneratedTeams",setup(t){const{teams:e,schedule:r}=Wn();async function n(i){const s=prompt("Ange nytt namn för "+i,i);if(!s||s===i)return;const a={};for(const[u,f]of Object.entries(e.value))a[u===i?s:u]=f;e.value=a;for(const u in r.value)for(const f in r.value[u])r.value[u][f]===i&&(r.value[u][f]=s);const c=new URLSearchParams(location.search).get("schedule");if(c){const u=$f(Xf,"schedules",c),f=Object.entries(r.value).map(([d,p])=>({day:d,tasks:p}));await MA(u,{teams:e.value,schedule:f})}}return(i,s)=>(Ke(),qe(Ft,null,[s[0]||(s[0]=we("h2",{class:"text-xl font-semibold text-center mb-4 text-gray-600 dark:text-gray-300"},"Lag",-1)),we("ul",T6,[(Ke(!0),qe(Ft,null,nn(ot(e),(a,o)=>(Ke(),qe("li",{key:o,class:"bg-gray-300 dark:bg-gray-800 p-3 rounded-lg border border-gray-700 relative"},[we("strong",w6,Ht(o),1),we("button",{onClick:c=>n(o),class:"absolute top-2 right-2 text-blue-600 hover:text-blue-400 text-sm underline"},"Byt namn",8,A6),we("span",S6,Ht(a.join(", ")),1)]))),128))])],64))}}),C6={class:"mb-6"},R6={class:"flex flex-col sm:flex-row gap-4"},P6={class:"flex-1"},F6=["value"],D6={class:"flex-1"},O6=Hn({__name:"ScheduleDaysSelector",setup(t){const{scheduleStartDay:e,scheduleDayCount:r,allDays:n,getAllDisplayDays:i}=Wn();function s(){r.value&&e.value&&i()}return(a,o)=>(Ke(),qe("div",C6,[o[4]||(o[4]=we("h2",{class:"text-lg font-semibold text-gray-800 dark:text-white mb-2"},"Schemadagar",-1)),o[5]||(o[5]=we("p",{class:"text-sm text-gray-600 dark:text-gray-300 mb-4"},"Välj vilken veckodag schemat ska börja på och hur många dagar det ska vara",-1)),we("div",R6,[we("div",P6,[o[2]||(o[2]=we("label",{class:"block text-sm text-gray-700 dark:text-gray-300 mb-1"},"Startdag",-1)),Hi(we("select",{"onUpdate:modelValue":o[0]||(o[0]=c=>Wt(e)?e.value=c:null),class:"w-full bg-gray-300 dark:bg-gray-800 border border-gray-400 dark:border-gray-600 text-gray-600 dark:text-gray-300 px-3 py-2 rounded-md h-[42px]"},[(Ke(!0),qe(Ft,null,nn(ot(n),c=>(Ke(),qe("option",{key:c,value:c},Ht(c),9,F6))),128))],512),[[Eu,ot(e)]])]),we("div",D6,[o[3]||(o[3]=we("label",{class:"block text-sm text-gray-700 dark:text-gray-300 mb-1"},"Antal dagar",-1)),Hi(we("input",{type:"number",min:"1",max:"28","onUpdate:modelValue":o[1]||(o[1]=c=>Wt(r)?r.value=c:null),class:"w-full bg-gray-300 dark:bg-gray-800 border border-gray-400 dark:border-gray-600 text-gray-600 dark:text-gray-300 px-3 py-2 rounded-md h-[42px]"},null,512),[[rc,ot(r),void 0,{number:!0}]])]),we("div",{class:"flex items-end"},[we("button",{onClick:s,class:"h-[42px] bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg shadow-md transition duration-200"}," Lägg till ")])])]))}}),b6={class:"min-h-screen p-6 sm:p-10 max-w-4xl mx-auto space-y-10 transition-colors duration-300"},k6={class:"absolute top-4 right-4"},N6={key:0,class:"space-y-6"},L6={key:1,class:"flex flex-col items-center space-y-6"},M6={key:0,class:"w-full max-w-lg"},V6=Hn({__name:"App",setup(t){const{schedule:e,teams:r,hasGeneratedTeams:n,activities:i,people:s}=Wn(),a=zt(!1),o=zt(!1);e1(()=>{const u=localStorage.getItem("theme");u==="dark"?a.value=!0:u==="light"?a.value=!1:a.value=window.matchMedia("(prefers-color-scheme: dark)").matches;const d=new URLSearchParams(location.search).get("schedule");d&&NA($f(Xf,"schedules",d)).then(v=>{if(v.exists()){const _=v.data();e.value=Object.fromEntries(_.schedule.map(E=>[E.day,E.tasks])),r.value=_.teams,n.value=!0,o.value=!0}});const p=localStorage.getItem("savedActivities"),g=localStorage.getItem("savedPeople");p&&(i.value=JSON.parse(p)),g&&(s.value=JSON.parse(g))});function c(){a.value=!a.value,localStorage.setItem("theme",a.value?"dark":"light")}return Ss(a,u=>{document.documentElement.classList.toggle("dark",u)},{immediate:!0}),Ss(i,u=>{localStorage.setItem("savedActivities",JSON.stringify(u))},{deep:!0}),Ss(s,u=>{localStorage.setItem("savedPeople",JSON.stringify(u))},{deep:!0}),(u,f)=>(Ke(),qe("main",b6,[we("div",k6,[we("div",{class:"relative w-14 h-8 rounded-full cursor-pointer bg-gray-300 dark:bg-gray-700 transition duration-300",onClick:c},[we("div",{class:ql(["absolute top-1 left-1 w-6 h-6 rounded-full bg-white flex items-center justify-center text-sm transition-all duration-300",{"translate-x-6":a.value}])},[we("span",null,Ht(a.value?"🌙":"☀️"),1)],2)])]),f[0]||(f[0]=we("header",{class:"text-center"},[we("h1",{class:"text-3xl sm:text-4xl font-bold tracking-tight mb-2 text-gray-600 dark:text-gray-300"},"Schemaläggare"),we("p",{class:"text-sm text-gray-600 dark:text-gray-300"},"Skapa slumpmässiga lag och generera ett veckoschema")],-1)),o.value?(Ke(),qe("section",L6,[ot(n)?(Ke(),qe("div",M6,[qt(I6)])):ni("",!0),qt(Ep)])):(Ke(),qe("section",N6,[qt(eS),qt(aS),qt(O6),qt(y6),qt(cS),qt(mS),qt(Ep)]))]))}});b2(V6).mount("#app");
