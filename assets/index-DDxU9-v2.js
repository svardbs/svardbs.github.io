(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();/**
* @vue/shared v3.5.16
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Vu(t){const e=Object.create(null);for(const r of t.split(","))e[r]=1;return r=>r in e}const mt={},vs=[],hn=()=>{},rv=()=>!1,Wl=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Bu=t=>t.startsWith("onUpdate:"),vr=Object.assign,Uu=(t,e)=>{const r=t.indexOf(e);r>-1&&t.splice(r,1)},nv=Object.prototype.hasOwnProperty,at=(t,e)=>nv.call(t,e),Me=Array.isArray,xs=t=>Qa(t)==="[object Map]",$l=t=>Qa(t)==="[object Set]",Lh=t=>Qa(t)==="[object Date]",Ge=t=>typeof t=="function",Lt=t=>typeof t=="string",gn=t=>typeof t=="symbol",xt=t=>t!==null&&typeof t=="object",lp=t=>(xt(t)||Ge(t))&&Ge(t.then)&&Ge(t.catch),cp=Object.prototype.toString,Qa=t=>cp.call(t),iv=t=>Qa(t).slice(8,-1),up=t=>Qa(t)==="[object Object]",Hu=t=>Lt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,ha=Vu(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),jl=t=>{const e=Object.create(null);return r=>e[r]||(e[r]=t(r))},sv=/-(\w)/g,ai=jl(t=>t.replace(sv,(e,r)=>r?r.toUpperCase():"")),av=/\B([A-Z])/g,vi=jl(t=>t.replace(av,"-$1").toLowerCase()),fp=jl(t=>t.charAt(0).toUpperCase()+t.slice(1)),Pc=jl(t=>t?`on${fp(t)}`:""),ei=(t,e)=>!Object.is(t,e),Wo=(t,...e)=>{for(let r=0;r<t.length;r++)t[r](...e)},hp=(t,e,r,n=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:n,value:r})},Qo=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Mh;const Gl=()=>Mh||(Mh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Wu(t){if(Me(t)){const e={};for(let r=0;r<t.length;r++){const n=t[r],i=Lt(n)?uv(n):Wu(n);if(i)for(const s in i)e[s]=i[s]}return e}else if(Lt(t)||xt(t))return t}const ov=/;(?![^(]*\))/g,lv=/:([^]+)/,cv=/\/\*[^]*?\*\//g;function uv(t){const e={};return t.replace(cv,"").split(ov).forEach(r=>{if(r){const n=r.split(lv);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function zl(t){let e="";if(Lt(t))e=t;else if(Me(t))for(let r=0;r<t.length;r++){const n=zl(t[r]);n&&(e+=n+" ")}else if(xt(t))for(const r in t)t[r]&&(e+=r+" ");return e.trim()}const fv="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",hv=Vu(fv);function dp(t){return!!t||t===""}function dv(t,e){if(t.length!==e.length)return!1;let r=!0;for(let n=0;r&&n<t.length;n++)r=Kl(t[n],e[n]);return r}function Kl(t,e){if(t===e)return!0;let r=Lh(t),n=Lh(e);if(r||n)return r&&n?t.getTime()===e.getTime():!1;if(r=gn(t),n=gn(e),r||n)return t===e;if(r=Me(t),n=Me(e),r||n)return r&&n?dv(t,e):!1;if(r=xt(t),n=xt(e),r||n){if(!r||!n)return!1;const i=Object.keys(t).length,s=Object.keys(e).length;if(i!==s)return!1;for(const a in t){const o=t.hasOwnProperty(a),c=e.hasOwnProperty(a);if(o&&!c||!o&&c||!Kl(t[a],e[a]))return!1}}return String(t)===String(e)}function pv(t,e){return t.findIndex(r=>Kl(r,e))}const pp=t=>!!(t&&t.__v_isRef===!0),zt=t=>Lt(t)?t:t==null?"":Me(t)||xt(t)&&(t.toString===cp||!Ge(t.toString))?pp(t)?zt(t.value):JSON.stringify(t,gp,2):String(t),gp=(t,e)=>pp(e)?gp(t,e.value):xs(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((r,[n,i],s)=>(r[Fc(n,s)+" =>"]=i,r),{})}:$l(e)?{[`Set(${e.size})`]:[...e.values()].map(r=>Fc(r))}:gn(e)?Fc(e):xt(e)&&!Me(e)&&!up(e)?String(e):e,Fc=(t,e="")=>{var r;return gn(t)?`Symbol(${(r=t.description)!=null?r:e})`:t};/**
* @vue/reactivity v3.5.16
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Rr;class gv{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Rr,!e&&Rr&&(this.index=(Rr.scopes||(Rr.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,r;if(this.scopes)for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].pause();for(e=0,r=this.effects.length;e<r;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,r;if(this.scopes)for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].resume();for(e=0,r=this.effects.length;e<r;e++)this.effects[e].resume()}}run(e){if(this._active){const r=Rr;try{return Rr=this,e()}finally{Rr=r}}}on(){++this._on===1&&(this.prevScope=Rr,Rr=this)}off(){this._on>0&&--this._on===0&&(Rr=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(this.effects.length=0,r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.cleanups.length=0,this.scopes){for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function mv(){return Rr}let _t;const Dc=new WeakSet;class mp{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Rr&&Rr.active&&Rr.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Dc.has(this)&&(Dc.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||vp(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Vh(this),xp(this);const e=_t,r=rn;_t=this,rn=!0;try{return this.fn()}finally{Ep(this),_t=e,rn=r,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Gu(e);this.deps=this.depsTail=void 0,Vh(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Dc.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){ru(this)&&this.run()}get dirty(){return ru(this)}}let _p=0,da,pa;function vp(t,e=!1){if(t.flags|=8,e){t.next=pa,pa=t;return}t.next=da,da=t}function $u(){_p++}function ju(){if(--_p>0)return;if(pa){let e=pa;for(pa=void 0;e;){const r=e.next;e.next=void 0,e.flags&=-9,e=r}}let t;for(;da;){let e=da;for(da=void 0;e;){const r=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){t||(t=n)}e=r}}if(t)throw t}function xp(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function Ep(t){let e,r=t.depsTail,n=r;for(;n;){const i=n.prevDep;n.version===-1?(n===r&&(r=i),Gu(n),_v(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=i}t.deps=e,t.depsTail=r}function ru(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(Tp(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function Tp(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===Pa)||(t.globalVersion=Pa,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!ru(t))))return;t.flags|=2;const e=t.dep,r=_t,n=rn;_t=t,rn=!0;try{xp(t);const i=t.fn(t._value);(e.version===0||ei(i,t._value))&&(t.flags|=128,t._value=i,e.version++)}catch(i){throw e.version++,i}finally{_t=r,rn=n,Ep(t),t.flags&=-3}}function Gu(t,e=!1){const{dep:r,prevSub:n,nextSub:i}=t;if(n&&(n.nextSub=i,t.prevSub=void 0),i&&(i.prevSub=n,t.nextSub=void 0),r.subs===t&&(r.subs=n,!n&&r.computed)){r.computed.flags&=-5;for(let s=r.computed.deps;s;s=s.nextDep)Gu(s,!0)}!e&&!--r.sc&&r.map&&r.map.delete(r.key)}function _v(t){const{prevDep:e,nextDep:r}=t;e&&(e.nextDep=r,t.prevDep=void 0),r&&(r.prevDep=e,t.nextDep=void 0)}let rn=!0;const yp=[];function kn(){yp.push(rn),rn=!1}function Nn(){const t=yp.pop();rn=t===void 0?!0:t}function Vh(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const r=_t;_t=void 0;try{e()}finally{_t=r}}}let Pa=0;class vv{constructor(e,r){this.sub=e,this.dep=r,this.version=r.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class zu{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!_t||!rn||_t===this.computed)return;let r=this.activeLink;if(r===void 0||r.sub!==_t)r=this.activeLink=new vv(_t,this),_t.deps?(r.prevDep=_t.depsTail,_t.depsTail.nextDep=r,_t.depsTail=r):_t.deps=_t.depsTail=r,wp(r);else if(r.version===-1&&(r.version=this.version,r.nextDep)){const n=r.nextDep;n.prevDep=r.prevDep,r.prevDep&&(r.prevDep.nextDep=n),r.prevDep=_t.depsTail,r.nextDep=void 0,_t.depsTail.nextDep=r,_t.depsTail=r,_t.deps===r&&(_t.deps=n)}return r}trigger(e){this.version++,Pa++,this.notify(e)}notify(e){$u();try{for(let r=this.subs;r;r=r.prevSub)r.sub.notify()&&r.sub.dep.notify()}finally{ju()}}}function wp(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)wp(n)}const r=t.dep.subs;r!==t&&(t.prevSub=r,r&&(r.nextSub=t)),t.dep.subs=t}}const nu=new WeakMap,Li=Symbol(""),iu=Symbol(""),Fa=Symbol("");function pr(t,e,r){if(rn&&_t){let n=nu.get(t);n||nu.set(t,n=new Map);let i=n.get(r);i||(n.set(r,i=new zu),i.map=n,i.key=r),i.track()}}function Cn(t,e,r,n,i,s){const a=nu.get(t);if(!a){Pa++;return}const o=c=>{c&&c.trigger()};if($u(),e==="clear")a.forEach(o);else{const c=Me(t),u=c&&Hu(r);if(c&&r==="length"){const f=Number(n);a.forEach((d,p)=>{(p==="length"||p===Fa||!gn(p)&&p>=f)&&o(d)})}else switch((r!==void 0||a.has(void 0))&&o(a.get(r)),u&&o(a.get(Fa)),e){case"add":c?u&&o(a.get("length")):(o(a.get(Li)),xs(t)&&o(a.get(iu)));break;case"delete":c||(o(a.get(Li)),xs(t)&&o(a.get(iu)));break;case"set":xs(t)&&o(a.get(Li));break}}ju()}function as(t){const e=st(t);return e===t?e:(pr(e,"iterate",Fa),zr(t)?e:e.map(rr))}function ql(t){return pr(t=st(t),"iterate",Fa),t}const xv={__proto__:null,[Symbol.iterator](){return Oc(this,Symbol.iterator,rr)},concat(...t){return as(this).concat(...t.map(e=>Me(e)?as(e):e))},entries(){return Oc(this,"entries",t=>(t[1]=rr(t[1]),t))},every(t,e){return Sn(this,"every",t,e,void 0,arguments)},filter(t,e){return Sn(this,"filter",t,e,r=>r.map(rr),arguments)},find(t,e){return Sn(this,"find",t,e,rr,arguments)},findIndex(t,e){return Sn(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Sn(this,"findLast",t,e,rr,arguments)},findLastIndex(t,e){return Sn(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Sn(this,"forEach",t,e,void 0,arguments)},includes(...t){return bc(this,"includes",t)},indexOf(...t){return bc(this,"indexOf",t)},join(t){return as(this).join(t)},lastIndexOf(...t){return bc(this,"lastIndexOf",t)},map(t,e){return Sn(this,"map",t,e,void 0,arguments)},pop(){return ia(this,"pop")},push(...t){return ia(this,"push",t)},reduce(t,...e){return Bh(this,"reduce",t,e)},reduceRight(t,...e){return Bh(this,"reduceRight",t,e)},shift(){return ia(this,"shift")},some(t,e){return Sn(this,"some",t,e,void 0,arguments)},splice(...t){return ia(this,"splice",t)},toReversed(){return as(this).toReversed()},toSorted(t){return as(this).toSorted(t)},toSpliced(...t){return as(this).toSpliced(...t)},unshift(...t){return ia(this,"unshift",t)},values(){return Oc(this,"values",rr)}};function Oc(t,e,r){const n=ql(t),i=n[e]();return n!==t&&!zr(t)&&(i._next=i.next,i.next=()=>{const s=i._next();return s.value&&(s.value=r(s.value)),s}),i}const Ev=Array.prototype;function Sn(t,e,r,n,i,s){const a=ql(t),o=a!==t&&!zr(t),c=a[e];if(c!==Ev[e]){const d=c.apply(t,s);return o?rr(d):d}let u=r;a!==t&&(o?u=function(d,p){return r.call(this,rr(d),p,t)}:r.length>2&&(u=function(d,p){return r.call(this,d,p,t)}));const f=c.call(a,u,n);return o&&i?i(f):f}function Bh(t,e,r,n){const i=ql(t);let s=r;return i!==t&&(zr(t)?r.length>3&&(s=function(a,o,c){return r.call(this,a,o,c,t)}):s=function(a,o,c){return r.call(this,a,rr(o),c,t)}),i[e](s,...n)}function bc(t,e,r){const n=st(t);pr(n,"iterate",Fa);const i=n[e](...r);return(i===-1||i===!1)&&Yu(r[0])?(r[0]=st(r[0]),n[e](...r)):i}function ia(t,e,r=[]){kn(),$u();const n=st(t)[e].apply(t,r);return ju(),Nn(),n}const Tv=Vu("__proto__,__v_isRef,__isVue"),Ap=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(gn));function yv(t){gn(t)||(t=String(t));const e=st(this);return pr(e,"has",t),e.hasOwnProperty(t)}class Sp{constructor(e=!1,r=!1){this._isReadonly=e,this._isShallow=r}get(e,r,n){if(r==="__v_skip")return e.__v_skip;const i=this._isReadonly,s=this._isShallow;if(r==="__v_isReactive")return!i;if(r==="__v_isReadonly")return i;if(r==="__v_isShallow")return s;if(r==="__v_raw")return n===(i?s?Ov:Pp:s?Rp:Cp).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const a=Me(e);if(!i){let c;if(a&&(c=xv[r]))return c;if(r==="hasOwnProperty")return yv}const o=Reflect.get(e,r,ar(e)?e:n);return(gn(r)?Ap.has(r):Tv(r))||(i||pr(e,"get",r),s)?o:ar(o)?a&&Hu(r)?o:o.value:xt(o)?i?Fp(o):qu(o):o}}class Ip extends Sp{constructor(e=!1){super(!1,e)}set(e,r,n,i){let s=e[r];if(!this._isShallow){const c=oi(s);if(!zr(n)&&!oi(n)&&(s=st(s),n=st(n)),!Me(e)&&ar(s)&&!ar(n))return c?!1:(s.value=n,!0)}const a=Me(e)&&Hu(r)?Number(r)<e.length:at(e,r),o=Reflect.set(e,r,n,ar(e)?e:i);return e===st(i)&&(a?ei(n,s)&&Cn(e,"set",r,n):Cn(e,"add",r,n)),o}deleteProperty(e,r){const n=at(e,r);e[r];const i=Reflect.deleteProperty(e,r);return i&&n&&Cn(e,"delete",r,void 0),i}has(e,r){const n=Reflect.has(e,r);return(!gn(r)||!Ap.has(r))&&pr(e,"has",r),n}ownKeys(e){return pr(e,"iterate",Me(e)?"length":Li),Reflect.ownKeys(e)}}class wv extends Sp{constructor(e=!1){super(!0,e)}set(e,r){return!0}deleteProperty(e,r){return!0}}const Av=new Ip,Sv=new wv,Iv=new Ip(!0);const su=t=>t,Io=t=>Reflect.getPrototypeOf(t);function Cv(t,e,r){return function(...n){const i=this.__v_raw,s=st(i),a=xs(s),o=t==="entries"||t===Symbol.iterator&&a,c=t==="keys"&&a,u=i[t](...n),f=r?su:e?Jo:rr;return!e&&pr(s,"iterate",c?iu:Li),{next(){const{value:d,done:p}=u.next();return p?{value:d,done:p}:{value:o?[f(d[0]),f(d[1])]:f(d),done:p}},[Symbol.iterator](){return this}}}}function Co(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Rv(t,e){const r={get(i){const s=this.__v_raw,a=st(s),o=st(i);t||(ei(i,o)&&pr(a,"get",i),pr(a,"get",o));const{has:c}=Io(a),u=e?su:t?Jo:rr;if(c.call(a,i))return u(s.get(i));if(c.call(a,o))return u(s.get(o));s!==a&&s.get(i)},get size(){const i=this.__v_raw;return!t&&pr(st(i),"iterate",Li),Reflect.get(i,"size",i)},has(i){const s=this.__v_raw,a=st(s),o=st(i);return t||(ei(i,o)&&pr(a,"has",i),pr(a,"has",o)),i===o?s.has(i):s.has(i)||s.has(o)},forEach(i,s){const a=this,o=a.__v_raw,c=st(o),u=e?su:t?Jo:rr;return!t&&pr(c,"iterate",Li),o.forEach((f,d)=>i.call(s,u(f),u(d),a))}};return vr(r,t?{add:Co("add"),set:Co("set"),delete:Co("delete"),clear:Co("clear")}:{add(i){!e&&!zr(i)&&!oi(i)&&(i=st(i));const s=st(this);return Io(s).has.call(s,i)||(s.add(i),Cn(s,"add",i,i)),this},set(i,s){!e&&!zr(s)&&!oi(s)&&(s=st(s));const a=st(this),{has:o,get:c}=Io(a);let u=o.call(a,i);u||(i=st(i),u=o.call(a,i));const f=c.call(a,i);return a.set(i,s),u?ei(s,f)&&Cn(a,"set",i,s):Cn(a,"add",i,s),this},delete(i){const s=st(this),{has:a,get:o}=Io(s);let c=a.call(s,i);c||(i=st(i),c=a.call(s,i)),o&&o.call(s,i);const u=s.delete(i);return c&&Cn(s,"delete",i,void 0),u},clear(){const i=st(this),s=i.size!==0,a=i.clear();return s&&Cn(i,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(i=>{r[i]=Cv(i,t,e)}),r}function Ku(t,e){const r=Rv(t,e);return(n,i,s)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?n:Reflect.get(at(r,i)&&i in n?r:n,i,s)}const Pv={get:Ku(!1,!1)},Fv={get:Ku(!1,!0)},Dv={get:Ku(!0,!1)};const Cp=new WeakMap,Rp=new WeakMap,Pp=new WeakMap,Ov=new WeakMap;function bv(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function kv(t){return t.__v_skip||!Object.isExtensible(t)?0:bv(iv(t))}function qu(t){return oi(t)?t:Xu(t,!1,Av,Pv,Cp)}function Nv(t){return Xu(t,!1,Iv,Fv,Rp)}function Fp(t){return Xu(t,!0,Sv,Dv,Pp)}function Xu(t,e,r,n,i){if(!xt(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const s=kv(t);if(s===0)return t;const a=i.get(t);if(a)return a;const o=new Proxy(t,s===2?n:r);return i.set(t,o),o}function Es(t){return oi(t)?Es(t.__v_raw):!!(t&&t.__v_isReactive)}function oi(t){return!!(t&&t.__v_isReadonly)}function zr(t){return!!(t&&t.__v_isShallow)}function Yu(t){return t?!!t.__v_raw:!1}function st(t){const e=t&&t.__v_raw;return e?st(e):t}function Lv(t){return!at(t,"__v_skip")&&Object.isExtensible(t)&&hp(t,"__v_skip",!0),t}const rr=t=>xt(t)?qu(t):t,Jo=t=>xt(t)?Fp(t):t;function ar(t){return t?t.__v_isRef===!0:!1}function xr(t){return Mv(t,!1)}function Mv(t,e){return ar(t)?t:new Vv(t,e)}class Vv{constructor(e,r){this.dep=new zu,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=r?e:st(e),this._value=r?e:rr(e),this.__v_isShallow=r}get value(){return this.dep.track(),this._value}set value(e){const r=this._rawValue,n=this.__v_isShallow||zr(e)||oi(e);e=n?e:st(e),ei(e,r)&&(this._rawValue=e,this._value=n?e:rr(e),this.dep.trigger())}}function At(t){return ar(t)?t.value:t}const Bv={get:(t,e,r)=>e==="__v_raw"?t:At(Reflect.get(t,e,r)),set:(t,e,r,n)=>{const i=t[e];return ar(i)&&!ar(r)?(i.value=r,!0):Reflect.set(t,e,r,n)}};function Dp(t){return Es(t)?t:new Proxy(t,Bv)}class Uv{constructor(e,r,n){this.fn=e,this.setter=r,this._value=void 0,this.dep=new zu(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Pa-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!r,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&_t!==this)return vp(this,!0),!0}get value(){const e=this.dep.track();return Tp(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Hv(t,e,r=!1){let n,i;return Ge(t)?n=t:(n=t.get,i=t.set),new Uv(n,i,r)}const Ro={},Zo=new WeakMap;let Fi;function Wv(t,e=!1,r=Fi){if(r){let n=Zo.get(r);n||Zo.set(r,n=[]),n.push(t)}}function $v(t,e,r=mt){const{immediate:n,deep:i,once:s,scheduler:a,augmentJob:o,call:c}=r,u=U=>i?U:zr(U)||i===!1||i===0?Rn(U,1):Rn(U);let f,d,p,g,v=!1,_=!1;if(ar(t)?(d=()=>t.value,v=zr(t)):Es(t)?(d=()=>u(t),v=!0):Me(t)?(_=!0,v=t.some(U=>Es(U)||zr(U)),d=()=>t.map(U=>{if(ar(U))return U.value;if(Es(U))return u(U);if(Ge(U))return c?c(U,2):U()})):Ge(t)?e?d=c?()=>c(t,2):t:d=()=>{if(p){kn();try{p()}finally{Nn()}}const U=Fi;Fi=f;try{return c?c(t,3,[g]):t(g)}finally{Fi=U}}:d=hn,e&&i){const U=d,re=i===!0?1/0:i;d=()=>Rn(U(),re)}const E=mv(),L=()=>{f.stop(),E&&E.active&&Uu(E.effects,f)};if(s&&e){const U=e;e=(...re)=>{U(...re),L()}}let V=_?new Array(t.length).fill(Ro):Ro;const N=U=>{if(!(!(f.flags&1)||!f.dirty&&!U))if(e){const re=f.run();if(i||v||(_?re.some((ue,w)=>ei(ue,V[w])):ei(re,V))){p&&p();const ue=Fi;Fi=f;try{const w=[re,V===Ro?void 0:_&&V[0]===Ro?[]:V,g];V=re,c?c(e,3,w):e(...w)}finally{Fi=ue}}}else f.run()};return o&&o(N),f=new mp(d),f.scheduler=a?()=>a(N,!1):N,g=U=>Wv(U,!1,f),p=f.onStop=()=>{const U=Zo.get(f);if(U){if(c)c(U,4);else for(const re of U)re();Zo.delete(f)}},e?n?N(!0):V=f.run():a?a(N.bind(null,!0),!0):f.run(),L.pause=f.pause.bind(f),L.resume=f.resume.bind(f),L.stop=L,L}function Rn(t,e=1/0,r){if(e<=0||!xt(t)||t.__v_skip||(r=r||new Set,r.has(t)))return t;if(r.add(t),e--,ar(t))Rn(t.value,e,r);else if(Me(t))for(let n=0;n<t.length;n++)Rn(t[n],e,r);else if($l(t)||xs(t))t.forEach(n=>{Rn(n,e,r)});else if(up(t)){for(const n in t)Rn(t[n],e,r);for(const n of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,n)&&Rn(t[n],e,r)}return t}/**
* @vue/runtime-core v3.5.16
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Ja(t,e,r,n){try{return n?t(...n):t()}catch(i){Xl(i,e,r)}}function mn(t,e,r,n){if(Ge(t)){const i=Ja(t,e,r,n);return i&&lp(i)&&i.catch(s=>{Xl(s,e,r)}),i}if(Me(t)){const i=[];for(let s=0;s<t.length;s++)i.push(mn(t[s],e,r,n));return i}}function Xl(t,e,r,n=!0){const i=e?e.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:a}=e&&e.appContext.config||mt;if(e){let o=e.parent;const c=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${r}`;for(;o;){const f=o.ec;if(f){for(let d=0;d<f.length;d++)if(f[d](t,c,u)===!1)return}o=o.parent}if(s){kn(),Ja(s,null,10,[t,c,u]),Nn();return}}jv(t,r,i,n,a)}function jv(t,e,r,n=!0,i=!1){if(i)throw t;console.error(t)}const Ar=[];let cn=-1;const Ts=[];let Xn=null,us=0;const Op=Promise.resolve();let el=null;function bp(t){const e=el||Op;return t?e.then(this?t.bind(this):t):e}function Gv(t){let e=cn+1,r=Ar.length;for(;e<r;){const n=e+r>>>1,i=Ar[n],s=Da(i);s<t||s===t&&i.flags&2?e=n+1:r=n}return e}function Qu(t){if(!(t.flags&1)){const e=Da(t),r=Ar[Ar.length-1];!r||!(t.flags&2)&&e>=Da(r)?Ar.push(t):Ar.splice(Gv(e),0,t),t.flags|=1,kp()}}function kp(){el||(el=Op.then(Lp))}function zv(t){Me(t)?Ts.push(...t):Xn&&t.id===-1?Xn.splice(us+1,0,t):t.flags&1||(Ts.push(t),t.flags|=1),kp()}function Uh(t,e,r=cn+1){for(;r<Ar.length;r++){const n=Ar[r];if(n&&n.flags&2){if(t&&n.id!==t.uid)continue;Ar.splice(r,1),r--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function Np(t){if(Ts.length){const e=[...new Set(Ts)].sort((r,n)=>Da(r)-Da(n));if(Ts.length=0,Xn){Xn.push(...e);return}for(Xn=e,us=0;us<Xn.length;us++){const r=Xn[us];r.flags&4&&(r.flags&=-2),r.flags&8||r(),r.flags&=-2}Xn=null,us=0}}const Da=t=>t.id==null?t.flags&2?-1:1/0:t.id;function Lp(t){try{for(cn=0;cn<Ar.length;cn++){const e=Ar[cn];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Ja(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;cn<Ar.length;cn++){const e=Ar[cn];e&&(e.flags&=-2)}cn=-1,Ar.length=0,Np(),el=null,(Ar.length||Ts.length)&&Lp()}}let Gr=null,Mp=null;function tl(t){const e=Gr;return Gr=t,Mp=t&&t.type.__scopeId||null,e}function Kv(t,e=Gr,r){if(!e||t._n)return t;const n=(...i)=>{n._d&&Xh(-1);const s=tl(e);let a;try{a=t(...i)}finally{tl(s),n._d&&Xh(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}function Oa(t,e){if(Gr===null)return t;const r=Zl(Gr),n=t.dirs||(t.dirs=[]);for(let i=0;i<e.length;i++){let[s,a,o,c=mt]=e[i];s&&(Ge(s)&&(s={mounted:s,updated:s}),s.deep&&Rn(a),n.push({dir:s,instance:r,value:a,oldValue:void 0,arg:o,modifiers:c}))}return t}function Ri(t,e,r,n){const i=t.dirs,s=e&&e.dirs;for(let a=0;a<i.length;a++){const o=i[a];s&&(o.oldValue=s[a].value);let c=o.dir[n];c&&(kn(),mn(c,r,8,[t.el,o,t,e]),Nn())}}const qv=Symbol("_vte"),Xv=t=>t.__isTeleport;function Ju(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Ju(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}/*! #__NO_SIDE_EFFECTS__ */function xi(t,e){return Ge(t)?vr({name:t.name},e,{setup:t}):t}function Vp(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function rl(t,e,r,n,i=!1){if(Me(t)){t.forEach((v,_)=>rl(v,e&&(Me(e)?e[_]:e),r,n,i));return}if(ga(n)&&!i){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&rl(t,e,r,n.component.subTree);return}const s=n.shapeFlag&4?Zl(n.component):n.el,a=i?null:s,{i:o,r:c}=t,u=e&&e.r,f=o.refs===mt?o.refs={}:o.refs,d=o.setupState,p=st(d),g=d===mt?()=>!1:v=>at(p,v);if(u!=null&&u!==c&&(Lt(u)?(f[u]=null,g(u)&&(d[u]=null)):ar(u)&&(u.value=null)),Ge(c))Ja(c,o,12,[a,f]);else{const v=Lt(c),_=ar(c);if(v||_){const E=()=>{if(t.f){const L=v?g(c)?d[c]:f[c]:c.value;i?Me(L)&&Uu(L,s):Me(L)?L.includes(s)||L.push(s):v?(f[c]=[s],g(c)&&(d[c]=f[c])):(c.value=[s],t.k&&(f[t.k]=c.value))}else v?(f[c]=a,g(c)&&(d[c]=a)):_&&(c.value=a,t.k&&(f[t.k]=a))};a?(E.id=-1,Nr(E,r)):E()}}}Gl().requestIdleCallback;Gl().cancelIdleCallback;const ga=t=>!!t.type.__asyncLoader,Bp=t=>t.type.__isKeepAlive;function Yv(t,e){Up(t,"a",e)}function Qv(t,e){Up(t,"da",e)}function Up(t,e,r=Sr){const n=t.__wdc||(t.__wdc=()=>{let i=r;for(;i;){if(i.isDeactivated)return;i=i.parent}return t()});if(Yl(e,n,r),r){let i=r.parent;for(;i&&i.parent;)Bp(i.parent.vnode)&&Jv(n,e,r,i),i=i.parent}}function Jv(t,e,r,n){const i=Yl(e,t,n,!0);Wp(()=>{Uu(n[e],i)},r)}function Yl(t,e,r=Sr,n=!1){if(r){const i=r[t]||(r[t]=[]),s=e.__weh||(e.__weh=(...a)=>{kn();const o=Za(r),c=mn(e,r,t,a);return o(),Nn(),c});return n?i.unshift(s):i.push(s),s}}const Hn=t=>(e,r=Sr)=>{(!ka||t==="sp")&&Yl(t,(...n)=>e(...n),r)},Zv=Hn("bm"),Hp=Hn("m"),ex=Hn("bu"),tx=Hn("u"),rx=Hn("bum"),Wp=Hn("um"),nx=Hn("sp"),ix=Hn("rtg"),sx=Hn("rtc");function ax(t,e=Sr){Yl("ec",t,e)}const ox=Symbol.for("v-ndc");function Pn(t,e,r,n){let i;const s=r,a=Me(t);if(a||Lt(t)){const o=a&&Es(t);let c=!1,u=!1;o&&(c=!zr(t),u=oi(t),t=ql(t)),i=new Array(t.length);for(let f=0,d=t.length;f<d;f++)i[f]=e(c?u?Jo(rr(t[f])):rr(t[f]):t[f],f,void 0,s)}else if(typeof t=="number"){i=new Array(t);for(let o=0;o<t;o++)i[o]=e(o+1,o,void 0,s)}else if(xt(t))if(t[Symbol.iterator])i=Array.from(t,(o,c)=>e(o,c,void 0,s));else{const o=Object.keys(t);i=new Array(o.length);for(let c=0,u=o.length;c<u;c++){const f=o[c];i[c]=e(t[f],f,c,s)}}else i=[];return i}const au=t=>t?u1(t)?Zl(t):au(t.parent):null,ma=vr(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>au(t.parent),$root:t=>au(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>jp(t),$forceUpdate:t=>t.f||(t.f=()=>{Qu(t.update)}),$nextTick:t=>t.n||(t.n=bp.bind(t.proxy)),$watch:t=>Px.bind(t)}),kc=(t,e)=>t!==mt&&!t.__isScriptSetup&&at(t,e),lx={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:r,setupState:n,data:i,props:s,accessCache:a,type:o,appContext:c}=t;let u;if(e[0]!=="$"){const g=a[e];if(g!==void 0)switch(g){case 1:return n[e];case 2:return i[e];case 4:return r[e];case 3:return s[e]}else{if(kc(n,e))return a[e]=1,n[e];if(i!==mt&&at(i,e))return a[e]=2,i[e];if((u=t.propsOptions[0])&&at(u,e))return a[e]=3,s[e];if(r!==mt&&at(r,e))return a[e]=4,r[e];ou&&(a[e]=0)}}const f=ma[e];let d,p;if(f)return e==="$attrs"&&pr(t.attrs,"get",""),f(t);if((d=o.__cssModules)&&(d=d[e]))return d;if(r!==mt&&at(r,e))return a[e]=4,r[e];if(p=c.config.globalProperties,at(p,e))return p[e]},set({_:t},e,r){const{data:n,setupState:i,ctx:s}=t;return kc(i,e)?(i[e]=r,!0):n!==mt&&at(n,e)?(n[e]=r,!0):at(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(s[e]=r,!0)},has({_:{data:t,setupState:e,accessCache:r,ctx:n,appContext:i,propsOptions:s}},a){let o;return!!r[a]||t!==mt&&at(t,a)||kc(e,a)||(o=s[0])&&at(o,a)||at(n,a)||at(ma,a)||at(i.config.globalProperties,a)},defineProperty(t,e,r){return r.get!=null?t._.accessCache[e]=0:at(r,"value")&&this.set(t,e,r.value,null),Reflect.defineProperty(t,e,r)}};function Hh(t){return Me(t)?t.reduce((e,r)=>(e[r]=null,e),{}):t}let ou=!0;function cx(t){const e=jp(t),r=t.proxy,n=t.ctx;ou=!1,e.beforeCreate&&Wh(e.beforeCreate,t,"bc");const{data:i,computed:s,methods:a,watch:o,provide:c,inject:u,created:f,beforeMount:d,mounted:p,beforeUpdate:g,updated:v,activated:_,deactivated:E,beforeDestroy:L,beforeUnmount:V,destroyed:N,unmounted:U,render:re,renderTracked:ue,renderTriggered:w,errorCaptured:y,serverPrefetch:T,expose:I,inheritAttrs:P,components:k,directives:R,filters:$e}=e;if(u&&ux(u,n,null),a)for(const Ne in a){const He=a[Ne];Ge(He)&&(n[Ne]=He.bind(r))}if(i){const Ne=i.call(r,r);xt(Ne)&&(t.data=qu(Ne))}if(ou=!0,s)for(const Ne in s){const He=s[Ne],it=Ge(He)?He.bind(r,r):Ge(He.get)?He.get.bind(r,r):hn,Ft=!Ge(He)&&Ge(He.set)?He.set.bind(r):hn,wt=Yx({get:it,set:Ft});Object.defineProperty(n,Ne,{enumerable:!0,configurable:!0,get:()=>wt.value,set:M=>wt.value=M})}if(o)for(const Ne in o)$p(o[Ne],n,r,Ne);if(c){const Ne=Ge(c)?c.call(r):c;Reflect.ownKeys(Ne).forEach(He=>{mx(He,Ne[He])})}f&&Wh(f,t,"c");function Xe(Ne,He){Me(He)?He.forEach(it=>Ne(it.bind(r))):He&&Ne(He.bind(r))}if(Xe(Zv,d),Xe(Hp,p),Xe(ex,g),Xe(tx,v),Xe(Yv,_),Xe(Qv,E),Xe(ax,y),Xe(sx,ue),Xe(ix,w),Xe(rx,V),Xe(Wp,U),Xe(nx,T),Me(I))if(I.length){const Ne=t.exposed||(t.exposed={});I.forEach(He=>{Object.defineProperty(Ne,He,{get:()=>r[He],set:it=>r[He]=it})})}else t.exposed||(t.exposed={});re&&t.render===hn&&(t.render=re),P!=null&&(t.inheritAttrs=P),k&&(t.components=k),R&&(t.directives=R),T&&Vp(t)}function ux(t,e,r=hn){Me(t)&&(t=lu(t));for(const n in t){const i=t[n];let s;xt(i)?"default"in i?s=$o(i.from||n,i.default,!0):s=$o(i.from||n):s=$o(i),ar(s)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>s.value,set:a=>s.value=a}):e[n]=s}}function Wh(t,e,r){mn(Me(t)?t.map(n=>n.bind(e.proxy)):t.bind(e.proxy),e,r)}function $p(t,e,r,n){let i=n.includes(".")?n1(r,n):()=>r[n];if(Lt(t)){const s=e[t];Ge(s)&&ki(i,s)}else if(Ge(t))ki(i,t.bind(r));else if(xt(t))if(Me(t))t.forEach(s=>$p(s,e,r,n));else{const s=Ge(t.handler)?t.handler.bind(r):e[t.handler];Ge(s)&&ki(i,s,t)}}function jp(t){const e=t.type,{mixins:r,extends:n}=e,{mixins:i,optionsCache:s,config:{optionMergeStrategies:a}}=t.appContext,o=s.get(e);let c;return o?c=o:!i.length&&!r&&!n?c=e:(c={},i.length&&i.forEach(u=>nl(c,u,a,!0)),nl(c,e,a)),xt(e)&&s.set(e,c),c}function nl(t,e,r,n=!1){const{mixins:i,extends:s}=e;s&&nl(t,s,r,!0),i&&i.forEach(a=>nl(t,a,r,!0));for(const a in e)if(!(n&&a==="expose")){const o=fx[a]||r&&r[a];t[a]=o?o(t[a],e[a]):e[a]}return t}const fx={data:$h,props:jh,emits:jh,methods:oa,computed:oa,beforeCreate:Tr,created:Tr,beforeMount:Tr,mounted:Tr,beforeUpdate:Tr,updated:Tr,beforeDestroy:Tr,beforeUnmount:Tr,destroyed:Tr,unmounted:Tr,activated:Tr,deactivated:Tr,errorCaptured:Tr,serverPrefetch:Tr,components:oa,directives:oa,watch:dx,provide:$h,inject:hx};function $h(t,e){return e?t?function(){return vr(Ge(t)?t.call(this,this):t,Ge(e)?e.call(this,this):e)}:e:t}function hx(t,e){return oa(lu(t),lu(e))}function lu(t){if(Me(t)){const e={};for(let r=0;r<t.length;r++)e[t[r]]=t[r];return e}return t}function Tr(t,e){return t?[...new Set([].concat(t,e))]:e}function oa(t,e){return t?vr(Object.create(null),t,e):e}function jh(t,e){return t?Me(t)&&Me(e)?[...new Set([...t,...e])]:vr(Object.create(null),Hh(t),Hh(e??{})):e}function dx(t,e){if(!t)return e;if(!e)return t;const r=vr(Object.create(null),t);for(const n in e)r[n]=Tr(t[n],e[n]);return r}function Gp(){return{app:null,config:{isNativeTag:rv,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let px=0;function gx(t,e){return function(n,i=null){Ge(n)||(n=vr({},n)),i!=null&&!xt(i)&&(i=null);const s=Gp(),a=new WeakSet,o=[];let c=!1;const u=s.app={_uid:px++,_component:n,_props:i,_container:null,_context:s,_instance:null,version:Qx,get config(){return s.config},set config(f){},use(f,...d){return a.has(f)||(f&&Ge(f.install)?(a.add(f),f.install(u,...d)):Ge(f)&&(a.add(f),f(u,...d))),u},mixin(f){return s.mixins.includes(f)||s.mixins.push(f),u},component(f,d){return d?(s.components[f]=d,u):s.components[f]},directive(f,d){return d?(s.directives[f]=d,u):s.directives[f]},mount(f,d,p){if(!c){const g=u._ceVNode||er(n,i);return g.appContext=s,p===!0?p="svg":p===!1&&(p=void 0),t(g,f,p),c=!0,u._container=f,f.__vue_app__=u,Zl(g.component)}},onUnmount(f){o.push(f)},unmount(){c&&(mn(o,u._instance,16),t(null,u._container),delete u._container.__vue_app__)},provide(f,d){return s.provides[f]=d,u},runWithContext(f){const d=ys;ys=u;try{return f()}finally{ys=d}}};return u}}let ys=null;function mx(t,e){if(Sr){let r=Sr.provides;const n=Sr.parent&&Sr.parent.provides;n===r&&(r=Sr.provides=Object.create(n)),r[t]=e}}function $o(t,e,r=!1){const n=Sr||Gr;if(n||ys){let i=ys?ys._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(i&&t in i)return i[t];if(arguments.length>1)return r&&Ge(e)?e.call(n&&n.proxy):e}}const zp={},Kp=()=>Object.create(zp),qp=t=>Object.getPrototypeOf(t)===zp;function _x(t,e,r,n=!1){const i={},s=Kp();t.propsDefaults=Object.create(null),Xp(t,e,i,s);for(const a in t.propsOptions[0])a in i||(i[a]=void 0);r?t.props=n?i:Nv(i):t.type.props?t.props=i:t.props=s,t.attrs=s}function vx(t,e,r,n){const{props:i,attrs:s,vnode:{patchFlag:a}}=t,o=st(i),[c]=t.propsOptions;let u=!1;if((n||a>0)&&!(a&16)){if(a&8){const f=t.vnode.dynamicProps;for(let d=0;d<f.length;d++){let p=f[d];if(Ql(t.emitsOptions,p))continue;const g=e[p];if(c)if(at(s,p))g!==s[p]&&(s[p]=g,u=!0);else{const v=ai(p);i[v]=cu(c,o,v,g,t,!1)}else g!==s[p]&&(s[p]=g,u=!0)}}}else{Xp(t,e,i,s)&&(u=!0);let f;for(const d in o)(!e||!at(e,d)&&((f=vi(d))===d||!at(e,f)))&&(c?r&&(r[d]!==void 0||r[f]!==void 0)&&(i[d]=cu(c,o,d,void 0,t,!0)):delete i[d]);if(s!==o)for(const d in s)(!e||!at(e,d))&&(delete s[d],u=!0)}u&&Cn(t.attrs,"set","")}function Xp(t,e,r,n){const[i,s]=t.propsOptions;let a=!1,o;if(e)for(let c in e){if(ha(c))continue;const u=e[c];let f;i&&at(i,f=ai(c))?!s||!s.includes(f)?r[f]=u:(o||(o={}))[f]=u:Ql(t.emitsOptions,c)||(!(c in n)||u!==n[c])&&(n[c]=u,a=!0)}if(s){const c=st(r),u=o||mt;for(let f=0;f<s.length;f++){const d=s[f];r[d]=cu(i,c,d,u[d],t,!at(u,d))}}return a}function cu(t,e,r,n,i,s){const a=t[r];if(a!=null){const o=at(a,"default");if(o&&n===void 0){const c=a.default;if(a.type!==Function&&!a.skipFactory&&Ge(c)){const{propsDefaults:u}=i;if(r in u)n=u[r];else{const f=Za(i);n=u[r]=c.call(null,e),f()}}else n=c;i.ce&&i.ce._setProp(r,n)}a[0]&&(s&&!o?n=!1:a[1]&&(n===""||n===vi(r))&&(n=!0))}return n}const xx=new WeakMap;function Yp(t,e,r=!1){const n=r?xx:e.propsCache,i=n.get(t);if(i)return i;const s=t.props,a={},o=[];let c=!1;if(!Ge(t)){const f=d=>{c=!0;const[p,g]=Yp(d,e,!0);vr(a,p),g&&o.push(...g)};!r&&e.mixins.length&&e.mixins.forEach(f),t.extends&&f(t.extends),t.mixins&&t.mixins.forEach(f)}if(!s&&!c)return xt(t)&&n.set(t,vs),vs;if(Me(s))for(let f=0;f<s.length;f++){const d=ai(s[f]);Gh(d)&&(a[d]=mt)}else if(s)for(const f in s){const d=ai(f);if(Gh(d)){const p=s[f],g=a[d]=Me(p)||Ge(p)?{type:p}:vr({},p),v=g.type;let _=!1,E=!0;if(Me(v))for(let L=0;L<v.length;++L){const V=v[L],N=Ge(V)&&V.name;if(N==="Boolean"){_=!0;break}else N==="String"&&(E=!1)}else _=Ge(v)&&v.name==="Boolean";g[0]=_,g[1]=E,(_||at(g,"default"))&&o.push(d)}}const u=[a,o];return xt(t)&&n.set(t,u),u}function Gh(t){return t[0]!=="$"&&!ha(t)}const Zu=t=>t[0]==="_"||t==="$stable",ef=t=>Me(t)?t.map(fn):[fn(t)],Ex=(t,e,r)=>{if(e._n)return e;const n=Kv((...i)=>ef(e(...i)),r);return n._c=!1,n},Qp=(t,e,r)=>{const n=t._ctx;for(const i in t){if(Zu(i))continue;const s=t[i];if(Ge(s))e[i]=Ex(i,s,n);else if(s!=null){const a=ef(s);e[i]=()=>a}}},Jp=(t,e)=>{const r=ef(e);t.slots.default=()=>r},Zp=(t,e,r)=>{for(const n in e)(r||!Zu(n))&&(t[n]=e[n])},Tx=(t,e,r)=>{const n=t.slots=Kp();if(t.vnode.shapeFlag&32){const i=e._;i?(Zp(n,e,r),r&&hp(n,"_",i,!0)):Qp(e,n)}else e&&Jp(t,e)},yx=(t,e,r)=>{const{vnode:n,slots:i}=t;let s=!0,a=mt;if(n.shapeFlag&32){const o=e._;o?r&&o===1?s=!1:Zp(i,e,r):(s=!e.$stable,Qp(e,i)),a=e}else e&&(Jp(t,e),a={default:1});if(s)for(const o in i)!Zu(o)&&a[o]==null&&delete i[o]},Nr=Lx;function wx(t){return Ax(t)}function Ax(t,e){const r=Gl();r.__VUE__=!0;const{insert:n,remove:i,patchProp:s,createElement:a,createText:o,createComment:c,setText:u,setElementText:f,parentNode:d,nextSibling:p,setScopeId:g=hn,insertStaticContent:v}=t,_=(b,B,K,ae=null,te=null,z=null,pe=void 0,he=null,fe=!!B.dynamicChildren)=>{if(b===B)return;b&&!sa(b,B)&&(ae=we(b),M(b,te,z,!0),b=null),B.patchFlag===-2&&(fe=!1,B.dynamicChildren=null);const{type:oe,ref:Re,shapeFlag:Ee}=B;switch(oe){case Jl:E(b,B,K,ae);break;case li:L(b,B,K,ae);break;case Lc:b==null&&V(B,K,ae,pe);break;case Ut:k(b,B,K,ae,te,z,pe,he,fe);break;default:Ee&1?re(b,B,K,ae,te,z,pe,he,fe):Ee&6?R(b,B,K,ae,te,z,pe,he,fe):(Ee&64||Ee&128)&&oe.process(b,B,K,ae,te,z,pe,he,fe,me)}Re!=null&&te&&rl(Re,b&&b.ref,z,B||b,!B)},E=(b,B,K,ae)=>{if(b==null)n(B.el=o(B.children),K,ae);else{const te=B.el=b.el;B.children!==b.children&&u(te,B.children)}},L=(b,B,K,ae)=>{b==null?n(B.el=c(B.children||""),K,ae):B.el=b.el},V=(b,B,K,ae)=>{[b.el,b.anchor]=v(b.children,B,K,ae,b.el,b.anchor)},N=({el:b,anchor:B},K,ae)=>{let te;for(;b&&b!==B;)te=p(b),n(b,K,ae),b=te;n(B,K,ae)},U=({el:b,anchor:B})=>{let K;for(;b&&b!==B;)K=p(b),i(b),b=K;i(B)},re=(b,B,K,ae,te,z,pe,he,fe)=>{B.type==="svg"?pe="svg":B.type==="math"&&(pe="mathml"),b==null?ue(B,K,ae,te,z,pe,he,fe):T(b,B,te,z,pe,he,fe)},ue=(b,B,K,ae,te,z,pe,he)=>{let fe,oe;const{props:Re,shapeFlag:Ee,transition:Ae,dirs:De}=b;if(fe=b.el=a(b.type,z,Re&&Re.is,Re),Ee&8?f(fe,b.children):Ee&16&&y(b.children,fe,null,ae,te,Nc(b,z),pe,he),De&&Ri(b,null,ae,"created"),w(fe,b,b.scopeId,pe,ae),Re){for(const Ve in Re)Ve!=="value"&&!ha(Ve)&&s(fe,Ve,null,Re[Ve],z,ae);"value"in Re&&s(fe,"value",null,Re.value,z),(oe=Re.onVnodeBeforeMount)&&an(oe,ae,b)}De&&Ri(b,null,ae,"beforeMount");const Pe=Sx(te,Ae);Pe&&Ae.beforeEnter(fe),n(fe,B,K),((oe=Re&&Re.onVnodeMounted)||Pe||De)&&Nr(()=>{oe&&an(oe,ae,b),Pe&&Ae.enter(fe),De&&Ri(b,null,ae,"mounted")},te)},w=(b,B,K,ae,te)=>{if(K&&g(b,K),ae)for(let z=0;z<ae.length;z++)g(b,ae[z]);if(te){let z=te.subTree;if(B===z||s1(z.type)&&(z.ssContent===B||z.ssFallback===B)){const pe=te.vnode;w(b,pe,pe.scopeId,pe.slotScopeIds,te.parent)}}},y=(b,B,K,ae,te,z,pe,he,fe=0)=>{for(let oe=fe;oe<b.length;oe++){const Re=b[oe]=he?Yn(b[oe]):fn(b[oe]);_(null,Re,B,K,ae,te,z,pe,he)}},T=(b,B,K,ae,te,z,pe)=>{const he=B.el=b.el;let{patchFlag:fe,dynamicChildren:oe,dirs:Re}=B;fe|=b.patchFlag&16;const Ee=b.props||mt,Ae=B.props||mt;let De;if(K&&Pi(K,!1),(De=Ae.onVnodeBeforeUpdate)&&an(De,K,B,b),Re&&Ri(B,b,K,"beforeUpdate"),K&&Pi(K,!0),(Ee.innerHTML&&Ae.innerHTML==null||Ee.textContent&&Ae.textContent==null)&&f(he,""),oe?I(b.dynamicChildren,oe,he,K,ae,Nc(B,te),z):pe||He(b,B,he,null,K,ae,Nc(B,te),z,!1),fe>0){if(fe&16)P(he,Ee,Ae,K,te);else if(fe&2&&Ee.class!==Ae.class&&s(he,"class",null,Ae.class,te),fe&4&&s(he,"style",Ee.style,Ae.style,te),fe&8){const Pe=B.dynamicProps;for(let Ve=0;Ve<Pe.length;Ve++){const je=Pe[Ve],jt=Ee[je],Dt=Ae[je];(Dt!==jt||je==="value")&&s(he,je,jt,Dt,te,K)}}fe&1&&b.children!==B.children&&f(he,B.children)}else!pe&&oe==null&&P(he,Ee,Ae,K,te);((De=Ae.onVnodeUpdated)||Re)&&Nr(()=>{De&&an(De,K,B,b),Re&&Ri(B,b,K,"updated")},ae)},I=(b,B,K,ae,te,z,pe)=>{for(let he=0;he<B.length;he++){const fe=b[he],oe=B[he],Re=fe.el&&(fe.type===Ut||!sa(fe,oe)||fe.shapeFlag&198)?d(fe.el):K;_(fe,oe,Re,null,ae,te,z,pe,!0)}},P=(b,B,K,ae,te)=>{if(B!==K){if(B!==mt)for(const z in B)!ha(z)&&!(z in K)&&s(b,z,B[z],null,te,ae);for(const z in K){if(ha(z))continue;const pe=K[z],he=B[z];pe!==he&&z!=="value"&&s(b,z,he,pe,te,ae)}"value"in K&&s(b,"value",B.value,K.value,te)}},k=(b,B,K,ae,te,z,pe,he,fe)=>{const oe=B.el=b?b.el:o(""),Re=B.anchor=b?b.anchor:o("");let{patchFlag:Ee,dynamicChildren:Ae,slotScopeIds:De}=B;De&&(he=he?he.concat(De):De),b==null?(n(oe,K,ae),n(Re,K,ae),y(B.children||[],K,Re,te,z,pe,he,fe)):Ee>0&&Ee&64&&Ae&&b.dynamicChildren?(I(b.dynamicChildren,Ae,K,te,z,pe,he),(B.key!=null||te&&B===te.subTree)&&e1(b,B,!0)):He(b,B,K,Re,te,z,pe,he,fe)},R=(b,B,K,ae,te,z,pe,he,fe)=>{B.slotScopeIds=he,b==null?B.shapeFlag&512?te.ctx.activate(B,K,ae,pe,fe):$e(B,K,ae,te,z,pe,fe):ke(b,B,fe)},$e=(b,B,K,ae,te,z,pe)=>{const he=b.component=jx(b,ae,te);if(Bp(b)&&(he.ctx.renderer=me),Gx(he,!1,pe),he.asyncDep){if(te&&te.registerDep(he,Xe,pe),!b.el){const fe=he.subTree=er(li);L(null,fe,B,K)}}else Xe(he,b,B,K,te,z,pe)},ke=(b,B,K)=>{const ae=B.component=b.component;if(kx(b,B,K))if(ae.asyncDep&&!ae.asyncResolved){Ne(ae,B,K);return}else ae.next=B,ae.update();else B.el=b.el,ae.vnode=B},Xe=(b,B,K,ae,te,z,pe)=>{const he=()=>{if(b.isMounted){let{next:Ee,bu:Ae,u:De,parent:Pe,vnode:Ve}=b;{const Vt=t1(b);if(Vt){Ee&&(Ee.el=Ve.el,Ne(b,Ee,pe)),Vt.asyncDep.then(()=>{b.isUnmounted||he()});return}}let je=Ee,jt;Pi(b,!1),Ee?(Ee.el=Ve.el,Ne(b,Ee,pe)):Ee=Ve,Ae&&Wo(Ae),(jt=Ee.props&&Ee.props.onVnodeBeforeUpdate)&&an(jt,Pe,Ee,Ve),Pi(b,!0);const Dt=Kh(b),Er=b.subTree;b.subTree=Dt,_(Er,Dt,d(Er.el),we(Er),b,te,z),Ee.el=Dt.el,je===null&&Nx(b,Dt.el),De&&Nr(De,te),(jt=Ee.props&&Ee.props.onVnodeUpdated)&&Nr(()=>an(jt,Pe,Ee,Ve),te)}else{let Ee;const{el:Ae,props:De}=B,{bm:Pe,m:Ve,parent:je,root:jt,type:Dt}=b,Er=ga(B);Pi(b,!1),Pe&&Wo(Pe),!Er&&(Ee=De&&De.onVnodeBeforeMount)&&an(Ee,je,B),Pi(b,!0);{jt.ce&&jt.ce._injectChildStyle(Dt);const Vt=b.subTree=Kh(b);_(null,Vt,K,ae,b,te,z),B.el=Vt.el}if(Ve&&Nr(Ve,te),!Er&&(Ee=De&&De.onVnodeMounted)){const Vt=B;Nr(()=>an(Ee,je,Vt),te)}(B.shapeFlag&256||je&&ga(je.vnode)&&je.vnode.shapeFlag&256)&&b.a&&Nr(b.a,te),b.isMounted=!0,B=K=ae=null}};b.scope.on();const fe=b.effect=new mp(he);b.scope.off();const oe=b.update=fe.run.bind(fe),Re=b.job=fe.runIfDirty.bind(fe);Re.i=b,Re.id=b.uid,fe.scheduler=()=>Qu(Re),Pi(b,!0),oe()},Ne=(b,B,K)=>{B.component=b;const ae=b.vnode.props;b.vnode=B,b.next=null,vx(b,B.props,ae,K),yx(b,B.children,K),kn(),Uh(b),Nn()},He=(b,B,K,ae,te,z,pe,he,fe=!1)=>{const oe=b&&b.children,Re=b?b.shapeFlag:0,Ee=B.children,{patchFlag:Ae,shapeFlag:De}=B;if(Ae>0){if(Ae&128){Ft(oe,Ee,K,ae,te,z,pe,he,fe);return}else if(Ae&256){it(oe,Ee,K,ae,te,z,pe,he,fe);return}}De&8?(Re&16&&ne(oe,te,z),Ee!==oe&&f(K,Ee)):Re&16?De&16?Ft(oe,Ee,K,ae,te,z,pe,he,fe):ne(oe,te,z,!0):(Re&8&&f(K,""),De&16&&y(Ee,K,ae,te,z,pe,he,fe))},it=(b,B,K,ae,te,z,pe,he,fe)=>{b=b||vs,B=B||vs;const oe=b.length,Re=B.length,Ee=Math.min(oe,Re);let Ae;for(Ae=0;Ae<Ee;Ae++){const De=B[Ae]=fe?Yn(B[Ae]):fn(B[Ae]);_(b[Ae],De,K,null,te,z,pe,he,fe)}oe>Re?ne(b,te,z,!0,!1,Ee):y(B,K,ae,te,z,pe,he,fe,Ee)},Ft=(b,B,K,ae,te,z,pe,he,fe)=>{let oe=0;const Re=B.length;let Ee=b.length-1,Ae=Re-1;for(;oe<=Ee&&oe<=Ae;){const De=b[oe],Pe=B[oe]=fe?Yn(B[oe]):fn(B[oe]);if(sa(De,Pe))_(De,Pe,K,null,te,z,pe,he,fe);else break;oe++}for(;oe<=Ee&&oe<=Ae;){const De=b[Ee],Pe=B[Ae]=fe?Yn(B[Ae]):fn(B[Ae]);if(sa(De,Pe))_(De,Pe,K,null,te,z,pe,he,fe);else break;Ee--,Ae--}if(oe>Ee){if(oe<=Ae){const De=Ae+1,Pe=De<Re?B[De].el:ae;for(;oe<=Ae;)_(null,B[oe]=fe?Yn(B[oe]):fn(B[oe]),K,Pe,te,z,pe,he,fe),oe++}}else if(oe>Ae)for(;oe<=Ee;)M(b[oe],te,z,!0),oe++;else{const De=oe,Pe=oe,Ve=new Map;for(oe=Pe;oe<=Ae;oe++){const Ot=B[oe]=fe?Yn(B[oe]):fn(B[oe]);Ot.key!=null&&Ve.set(Ot.key,oe)}let je,jt=0;const Dt=Ae-Pe+1;let Er=!1,Vt=0;const Xr=new Array(Dt);for(oe=0;oe<Dt;oe++)Xr[oe]=0;for(oe=De;oe<=Ee;oe++){const Ot=b[oe];if(jt>=Dt){M(Ot,te,z,!0);continue}let Cr;if(Ot.key!=null)Cr=Ve.get(Ot.key);else for(je=Pe;je<=Ae;je++)if(Xr[je-Pe]===0&&sa(Ot,B[je])){Cr=je;break}Cr===void 0?M(Ot,te,z,!0):(Xr[Cr-Pe]=oe+1,Cr>=Vt?Vt=Cr:Er=!0,_(Ot,B[Cr],K,null,te,z,pe,he,fe),jt++)}const $n=Er?Ix(Xr):vs;for(je=$n.length-1,oe=Dt-1;oe>=0;oe--){const Ot=Pe+oe,Cr=B[Ot],Zi=Ot+1<Re?B[Ot+1].el:ae;Xr[oe]===0?_(null,Cr,K,Zi,te,z,pe,he,fe):Er&&(je<0||oe!==$n[je]?wt(Cr,K,Zi,2):je--)}}},wt=(b,B,K,ae,te=null)=>{const{el:z,type:pe,transition:he,children:fe,shapeFlag:oe}=b;if(oe&6){wt(b.component.subTree,B,K,ae);return}if(oe&128){b.suspense.move(B,K,ae);return}if(oe&64){pe.move(b,B,K,me);return}if(pe===Ut){n(z,B,K);for(let Ee=0;Ee<fe.length;Ee++)wt(fe[Ee],B,K,ae);n(b.anchor,B,K);return}if(pe===Lc){N(b,B,K);return}if(ae!==2&&oe&1&&he)if(ae===0)he.beforeEnter(z),n(z,B,K),Nr(()=>he.enter(z),te);else{const{leave:Ee,delayLeave:Ae,afterLeave:De}=he,Pe=()=>{b.ctx.isUnmounted?i(z):n(z,B,K)},Ve=()=>{Ee(z,()=>{Pe(),De&&De()})};Ae?Ae(z,Pe,Ve):Ve()}else n(z,B,K)},M=(b,B,K,ae=!1,te=!1)=>{const{type:z,props:pe,ref:he,children:fe,dynamicChildren:oe,shapeFlag:Re,patchFlag:Ee,dirs:Ae,cacheIndex:De}=b;if(Ee===-2&&(te=!1),he!=null&&(kn(),rl(he,null,K,b,!0),Nn()),De!=null&&(B.renderCache[De]=void 0),Re&256){B.ctx.deactivate(b);return}const Pe=Re&1&&Ae,Ve=!ga(b);let je;if(Ve&&(je=pe&&pe.onVnodeBeforeUnmount)&&an(je,B,b),Re&6)H(b.component,K,ae);else{if(Re&128){b.suspense.unmount(K,ae);return}Pe&&Ri(b,null,B,"beforeUnmount"),Re&64?b.type.remove(b,B,K,me,ae):oe&&!oe.hasOnce&&(z!==Ut||Ee>0&&Ee&64)?ne(oe,B,K,!1,!0):(z===Ut&&Ee&384||!te&&Re&16)&&ne(fe,B,K),ae&&G(b)}(Ve&&(je=pe&&pe.onVnodeUnmounted)||Pe)&&Nr(()=>{je&&an(je,B,b),Pe&&Ri(b,null,B,"unmounted")},K)},G=b=>{const{type:B,el:K,anchor:ae,transition:te}=b;if(B===Ut){W(K,ae);return}if(B===Lc){U(b);return}const z=()=>{i(K),te&&!te.persisted&&te.afterLeave&&te.afterLeave()};if(b.shapeFlag&1&&te&&!te.persisted){const{leave:pe,delayLeave:he}=te,fe=()=>pe(K,z);he?he(b.el,z,fe):fe()}else z()},W=(b,B)=>{let K;for(;b!==B;)K=p(b),i(b),b=K;i(B)},H=(b,B,K)=>{const{bum:ae,scope:te,job:z,subTree:pe,um:he,m:fe,a:oe,parent:Re,slots:{__:Ee}}=b;zh(fe),zh(oe),ae&&Wo(ae),Re&&Me(Ee)&&Ee.forEach(Ae=>{Re.renderCache[Ae]=void 0}),te.stop(),z&&(z.flags|=8,M(pe,b,B,K)),he&&Nr(he,B),Nr(()=>{b.isUnmounted=!0},B),B&&B.pendingBranch&&!B.isUnmounted&&b.asyncDep&&!b.asyncResolved&&b.suspenseId===B.pendingId&&(B.deps--,B.deps===0&&B.resolve())},ne=(b,B,K,ae=!1,te=!1,z=0)=>{for(let pe=z;pe<b.length;pe++)M(b[pe],B,K,ae,te)},we=b=>{if(b.shapeFlag&6)return we(b.component.subTree);if(b.shapeFlag&128)return b.suspense.next();const B=p(b.anchor||b.el),K=B&&B[qv];return K?p(K):B};let Ce=!1;const Ie=(b,B,K)=>{b==null?B._vnode&&M(B._vnode,null,null,!0):_(B._vnode||null,b,B,null,null,null,K),B._vnode=b,Ce||(Ce=!0,Uh(),Np(),Ce=!1)},me={p:_,um:M,m:wt,r:G,mt:$e,mc:y,pc:He,pbc:I,n:we,o:t};return{render:Ie,hydrate:void 0,createApp:gx(Ie)}}function Nc({type:t,props:e},r){return r==="svg"&&t==="foreignObject"||r==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:r}function Pi({effect:t,job:e},r){r?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function Sx(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function e1(t,e,r=!1){const n=t.children,i=e.children;if(Me(n)&&Me(i))for(let s=0;s<n.length;s++){const a=n[s];let o=i[s];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=i[s]=Yn(i[s]),o.el=a.el),!r&&o.patchFlag!==-2&&e1(a,o)),o.type===Jl&&(o.el=a.el),o.type===li&&!o.el&&(o.el=a.el)}}function Ix(t){const e=t.slice(),r=[0];let n,i,s,a,o;const c=t.length;for(n=0;n<c;n++){const u=t[n];if(u!==0){if(i=r[r.length-1],t[i]<u){e[n]=i,r.push(n);continue}for(s=0,a=r.length-1;s<a;)o=s+a>>1,t[r[o]]<u?s=o+1:a=o;u<t[r[s]]&&(s>0&&(e[n]=r[s-1]),r[s]=n)}}for(s=r.length,a=r[s-1];s-- >0;)r[s]=a,a=e[a];return r}function t1(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:t1(e)}function zh(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const Cx=Symbol.for("v-scx"),Rx=()=>$o(Cx);function ki(t,e,r){return r1(t,e,r)}function r1(t,e,r=mt){const{immediate:n,deep:i,flush:s,once:a}=r,o=vr({},r),c=e&&n||!e&&s!=="post";let u;if(ka){if(s==="sync"){const g=Rx();u=g.__watcherHandles||(g.__watcherHandles=[])}else if(!c){const g=()=>{};return g.stop=hn,g.resume=hn,g.pause=hn,g}}const f=Sr;o.call=(g,v,_)=>mn(g,f,v,_);let d=!1;s==="post"?o.scheduler=g=>{Nr(g,f&&f.suspense)}:s!=="sync"&&(d=!0,o.scheduler=(g,v)=>{v?g():Qu(g)}),o.augmentJob=g=>{e&&(g.flags|=4),d&&(g.flags|=2,f&&(g.id=f.uid,g.i=f))};const p=$v(t,e,o);return ka&&(u?u.push(p):c&&p()),p}function Px(t,e,r){const n=this.proxy,i=Lt(t)?t.includes(".")?n1(n,t):()=>n[t]:t.bind(n,n);let s;Ge(e)?s=e:(s=e.handler,r=e);const a=Za(this),o=r1(i,s.bind(n),r);return a(),o}function n1(t,e){const r=e.split(".");return()=>{let n=t;for(let i=0;i<r.length&&n;i++)n=n[r[i]];return n}}const Fx=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${ai(e)}Modifiers`]||t[`${vi(e)}Modifiers`];function Dx(t,e,...r){if(t.isUnmounted)return;const n=t.vnode.props||mt;let i=r;const s=e.startsWith("update:"),a=s&&Fx(n,e.slice(7));a&&(a.trim&&(i=r.map(f=>Lt(f)?f.trim():f)),a.number&&(i=r.map(Qo)));let o,c=n[o=Pc(e)]||n[o=Pc(ai(e))];!c&&s&&(c=n[o=Pc(vi(e))]),c&&mn(c,t,6,i);const u=n[o+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[o])return;t.emitted[o]=!0,mn(u,t,6,i)}}function i1(t,e,r=!1){const n=e.emitsCache,i=n.get(t);if(i!==void 0)return i;const s=t.emits;let a={},o=!1;if(!Ge(t)){const c=u=>{const f=i1(u,e,!0);f&&(o=!0,vr(a,f))};!r&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!s&&!o?(xt(t)&&n.set(t,null),null):(Me(s)?s.forEach(c=>a[c]=null):vr(a,s),xt(t)&&n.set(t,a),a)}function Ql(t,e){return!t||!Wl(e)?!1:(e=e.slice(2).replace(/Once$/,""),at(t,e[0].toLowerCase()+e.slice(1))||at(t,vi(e))||at(t,e))}function Kh(t){const{type:e,vnode:r,proxy:n,withProxy:i,propsOptions:[s],slots:a,attrs:o,emit:c,render:u,renderCache:f,props:d,data:p,setupState:g,ctx:v,inheritAttrs:_}=t,E=tl(t);let L,V;try{if(r.shapeFlag&4){const U=i||n,re=U;L=fn(u.call(re,U,f,d,g,p,v)),V=o}else{const U=e;L=fn(U.length>1?U(d,{attrs:o,slots:a,emit:c}):U(d,null)),V=e.props?o:Ox(o)}}catch(U){_a.length=0,Xl(U,t,1),L=er(li)}let N=L;if(V&&_!==!1){const U=Object.keys(V),{shapeFlag:re}=N;U.length&&re&7&&(s&&U.some(Bu)&&(V=bx(V,s)),N=Fs(N,V,!1,!0))}return r.dirs&&(N=Fs(N,null,!1,!0),N.dirs=N.dirs?N.dirs.concat(r.dirs):r.dirs),r.transition&&Ju(N,r.transition),L=N,tl(E),L}const Ox=t=>{let e;for(const r in t)(r==="class"||r==="style"||Wl(r))&&((e||(e={}))[r]=t[r]);return e},bx=(t,e)=>{const r={};for(const n in t)(!Bu(n)||!(n.slice(9)in e))&&(r[n]=t[n]);return r};function kx(t,e,r){const{props:n,children:i,component:s}=t,{props:a,children:o,patchFlag:c}=e,u=s.emitsOptions;if(e.dirs||e.transition)return!0;if(r&&c>=0){if(c&1024)return!0;if(c&16)return n?qh(n,a,u):!!a;if(c&8){const f=e.dynamicProps;for(let d=0;d<f.length;d++){const p=f[d];if(a[p]!==n[p]&&!Ql(u,p))return!0}}}else return(i||o)&&(!o||!o.$stable)?!0:n===a?!1:n?a?qh(n,a,u):!0:!!a;return!1}function qh(t,e,r){const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!0;for(let i=0;i<n.length;i++){const s=n[i];if(e[s]!==t[s]&&!Ql(r,s))return!0}return!1}function Nx({vnode:t,parent:e},r){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===t&&(n.el=t.el),n===t)(t=e.vnode).el=r,e=e.parent;else break}}const s1=t=>t.__isSuspense;function Lx(t,e){e&&e.pendingBranch?Me(t)?e.effects.push(...t):e.effects.push(t):zv(t)}const Ut=Symbol.for("v-fgt"),Jl=Symbol.for("v-txt"),li=Symbol.for("v-cmt"),Lc=Symbol.for("v-stc"),_a=[];let Ur=null;function Ye(t=!1){_a.push(Ur=t?null:[])}function Mx(){_a.pop(),Ur=_a[_a.length-1]||null}let ba=1;function Xh(t,e=!1){ba+=t,t<0&&Ur&&e&&(Ur.hasOnce=!0)}function a1(t){return t.dynamicChildren=ba>0?Ur||vs:null,Mx(),ba>0&&Ur&&Ur.push(t),t}function Ze(t,e,r,n,i,s){return a1(Fe(t,e,r,n,i,s,!0))}function Vx(t,e,r,n,i){return a1(er(t,e,r,n,i,!0))}function o1(t){return t?t.__v_isVNode===!0:!1}function sa(t,e){return t.type===e.type&&t.key===e.key}const l1=({key:t})=>t??null,jo=({ref:t,ref_key:e,ref_for:r})=>(typeof t=="number"&&(t=""+t),t!=null?Lt(t)||ar(t)||Ge(t)?{i:Gr,r:t,k:e,f:!!r}:t:null);function Fe(t,e=null,r=null,n=0,i=null,s=t===Ut?0:1,a=!1,o=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&l1(e),ref:e&&jo(e),scopeId:Mp,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Gr};return o?(tf(c,r),s&128&&t.normalize(c)):r&&(c.shapeFlag|=Lt(r)?8:16),ba>0&&!a&&Ur&&(c.patchFlag>0||s&6)&&c.patchFlag!==32&&Ur.push(c),c}const er=Bx;function Bx(t,e=null,r=null,n=0,i=null,s=!1){if((!t||t===ox)&&(t=li),o1(t)){const o=Fs(t,e,!0);return r&&tf(o,r),ba>0&&!s&&Ur&&(o.shapeFlag&6?Ur[Ur.indexOf(t)]=o:Ur.push(o)),o.patchFlag=-2,o}if(Xx(t)&&(t=t.__vccOpts),e){e=Ux(e);let{class:o,style:c}=e;o&&!Lt(o)&&(e.class=zl(o)),xt(c)&&(Yu(c)&&!Me(c)&&(c=vr({},c)),e.style=Wu(c))}const a=Lt(t)?1:s1(t)?128:Xv(t)?64:xt(t)?4:Ge(t)?2:0;return Fe(t,e,r,n,i,a,s,!0)}function Ux(t){return t?Yu(t)||qp(t)?vr({},t):t:null}function Fs(t,e,r=!1,n=!1){const{props:i,ref:s,patchFlag:a,children:o,transition:c}=t,u=e?Hx(i||{},e):i,f={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&l1(u),ref:e&&e.ref?r&&s?Me(s)?s.concat(jo(e)):[s,jo(e)]:jo(e):s,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Ut?a===-1?16:a|16:a,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:c,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Fs(t.ssContent),ssFallback:t.ssFallback&&Fs(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return c&&n&&Ju(f,c.clone(f)),f}function c1(t=" ",e=0){return er(Jl,null,t,e)}function Mi(t="",e=!1){return e?(Ye(),Vx(li,null,t)):er(li,null,t)}function fn(t){return t==null||typeof t=="boolean"?er(li):Me(t)?er(Ut,null,t.slice()):o1(t)?Yn(t):er(Jl,null,String(t))}function Yn(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Fs(t)}function tf(t,e){let r=0;const{shapeFlag:n}=t;if(e==null)e=null;else if(Me(e))r=16;else if(typeof e=="object")if(n&65){const i=e.default;i&&(i._c&&(i._d=!1),tf(t,i()),i._c&&(i._d=!0));return}else{r=32;const i=e._;!i&&!qp(e)?e._ctx=Gr:i===3&&Gr&&(Gr.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Ge(e)?(e={default:e,_ctx:Gr},r=32):(e=String(e),n&64?(r=16,e=[c1(e)]):r=8);t.children=e,t.shapeFlag|=r}function Hx(...t){const e={};for(let r=0;r<t.length;r++){const n=t[r];for(const i in n)if(i==="class")e.class!==n.class&&(e.class=zl([e.class,n.class]));else if(i==="style")e.style=Wu([e.style,n.style]);else if(Wl(i)){const s=e[i],a=n[i];a&&s!==a&&!(Me(s)&&s.includes(a))&&(e[i]=s?[].concat(s,a):a)}else i!==""&&(e[i]=n[i])}return e}function an(t,e,r,n=null){mn(t,e,7,[r,n])}const Wx=Gp();let $x=0;function jx(t,e,r){const n=t.type,i=(e?e.appContext:t.appContext)||Wx,s={uid:$x++,vnode:t,type:n,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new gv(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Yp(n,i),emitsOptions:i1(n,i),emit:null,emitted:null,propsDefaults:mt,inheritAttrs:n.inheritAttrs,ctx:mt,data:mt,props:mt,attrs:mt,slots:mt,refs:mt,setupState:mt,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=Dx.bind(null,s),t.ce&&t.ce(s),s}let Sr=null,il,uu;{const t=Gl(),e=(r,n)=>{let i;return(i=t[r])||(i=t[r]=[]),i.push(n),s=>{i.length>1?i.forEach(a=>a(s)):i[0](s)}};il=e("__VUE_INSTANCE_SETTERS__",r=>Sr=r),uu=e("__VUE_SSR_SETTERS__",r=>ka=r)}const Za=t=>{const e=Sr;return il(t),t.scope.on(),()=>{t.scope.off(),il(e)}},Yh=()=>{Sr&&Sr.scope.off(),il(null)};function u1(t){return t.vnode.shapeFlag&4}let ka=!1;function Gx(t,e=!1,r=!1){e&&uu(e);const{props:n,children:i}=t.vnode,s=u1(t);_x(t,n,s,e),Tx(t,i,r||e);const a=s?zx(t,e):void 0;return e&&uu(!1),a}function zx(t,e){const r=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,lx);const{setup:n}=r;if(n){kn();const i=t.setupContext=n.length>1?qx(t):null,s=Za(t),a=Ja(n,t,0,[t.props,i]),o=lp(a);if(Nn(),s(),(o||t.sp)&&!ga(t)&&Vp(t),o){if(a.then(Yh,Yh),e)return a.then(c=>{Qh(t,c)}).catch(c=>{Xl(c,t,0)});t.asyncDep=a}else Qh(t,a)}else f1(t)}function Qh(t,e,r){Ge(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:xt(e)&&(t.setupState=Dp(e)),f1(t)}function f1(t,e,r){const n=t.type;t.render||(t.render=n.render||hn);{const i=Za(t);kn();try{cx(t)}finally{Nn(),i()}}}const Kx={get(t,e){return pr(t,"get",""),t[e]}};function qx(t){const e=r=>{t.exposed=r||{}};return{attrs:new Proxy(t.attrs,Kx),slots:t.slots,emit:t.emit,expose:e}}function Zl(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Dp(Lv(t.exposed)),{get(e,r){if(r in e)return e[r];if(r in ma)return ma[r](t)},has(e,r){return r in e||r in ma}})):t.proxy}function Xx(t){return Ge(t)&&"__vccOpts"in t}const Yx=(t,e)=>Hv(t,e,ka),Qx="3.5.16";/**
* @vue/runtime-dom v3.5.16
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let fu;const Jh=typeof window<"u"&&window.trustedTypes;if(Jh)try{fu=Jh.createPolicy("vue",{createHTML:t=>t})}catch{}const h1=fu?t=>fu.createHTML(t):t=>t,Jx="http://www.w3.org/2000/svg",Zx="http://www.w3.org/1998/Math/MathML",In=typeof document<"u"?document:null,Zh=In&&In.createElement("template"),eE={insert:(t,e,r)=>{e.insertBefore(t,r||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,r,n)=>{const i=e==="svg"?In.createElementNS(Jx,t):e==="mathml"?In.createElementNS(Zx,t):r?In.createElement(t,{is:r}):In.createElement(t);return t==="select"&&n&&n.multiple!=null&&i.setAttribute("multiple",n.multiple),i},createText:t=>In.createTextNode(t),createComment:t=>In.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>In.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,r,n,i,s){const a=r?r.previousSibling:e.lastChild;if(i&&(i===s||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),r),!(i===s||!(i=i.nextSibling)););else{Zh.innerHTML=h1(n==="svg"?`<svg>${t}</svg>`:n==="mathml"?`<math>${t}</math>`:t);const o=Zh.content;if(n==="svg"||n==="mathml"){const c=o.firstChild;for(;c.firstChild;)o.appendChild(c.firstChild);o.removeChild(c)}e.insertBefore(o,r)}return[a?a.nextSibling:e.firstChild,r?r.previousSibling:e.lastChild]}},tE=Symbol("_vtc");function rE(t,e,r){const n=t[tE];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?t.removeAttribute("class"):r?t.setAttribute("class",e):t.className=e}const e0=Symbol("_vod"),nE=Symbol("_vsh"),iE=Symbol(""),sE=/(^|;)\s*display\s*:/;function aE(t,e,r){const n=t.style,i=Lt(r);let s=!1;if(r&&!i){if(e)if(Lt(e))for(const a of e.split(";")){const o=a.slice(0,a.indexOf(":")).trim();r[o]==null&&Go(n,o,"")}else for(const a in e)r[a]==null&&Go(n,a,"");for(const a in r)a==="display"&&(s=!0),Go(n,a,r[a])}else if(i){if(e!==r){const a=n[iE];a&&(r+=";"+a),n.cssText=r,s=sE.test(r)}}else e&&t.removeAttribute("style");e0 in t&&(t[e0]=s?n.display:"",t[nE]&&(n.display="none"))}const t0=/\s*!important$/;function Go(t,e,r){if(Me(r))r.forEach(n=>Go(t,e,n));else if(r==null&&(r=""),e.startsWith("--"))t.setProperty(e,r);else{const n=oE(t,e);t0.test(r)?t.setProperty(vi(n),r.replace(t0,""),"important"):t[n]=r}}const r0=["Webkit","Moz","ms"],Mc={};function oE(t,e){const r=Mc[e];if(r)return r;let n=ai(e);if(n!=="filter"&&n in t)return Mc[e]=n;n=fp(n);for(let i=0;i<r0.length;i++){const s=r0[i]+n;if(s in t)return Mc[e]=s}return e}const n0="http://www.w3.org/1999/xlink";function i0(t,e,r,n,i,s=hv(e)){n&&e.startsWith("xlink:")?r==null?t.removeAttributeNS(n0,e.slice(6,e.length)):t.setAttributeNS(n0,e,r):r==null||s&&!dp(r)?t.removeAttribute(e):t.setAttribute(e,s?"":gn(r)?String(r):r)}function s0(t,e,r,n,i){if(e==="innerHTML"||e==="textContent"){r!=null&&(t[e]=e==="innerHTML"?h1(r):r);return}const s=t.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const o=s==="OPTION"?t.getAttribute("value")||"":t.value,c=r==null?t.type==="checkbox"?"on":"":String(r);(o!==c||!("_value"in t))&&(t.value=c),r==null&&t.removeAttribute(e),t._value=r;return}let a=!1;if(r===""||r==null){const o=typeof t[e];o==="boolean"?r=dp(r):r==null&&o==="string"?(r="",a=!0):o==="number"&&(r=0,a=!0)}try{t[e]=r}catch{}a&&t.removeAttribute(i||e)}function Oi(t,e,r,n){t.addEventListener(e,r,n)}function lE(t,e,r,n){t.removeEventListener(e,r,n)}const a0=Symbol("_vei");function cE(t,e,r,n,i=null){const s=t[a0]||(t[a0]={}),a=s[e];if(n&&a)a.value=n;else{const[o,c]=uE(e);if(n){const u=s[e]=dE(n,i);Oi(t,o,u,c)}else a&&(lE(t,o,a,c),s[e]=void 0)}}const o0=/(?:Once|Passive|Capture)$/;function uE(t){let e;if(o0.test(t)){e={};let n;for(;n=t.match(o0);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):vi(t.slice(2)),e]}let Vc=0;const fE=Promise.resolve(),hE=()=>Vc||(fE.then(()=>Vc=0),Vc=Date.now());function dE(t,e){const r=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=r.attached)return;mn(pE(n,r.value),e,5,[n])};return r.value=t,r.attached=hE(),r}function pE(t,e){if(Me(e)){const r=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{r.call(t),t._stopped=!0},e.map(n=>i=>!i._stopped&&n&&n(i))}else return e}const l0=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,gE=(t,e,r,n,i,s)=>{const a=i==="svg";e==="class"?rE(t,n,a):e==="style"?aE(t,r,n):Wl(e)?Bu(e)||cE(t,e,r,n,s):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):mE(t,e,n,a))?(s0(t,e,n),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&i0(t,e,n,a,s,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Lt(n))?s0(t,ai(e),n,s,e):(e==="true-value"?t._trueValue=n:e==="false-value"&&(t._falseValue=n),i0(t,e,n,a))};function mE(t,e,r,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in t&&l0(e)&&Ge(r));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=t.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return l0(e)&&Lt(r)?!1:e in t}const sl=t=>{const e=t.props["onUpdate:modelValue"]||!1;return Me(e)?r=>Wo(e,r):e};function _E(t){t.target.composing=!0}function c0(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const ws=Symbol("_assign"),rf={created(t,{modifiers:{lazy:e,trim:r,number:n}},i){t[ws]=sl(i);const s=n||i.props&&i.props.type==="number";Oi(t,e?"change":"input",a=>{if(a.target.composing)return;let o=t.value;r&&(o=o.trim()),s&&(o=Qo(o)),t[ws](o)}),r&&Oi(t,"change",()=>{t.value=t.value.trim()}),e||(Oi(t,"compositionstart",_E),Oi(t,"compositionend",c0),Oi(t,"change",c0))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:r,modifiers:{lazy:n,trim:i,number:s}},a){if(t[ws]=sl(a),t.composing)return;const o=(s||t.type==="number")&&!/^0\d/.test(t.value)?Qo(t.value):t.value,c=e??"";o!==c&&(document.activeElement===t&&t.type!=="range"&&(n&&e===r||i&&t.value.trim()===c)||(t.value=c))}},u0={deep:!0,created(t,{value:e,modifiers:{number:r}},n){const i=$l(e);Oi(t,"change",()=>{const s=Array.prototype.filter.call(t.options,a=>a.selected).map(a=>r?Qo(al(a)):al(a));t[ws](t.multiple?i?new Set(s):s:s[0]),t._assigning=!0,bp(()=>{t._assigning=!1})}),t[ws]=sl(n)},mounted(t,{value:e}){f0(t,e)},beforeUpdate(t,e,r){t[ws]=sl(r)},updated(t,{value:e}){t._assigning||f0(t,e)}};function f0(t,e){const r=t.multiple,n=Me(e);if(!(r&&!n&&!$l(e))){for(let i=0,s=t.options.length;i<s;i++){const a=t.options[i],o=al(a);if(r)if(n){const c=typeof o;c==="string"||c==="number"?a.selected=e.some(u=>String(u)===String(o)):a.selected=pv(e,o)>-1}else a.selected=e.has(o);else if(Kl(al(a),e)){t.selectedIndex!==i&&(t.selectedIndex=i);return}}!r&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function al(t){return"_value"in t?t._value:t.value}const vE={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},d1=(t,e)=>{const r=t._withKeys||(t._withKeys={}),n=e.join(".");return r[n]||(r[n]=i=>{if(!("key"in i))return;const s=vi(i.key);if(e.some(a=>a===s||vE[a]===s))return t(i)})},xE=vr({patchProp:gE},eE);let h0;function EE(){return h0||(h0=wx(xE))}const TE=(...t)=>{const e=EE().createApp(...t),{mount:r}=e;return e.mount=n=>{const i=wE(n);if(!i)return;const s=e._component;!Ge(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const a=r(i,!1,yE(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),a},e};function yE(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function wE(t){return Lt(t)?document.querySelector(t):t}const AE=()=>{};var d0={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p1=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},SE=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],c=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},g1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,f=s>>2,d=(s&3)<<4|o>>4;let p=(o&15)<<2|u>>6,g=u&63;c||(g=64,a||(p=64)),n.push(r[f],r[d],r[p],r[g])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(p1(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):SE(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const u=i<t.length?r[t.charAt(i)]:64;++i;const d=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||u==null||d==null)throw new IE;const p=s<<2|o>>4;if(n.push(p),u!==64){const g=o<<4&240|u>>2;if(n.push(g),d!==64){const v=u<<6&192|d;n.push(v)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class IE extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const CE=function(t){const e=p1(t);return g1.encodeByteArray(e,!0)},ol=function(t){return CE(t).replace(/\./g,"")},RE=function(t){try{return g1.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PE(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FE=()=>PE().__FIREBASE_DEFAULTS__,DE=()=>{if(typeof process>"u"||typeof d0>"u")return;const t=d0.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},OE=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&RE(t[1]);return e&&JSON.parse(e)},nf=()=>{try{return AE()||FE()||DE()||OE()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},bE=t=>{var e,r;return(r=(e=nf())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},kE=t=>{const e=bE(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},m1=()=>{var t;return(t=nf())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sf(t){return t.endsWith(".cloudworkstations.dev")}async function LE(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ME(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[ol(JSON.stringify(r)),ol(JSON.stringify(a)),""].join(".")}const va={};function VE(){const t={prod:[],emulator:[]};for(const e of Object.keys(va))va[e]?t.emulator.push(e):t.prod.push(e);return t}function BE(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let p0=!1;function UE(t,e){if(typeof window>"u"||typeof document>"u"||!sf(window.location.host)||va[t]===e||va[t]||p0)return;va[t]=e;function r(p){return`__firebase__banner__${p}`}const n="__firebase__banner",s=VE().prod.length>0;function a(){const p=document.getElementById(n);p&&p.remove()}function o(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function c(p,g){p.setAttribute("width","24"),p.setAttribute("id",g),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function u(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{p0=!0,a()},p}function f(p,g){p.setAttribute("id",g),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function d(){const p=BE(n),g=r("text"),v=document.getElementById(g)||document.createElement("span"),_=r("learnmore"),E=document.getElementById(_)||document.createElement("a"),L=r("preprendIcon"),V=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const N=p.element;o(N),f(E,_);const U=u();c(V,L),N.append(V,v,E,U),document.body.appendChild(N)}s?(v.innerText="Preview backend disconnected.",V.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(V.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HE(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function WE(){var t;const e=(t=nf())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function $E(){return!WE()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function jE(){try{return typeof indexedDB=="object"}catch{return!1}}function GE(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zE="FirebaseError";class Bs extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=zE,Object.setPrototypeOf(this,Bs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,_1.prototype.create)}}class _1{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?KE(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Bs(i,o,n)}}function KE(t,e){return t.replace(qE,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const qE=/\{\$([^}]+)}/g;function ll(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(g0(s)&&g0(a)){if(!ll(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function g0(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Na(t){return t&&t._delegate?t._delegate:t}class La{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Di="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XE{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new NE;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(QE(e))try{this.getOrInitializeService({instanceIdentifier:Di})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Di){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Di){return this.instances.has(e)}getOptions(e=Di){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:YE(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Di){return this.component?this.component.multipleInstances?e:Di:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function YE(t){return t===Di?void 0:t}function QE(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new XE(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Je;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Je||(Je={}));const ZE={debug:Je.DEBUG,verbose:Je.VERBOSE,info:Je.INFO,warn:Je.WARN,error:Je.ERROR,silent:Je.SILENT},e2=Je.INFO,t2={[Je.DEBUG]:"log",[Je.VERBOSE]:"log",[Je.INFO]:"info",[Je.WARN]:"warn",[Je.ERROR]:"error"},r2=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=t2[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class v1{constructor(e){this.name=e,this._logLevel=e2,this._logHandler=r2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Je))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?ZE[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Je.DEBUG,...e),this._logHandler(this,Je.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Je.VERBOSE,...e),this._logHandler(this,Je.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Je.INFO,...e),this._logHandler(this,Je.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Je.WARN,...e),this._logHandler(this,Je.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Je.ERROR,...e),this._logHandler(this,Je.ERROR,...e)}}const n2=(t,e)=>e.some(r=>t instanceof r);let m0,_0;function i2(){return m0||(m0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function s2(){return _0||(_0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const x1=new WeakMap,hu=new WeakMap,E1=new WeakMap,Bc=new WeakMap,af=new WeakMap;function a2(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(ti(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&x1.set(r,t)}).catch(()=>{}),af.set(e,t),e}function o2(t){if(hu.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});hu.set(t,e)}let du={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return hu.get(t);if(e==="objectStoreNames")return t.objectStoreNames||E1.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ti(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function l2(t){du=t(du)}function c2(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Uc(this),e,...r);return E1.set(n,e.sort?e.sort():[e]),ti(n)}:s2().includes(t)?function(...e){return t.apply(Uc(this),e),ti(x1.get(this))}:function(...e){return ti(t.apply(Uc(this),e))}}function u2(t){return typeof t=="function"?c2(t):(t instanceof IDBTransaction&&o2(t),n2(t,i2())?new Proxy(t,du):t)}function ti(t){if(t instanceof IDBRequest)return a2(t);if(Bc.has(t))return Bc.get(t);const e=u2(t);return e!==t&&(Bc.set(t,e),af.set(e,t)),e}const Uc=t=>af.get(t);function f2(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=ti(a);return n&&a.addEventListener("upgradeneeded",c=>{n(ti(a.result),c.oldVersion,c.newVersion,ti(a.transaction),c)}),r&&a.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),o.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const h2=["get","getKey","getAll","getAllKeys","count"],d2=["put","add","delete","clear"],Hc=new Map;function v0(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Hc.get(e))return Hc.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=d2.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||h2.includes(r)))return;const s=async function(a,...o){const c=this.transaction(a,i?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(o.shift())),(await Promise.all([u[r](...o),i&&c.done]))[0]};return Hc.set(e,s),s}l2(t=>({...t,get:(e,r,n)=>v0(e,r)||t.get(e,r,n),has:(e,r)=>!!v0(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p2{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(g2(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function g2(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const pu="@firebase/app",x0="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ln=new v1("@firebase/app"),m2="@firebase/app-compat",_2="@firebase/analytics-compat",v2="@firebase/analytics",x2="@firebase/app-check-compat",E2="@firebase/app-check",T2="@firebase/auth",y2="@firebase/auth-compat",w2="@firebase/database",A2="@firebase/data-connect",S2="@firebase/database-compat",I2="@firebase/functions",C2="@firebase/functions-compat",R2="@firebase/installations",P2="@firebase/installations-compat",F2="@firebase/messaging",D2="@firebase/messaging-compat",O2="@firebase/performance",b2="@firebase/performance-compat",k2="@firebase/remote-config",N2="@firebase/remote-config-compat",L2="@firebase/storage",M2="@firebase/storage-compat",V2="@firebase/firestore",B2="@firebase/ai",U2="@firebase/firestore-compat",H2="firebase",W2="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gu="[DEFAULT]",$2={[pu]:"fire-core",[m2]:"fire-core-compat",[v2]:"fire-analytics",[_2]:"fire-analytics-compat",[E2]:"fire-app-check",[x2]:"fire-app-check-compat",[T2]:"fire-auth",[y2]:"fire-auth-compat",[w2]:"fire-rtdb",[A2]:"fire-data-connect",[S2]:"fire-rtdb-compat",[I2]:"fire-fn",[C2]:"fire-fn-compat",[R2]:"fire-iid",[P2]:"fire-iid-compat",[F2]:"fire-fcm",[D2]:"fire-fcm-compat",[O2]:"fire-perf",[b2]:"fire-perf-compat",[k2]:"fire-rc",[N2]:"fire-rc-compat",[L2]:"fire-gcs",[M2]:"fire-gcs-compat",[V2]:"fire-fst",[U2]:"fire-fst-compat",[B2]:"fire-vertex","fire-js":"fire-js",[H2]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cl=new Map,j2=new Map,mu=new Map;function E0(t,e){try{t.container.addComponent(e)}catch(r){Ln.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function ul(t){const e=t.name;if(mu.has(e))return Ln.debug(`There were multiple attempts to register component ${e}.`),!1;mu.set(e,t);for(const r of cl.values())E0(r,t);for(const r of j2.values())E0(r,t);return!0}function G2(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function z2(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ri=new _1("app","Firebase",K2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q2{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new La("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ri.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X2=W2;function T1(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:gu,automaticDataCollectionEnabled:!0},e),i=n.name;if(typeof i!="string"||!i)throw ri.create("bad-app-name",{appName:String(i)});if(r||(r=m1()),!r)throw ri.create("no-options");const s=cl.get(i);if(s){if(ll(r,s.options)&&ll(n,s.config))return s;throw ri.create("duplicate-app",{appName:i})}const a=new JE(i);for(const c of mu.values())a.addComponent(c);const o=new q2(r,n,a);return cl.set(i,o),o}function Y2(t=gu){const e=cl.get(t);if(!e&&t===gu&&m1())return T1();if(!e)throw ri.create("no-app",{appName:t});return e}function As(t,e,r){var n;let i=(n=$2[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ln.warn(o.join(" "));return}ul(new La(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q2="firebase-heartbeat-database",J2=1,Ma="firebase-heartbeat-store";let Wc=null;function y1(){return Wc||(Wc=f2(Q2,J2,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ma)}catch(r){console.warn(r)}}}}).catch(t=>{throw ri.create("idb-open",{originalErrorMessage:t.message})})),Wc}async function Z2(t){try{const r=(await y1()).transaction(Ma),n=await r.objectStore(Ma).get(w1(t));return await r.done,n}catch(e){if(e instanceof Bs)Ln.warn(e.message);else{const r=ri.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ln.warn(r.message)}}}async function T0(t,e){try{const n=(await y1()).transaction(Ma,"readwrite");await n.objectStore(Ma).put(e,w1(t)),await n.done}catch(r){if(r instanceof Bs)Ln.warn(r.message);else{const n=ri.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Ln.warn(n.message)}}}function w1(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eT=1024,tT=30;class rT{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new iT(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=y0();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>tT){const a=sT(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Ln.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=y0(),{heartbeatsToSend:n,unsentEntries:i}=nT(this._heartbeatsCache.heartbeats),s=ol(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return Ln.warn(r),""}}}function y0(){return new Date().toISOString().substring(0,10)}function nT(t,e=eT){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),w0(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),w0(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class iT{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return jE()?GE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Z2(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return T0(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return T0(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function w0(t){return ol(JSON.stringify({version:2,heartbeats:t})).length}function sT(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aT(t){ul(new La("platform-logger",e=>new p2(e),"PRIVATE")),ul(new La("heartbeat",e=>new rT(e),"PRIVATE")),As(pu,x0,t),As(pu,x0,"esm2017"),As("fire-js","")}aT("");var oT="firebase",lT="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */As(oT,lT,"app");var A0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ni,A1;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,y){function T(){}T.prototype=y.prototype,w.D=y.prototype,w.prototype=new T,w.prototype.constructor=w,w.C=function(I,P,k){for(var R=Array(arguments.length-2),$e=2;$e<arguments.length;$e++)R[$e-2]=arguments[$e];return y.prototype[P].apply(I,R)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,y,T){T||(T=0);var I=Array(16);if(typeof y=="string")for(var P=0;16>P;++P)I[P]=y.charCodeAt(T++)|y.charCodeAt(T++)<<8|y.charCodeAt(T++)<<16|y.charCodeAt(T++)<<24;else for(P=0;16>P;++P)I[P]=y[T++]|y[T++]<<8|y[T++]<<16|y[T++]<<24;y=w.g[0],T=w.g[1],P=w.g[2];var k=w.g[3],R=y+(k^T&(P^k))+I[0]+3614090360&4294967295;y=T+(R<<7&4294967295|R>>>25),R=k+(P^y&(T^P))+I[1]+3905402710&4294967295,k=y+(R<<12&4294967295|R>>>20),R=P+(T^k&(y^T))+I[2]+606105819&4294967295,P=k+(R<<17&4294967295|R>>>15),R=T+(y^P&(k^y))+I[3]+3250441966&4294967295,T=P+(R<<22&4294967295|R>>>10),R=y+(k^T&(P^k))+I[4]+4118548399&4294967295,y=T+(R<<7&4294967295|R>>>25),R=k+(P^y&(T^P))+I[5]+1200080426&4294967295,k=y+(R<<12&4294967295|R>>>20),R=P+(T^k&(y^T))+I[6]+2821735955&4294967295,P=k+(R<<17&4294967295|R>>>15),R=T+(y^P&(k^y))+I[7]+4249261313&4294967295,T=P+(R<<22&4294967295|R>>>10),R=y+(k^T&(P^k))+I[8]+1770035416&4294967295,y=T+(R<<7&4294967295|R>>>25),R=k+(P^y&(T^P))+I[9]+2336552879&4294967295,k=y+(R<<12&4294967295|R>>>20),R=P+(T^k&(y^T))+I[10]+4294925233&4294967295,P=k+(R<<17&4294967295|R>>>15),R=T+(y^P&(k^y))+I[11]+2304563134&4294967295,T=P+(R<<22&4294967295|R>>>10),R=y+(k^T&(P^k))+I[12]+1804603682&4294967295,y=T+(R<<7&4294967295|R>>>25),R=k+(P^y&(T^P))+I[13]+4254626195&4294967295,k=y+(R<<12&4294967295|R>>>20),R=P+(T^k&(y^T))+I[14]+2792965006&4294967295,P=k+(R<<17&4294967295|R>>>15),R=T+(y^P&(k^y))+I[15]+1236535329&4294967295,T=P+(R<<22&4294967295|R>>>10),R=y+(P^k&(T^P))+I[1]+4129170786&4294967295,y=T+(R<<5&4294967295|R>>>27),R=k+(T^P&(y^T))+I[6]+3225465664&4294967295,k=y+(R<<9&4294967295|R>>>23),R=P+(y^T&(k^y))+I[11]+643717713&4294967295,P=k+(R<<14&4294967295|R>>>18),R=T+(k^y&(P^k))+I[0]+3921069994&4294967295,T=P+(R<<20&4294967295|R>>>12),R=y+(P^k&(T^P))+I[5]+3593408605&4294967295,y=T+(R<<5&4294967295|R>>>27),R=k+(T^P&(y^T))+I[10]+38016083&4294967295,k=y+(R<<9&4294967295|R>>>23),R=P+(y^T&(k^y))+I[15]+3634488961&4294967295,P=k+(R<<14&4294967295|R>>>18),R=T+(k^y&(P^k))+I[4]+3889429448&4294967295,T=P+(R<<20&4294967295|R>>>12),R=y+(P^k&(T^P))+I[9]+568446438&4294967295,y=T+(R<<5&4294967295|R>>>27),R=k+(T^P&(y^T))+I[14]+3275163606&4294967295,k=y+(R<<9&4294967295|R>>>23),R=P+(y^T&(k^y))+I[3]+4107603335&4294967295,P=k+(R<<14&4294967295|R>>>18),R=T+(k^y&(P^k))+I[8]+1163531501&4294967295,T=P+(R<<20&4294967295|R>>>12),R=y+(P^k&(T^P))+I[13]+2850285829&4294967295,y=T+(R<<5&4294967295|R>>>27),R=k+(T^P&(y^T))+I[2]+4243563512&4294967295,k=y+(R<<9&4294967295|R>>>23),R=P+(y^T&(k^y))+I[7]+1735328473&4294967295,P=k+(R<<14&4294967295|R>>>18),R=T+(k^y&(P^k))+I[12]+2368359562&4294967295,T=P+(R<<20&4294967295|R>>>12),R=y+(T^P^k)+I[5]+4294588738&4294967295,y=T+(R<<4&4294967295|R>>>28),R=k+(y^T^P)+I[8]+2272392833&4294967295,k=y+(R<<11&4294967295|R>>>21),R=P+(k^y^T)+I[11]+1839030562&4294967295,P=k+(R<<16&4294967295|R>>>16),R=T+(P^k^y)+I[14]+4259657740&4294967295,T=P+(R<<23&4294967295|R>>>9),R=y+(T^P^k)+I[1]+2763975236&4294967295,y=T+(R<<4&4294967295|R>>>28),R=k+(y^T^P)+I[4]+1272893353&4294967295,k=y+(R<<11&4294967295|R>>>21),R=P+(k^y^T)+I[7]+4139469664&4294967295,P=k+(R<<16&4294967295|R>>>16),R=T+(P^k^y)+I[10]+3200236656&4294967295,T=P+(R<<23&4294967295|R>>>9),R=y+(T^P^k)+I[13]+681279174&4294967295,y=T+(R<<4&4294967295|R>>>28),R=k+(y^T^P)+I[0]+3936430074&4294967295,k=y+(R<<11&4294967295|R>>>21),R=P+(k^y^T)+I[3]+3572445317&4294967295,P=k+(R<<16&4294967295|R>>>16),R=T+(P^k^y)+I[6]+76029189&4294967295,T=P+(R<<23&4294967295|R>>>9),R=y+(T^P^k)+I[9]+3654602809&4294967295,y=T+(R<<4&4294967295|R>>>28),R=k+(y^T^P)+I[12]+3873151461&4294967295,k=y+(R<<11&4294967295|R>>>21),R=P+(k^y^T)+I[15]+530742520&4294967295,P=k+(R<<16&4294967295|R>>>16),R=T+(P^k^y)+I[2]+3299628645&4294967295,T=P+(R<<23&4294967295|R>>>9),R=y+(P^(T|~k))+I[0]+4096336452&4294967295,y=T+(R<<6&4294967295|R>>>26),R=k+(T^(y|~P))+I[7]+1126891415&4294967295,k=y+(R<<10&4294967295|R>>>22),R=P+(y^(k|~T))+I[14]+2878612391&4294967295,P=k+(R<<15&4294967295|R>>>17),R=T+(k^(P|~y))+I[5]+4237533241&4294967295,T=P+(R<<21&4294967295|R>>>11),R=y+(P^(T|~k))+I[12]+1700485571&4294967295,y=T+(R<<6&4294967295|R>>>26),R=k+(T^(y|~P))+I[3]+2399980690&4294967295,k=y+(R<<10&4294967295|R>>>22),R=P+(y^(k|~T))+I[10]+4293915773&4294967295,P=k+(R<<15&4294967295|R>>>17),R=T+(k^(P|~y))+I[1]+2240044497&4294967295,T=P+(R<<21&4294967295|R>>>11),R=y+(P^(T|~k))+I[8]+1873313359&4294967295,y=T+(R<<6&4294967295|R>>>26),R=k+(T^(y|~P))+I[15]+4264355552&4294967295,k=y+(R<<10&4294967295|R>>>22),R=P+(y^(k|~T))+I[6]+2734768916&4294967295,P=k+(R<<15&4294967295|R>>>17),R=T+(k^(P|~y))+I[13]+1309151649&4294967295,T=P+(R<<21&4294967295|R>>>11),R=y+(P^(T|~k))+I[4]+4149444226&4294967295,y=T+(R<<6&4294967295|R>>>26),R=k+(T^(y|~P))+I[11]+3174756917&4294967295,k=y+(R<<10&4294967295|R>>>22),R=P+(y^(k|~T))+I[2]+718787259&4294967295,P=k+(R<<15&4294967295|R>>>17),R=T+(k^(P|~y))+I[9]+3951481745&4294967295,w.g[0]=w.g[0]+y&4294967295,w.g[1]=w.g[1]+(P+(R<<21&4294967295|R>>>11))&4294967295,w.g[2]=w.g[2]+P&4294967295,w.g[3]=w.g[3]+k&4294967295}n.prototype.u=function(w,y){y===void 0&&(y=w.length);for(var T=y-this.blockSize,I=this.B,P=this.h,k=0;k<y;){if(P==0)for(;k<=T;)i(this,w,k),k+=this.blockSize;if(typeof w=="string"){for(;k<y;)if(I[P++]=w.charCodeAt(k++),P==this.blockSize){i(this,I),P=0;break}}else for(;k<y;)if(I[P++]=w[k++],P==this.blockSize){i(this,I),P=0;break}}this.h=P,this.o+=y},n.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var y=1;y<w.length-8;++y)w[y]=0;var T=8*this.o;for(y=w.length-8;y<w.length;++y)w[y]=T&255,T/=256;for(this.u(w),w=Array(16),y=T=0;4>y;++y)for(var I=0;32>I;I+=8)w[T++]=this.g[y]>>>I&255;return w};function s(w,y){var T=o;return Object.prototype.hasOwnProperty.call(T,w)?T[w]:T[w]=y(w)}function a(w,y){this.h=y;for(var T=[],I=!0,P=w.length-1;0<=P;P--){var k=w[P]|0;I&&k==y||(T[P]=k,I=!1)}this.g=T}var o={};function c(w){return-128<=w&&128>w?s(w,function(y){return new a([y|0],0>y?-1:0)}):new a([w|0],0>w?-1:0)}function u(w){if(isNaN(w)||!isFinite(w))return d;if(0>w)return E(u(-w));for(var y=[],T=1,I=0;w>=T;I++)y[I]=w/T|0,T*=4294967296;return new a(y,0)}function f(w,y){if(w.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(w.charAt(0)=="-")return E(f(w.substring(1),y));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=u(Math.pow(y,8)),I=d,P=0;P<w.length;P+=8){var k=Math.min(8,w.length-P),R=parseInt(w.substring(P,P+k),y);8>k?(k=u(Math.pow(y,k)),I=I.j(k).add(u(R))):(I=I.j(T),I=I.add(u(R)))}return I}var d=c(0),p=c(1),g=c(16777216);t=a.prototype,t.m=function(){if(_(this))return-E(this).m();for(var w=0,y=1,T=0;T<this.g.length;T++){var I=this.i(T);w+=(0<=I?I:4294967296+I)*y,y*=4294967296}return w},t.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(v(this))return"0";if(_(this))return"-"+E(this).toString(w);for(var y=u(Math.pow(w,6)),T=this,I="";;){var P=U(T,y).g;T=L(T,P.j(y));var k=((0<T.g.length?T.g[0]:T.h)>>>0).toString(w);if(T=P,v(T))return k+I;for(;6>k.length;)k="0"+k;I=k+I}},t.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function v(w){if(w.h!=0)return!1;for(var y=0;y<w.g.length;y++)if(w.g[y]!=0)return!1;return!0}function _(w){return w.h==-1}t.l=function(w){return w=L(this,w),_(w)?-1:v(w)?0:1};function E(w){for(var y=w.g.length,T=[],I=0;I<y;I++)T[I]=~w.g[I];return new a(T,~w.h).add(p)}t.abs=function(){return _(this)?E(this):this},t.add=function(w){for(var y=Math.max(this.g.length,w.g.length),T=[],I=0,P=0;P<=y;P++){var k=I+(this.i(P)&65535)+(w.i(P)&65535),R=(k>>>16)+(this.i(P)>>>16)+(w.i(P)>>>16);I=R>>>16,k&=65535,R&=65535,T[P]=R<<16|k}return new a(T,T[T.length-1]&-2147483648?-1:0)};function L(w,y){return w.add(E(y))}t.j=function(w){if(v(this)||v(w))return d;if(_(this))return _(w)?E(this).j(E(w)):E(E(this).j(w));if(_(w))return E(this.j(E(w)));if(0>this.l(g)&&0>w.l(g))return u(this.m()*w.m());for(var y=this.g.length+w.g.length,T=[],I=0;I<2*y;I++)T[I]=0;for(I=0;I<this.g.length;I++)for(var P=0;P<w.g.length;P++){var k=this.i(I)>>>16,R=this.i(I)&65535,$e=w.i(P)>>>16,ke=w.i(P)&65535;T[2*I+2*P]+=R*ke,V(T,2*I+2*P),T[2*I+2*P+1]+=k*ke,V(T,2*I+2*P+1),T[2*I+2*P+1]+=R*$e,V(T,2*I+2*P+1),T[2*I+2*P+2]+=k*$e,V(T,2*I+2*P+2)}for(I=0;I<y;I++)T[I]=T[2*I+1]<<16|T[2*I];for(I=y;I<2*y;I++)T[I]=0;return new a(T,0)};function V(w,y){for(;(w[y]&65535)!=w[y];)w[y+1]+=w[y]>>>16,w[y]&=65535,y++}function N(w,y){this.g=w,this.h=y}function U(w,y){if(v(y))throw Error("division by zero");if(v(w))return new N(d,d);if(_(w))return y=U(E(w),y),new N(E(y.g),E(y.h));if(_(y))return y=U(w,E(y)),new N(E(y.g),y.h);if(30<w.g.length){if(_(w)||_(y))throw Error("slowDivide_ only works with positive integers.");for(var T=p,I=y;0>=I.l(w);)T=re(T),I=re(I);var P=ue(T,1),k=ue(I,1);for(I=ue(I,2),T=ue(T,2);!v(I);){var R=k.add(I);0>=R.l(w)&&(P=P.add(T),k=R),I=ue(I,1),T=ue(T,1)}return y=L(w,P.j(y)),new N(P,y)}for(P=d;0<=w.l(y);){for(T=Math.max(1,Math.floor(w.m()/y.m())),I=Math.ceil(Math.log(T)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),k=u(T),R=k.j(y);_(R)||0<R.l(w);)T-=I,k=u(T),R=k.j(y);v(k)&&(k=p),P=P.add(k),w=L(w,R)}return new N(P,w)}t.A=function(w){return U(this,w).h},t.and=function(w){for(var y=Math.max(this.g.length,w.g.length),T=[],I=0;I<y;I++)T[I]=this.i(I)&w.i(I);return new a(T,this.h&w.h)},t.or=function(w){for(var y=Math.max(this.g.length,w.g.length),T=[],I=0;I<y;I++)T[I]=this.i(I)|w.i(I);return new a(T,this.h|w.h)},t.xor=function(w){for(var y=Math.max(this.g.length,w.g.length),T=[],I=0;I<y;I++)T[I]=this.i(I)^w.i(I);return new a(T,this.h^w.h)};function re(w){for(var y=w.g.length+1,T=[],I=0;I<y;I++)T[I]=w.i(I)<<1|w.i(I-1)>>>31;return new a(T,w.h)}function ue(w,y){var T=y>>5;y%=32;for(var I=w.g.length-T,P=[],k=0;k<I;k++)P[k]=0<y?w.i(k+T)>>>y|w.i(k+T+1)<<32-y:w.i(k+T);return new a(P,w.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,A1=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=f,ni=a}).apply(typeof A0<"u"?A0:typeof self<"u"?self:typeof window<"u"?window:{});var Po=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var S1,la,I1,zo,_u,C1,R1,P1;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,m){return l==Array.prototype||l==Object.prototype||(l[h]=m.value),l};function r(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Po=="object"&&Po];for(var h=0;h<l.length;++h){var m=l[h];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var n=r(this);function i(l,h){if(h)e:{var m=n;l=l.split(".");for(var A=0;A<l.length-1;A++){var j=l[A];if(!(j in m))break e;m=m[j]}l=l[l.length-1],A=m[l],h=h(A),h!=A&&h!=null&&e(m,l,{configurable:!0,writable:!0,value:h})}}function s(l,h){l instanceof String&&(l+="");var m=0,A=!1,j={next:function(){if(!A&&m<l.length){var J=m++;return{value:h(J,l[J]),done:!1}}return A=!0,{done:!0,value:void 0}}};return j[Symbol.iterator]=function(){return j},j}i("Array.prototype.values",function(l){return l||function(){return s(this,function(h,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function c(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function u(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function f(l,h,m){return l.call.apply(l.bind,arguments)}function d(l,h,m){if(!l)throw Error();if(2<arguments.length){var A=Array.prototype.slice.call(arguments,2);return function(){var j=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(j,A),l.apply(h,j)}}return function(){return l.apply(h,arguments)}}function p(l,h,m){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:d,p.apply(null,arguments)}function g(l,h){var m=Array.prototype.slice.call(arguments,1);return function(){var A=m.slice();return A.push.apply(A,arguments),l.apply(this,A)}}function v(l,h){function m(){}m.prototype=h.prototype,l.aa=h.prototype,l.prototype=new m,l.prototype.constructor=l,l.Qb=function(A,j,J){for(var xe=Array(arguments.length-2),gt=2;gt<arguments.length;gt++)xe[gt-2]=arguments[gt];return h.prototype[j].apply(A,xe)}}function _(l){const h=l.length;if(0<h){const m=Array(h);for(let A=0;A<h;A++)m[A]=l[A];return m}return[]}function E(l,h){for(let m=1;m<arguments.length;m++){const A=arguments[m];if(c(A)){const j=l.length||0,J=A.length||0;l.length=j+J;for(let xe=0;xe<J;xe++)l[j+xe]=A[xe]}else l.push(A)}}class L{constructor(h,m){this.i=h,this.j=m,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function V(l){return/^[\s\xa0]*$/.test(l)}function N(){var l=o.navigator;return l&&(l=l.userAgent)?l:""}function U(l){return U[" "](l),l}U[" "]=function(){};var re=N().indexOf("Gecko")!=-1&&!(N().toLowerCase().indexOf("webkit")!=-1&&N().indexOf("Edge")==-1)&&!(N().indexOf("Trident")!=-1||N().indexOf("MSIE")!=-1)&&N().indexOf("Edge")==-1;function ue(l,h,m){for(const A in l)h.call(m,l[A],A,l)}function w(l,h){for(const m in l)h.call(void 0,l[m],m,l)}function y(l){const h={};for(const m in l)h[m]=l[m];return h}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(l,h){let m,A;for(let j=1;j<arguments.length;j++){A=arguments[j];for(m in A)l[m]=A[m];for(let J=0;J<T.length;J++)m=T[J],Object.prototype.hasOwnProperty.call(A,m)&&(l[m]=A[m])}}function P(l){var h=1;l=l.split(":");const m=[];for(;0<h&&l.length;)m.push(l.shift()),h--;return l.length&&m.push(l.join(":")),m}function k(l){o.setTimeout(()=>{throw l},0)}function R(){var l=it;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class $e{constructor(){this.h=this.g=null}add(h,m){const A=ke.get();A.set(h,m),this.h?this.h.next=A:this.g=A,this.h=A}}var ke=new L(()=>new Xe,l=>l.reset());class Xe{constructor(){this.next=this.g=this.h=null}set(h,m){this.h=h,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let Ne,He=!1,it=new $e,Ft=()=>{const l=o.Promise.resolve(void 0);Ne=()=>{l.then(wt)}};var wt=()=>{for(var l;l=R();){try{l.h.call(l.g)}catch(m){k(m)}var h=ke;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}He=!1};function M(){this.s=this.s,this.C=this.C}M.prototype.s=!1,M.prototype.ma=function(){this.s||(this.s=!0,this.N())},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function G(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}G.prototype.h=function(){this.defaultPrevented=!0};var W=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const m=()=>{};o.addEventListener("test",m,h),o.removeEventListener("test",m,h)}catch{}return l}();function H(l,h){if(G.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var m=this.type=l.type,A=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(re){e:{try{U(h.nodeName);var j=!0;break e}catch{}j=!1}j||(h=null)}}else m=="mouseover"?h=l.fromElement:m=="mouseout"&&(h=l.toElement);this.relatedTarget=h,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:ne[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&H.aa.h.call(this)}}v(H,G);var ne={2:"touch",3:"pen",4:"mouse"};H.prototype.h=function(){H.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var we="closure_listenable_"+(1e6*Math.random()|0),Ce=0;function Ie(l,h,m,A,j){this.listener=l,this.proxy=null,this.src=h,this.type=m,this.capture=!!A,this.ha=j,this.key=++Ce,this.da=this.fa=!1}function me(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function et(l){this.src=l,this.g={},this.h=0}et.prototype.add=function(l,h,m,A,j){var J=l.toString();l=this.g[J],l||(l=this.g[J]=[],this.h++);var xe=B(l,h,A,j);return-1<xe?(h=l[xe],m||(h.fa=!1)):(h=new Ie(h,this.src,J,!!A,j),h.fa=m,l.push(h)),h};function b(l,h){var m=h.type;if(m in l.g){var A=l.g[m],j=Array.prototype.indexOf.call(A,h,void 0),J;(J=0<=j)&&Array.prototype.splice.call(A,j,1),J&&(me(h),l.g[m].length==0&&(delete l.g[m],l.h--))}}function B(l,h,m,A){for(var j=0;j<l.length;++j){var J=l[j];if(!J.da&&J.listener==h&&J.capture==!!m&&J.ha==A)return j}return-1}var K="closure_lm_"+(1e6*Math.random()|0),ae={};function te(l,h,m,A,j){if(Array.isArray(h)){for(var J=0;J<h.length;J++)te(l,h[J],m,A,j);return null}return m=De(m),l&&l[we]?l.K(h,m,u(A)?!!A.capture:!1,j):z(l,h,m,!1,A,j)}function z(l,h,m,A,j,J){if(!h)throw Error("Invalid event type");var xe=u(j)?!!j.capture:!!j,gt=Ee(l);if(gt||(l[K]=gt=new et(l)),m=gt.add(h,m,A,xe,J),m.proxy)return m;if(A=pe(),m.proxy=A,A.src=l,A.listener=m,l.addEventListener)W||(j=xe),j===void 0&&(j=!1),l.addEventListener(h.toString(),A,j);else if(l.attachEvent)l.attachEvent(oe(h.toString()),A);else if(l.addListener&&l.removeListener)l.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return m}function pe(){function l(m){return h.call(l.src,l.listener,m)}const h=Re;return l}function he(l,h,m,A,j){if(Array.isArray(h))for(var J=0;J<h.length;J++)he(l,h[J],m,A,j);else A=u(A)?!!A.capture:!!A,m=De(m),l&&l[we]?(l=l.i,h=String(h).toString(),h in l.g&&(J=l.g[h],m=B(J,m,A,j),-1<m&&(me(J[m]),Array.prototype.splice.call(J,m,1),J.length==0&&(delete l.g[h],l.h--)))):l&&(l=Ee(l))&&(h=l.g[h.toString()],l=-1,h&&(l=B(h,m,A,j)),(m=-1<l?h[l]:null)&&fe(m))}function fe(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[we])b(h.i,l);else{var m=l.type,A=l.proxy;h.removeEventListener?h.removeEventListener(m,A,l.capture):h.detachEvent?h.detachEvent(oe(m),A):h.addListener&&h.removeListener&&h.removeListener(A),(m=Ee(h))?(b(m,l),m.h==0&&(m.src=null,h[K]=null)):me(l)}}}function oe(l){return l in ae?ae[l]:ae[l]="on"+l}function Re(l,h){if(l.da)l=!0;else{h=new H(h,this);var m=l.listener,A=l.ha||l.src;l.fa&&fe(l),l=m.call(A,h)}return l}function Ee(l){return l=l[K],l instanceof et?l:null}var Ae="__closure_events_fn_"+(1e9*Math.random()>>>0);function De(l){return typeof l=="function"?l:(l[Ae]||(l[Ae]=function(h){return l.handleEvent(h)}),l[Ae])}function Pe(){M.call(this),this.i=new et(this),this.M=this,this.F=null}v(Pe,M),Pe.prototype[we]=!0,Pe.prototype.removeEventListener=function(l,h,m,A){he(this,l,h,m,A)};function Ve(l,h){var m,A=l.F;if(A)for(m=[];A;A=A.F)m.push(A);if(l=l.M,A=h.type||h,typeof h=="string")h=new G(h,l);else if(h instanceof G)h.target=h.target||l;else{var j=h;h=new G(A,l),I(h,j)}if(j=!0,m)for(var J=m.length-1;0<=J;J--){var xe=h.g=m[J];j=je(xe,A,!0,h)&&j}if(xe=h.g=l,j=je(xe,A,!0,h)&&j,j=je(xe,A,!1,h)&&j,m)for(J=0;J<m.length;J++)xe=h.g=m[J],j=je(xe,A,!1,h)&&j}Pe.prototype.N=function(){if(Pe.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var m=l.g[h],A=0;A<m.length;A++)me(m[A]);delete l.g[h],l.h--}}this.F=null},Pe.prototype.K=function(l,h,m,A){return this.i.add(String(l),h,!1,m,A)},Pe.prototype.L=function(l,h,m,A){return this.i.add(String(l),h,!0,m,A)};function je(l,h,m,A){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var j=!0,J=0;J<h.length;++J){var xe=h[J];if(xe&&!xe.da&&xe.capture==m){var gt=xe.listener,Qt=xe.ha||xe.src;xe.fa&&b(l.i,xe),j=gt.call(Qt,A)!==!1&&j}}return j&&!A.defaultPrevented}function jt(l,h,m){if(typeof l=="function")m&&(l=p(l,m));else if(l&&typeof l.handleEvent=="function")l=p(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:o.setTimeout(l,h||0)}function Dt(l){l.g=jt(()=>{l.g=null,l.i&&(l.i=!1,Dt(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class Er extends M{constructor(h,m){super(),this.m=h,this.l=m,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Dt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Vt(l){M.call(this),this.h=l,this.g={}}v(Vt,M);var Xr=[];function $n(l){ue(l.g,function(h,m){this.g.hasOwnProperty(m)&&fe(h)},l),l.g={}}Vt.prototype.N=function(){Vt.aa.N.call(this),$n(this)},Vt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ot=o.JSON.stringify,Cr=o.JSON.parse,Zi=class{stringify(l){return o.JSON.stringify(l,void 0)}parse(l){return o.JSON.parse(l,void 0)}};function es(){}es.prototype.h=null;function qs(l){return l.h||(l.h=l.i())}function Xs(){}var yi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ys(){G.call(this,"d")}v(Ys,G);function jn(){G.call(this,"c")}v(jn,G);var En={},uo=null;function ts(){return uo=uo||new Pe}En.La="serverreachability";function fo(l){G.call(this,En.La,l)}v(fo,G);function wi(l){const h=ts();Ve(h,new fo(h))}En.STAT_EVENT="statevent";function ho(l,h){G.call(this,En.STAT_EVENT,l),this.stat=h}v(ho,G);function Yt(l){const h=ts();Ve(h,new ho(h,l))}En.Ma="timingevent";function po(l,h){G.call(this,En.Ma,l),this.size=h}v(po,G);function Tn(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){l()},h)}function Ai(){this.g=!0}Ai.prototype.xa=function(){this.g=!1};function Tc(l,h,m,A,j,J){l.info(function(){if(l.g)if(J)for(var xe="",gt=J.split("&"),Qt=0;Qt<gt.length;Qt++){var tt=gt[Qt].split("=");if(1<tt.length){var ur=tt[0];tt=tt[1];var fr=ur.split("_");xe=2<=fr.length&&fr[1]=="type"?xe+(ur+"="+tt+"&"):xe+(ur+"=redacted&")}}else xe=null;else xe=J;return"XMLHTTP REQ ("+A+") [attempt "+j+"]: "+h+`
`+m+`
`+xe})}function yc(l,h,m,A,j,J,xe){l.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+j+"]: "+h+`
`+m+`
`+J+" "+xe})}function x(l,h,m,A){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+S(l,m)+(A?" "+A:"")})}function F(l,h){l.info(function(){return"TIMEOUT: "+h})}Ai.prototype.info=function(){};function S(l,h){if(!l.g)return h;if(!h)return null;try{var m=JSON.parse(h);if(m){for(l=0;l<m.length;l++)if(Array.isArray(m[l])){var A=m[l];if(!(2>A.length)){var j=A[1];if(Array.isArray(j)&&!(1>j.length)){var J=j[0];if(J!="noop"&&J!="stop"&&J!="close")for(var xe=1;xe<j.length;xe++)j[xe]=""}}}}return Ot(m)}catch{return h}}var C={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},D={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},O;function q(){}v(q,es),q.prototype.g=function(){return new XMLHttpRequest},q.prototype.i=function(){return{}},O=new q;function Z(l,h,m,A){this.j=l,this.i=h,this.l=m,this.R=A||1,this.U=new Vt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new X}function X(){this.i=null,this.g="",this.h=!1}var Y={},Q={};function le(l,h,m){l.L=1,l.v=_o(wn(h)),l.m=m,l.P=!0,ve(l,null)}function ve(l,h){l.F=Date.now(),Te(l),l.A=wn(l.v);var m=l.A,A=l.R;Array.isArray(A)||(A=[String(A)]),ph(m.i,"t",A),l.C=0,m=l.j.J,l.h=new X,l.g=Oh(l.j,m?h:null,!l.m),0<l.O&&(l.M=new Er(p(l.Y,l,l.g),l.O)),h=l.U,m=l.g,A=l.ca;var j="readystatechange";Array.isArray(j)||(j&&(Xr[0]=j.toString()),j=Xr);for(var J=0;J<j.length;J++){var xe=te(m,j[J],A||h.handleEvent,!1,h.h||h);if(!xe)break;h.g[xe.key]=xe}h=l.H?y(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),wi(),Tc(l.i,l.u,l.A,l.l,l.R,l.m)}Z.prototype.ca=function(l){l=l.target;const h=this.M;h&&An(l)==3?h.j():this.Y(l)},Z.prototype.Y=function(l){try{if(l==this.g)e:{const fr=An(this.g);var h=this.g.Ba();const ss=this.g.Z();if(!(3>fr)&&(fr!=3||this.g&&(this.h.h||this.g.oa()||Th(this.g)))){this.J||fr!=4||h==7||(h==8||0>=ss?wi(3):wi(2)),pt(this);var m=this.g.Z();this.X=m;t:if(ye(this)){var A=Th(this.g);l="";var j=A.length,J=An(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Tt(this),lt(this);var xe="";break t}this.h.i=new o.TextDecoder}for(h=0;h<j;h++)this.h.h=!0,l+=this.h.i.decode(A[h],{stream:!(J&&h==j-1)});A.length=0,this.h.g+=l,this.C=0,xe=this.h.g}else xe=this.g.oa();if(this.o=m==200,yc(this.i,this.u,this.A,this.l,this.R,fr,m),this.o){if(this.T&&!this.K){t:{if(this.g){var gt,Qt=this.g;if((gt=Qt.g?Qt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!V(gt)){var tt=gt;break t}}tt=null}if(m=tt)x(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,yn(this,m);else{this.o=!1,this.s=3,Yt(12),Tt(this),lt(this);break e}}if(this.P){m=!0;let Yr;for(;!this.J&&this.C<xe.length;)if(Yr=de(this,xe),Yr==Q){fr==4&&(this.s=4,Yt(14),m=!1),x(this.i,this.l,null,"[Incomplete Response]");break}else if(Yr==Y){this.s=4,Yt(15),x(this.i,this.l,xe,"[Invalid Chunk]"),m=!1;break}else x(this.i,this.l,Yr,null),yn(this,Yr);if(ye(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),fr!=4||xe.length!=0||this.h.h||(this.s=1,Yt(16),m=!1),this.o=this.o&&m,!m)x(this.i,this.l,xe,"[Invalid Chunked Response]"),Tt(this),lt(this);else if(0<xe.length&&!this.W){this.W=!0;var ur=this.j;ur.g==this&&ur.ba&&!ur.M&&(ur.j.info("Great, no buffering proxy detected. Bytes received: "+xe.length),Cc(ur),ur.M=!0,Yt(11))}}else x(this.i,this.l,xe,null),yn(this,xe);fr==4&&Tt(this),this.o&&!this.J&&(fr==4?Rh(this.j,this):(this.o=!1,Te(this)))}else ev(this.g),m==400&&0<xe.indexOf("Unknown SID")?(this.s=3,Yt(12)):(this.s=0,Yt(13)),Tt(this),lt(this)}}}catch{}finally{}};function ye(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function de(l,h){var m=l.C,A=h.indexOf(`
`,m);return A==-1?Q:(m=Number(h.substring(m,A)),isNaN(m)?Y:(A+=1,A+m>h.length?Q:(h=h.slice(A,A+m),l.C=A+m,h)))}Z.prototype.cancel=function(){this.J=!0,Tt(this)};function Te(l){l.S=Date.now()+l.I,Be(l,l.I)}function Be(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Tn(p(l.ba,l),h)}function pt(l){l.B&&(o.clearTimeout(l.B),l.B=null)}Z.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(F(this.i,this.A),this.L!=2&&(wi(),Yt(17)),Tt(this),this.s=2,lt(this)):Be(this,this.S-l)};function lt(l){l.j.G==0||l.J||Rh(l.j,l)}function Tt(l){pt(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,$n(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function yn(l,h){try{var m=l.j;if(m.G!=0&&(m.g==l||br(m.h,l))){if(!l.K&&br(m.h,l)&&m.G==3){try{var A=m.Da.g.parse(h)}catch{A=null}if(Array.isArray(A)&&A.length==3){var j=A;if(j[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<l.F)wo(m),To(m);else break e;Ic(m),Yt(18)}}else m.za=j[1],0<m.za-m.T&&37500>j[2]&&m.F&&m.v==0&&!m.C&&(m.C=Tn(p(m.Za,m),6e3));if(1>=rs(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else Ci(m,11)}else if((l.K||m.g==l)&&wo(m),!V(h))for(j=m.Da.g.parse(h),h=0;h<j.length;h++){let tt=j[h];if(m.T=tt[0],tt=tt[1],m.G==2)if(tt[0]=="c"){m.K=tt[1],m.ia=tt[2];const ur=tt[3];ur!=null&&(m.la=ur,m.j.info("VER="+m.la));const fr=tt[4];fr!=null&&(m.Aa=fr,m.j.info("SVER="+m.Aa));const ss=tt[5];ss!=null&&typeof ss=="number"&&0<ss&&(A=1.5*ss,m.L=A,m.j.info("backChannelRequestTimeoutMs_="+A)),A=m;const Yr=l.g;if(Yr){const So=Yr.g?Yr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(So){var J=A.h;J.g||So.indexOf("spdy")==-1&&So.indexOf("quic")==-1&&So.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(wc(J,J.h),J.h=null))}if(A.D){const Rc=Yr.g?Yr.g.getResponseHeader("X-HTTP-Session-Id"):null;Rc&&(A.ya=Rc,vt(A.I,A.D,Rc))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-l.F,m.j.info("Handshake RTT: "+m.R+"ms")),A=m;var xe=l;if(A.qa=Dh(A,A.J?A.ia:null,A.W),xe.K){ah(A.h,xe);var gt=xe,Qt=A.L;Qt&&(gt.I=Qt),gt.B&&(pt(gt),Te(gt)),A.g=xe}else Ih(A);0<m.i.length&&yo(m)}else tt[0]!="stop"&&tt[0]!="close"||Ci(m,7);else m.G==3&&(tt[0]=="stop"||tt[0]=="close"?tt[0]=="stop"?Ci(m,7):Sc(m):tt[0]!="noop"&&m.l&&m.l.ta(tt),m.v=0)}}wi(4)}catch{}}var Si=class{constructor(l,h){this.g=l,this.map=h}};function Gn(l){this.l=l||10,o.PerformanceNavigationTiming?(l=o.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function sn(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function rs(l){return l.h?1:l.g?l.g.size:0}function br(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function wc(l,h){l.g?l.g.add(h):l.h=h}function ah(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}Gn.prototype.cancel=function(){if(this.i=oh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function oh(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const m of l.g.values())h=h.concat(m.D);return h}return _(l.i)}function B_(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(c(l)){for(var h=[],m=l.length,A=0;A<m;A++)h.push(l[A]);return h}h=[],m=0;for(A in l)h[m++]=l[A];return h}function U_(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(c(l)||typeof l=="string"){var h=[];l=l.length;for(var m=0;m<l;m++)h.push(m);return h}h=[],m=0;for(const A in l)h[m++]=A;return h}}}function lh(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(c(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var m=U_(l),A=B_(l),j=A.length,J=0;J<j;J++)h.call(void 0,A[J],m&&m[J],l)}var ch=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function H_(l,h){if(l){l=l.split("&");for(var m=0;m<l.length;m++){var A=l[m].indexOf("="),j=null;if(0<=A){var J=l[m].substring(0,A);j=l[m].substring(A+1)}else J=l[m];h(J,j?decodeURIComponent(j.replace(/\+/g," ")):"")}}}function Ii(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Ii){this.h=l.h,go(this,l.j),this.o=l.o,this.g=l.g,mo(this,l.s),this.l=l.l;var h=l.i,m=new Zs;m.i=h.i,h.g&&(m.g=new Map(h.g),m.h=h.h),uh(this,m),this.m=l.m}else l&&(h=String(l).match(ch))?(this.h=!1,go(this,h[1]||"",!0),this.o=Qs(h[2]||""),this.g=Qs(h[3]||"",!0),mo(this,h[4]),this.l=Qs(h[5]||"",!0),uh(this,h[6]||"",!0),this.m=Qs(h[7]||"")):(this.h=!1,this.i=new Zs(null,this.h))}Ii.prototype.toString=function(){var l=[],h=this.j;h&&l.push(Js(h,fh,!0),":");var m=this.g;return(m||h=="file")&&(l.push("//"),(h=this.o)&&l.push(Js(h,fh,!0),"@"),l.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&l.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&l.push("/"),l.push(Js(m,m.charAt(0)=="/"?j_:$_,!0))),(m=this.i.toString())&&l.push("?",m),(m=this.m)&&l.push("#",Js(m,z_)),l.join("")};function wn(l){return new Ii(l)}function go(l,h,m){l.j=m?Qs(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function mo(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function uh(l,h,m){h instanceof Zs?(l.i=h,K_(l.i,l.h)):(m||(h=Js(h,G_)),l.i=new Zs(h,l.h))}function vt(l,h,m){l.i.set(h,m)}function _o(l){return vt(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function Qs(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Js(l,h,m){return typeof l=="string"?(l=encodeURI(l).replace(h,W_),m&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function W_(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var fh=/[#\/\?@]/g,$_=/[#\?:]/g,j_=/[#\?]/g,G_=/[#\?@]/g,z_=/#/g;function Zs(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function zn(l){l.g||(l.g=new Map,l.h=0,l.i&&H_(l.i,function(h,m){l.add(decodeURIComponent(h.replace(/\+/g," ")),m)}))}t=Zs.prototype,t.add=function(l,h){zn(this),this.i=null,l=ns(this,l);var m=this.g.get(l);return m||this.g.set(l,m=[]),m.push(h),this.h+=1,this};function hh(l,h){zn(l),h=ns(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function dh(l,h){return zn(l),h=ns(l,h),l.g.has(h)}t.forEach=function(l,h){zn(this),this.g.forEach(function(m,A){m.forEach(function(j){l.call(h,j,A,this)},this)},this)},t.na=function(){zn(this);const l=Array.from(this.g.values()),h=Array.from(this.g.keys()),m=[];for(let A=0;A<h.length;A++){const j=l[A];for(let J=0;J<j.length;J++)m.push(h[A])}return m},t.V=function(l){zn(this);let h=[];if(typeof l=="string")dh(this,l)&&(h=h.concat(this.g.get(ns(this,l))));else{l=Array.from(this.g.values());for(let m=0;m<l.length;m++)h=h.concat(l[m])}return h},t.set=function(l,h){return zn(this),this.i=null,l=ns(this,l),dh(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},t.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function ph(l,h,m){hh(l,h),0<m.length&&(l.i=null,l.g.set(ns(l,h),_(m)),l.h+=m.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(var m=0;m<h.length;m++){var A=h[m];const J=encodeURIComponent(String(A)),xe=this.V(A);for(A=0;A<xe.length;A++){var j=J;xe[A]!==""&&(j+="="+encodeURIComponent(String(xe[A]))),l.push(j)}}return this.i=l.join("&")};function ns(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function K_(l,h){h&&!l.j&&(zn(l),l.i=null,l.g.forEach(function(m,A){var j=A.toLowerCase();A!=j&&(hh(this,A),ph(this,j,m))},l)),l.j=h}function q_(l,h){const m=new Ai;if(o.Image){const A=new Image;A.onload=g(Kn,m,"TestLoadImage: loaded",!0,h,A),A.onerror=g(Kn,m,"TestLoadImage: error",!1,h,A),A.onabort=g(Kn,m,"TestLoadImage: abort",!1,h,A),A.ontimeout=g(Kn,m,"TestLoadImage: timeout",!1,h,A),o.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=l}else h(!1)}function X_(l,h){const m=new Ai,A=new AbortController,j=setTimeout(()=>{A.abort(),Kn(m,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:A.signal}).then(J=>{clearTimeout(j),J.ok?Kn(m,"TestPingServer: ok",!0,h):Kn(m,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(j),Kn(m,"TestPingServer: error",!1,h)})}function Kn(l,h,m,A,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),A(m)}catch{}}function Y_(){this.g=new Zi}function Q_(l,h,m){const A=m||"";try{lh(l,function(j,J){let xe=j;u(j)&&(xe=Ot(j)),h.push(A+J+"="+encodeURIComponent(xe))})}catch(j){throw h.push(A+"type="+encodeURIComponent("_badmap")),j}}function vo(l){this.l=l.Ub||null,this.j=l.eb||!1}v(vo,es),vo.prototype.g=function(){return new xo(this.l,this.j)},vo.prototype.i=function(l){return function(){return l}}({});function xo(l,h){Pe.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(xo,Pe),t=xo.prototype,t.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,ta(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||o).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ea(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,ta(this)),this.g&&(this.readyState=3,ta(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;gh(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function gh(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?ea(this):ta(this),this.readyState==3&&gh(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,ea(this))},t.Qa=function(l){this.g&&(this.response=l,ea(this))},t.ga=function(){this.g&&ea(this)};function ea(l){l.readyState=4,l.l=null,l.j=null,l.v=null,ta(l)}t.setRequestHeader=function(l,h){this.u.append(l,h)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var m=h.next();!m.done;)m=m.value,l.push(m[0]+": "+m[1]),m=h.next();return l.join(`\r
`)};function ta(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(xo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function mh(l){let h="";return ue(l,function(m,A){h+=A,h+=":",h+=m,h+=`\r
`}),h}function Ac(l,h,m){e:{for(A in m){var A=!1;break e}A=!0}A||(m=mh(m),typeof l=="string"?m!=null&&encodeURIComponent(String(m)):vt(l,h,m))}function It(l){Pe.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(It,Pe);var J_=/^https?$/i,Z_=["POST","PUT"];t=It.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,h,m,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():O.g(),this.v=this.o?qs(this.o):qs(O),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(J){_h(this,J);return}if(l=m||"",m=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var j in A)m.set(j,A[j]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const J of A.keys())m.set(J,A.get(J));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(m.keys()).find(J=>J.toLowerCase()=="content-type"),j=o.FormData&&l instanceof o.FormData,!(0<=Array.prototype.indexOf.call(Z_,h,void 0))||A||j||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,xe]of m)this.g.setRequestHeader(J,xe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Eh(this),this.u=!0,this.g.send(l),this.u=!1}catch(J){_h(this,J)}};function _h(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,vh(l),Eo(l)}function vh(l){l.A||(l.A=!0,Ve(l,"complete"),Ve(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,Ve(this,"complete"),Ve(this,"abort"),Eo(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Eo(this,!0)),It.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?xh(this):this.bb())},t.bb=function(){xh(this)};function xh(l){if(l.h&&typeof a<"u"&&(!l.v[1]||An(l)!=4||l.Z()!=2)){if(l.u&&An(l)==4)jt(l.Ea,0,l);else if(Ve(l,"readystatechange"),An(l)==4){l.h=!1;try{const xe=l.Z();e:switch(xe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var m;if(!(m=h)){var A;if(A=xe===0){var j=String(l.D).match(ch)[1]||null;!j&&o.self&&o.self.location&&(j=o.self.location.protocol.slice(0,-1)),A=!J_.test(j?j.toLowerCase():"")}m=A}if(m)Ve(l,"complete"),Ve(l,"success");else{l.m=6;try{var J=2<An(l)?l.g.statusText:""}catch{J=""}l.l=J+" ["+l.Z()+"]",vh(l)}}finally{Eo(l)}}}}function Eo(l,h){if(l.g){Eh(l);const m=l.g,A=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||Ve(l,"ready");try{m.onreadystatechange=A}catch{}}}function Eh(l){l.I&&(o.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function An(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<An(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),Cr(h)}};function Th(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function ev(l){const h={};l=(l.g&&2<=An(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<l.length;A++){if(V(l[A]))continue;var m=P(l[A]);const j=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const J=h[j]||[];h[j]=J,J.push(m)}w(h,function(A){return A.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ra(l,h,m){return m&&m.internalChannelParams&&m.internalChannelParams[l]||h}function yh(l){this.Aa=0,this.i=[],this.j=new Ai,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ra("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ra("baseRetryDelayMs",5e3,l),this.cb=ra("retryDelaySeedMs",1e4,l),this.Wa=ra("forwardChannelMaxRetries",2,l),this.wa=ra("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Gn(l&&l.concurrentRequestLimit),this.Da=new Y_,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=yh.prototype,t.la=8,t.G=1,t.connect=function(l,h,m,A){Yt(0),this.W=l,this.H=h||{},m&&A!==void 0&&(this.H.OSID=m,this.H.OAID=A),this.F=this.X,this.I=Dh(this,null,this.W),yo(this)};function Sc(l){if(wh(l),l.G==3){var h=l.U++,m=wn(l.I);if(vt(m,"SID",l.K),vt(m,"RID",h),vt(m,"TYPE","terminate"),na(l,m),h=new Z(l,l.j,h),h.L=2,h.v=_o(wn(m)),m=!1,o.navigator&&o.navigator.sendBeacon)try{m=o.navigator.sendBeacon(h.v.toString(),"")}catch{}!m&&o.Image&&(new Image().src=h.v,m=!0),m||(h.g=Oh(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Te(h)}Fh(l)}function To(l){l.g&&(Cc(l),l.g.cancel(),l.g=null)}function wh(l){To(l),l.u&&(o.clearTimeout(l.u),l.u=null),wo(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&o.clearTimeout(l.s),l.s=null)}function yo(l){if(!sn(l.h)&&!l.s){l.s=!0;var h=l.Ga;Ne||Ft(),He||(Ne(),He=!0),it.add(h,l),l.B=0}}function tv(l,h){return rs(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Tn(p(l.Ga,l,h),Ph(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const j=new Z(this,this.j,l);let J=this.o;if(this.S&&(J?(J=y(J),I(J,this.S)):J=this.S),this.m!==null||this.O||(j.H=J,J=null),this.P)e:{for(var h=0,m=0;m<this.i.length;m++){t:{var A=this.i[m];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(h+=A,4096<h){h=m;break e}if(h===4096||m===this.i.length-1){h=m+1;break e}}h=1e3}else h=1e3;h=Sh(this,j,h),m=wn(this.I),vt(m,"RID",l),vt(m,"CVER",22),this.D&&vt(m,"X-HTTP-Session-Id",this.D),na(this,m),J&&(this.O?h="headers="+encodeURIComponent(String(mh(J)))+"&"+h:this.m&&Ac(m,this.m,J)),wc(this.h,j),this.Ua&&vt(m,"TYPE","init"),this.P?(vt(m,"$req",h),vt(m,"SID","null"),j.T=!0,le(j,m,null)):le(j,m,h),this.G=2}}else this.G==3&&(l?Ah(this,l):this.i.length==0||sn(this.h)||Ah(this))};function Ah(l,h){var m;h?m=h.l:m=l.U++;const A=wn(l.I);vt(A,"SID",l.K),vt(A,"RID",m),vt(A,"AID",l.T),na(l,A),l.m&&l.o&&Ac(A,l.m,l.o),m=new Z(l,l.j,m,l.B+1),l.m===null&&(m.H=l.o),h&&(l.i=h.D.concat(l.i)),h=Sh(l,m,1e3),m.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),wc(l.h,m),le(m,A,h)}function na(l,h){l.H&&ue(l.H,function(m,A){vt(h,A,m)}),l.l&&lh({},function(m,A){vt(h,A,m)})}function Sh(l,h,m){m=Math.min(l.i.length,m);var A=l.l?p(l.l.Na,l.l,l):null;e:{var j=l.i;let J=-1;for(;;){const xe=["count="+m];J==-1?0<m?(J=j[0].g,xe.push("ofs="+J)):J=0:xe.push("ofs="+J);let gt=!0;for(let Qt=0;Qt<m;Qt++){let tt=j[Qt].g;const ur=j[Qt].map;if(tt-=J,0>tt)J=Math.max(0,j[Qt].g-100),gt=!1;else try{Q_(ur,xe,"req"+tt+"_")}catch{A&&A(ur)}}if(gt){A=xe.join("&");break e}}}return l=l.i.splice(0,m),h.D=l,A}function Ih(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;Ne||Ft(),He||(Ne(),He=!0),it.add(h,l),l.v=0}}function Ic(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Tn(p(l.Fa,l),Ph(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Ch(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Tn(p(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Yt(10),To(this),Ch(this))};function Cc(l){l.A!=null&&(o.clearTimeout(l.A),l.A=null)}function Ch(l){l.g=new Z(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=wn(l.qa);vt(h,"RID","rpc"),vt(h,"SID",l.K),vt(h,"AID",l.T),vt(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&vt(h,"TO",l.ja),vt(h,"TYPE","xmlhttp"),na(l,h),l.m&&l.o&&Ac(h,l.m,l.o),l.L&&(l.g.I=l.L);var m=l.g;l=l.ia,m.L=1,m.v=_o(wn(h)),m.m=null,m.P=!0,ve(m,l)}t.Za=function(){this.C!=null&&(this.C=null,To(this),Ic(this),Yt(19))};function wo(l){l.C!=null&&(o.clearTimeout(l.C),l.C=null)}function Rh(l,h){var m=null;if(l.g==h){wo(l),Cc(l),l.g=null;var A=2}else if(br(l.h,h))m=h.D,ah(l.h,h),A=1;else return;if(l.G!=0){if(h.o)if(A==1){m=h.m?h.m.length:0,h=Date.now()-h.F;var j=l.B;A=ts(),Ve(A,new po(A,m)),yo(l)}else Ih(l);else if(j=h.s,j==3||j==0&&0<h.X||!(A==1&&tv(l,h)||A==2&&Ic(l)))switch(m&&0<m.length&&(h=l.h,h.i=h.i.concat(m)),j){case 1:Ci(l,5);break;case 4:Ci(l,10);break;case 3:Ci(l,6);break;default:Ci(l,2)}}}function Ph(l,h){let m=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(m*=2),m*h}function Ci(l,h){if(l.j.info("Error code "+h),h==2){var m=p(l.fb,l),A=l.Xa;const j=!A;A=new Ii(A||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||go(A,"https"),_o(A),j?q_(A.toString(),m):X_(A.toString(),m)}else Yt(2);l.G=0,l.l&&l.l.sa(h),Fh(l),wh(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),Yt(2)):(this.j.info("Failed to ping google.com"),Yt(1))};function Fh(l){if(l.G=0,l.ka=[],l.l){const h=oh(l.h);(h.length!=0||l.i.length!=0)&&(E(l.ka,h),E(l.ka,l.i),l.h.i.length=0,_(l.i),l.i.length=0),l.l.ra()}}function Dh(l,h,m){var A=m instanceof Ii?wn(m):new Ii(m);if(A.g!="")h&&(A.g=h+"."+A.g),mo(A,A.s);else{var j=o.location;A=j.protocol,h=h?h+"."+j.hostname:j.hostname,j=+j.port;var J=new Ii(null);A&&go(J,A),h&&(J.g=h),j&&mo(J,j),m&&(J.l=m),A=J}return m=l.D,h=l.ya,m&&h&&vt(A,m,h),vt(A,"VER",l.la),na(l,A),A}function Oh(l,h,m){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new It(new vo({eb:m})):new It(l.pa),h.Ha(l.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function bh(){}t=bh.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Ao(){}Ao.prototype.g=function(l,h){return new kr(l,h)};function kr(l,h){Pe.call(this),this.g=new yh(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!V(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!V(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new is(this)}v(kr,Pe),kr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},kr.prototype.close=function(){Sc(this.g)},kr.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var m={};m.__data__=l,l=m}else this.u&&(m={},m.__data__=Ot(l),l=m);h.i.push(new Si(h.Ya++,l)),h.G==3&&yo(h)},kr.prototype.N=function(){this.g.l=null,delete this.j,Sc(this.g),delete this.g,kr.aa.N.call(this)};function kh(l){Ys.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const m in h){l=m;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}v(kh,Ys);function Nh(){jn.call(this),this.status=1}v(Nh,jn);function is(l){this.g=l}v(is,bh),is.prototype.ua=function(){Ve(this.g,"a")},is.prototype.ta=function(l){Ve(this.g,new kh(l))},is.prototype.sa=function(l){Ve(this.g,new Nh)},is.prototype.ra=function(){Ve(this.g,"b")},Ao.prototype.createWebChannel=Ao.prototype.g,kr.prototype.send=kr.prototype.o,kr.prototype.open=kr.prototype.m,kr.prototype.close=kr.prototype.close,P1=function(){return new Ao},R1=function(){return ts()},C1=En,_u={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},C.NO_ERROR=0,C.TIMEOUT=8,C.HTTP_ERROR=6,zo=C,D.COMPLETE="complete",I1=D,Xs.EventType=yi,yi.OPEN="a",yi.CLOSE="b",yi.ERROR="c",yi.MESSAGE="d",Pe.prototype.listen=Pe.prototype.K,la=Xs,It.prototype.listenOnce=It.prototype.L,It.prototype.getLastError=It.prototype.Ka,It.prototype.getLastErrorCode=It.prototype.Ba,It.prototype.getStatus=It.prototype.Z,It.prototype.getResponseJson=It.prototype.Oa,It.prototype.getResponseText=It.prototype.oa,It.prototype.send=It.prototype.ea,It.prototype.setWithCredentials=It.prototype.Ha,S1=It}).apply(typeof Po<"u"?Po:typeof self<"u"?self:typeof window<"u"?window:{});const S0="@firebase/firestore",I0="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}dr.UNAUTHENTICATED=new dr(null),dr.GOOGLE_CREDENTIALS=new dr("google-credentials-uid"),dr.FIRST_PARTY=new dr("first-party-uid"),dr.MOCK_USER=new dr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Us="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bi=new v1("@firebase/firestore");function fs(){return Bi.logLevel}function Se(t,...e){if(Bi.logLevel<=Je.DEBUG){const r=e.map(of);Bi.debug(`Firestore (${Us}): ${t}`,...r)}}function Mn(t,...e){if(Bi.logLevel<=Je.ERROR){const r=e.map(of);Bi.error(`Firestore (${Us}): ${t}`,...r)}}function Ds(t,...e){if(Bi.logLevel<=Je.WARN){const r=e.map(of);Bi.warn(`Firestore (${Us}): ${t}`,...r)}}function of(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Le(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,F1(t,n,r)}function F1(t,e,r){let n=`FIRESTORE (${Us}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Mn(n),new Error(n)}function ot(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||F1(e,i,n)}function We(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Oe extends Bs{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class cT{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(dr.UNAUTHENTICATED))}shutdown(){}}class uT{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class fT{constructor(e){this.t=e,this.currentUser=dr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){ot(this.o===void 0,42304);let n=this.i;const i=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let s=new ii;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ii,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},o=c=>{Se("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(c=>o(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?o(c):(Se("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ii)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Se("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ot(typeof n.accessToken=="string",31837,{l:n}),new D1(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ot(e===null||typeof e=="string",2055,{h:e}),new dr(e)}}class hT{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=dr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class dT{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new hT(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(dr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class C0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class pT{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,z2(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){ot(this.o===void 0,3512);const n=s=>{s.error!=null&&Se("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,Se("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Se("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):Se("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new C0(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(ot(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new C0(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gT(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O1(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=gT(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%62))}return n}}function Ke(t,e){return t<e?-1:t>e?1:0}function vu(t,e){let r=0;for(;r<t.length&&r<e.length;){const n=t.codePointAt(r),i=e.codePointAt(r);if(n!==i){if(n<128&&i<128)return Ke(n,i);{const s=O1(),a=mT(s.encode(R0(t,r)),s.encode(R0(e,r)));return a!==0?a:Ke(n,i)}}r+=n>65535?2:1}return Ke(t.length,e.length)}function R0(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function mT(t,e){for(let r=0;r<t.length&&r<e.length;++r)if(t[r]!==e[r])return Ke(t[r],e[r]);return Ke(t.length,e.length)}function Os(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P0=-62135596800,F0=1e6;class Wt{static now(){return Wt.fromMillis(Date.now())}static fromDate(e){return Wt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*F0);return new Wt(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Oe(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Oe(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<P0)throw new Oe(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Oe(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/F0}_compareTo(e){return this.seconds===e.seconds?Ke(this.nanoseconds,e.nanoseconds):Ke(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-P0;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{static fromTimestamp(e){return new Ue(e)}static min(){return new Ue(new Wt(0,0))}static max(){return new Ue(new Wt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D0="__name__";class un{constructor(e,r,n){r===void 0?r=0:r>e.length&&Le(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&Le(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return un.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof un?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=un.compareSegments(e.get(i),r.get(i));if(s!==0)return s}return Ke(e.length,r.length)}static compareSegments(e,r){const n=un.isNumericId(e),i=un.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?un.extractNumericId(e).compare(un.extractNumericId(r)):vu(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ni.fromString(e.substring(4,e.length-2))}}class yt extends un{construct(e,r,n){return new yt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Oe(ce.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new yt(r)}static emptyPath(){return new yt([])}}const _T=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class nr extends un{construct(e,r,n){return new nr(e,r,n)}static isValidIdentifier(e){return _T.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),nr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===D0}static keyField(){return new nr([D0])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new Oe(ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new Oe(ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Oe(ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new Oe(ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new nr(r)}static emptyPath(){return new nr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e){this.path=e}static fromPath(e){return new be(yt.fromString(e))}static fromName(e){return new be(yt.fromString(e).popFirst(5))}static empty(){return new be(yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&yt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return yt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new be(new yt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Va=-1;function vT(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=Ue.fromTimestamp(n===1e9?new Wt(r+1,0):new Wt(r,n));return new ci(i,be.empty(),e)}function xT(t){return new ci(t.readTime,t.key,Va)}class ci{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new ci(Ue.min(),be.empty(),Va)}static max(){return new ci(Ue.max(),be.empty(),Va)}}function ET(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=be.comparator(t.documentKey,e.documentKey),r!==0?r:Ke(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TT="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class yT{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hs(t){if(t.code!==ce.FAILED_PRECONDITION||t.message!==TT)throw t;Se("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Le(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new ie((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof ie?r:ie.resolve(r)}catch(r){return ie.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):ie.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):ie.reject(r)}static resolve(e){return new ie((r,n)=>{r(e)})}static reject(e){return new ie((r,n)=>{n(e)})}static waitFor(e){return new ie((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},c=>n(c))}),a=!0,s===i&&r()})}static or(e){let r=ie.resolve(!1);for(const n of e)r=r.next(i=>i?ie.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new ie((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let c=0;c<s;c++){const u=c;r(e[u]).next(f=>{a[u]=f,++o,o===s&&n(a)},f=>i(f))}})}static doWhile(e,r){return new ie((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function wT(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Ws(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ue(n),this.ce=n=>r.writeSequenceNumber(n))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}ec.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lf=-1;function tc(t){return t==null}function fl(t){return t===0&&1/t==-1/0}function AT(t){return typeof t=="number"&&Number.isInteger(t)&&!fl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k1="";function ST(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=O0(e)),e=IT(t.get(r),e);return O0(e)}function IT(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const s=t.charAt(i);switch(s){case"\0":r+="";break;case k1:r+="";break;default:r+=s}}return r}function O0(t){return t+k1+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b0(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function ji(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function N1(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e,r){this.comparator=e,this.root=r||tr.EMPTY}insert(e,r){return new St(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,tr.BLACK,null,null))}remove(e){return new St(this.comparator,this.root.remove(e,this.comparator).copy(null,null,tr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Fo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Fo(this.root,e,this.comparator,!1)}getReverseIterator(){return new Fo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Fo(this.root,e,this.comparator,!0)}}class Fo{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class tr{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??tr.RED,this.left=i??tr.EMPTY,this.right=s??tr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new tr(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return tr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return tr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,tr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,tr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Le(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Le(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Le(27949);return e+(this.isRed()?0:1)}}tr.EMPTY=null,tr.RED=!0,tr.BLACK=!1;tr.EMPTY=new class{constructor(){this.size=0}get key(){throw Le(57766)}get value(){throw Le(16141)}get color(){throw Le(16727)}get left(){throw Le(29726)}get right(){throw Le(36894)}copy(e,r,n,i,s){return this}insert(e,r,n){return new tr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e){this.comparator=e,this.data=new St(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new k0(this.data.getIterator())}getIteratorFrom(e){return new k0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof $t)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new $t(this.comparator);return r.data=e,r}}class k0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.fields=e,e.sort(nr.comparator)}static empty(){return new en([])}unionWith(e){let r=new $t(nr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new en(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Os(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new L1("Invalid base64 string: "+s):s}}(e);return new lr(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new lr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ke(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}lr.EMPTY_BYTE_STRING=new lr("");const CT=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ui(t){if(ot(!!t,39018),typeof t=="string"){let e=0;const r=CT.exec(t);if(ot(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Pt(t.seconds),nanos:Pt(t.nanos)}}function Pt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function fi(t){return typeof t=="string"?lr.fromBase64String(t):lr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M1="server_timestamp",V1="__type__",B1="__previous_value__",U1="__local_write_time__";function cf(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[V1])===null||r===void 0?void 0:r.stringValue)===M1}function rc(t){const e=t.mapValue.fields[B1];return cf(e)?rc(e):e}function Ba(t){const e=ui(t.mapValue.fields[U1].timestampValue);return new Wt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RT{constructor(e,r,n,i,s,a,o,c,u,f){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=f}}const hl="(default)";class Ua{constructor(e,r){this.projectId=e,this.database=r||hl}static empty(){return new Ua("","")}get isDefaultDatabase(){return this.database===hl}isEqual(e){return e instanceof Ua&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H1="__type__",PT="__max__",Do={mapValue:{}},W1="__vector__",dl="value";function hi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?cf(t)?4:DT(t)?9007199254740991:FT(t)?10:11:Le(28295,{value:t})}function _n(t,e){if(t===e)return!0;const r=hi(t);if(r!==hi(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ba(t).isEqual(Ba(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=ui(i.timestampValue),o=ui(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return fi(i.bytesValue).isEqual(fi(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Pt(i.geoPointValue.latitude)===Pt(s.geoPointValue.latitude)&&Pt(i.geoPointValue.longitude)===Pt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Pt(i.integerValue)===Pt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Pt(i.doubleValue),o=Pt(s.doubleValue);return a===o?fl(a)===fl(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return Os(t.arrayValue.values||[],e.arrayValue.values||[],_n);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(b0(a)!==b0(o))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(o[c]===void 0||!_n(a[c],o[c])))return!1;return!0}(t,e);default:return Le(52216,{left:t})}}function Ha(t,e){return(t.values||[]).find(r=>_n(r,e))!==void 0}function bs(t,e){if(t===e)return 0;const r=hi(t),n=hi(e);if(r!==n)return Ke(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Ke(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=Pt(s.integerValue||s.doubleValue),c=Pt(a.integerValue||a.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(t,e);case 3:return N0(t.timestampValue,e.timestampValue);case 4:return N0(Ba(t),Ba(e));case 5:return vu(t.stringValue,e.stringValue);case 6:return function(s,a){const o=fi(s),c=fi(a);return o.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),c=a.split("/");for(let u=0;u<o.length&&u<c.length;u++){const f=Ke(o[u],c[u]);if(f!==0)return f}return Ke(o.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=Ke(Pt(s.latitude),Pt(a.latitude));return o!==0?o:Ke(Pt(s.longitude),Pt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return L0(t.arrayValue,e.arrayValue);case 10:return function(s,a){var o,c,u,f;const d=s.fields||{},p=a.fields||{},g=(o=d[dl])===null||o===void 0?void 0:o.arrayValue,v=(c=p[dl])===null||c===void 0?void 0:c.arrayValue,_=Ke(((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0,((f=v==null?void 0:v.values)===null||f===void 0?void 0:f.length)||0);return _!==0?_:L0(g,v)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===Do.mapValue&&a===Do.mapValue)return 0;if(s===Do.mapValue)return 1;if(a===Do.mapValue)return-1;const o=s.fields||{},c=Object.keys(o),u=a.fields||{},f=Object.keys(u);c.sort(),f.sort();for(let d=0;d<c.length&&d<f.length;++d){const p=vu(c[d],f[d]);if(p!==0)return p;const g=bs(o[c[d]],u[f[d]]);if(g!==0)return g}return Ke(c.length,f.length)}(t.mapValue,e.mapValue);default:throw Le(23264,{Pe:r})}}function N0(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ke(t,e);const r=ui(t),n=ui(e),i=Ke(r.seconds,n.seconds);return i!==0?i:Ke(r.nanos,n.nanos)}function L0(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=bs(r[i],n[i]);if(s)return s}return Ke(r.length,n.length)}function ks(t){return xu(t)}function xu(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=ui(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return fi(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return be.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=xu(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${xu(r.fields[a])}`;return i+"}"}(t.mapValue):Le(61005,{value:t})}function Ko(t){switch(hi(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=rc(t);return e?16+Ko(e):16;case 5:return 2*t.stringValue.length;case 6:return fi(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,s)=>i+Ko(s),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return ji(n.fields,(s,a)=>{i+=s.length+Ko(a)}),i}(t.mapValue);default:throw Le(13486,{value:t})}}function Eu(t){return!!t&&"integerValue"in t}function uf(t){return!!t&&"arrayValue"in t}function M0(t){return!!t&&"nullValue"in t}function V0(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function qo(t){return!!t&&"mapValue"in t}function FT(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[H1])===null||r===void 0?void 0:r.stringValue)===W1}function xa(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ji(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=xa(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=xa(t.arrayValue.values[r]);return e}return Object.assign({},t)}function DT(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===PT}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(e){this.value=e}static empty(){return new jr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!qo(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=xa(r)}setAll(e){let r=nr.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const c=this.getFieldsMap(r);this.applyChanges(c,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=xa(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());qo(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return _n(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];qo(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){ji(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new jr(xa(this.value))}}function $1(t){const e=[];return ji(t.fields,(r,n)=>{const i=new nr([r]);if(qo(n)){const s=$1(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new en(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new gr(e,0,Ue.min(),Ue.min(),Ue.min(),jr.empty(),0)}static newFoundDocument(e,r,n,i){return new gr(e,1,r,Ue.min(),n,i,0)}static newNoDocument(e,r){return new gr(e,2,r,Ue.min(),Ue.min(),jr.empty(),0)}static newUnknownDocument(e,r){return new gr(e,3,r,Ue.min(),Ue.min(),jr.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=jr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=jr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof gr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new gr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl{constructor(e,r){this.position=e,this.inclusive=r}}function B0(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=be.comparator(be.fromName(a.referenceValue),r.key):n=bs(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function U0(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!_n(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e,r="asc"){this.field=e,this.dir=r}}function OT(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1{}class Ht extends j1{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new kT(e,r,n):r==="array-contains"?new MT(e,n):r==="in"?new VT(e,n):r==="not-in"?new BT(e,n):r==="array-contains-any"?new UT(e,n):new Ht(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new NT(e,n):new LT(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(bs(r,this.value)):r!==null&&hi(this.value)===hi(r)&&this.matchesComparison(bs(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Le(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class vn extends j1{constructor(e,r){super(),this.filters=e,this.op=r,this.Te=null}static create(e,r){return new vn(e,r)}matches(e){return G1(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function G1(t){return t.op==="and"}function z1(t){return bT(t)&&G1(t)}function bT(t){for(const e of t.filters)if(e instanceof vn)return!1;return!0}function Tu(t){if(t instanceof Ht)return t.field.canonicalString()+t.op.toString()+ks(t.value);if(z1(t))return t.filters.map(e=>Tu(e)).join(",");{const e=t.filters.map(r=>Tu(r)).join(",");return`${t.op}(${e})`}}function K1(t,e){return t instanceof Ht?function(n,i){return i instanceof Ht&&n.op===i.op&&n.field.isEqual(i.field)&&_n(n.value,i.value)}(t,e):t instanceof vn?function(n,i){return i instanceof vn&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&K1(a,i.filters[o]),!0):!1}(t,e):void Le(19439)}function q1(t){return t instanceof Ht?function(r){return`${r.field.canonicalString()} ${r.op} ${ks(r.value)}`}(t):t instanceof vn?function(r){return r.op.toString()+" {"+r.getFilters().map(q1).join(" ,")+"}"}(t):"Filter"}class kT extends Ht{constructor(e,r,n){super(e,r,n),this.key=be.fromName(n.referenceValue)}matches(e){const r=be.comparator(e.key,this.key);return this.matchesComparison(r)}}class NT extends Ht{constructor(e,r){super(e,"in",r),this.keys=X1("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class LT extends Ht{constructor(e,r){super(e,"not-in",r),this.keys=X1("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function X1(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>be.fromName(n.referenceValue))}class MT extends Ht{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return uf(r)&&Ha(r.arrayValue,this.value)}}class VT extends Ht{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Ha(this.value.arrayValue,r)}}class BT extends Ht{constructor(e,r){super(e,"not-in",r)}matches(e){if(Ha(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Ha(this.value.arrayValue,r)}}class UT extends Ht{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!uf(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Ha(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.Ie=null}}function H0(t,e=null,r=[],n=[],i=null,s=null,a=null){return new HT(t,e,r,n,i,s,a)}function ff(t){const e=We(t);if(e.Ie===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Tu(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),tc(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>ks(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>ks(n)).join(",")),e.Ie=r}return e.Ie}function hf(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!OT(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!K1(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!U0(t.startAt,e.startAt)&&U0(t.endAt,e.endAt)}function yu(t){return be.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=c,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function WT(t,e,r,n,i,s,a,o){return new nc(t,e,r,n,i,s,a,o)}function df(t){return new nc(t)}function W0(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function $T(t){return t.collectionGroup!==null}function Ea(t){const e=We(t);if(e.Ee===null){e.Ee=[];const r=new Set;for(const s of e.explicitOrderBy)e.Ee.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new $t(nr.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(o=o.add(u.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.Ee.push(new gl(s,n))}),r.has(nr.keyField().canonicalString())||e.Ee.push(new gl(nr.keyField(),n))}return e.Ee}function dn(t){const e=We(t);return e.de||(e.de=jT(e,Ea(t))),e.de}function jT(t,e){if(t.limitType==="F")return H0(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new gl(i.field,s)});const r=t.endAt?new pl(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new pl(t.startAt.position,t.startAt.inclusive):null;return H0(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function wu(t,e,r){return new nc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function ic(t,e){return hf(dn(t),dn(e))&&t.limitType===e.limitType}function Y1(t){return`${ff(dn(t))}|lt:${t.limitType}`}function hs(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>q1(i)).join(", ")}]`),tc(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>ks(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>ks(i)).join(",")),`Target(${n})`}(dn(t))}; limitType=${t.limitType})`}function sc(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):be.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of Ea(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,c){const u=B0(a,o,c);return a.inclusive?u<=0:u<0}(n.startAt,Ea(n),i)||n.endAt&&!function(a,o,c){const u=B0(a,o,c);return a.inclusive?u>=0:u>0}(n.endAt,Ea(n),i))}(t,e)}function GT(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Q1(t){return(e,r)=>{let n=!1;for(const i of Ea(t)){const s=zT(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function zT(t,e,r){const n=t.field.isKeyField()?be.comparator(e.key,r.key):function(s,a,o){const c=a.data.field(s),u=o.data.field(s);return c!==null&&u!==null?bs(c,u):Le(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Le(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ji(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return N1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KT=new St(be.comparator);function Vn(){return KT}const J1=new St(be.comparator);function ca(...t){let e=J1;for(const r of t)e=e.insert(r.key,r);return e}function Z1(t){let e=J1;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Ni(){return Ta()}function eg(){return Ta()}function Ta(){return new Gi(t=>t.toString(),(t,e)=>t.isEqual(e))}const qT=new St(be.comparator),XT=new $t(be.comparator);function qe(...t){let e=XT;for(const r of t)e=e.add(r);return e}const YT=new $t(Ke);function QT(){return YT}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pf(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fl(e)?"-0":e}}function tg(t){return{integerValue:""+t}}function JT(t,e){return AT(e)?tg(e):pf(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{constructor(){this._=void 0}}function ZT(t,e,r){return t instanceof ml?function(i,s){const a={fields:{[V1]:{stringValue:M1},[U1]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&cf(s)&&(s=rc(s)),s&&(a.fields[B1]=s),{mapValue:a}}(r,e):t instanceof Wa?ng(t,e):t instanceof $a?ig(t,e):function(i,s){const a=rg(i,s),o=$0(a)+$0(i.Re);return Eu(a)&&Eu(i.Re)?tg(o):pf(i.serializer,o)}(t,e)}function ey(t,e,r){return t instanceof Wa?ng(t,e):t instanceof $a?ig(t,e):r}function rg(t,e){return t instanceof _l?function(n){return Eu(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class ml extends ac{}class Wa extends ac{constructor(e){super(),this.elements=e}}function ng(t,e){const r=sg(e);for(const n of t.elements)r.some(i=>_n(i,n))||r.push(n);return{arrayValue:{values:r}}}class $a extends ac{constructor(e){super(),this.elements=e}}function ig(t,e){let r=sg(e);for(const n of t.elements)r=r.filter(i=>!_n(i,n));return{arrayValue:{values:r}}}class _l extends ac{constructor(e,r){super(),this.serializer=e,this.Re=r}}function $0(t){return Pt(t.integerValue||t.doubleValue)}function sg(t){return uf(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function ty(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Wa&&i instanceof Wa||n instanceof $a&&i instanceof $a?Os(n.elements,i.elements,_n):n instanceof _l&&i instanceof _l?_n(n.Re,i.Re):n instanceof ml&&i instanceof ml}(t.transform,e.transform)}class ry{constructor(e,r){this.version=e,this.transformResults=r}}class Fn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Fn}static exists(e){return new Fn(void 0,e)}static updateTime(e){return new Fn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Xo(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class oc{}function ag(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new lg(t.key,Fn.none()):new eo(t.key,t.data,Fn.none());{const r=t.data,n=jr.empty();let i=new $t(nr.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new zi(t.key,n,new en(i.toArray()),Fn.none())}}function ny(t,e,r){t instanceof eo?function(i,s,a){const o=i.value.clone(),c=G0(i.fieldTransforms,s,a.transformResults);o.setAll(c),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof zi?function(i,s,a){if(!Xo(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=G0(i.fieldTransforms,s,a.transformResults),c=s.data;c.setAll(og(i)),c.setAll(o),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function ya(t,e,r,n){return t instanceof eo?function(s,a,o,c){if(!Xo(s.precondition,a))return o;const u=s.value.clone(),f=z0(s.fieldTransforms,c,a);return u.setAll(f),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof zi?function(s,a,o,c){if(!Xo(s.precondition,a))return o;const u=z0(s.fieldTransforms,c,a),f=a.data;return f.setAll(og(s)),f.setAll(u),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,r,n):function(s,a,o){return Xo(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function iy(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=rg(n.transform,i||null);s!=null&&(r===null&&(r=jr.empty()),r.set(n.field,s))}return r||null}function j0(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Os(n,i,(s,a)=>ty(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class eo extends oc{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class zi extends oc{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function og(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function G0(t,e,r){const n=new Map;ot(t.length===r.length,32656,{Ve:r.length,me:t.length});for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,ey(a,o,r[i]))}return n}function z0(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,ZT(s,a,e))}return n}class lg extends oc{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class sy extends oc{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&ny(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=ya(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=ya(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=eg();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const c=ag(a,o);c!==null&&n.set(i.key,c),a.isValidDocument()||a.convertToNoDocument(Ue.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),qe())}isEqual(e){return this.batchId===e.batchId&&Os(this.mutations,e.mutations,(r,n)=>j0(r,n))&&Os(this.baseMutations,e.baseMutations,(r,n)=>j0(r,n))}}class gf{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){ot(e.mutations.length===n.length,58842,{fe:e.mutations.length,ge:n.length});let i=function(){return qT}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new gf(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ly{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kt,Qe;function cy(t){switch(t){case ce.OK:return Le(64938);case ce.CANCELLED:case ce.UNKNOWN:case ce.DEADLINE_EXCEEDED:case ce.RESOURCE_EXHAUSTED:case ce.INTERNAL:case ce.UNAVAILABLE:case ce.UNAUTHENTICATED:return!1;case ce.INVALID_ARGUMENT:case ce.NOT_FOUND:case ce.ALREADY_EXISTS:case ce.PERMISSION_DENIED:case ce.FAILED_PRECONDITION:case ce.ABORTED:case ce.OUT_OF_RANGE:case ce.UNIMPLEMENTED:case ce.DATA_LOSS:return!0;default:return Le(15467,{code:t})}}function cg(t){if(t===void 0)return Mn("GRPC error has no .code"),ce.UNKNOWN;switch(t){case kt.OK:return ce.OK;case kt.CANCELLED:return ce.CANCELLED;case kt.UNKNOWN:return ce.UNKNOWN;case kt.DEADLINE_EXCEEDED:return ce.DEADLINE_EXCEEDED;case kt.RESOURCE_EXHAUSTED:return ce.RESOURCE_EXHAUSTED;case kt.INTERNAL:return ce.INTERNAL;case kt.UNAVAILABLE:return ce.UNAVAILABLE;case kt.UNAUTHENTICATED:return ce.UNAUTHENTICATED;case kt.INVALID_ARGUMENT:return ce.INVALID_ARGUMENT;case kt.NOT_FOUND:return ce.NOT_FOUND;case kt.ALREADY_EXISTS:return ce.ALREADY_EXISTS;case kt.PERMISSION_DENIED:return ce.PERMISSION_DENIED;case kt.FAILED_PRECONDITION:return ce.FAILED_PRECONDITION;case kt.ABORTED:return ce.ABORTED;case kt.OUT_OF_RANGE:return ce.OUT_OF_RANGE;case kt.UNIMPLEMENTED:return ce.UNIMPLEMENTED;case kt.DATA_LOSS:return ce.DATA_LOSS;default:return Le(39323,{code:t})}}(Qe=kt||(kt={}))[Qe.OK=0]="OK",Qe[Qe.CANCELLED=1]="CANCELLED",Qe[Qe.UNKNOWN=2]="UNKNOWN",Qe[Qe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Qe[Qe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Qe[Qe.NOT_FOUND=5]="NOT_FOUND",Qe[Qe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Qe[Qe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Qe[Qe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Qe[Qe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Qe[Qe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Qe[Qe.ABORTED=10]="ABORTED",Qe[Qe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Qe[Qe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Qe[Qe.INTERNAL=13]="INTERNAL",Qe[Qe.UNAVAILABLE=14]="UNAVAILABLE",Qe[Qe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uy=new ni([4294967295,4294967295],0);function K0(t){const e=O1().encode(t),r=new A1;return r.update(e),new Uint8Array(r.digest())}function q0(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ni([r,n],0),new ni([i,s],0)]}class mf{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new ua(`Invalid padding: ${r}`);if(n<0)throw new ua(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new ua(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new ua(`Invalid padding when bitmap length is 0: ${r}`);this.pe=8*e.length-r,this.ye=ni.fromNumber(this.pe)}we(e,r,n){let i=e.add(r.multiply(ni.fromNumber(n)));return i.compare(uy)===1&&(i=new ni([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const r=K0(e),[n,i]=q0(r);for(let s=0;s<this.hashCount;s++){const a=this.we(n,i,s);if(!this.be(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new mf(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.pe===0)return;const r=K0(e),[n,i]=q0(r);for(let s=0;s<this.hashCount;s++){const a=this.we(n,i,s);this.Se(a)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class ua extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lc{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,to.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new lc(Ue.min(),i,new St(Ke),Vn(),qe())}}class to{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new to(n,r,qe(),qe(),qe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{constructor(e,r,n,i){this.De=e,this.removedTargetIds=r,this.key=n,this.ve=i}}class ug{constructor(e,r){this.targetId=e,this.Ce=r}}class fg{constructor(e,r,n=lr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class X0{constructor(){this.Fe=0,this.Me=Y0(),this.xe=lr.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=qe(),r=qe(),n=qe();return this.Me.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:Le(38017,{changeType:s})}}),new to(this.xe,this.Oe,e,r,n)}Qe(){this.Ne=!1,this.Me=Y0()}$e(e,r){this.Ne=!0,this.Me=this.Me.insert(e,r)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,ot(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class fy{constructor(e){this.ze=e,this.je=new Map,this.He=Vn(),this.Je=Oo(),this.Ye=Oo(),this.Ze=new St(Ke)}Xe(e){for(const r of e.De)e.ve&&e.ve.isFoundDocument()?this.et(r,e.ve):this.tt(r,e.key,e.ve);for(const r of e.removedTargetIds)this.tt(r,e.key,e.ve)}nt(e){this.forEachTarget(e,r=>{const n=this.rt(r);switch(e.state){case 0:this.it(r)&&n.ke(e.resumeToken);break;case 1:n.We(),n.Be||n.Qe(),n.ke(e.resumeToken);break;case 2:n.We(),n.Be||this.removeTarget(r);break;case 3:this.it(r)&&(n.Ge(),n.ke(e.resumeToken));break;case 4:this.it(r)&&(this.st(r),n.ke(e.resumeToken));break;default:Le(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.je.forEach((n,i)=>{this.it(i)&&r(i)})}ot(e){const r=e.targetId,n=e.Ce.count,i=this._t(r);if(i){const s=i.target;if(yu(s))if(n===0){const a=new be(s.path);this.tt(r,a,gr.newNoDocument(a,Ue.min()))}else ot(n===1,20013,{expectedCount:n});else{const a=this.ut(r);if(a!==n){const o=this.ct(e),c=o?this.lt(o,e,a):1;if(c!==0){this.st(r);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(r,u)}}}}}ct(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=fi(n).toUint8Array()}catch(c){if(c instanceof L1)return Ds("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{o=new mf(a,i,s)}catch(c){return Ds(c instanceof ua?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return o.pe===0?null:o}lt(e,r,n){return r.Ce.count===n-this.Tt(e,r.targetId)?0:2}Tt(e,r){const n=this.ze.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.ze.Pt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.tt(r,s,null),i++)}),i}It(e){const r=new Map;this.je.forEach((s,a)=>{const o=this._t(a);if(o){if(s.current&&yu(o.target)){const c=new be(o.target.path);this.Et(c).has(a)||this.dt(a,c)||this.tt(a,c,gr.newNoDocument(c,e))}s.Le&&(r.set(a,s.qe()),s.Qe())}});let n=qe();this.Ye.forEach((s,a)=>{let o=!0;a.forEachWhile(c=>{const u=this._t(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.He.forEach((s,a)=>a.setReadTime(e));const i=new lc(e,r,this.Ze,this.He,n);return this.He=Vn(),this.Je=Oo(),this.Ye=Oo(),this.Ze=new St(Ke),i}et(e,r){if(!this.it(e))return;const n=this.dt(e,r.key)?2:0;this.rt(e).$e(r.key,n),this.He=this.He.insert(r.key,r),this.Je=this.Je.insert(r.key,this.Et(r.key).add(e)),this.Ye=this.Ye.insert(r.key,this.At(r.key).add(e))}tt(e,r,n){if(!this.it(e))return;const i=this.rt(e);this.dt(e,r)?i.$e(r,1):i.Ue(r),this.Ye=this.Ye.insert(r,this.At(r).delete(e)),this.Ye=this.Ye.insert(r,this.At(r).add(e)),n&&(this.He=this.He.insert(r,n))}removeTarget(e){this.je.delete(e)}ut(e){const r=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let r=this.je.get(e);return r||(r=new X0,this.je.set(e,r)),r}At(e){let r=this.Ye.get(e);return r||(r=new $t(Ke),this.Ye=this.Ye.insert(e,r)),r}Et(e){let r=this.Je.get(e);return r||(r=new $t(Ke),this.Je=this.Je.insert(e,r)),r}it(e){const r=this._t(e)!==null;return r||Se("WatchChangeAggregator","Detected inactive target",e),r}_t(e){const r=this.je.get(e);return r&&r.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new X0),this.ze.getRemoteKeysForTarget(e).forEach(r=>{this.tt(e,r,null)})}dt(e,r){return this.ze.getRemoteKeysForTarget(e).has(r)}}function Oo(){return new St(be.comparator)}function Y0(){return new St(be.comparator)}const hy={asc:"ASCENDING",desc:"DESCENDING"},dy={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},py={and:"AND",or:"OR"};class gy{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Au(t,e){return t.useProto3Json||tc(e)?e:{value:e}}function vl(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function hg(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function my(t,e){return vl(t,e.toTimestamp())}function pn(t){return ot(!!t,49232),Ue.fromTimestamp(function(r){const n=ui(r);return new Wt(n.seconds,n.nanos)}(t))}function _f(t,e){return Su(t,e).canonicalString()}function Su(t,e){const r=function(i){return new yt(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function dg(t){const e=yt.fromString(t);return ot(vg(e),10190,{key:e.toString()}),e}function Iu(t,e){return _f(t.databaseId,e.path)}function $c(t,e){const r=dg(e);if(r.get(1)!==t.databaseId.projectId)throw new Oe(ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Oe(ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new be(gg(r))}function pg(t,e){return _f(t.databaseId,e)}function _y(t){const e=dg(t);return e.length===4?yt.emptyPath():gg(e)}function Cu(t){return new yt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function gg(t){return ot(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Q0(t,e,r){return{name:Iu(t,e),fields:r.value.mapValue.fields}}function vy(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Le(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(ot(f===void 0||typeof f=="string",58123),lr.fromBase64String(f||"")):(ot(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),lr.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(u){const f=u.code===void 0?ce.UNKNOWN:cg(u.code);return new Oe(f,u.message||"")}(a);r=new fg(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=$c(t,n.document.name),s=pn(n.document.updateTime),a=n.document.createTime?pn(n.document.createTime):Ue.min(),o=new jr({mapValue:{fields:n.document.fields}}),c=gr.newFoundDocument(i,s,a,o),u=n.targetIds||[],f=n.removedTargetIds||[];r=new Yo(u,f,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=$c(t,n.document),s=n.readTime?pn(n.readTime):Ue.min(),a=gr.newNoDocument(i,s),o=n.removedTargetIds||[];r=new Yo([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=$c(t,n.document),s=n.removedTargetIds||[];r=new Yo([],s,i,null)}else{if(!("filter"in e))return Le(11601,{Vt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new ly(i,s),o=n.targetId;r=new ug(o,a)}}return r}function xy(t,e){let r;if(e instanceof eo)r={update:Q0(t,e.key,e.value)};else if(e instanceof lg)r={delete:Iu(t,e.key)};else if(e instanceof zi)r={update:Q0(t,e.key,e.data),updateMask:Ry(e.fieldMask)};else{if(!(e instanceof sy))return Le(16599,{ft:e.type});r={verify:Iu(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof ml)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Wa)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof $a)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof _l)return{fieldPath:a.field.canonicalString(),increment:o.Re};throw Le(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:my(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Le(27497)}(t,e.precondition)),r}function Ey(t,e){return t&&t.length>0?(ot(e!==void 0,14353),t.map(r=>function(i,s){let a=i.updateTime?pn(i.updateTime):pn(s);return a.isEqual(Ue.min())&&(a=pn(s)),new ry(a,i.transformResults||[])}(r,e))):[]}function Ty(t,e){return{documents:[pg(t,e.path)]}}function yy(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=pg(t,i);const s=function(u){if(u.length!==0)return _g(vn.create(u,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(u){if(u.length!==0)return u.map(f=>function(p){return{field:ds(p.field),direction:Sy(p.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=Au(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{gt:r,parent:i}}function wy(t){let e=_y(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){ot(n===1,65062);const f=r.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];r.where&&(s=function(d){const p=mg(d);return p instanceof vn&&z1(p)?p.getFilters():[p]}(r.where));let a=[];r.orderBy&&(a=function(d){return d.map(p=>function(v){return new gl(ps(v.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(p))}(r.orderBy));let o=null;r.limit&&(o=function(d){let p;return p=typeof d=="object"?d.value:d,tc(p)?null:p}(r.limit));let c=null;r.startAt&&(c=function(d){const p=!!d.before,g=d.values||[];return new pl(g,p)}(r.startAt));let u=null;return r.endAt&&(u=function(d){const p=!d.before,g=d.values||[];return new pl(g,p)}(r.endAt)),WT(e,i,a,s,o,"F",c,u)}function Ay(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Le(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function mg(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=ps(r.unaryFilter.field);return Ht.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=ps(r.unaryFilter.field);return Ht.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ps(r.unaryFilter.field);return Ht.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=ps(r.unaryFilter.field);return Ht.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Le(61313);default:return Le(60726)}}(t):t.fieldFilter!==void 0?function(r){return Ht.create(ps(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Le(58110);default:return Le(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return vn.create(r.compositeFilter.filters.map(n=>mg(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Le(1026)}}(r.compositeFilter.op))}(t):Le(30097,{filter:t})}function Sy(t){return hy[t]}function Iy(t){return dy[t]}function Cy(t){return py[t]}function ds(t){return{fieldPath:t.canonicalString()}}function ps(t){return nr.fromServerFormat(t.fieldPath)}function _g(t){return t instanceof Ht?function(r){if(r.op==="=="){if(V0(r.value))return{unaryFilter:{field:ds(r.field),op:"IS_NAN"}};if(M0(r.value))return{unaryFilter:{field:ds(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(V0(r.value))return{unaryFilter:{field:ds(r.field),op:"IS_NOT_NAN"}};if(M0(r.value))return{unaryFilter:{field:ds(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ds(r.field),op:Iy(r.op),value:r.value}}}(t):t instanceof vn?function(r){const n=r.getFilters().map(i=>_g(i));return n.length===1?n[0]:{compositeFilter:{op:Cy(r.op),filters:n}}}(t):Le(54877,{filter:t})}function Ry(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function vg(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e,r,n,i,s=Ue.min(),a=Ue.min(),o=lr.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=c}withSequenceNumber(e){return new Qn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Qn(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Qn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Qn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{constructor(e){this.wt=e}}function Fy(t){const e=wy({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?wu(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dy{constructor(){this.Cn=new Oy}addToCollectionParentIndex(e,r){return this.Cn.add(r),ie.resolve()}getCollectionParents(e,r){return ie.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return ie.resolve()}deleteFieldIndex(e,r){return ie.resolve()}deleteAllFieldIndexes(e){return ie.resolve()}createTargetIndexes(e,r){return ie.resolve()}getDocumentsMatchingTarget(e,r){return ie.resolve(null)}getIndexType(e,r){return ie.resolve(0)}getFieldIndexes(e,r){return ie.resolve([])}getNextCollectionGroupToUpdate(e){return ie.resolve(null)}getMinOffset(e,r){return ie.resolve(ci.min())}getMinOffsetFromCollectionGroup(e,r){return ie.resolve(ci.min())}updateCollectionGroup(e,r,n){return ie.resolve()}updateIndexEntries(e,r){return ie.resolve()}}class Oy{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new $t(yt.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new $t(yt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},xg=41943040;class Pr{static withCacheSize(e){return new Pr(e,Pr.DEFAULT_COLLECTION_PERCENTILE,Pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Pr.DEFAULT_COLLECTION_PERCENTILE=10,Pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Pr.DEFAULT=new Pr(xg,Pr.DEFAULT_COLLECTION_PERCENTILE,Pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Pr.DISABLED=new Pr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new Ns(0)}static lr(){return new Ns(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z0="LruGarbageCollector",by=1048576;function ed([t,e],[r,n]){const i=Ke(t,r);return i===0?Ke(e,n):i}class ky{constructor(e){this.Er=e,this.buffer=new $t(ed),this.dr=0}Ar(){return++this.dr}Rr(e){const r=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();ed(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class Ny{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){Se(Z0,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Ws(r)?Se(Z0,"Ignoring IndexedDB error during garbage collection: ",r):await Hs(r)}await this.mr(3e5)})}}class Ly{constructor(e,r){this.gr=e,this.params=r}calculateTargetCount(e,r){return this.gr.pr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return ie.resolve(ec.le);const n=new ky(r);return this.gr.forEachTarget(e,i=>n.Rr(i.sequenceNumber)).next(()=>this.gr.yr(e,i=>n.Rr(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.gr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.gr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Se("LruGarbageCollector","Garbage collection skipped; disabled"),ie.resolve(J0)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Se("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),J0):this.wr(e,r))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,r){let n,i,s,a,o,c,u;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(Se("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,a=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(n=d,o=Date.now(),this.removeTargets(e,n,r))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(d=>(u=Date.now(),fs()<=Je.DEBUG&&Se("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${i} in `+(o-a)+`ms
	Removed ${s} targets in `+(c-o)+`ms
	Removed ${d} documents in `+(u-c)+`ms
Total Duration: ${u-f}ms`),ie.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}}function My(t,e){return new Ly(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy{constructor(){this.changes=new Gi(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,gr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?ie.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&ya(n.mutation,i,en.empty(),Wt.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,qe()).next(()=>n))}getLocalViewOfDocuments(e,r,n=qe()){const i=Ni();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=ca();return s.forEach((o,c)=>{a=a.insert(o,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Ni();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,qe()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=Vn();const a=Ta(),o=function(){return Ta()}();return r.forEach((c,u)=>{const f=n.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof zi)?s=s.insert(u.key,u):f!==void 0?(a.set(u.key,f.mutation.getFieldMask()),ya(f.mutation,u,f.mutation.getFieldMask(),Wt.now())):a.set(u.key,en.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,f)=>a.set(u,f)),r.forEach((u,f)=>{var d;return o.set(u,new By(f,(d=a.get(u))!==null&&d!==void 0?d:null))}),o))}recalculateAndSaveOverlays(e,r){const n=Ta();let i=new St((a,o)=>a-o),s=qe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(c=>{const u=r.get(c);if(u===null)return;let f=n.get(c)||en.empty();f=o.applyToLocalView(u,f),n.set(c,f);const d=(i.get(o.batchId)||qe()).add(c);i=i.insert(o.batchId,d)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const c=o.getNext(),u=c.key,f=c.value,d=eg();f.forEach(p=>{if(!s.has(p)){const g=ag(r.get(p),n.get(p));g!==null&&d.set(p,g),s=s.add(p)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,d))}return ie.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return be.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):$T(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):ie.resolve(Ni());let o=Va,c=s;return a.next(u=>ie.forEach(u,(f,d)=>(o<d.largestBatchId&&(o=d.largestBatchId),s.get(f)?ie.resolve():this.remoteDocumentCache.getEntry(e,f).next(p=>{c=c.insert(f,p)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,qe())).next(f=>({batchId:o,changes:Z1(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new be(r)).next(n=>{let i=ca();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=ca();return this.indexManager.getCollectionParents(e,s).next(o=>ie.forEach(o,c=>{const u=function(d,p){return new nc(p,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(r,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,n,i).next(f=>{f.forEach((d,p)=>{a=a.insert(d,p)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((c,u)=>{const f=u.getKey();a.get(f)===null&&(a=a.insert(f,gr.newInvalidDocument(f)))});let o=ca();return a.forEach((c,u)=>{const f=s.get(c);f!==void 0&&ya(f.mutation,u,en.empty(),Wt.now()),sc(r,u)&&(o=o.insert(c,u))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hy{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,r){return ie.resolve(this.kr.get(r))}saveBundleMetadata(e,r){return this.kr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:pn(i.createTime)}}(r)),ie.resolve()}getNamedQuery(e,r){return ie.resolve(this.qr.get(r))}saveNamedQuery(e,r){return this.qr.set(r.name,function(i){return{name:i.name,query:Fy(i.bundledQuery),readTime:pn(i.readTime)}}(r)),ie.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(){this.overlays=new St(be.comparator),this.Qr=new Map}getOverlay(e,r){return ie.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Ni();return ie.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.St(e,r,s)}),ie.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Qr.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Qr.delete(n)),ie.resolve()}getOverlaysForCollection(e,r,n){const i=Ni(),s=r.length+1,a=new be(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const c=o.getNext().value,u=c.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>n&&i.set(c.getKey(),c)}return ie.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new St((u,f)=>u-f);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let f=s.get(u.largestBatchId);f===null&&(f=Ni(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const o=Ni(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,f)=>o.set(u,f)),!(o.size()>=i)););return ie.resolve(o)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Qr.get(i.largestBatchId).delete(n.key);this.Qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new oy(r,n));let s=this.Qr.get(r);s===void 0&&(s=qe(),this.Qr.set(r,s)),this.Qr.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(){this.sessionToken=lr.EMPTY_BYTE_STRING}getSessionToken(e){return ie.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,ie.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{constructor(){this.$r=new $t(Gt.Ur),this.Kr=new $t(Gt.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,r){const n=new Gt(e,r);this.$r=this.$r.add(n),this.Kr=this.Kr.add(n)}Gr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.zr(new Gt(e,r))}jr(e,r){e.forEach(n=>this.removeReference(n,r))}Hr(e){const r=new be(new yt([])),n=new Gt(r,e),i=new Gt(r,e+1),s=[];return this.Kr.forEachInRange([n,i],a=>{this.zr(a),s.push(a.key)}),s}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const r=new be(new yt([])),n=new Gt(r,e),i=new Gt(r,e+1);let s=qe();return this.Kr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new Gt(e,0),n=this.$r.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Gt{constructor(e,r){this.key=e,this.Zr=r}static Ur(e,r){return be.comparator(e.key,r.key)||Ke(e.Zr,r.Zr)}static Wr(e,r){return Ke(e.Zr,r.Zr)||be.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.nr=1,this.Xr=new $t(Gt.Ur)}checkEmpty(e){return ie.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new ay(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.Xr=this.Xr.add(new Gt(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return ie.resolve(a)}lookupMutationBatch(e,r){return ie.resolve(this.ei(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ti(n),s=i<0?0:i;return ie.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ie.resolve(this.mutationQueue.length===0?lf:this.nr-1)}getAllMutationBatches(e){return ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Gt(r,0),i=new Gt(r,Number.POSITIVE_INFINITY),s=[];return this.Xr.forEachInRange([n,i],a=>{const o=this.ei(a.Zr);s.push(o)}),ie.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new $t(Ke);return r.forEach(i=>{const s=new Gt(i,0),a=new Gt(i,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([s,a],o=>{n=n.add(o.Zr)})}),ie.resolve(this.ni(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;be.isDocumentKey(s)||(s=s.child(""));const a=new Gt(new be(s),0);let o=new $t(Ke);return this.Xr.forEachWhile(c=>{const u=c.key.path;return!!n.isPrefixOf(u)&&(u.length===i&&(o=o.add(c.Zr)),!0)},a),ie.resolve(this.ni(o))}ni(e){const r=[];return e.forEach(n=>{const i=this.ei(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){ot(this.ri(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Xr;return ie.forEach(r.mutations,i=>{const s=new Gt(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Xr=n})}sr(e){}containsKey(e,r){const n=new Gt(r,0),i=this.Xr.firstAfterOrEqual(n);return ie.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ie.resolve()}ri(e,r){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const r=this.ti(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gy{constructor(e){this.ii=e,this.docs=function(){return new St(be.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.ii(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return ie.resolve(n?n.document.mutableCopy():gr.newInvalidDocument(r))}getEntries(e,r){let n=Vn();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():gr.newInvalidDocument(i))}),ie.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=Vn();const a=r.path,o=new be(a.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(o);for(;c.hasNext();){const{key:u,value:{document:f}}=c.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||ET(xT(f),n)<=0||(i.has(f.key)||sc(r,f))&&(s=s.insert(f.key,f.mutableCopy()))}return ie.resolve(s)}getAllFromCollectionGroup(e,r,n,i){Le(9500)}si(e,r){return ie.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new zy(this)}getSize(e){return ie.resolve(this.size)}}class zy extends Vy{constructor(e){super(),this.Br=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Br.addEntry(e,i)):this.Br.removeEntry(n)}),ie.waitFor(r)}getFromCache(e,r){return this.Br.getEntry(e,r)}getAllFromCache(e,r){return this.Br.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ky{constructor(e){this.persistence=e,this.oi=new Gi(r=>ff(r),hf),this.lastRemoteSnapshotVersion=Ue.min(),this.highestTargetId=0,this._i=0,this.ai=new vf,this.targetCount=0,this.ui=Ns.cr()}forEachTarget(e,r){return this.oi.forEach((n,i)=>r(i)),ie.resolve()}getLastRemoteSnapshotVersion(e){return ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ie.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),ie.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this._i&&(this._i=r),ie.resolve()}Tr(e){this.oi.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ui=new Ns(r),this.highestTargetId=r),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,r){return this.Tr(r),this.targetCount+=1,ie.resolve()}updateTargetData(e,r){return this.Tr(r),ie.resolve()}removeTargetData(e,r){return this.oi.delete(r.target),this.ai.Hr(r.targetId),this.targetCount-=1,ie.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.oi.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.oi.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),ie.waitFor(s).next(()=>i)}getTargetCount(e){return ie.resolve(this.targetCount)}getTargetData(e,r){const n=this.oi.get(r)||null;return ie.resolve(n)}addMatchingKeys(e,r,n){return this.ai.Gr(r,n),ie.resolve()}removeMatchingKeys(e,r,n){this.ai.jr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),ie.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.ai.Hr(r),ie.resolve()}getMatchingKeysForTargetId(e,r){const n=this.ai.Yr(r);return ie.resolve(n)}containsKey(e,r){return ie.resolve(this.ai.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eg{constructor(e,r){this.ci={},this.overlays={},this.li=new ec(0),this.hi=!1,this.hi=!0,this.Pi=new $y,this.referenceDelegate=e(this),this.Ti=new Ky(this),this.indexManager=new Dy,this.remoteDocumentCache=function(i){return new Gy(i)}(n=>this.referenceDelegate.Ii(n)),this.serializer=new Py(r),this.Ei=new Hy(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new Wy,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ci[e.toKey()];return n||(n=new jy(r,this.referenceDelegate),this.ci[e.toKey()]=n),n}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,r,n){Se("MemoryPersistence","Starting transaction:",e);const i=new qy(this.li.next());return this.referenceDelegate.di(),n(i).next(s=>this.referenceDelegate.Ai(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ri(e,r){return ie.or(Object.values(this.ci).map(n=>()=>n.containsKey(e,r)))}}class qy extends yT{constructor(e){super(),this.currentSequenceNumber=e}}class xf{constructor(e){this.persistence=e,this.Vi=new vf,this.mi=null}static fi(e){return new xf(e)}get gi(){if(this.mi)return this.mi;throw Le(60996)}addReference(e,r,n){return this.Vi.addReference(n,r),this.gi.delete(n.toString()),ie.resolve()}removeReference(e,r,n){return this.Vi.removeReference(n,r),this.gi.add(n.toString()),ie.resolve()}markPotentiallyOrphaned(e,r){return this.gi.add(r.toString()),ie.resolve()}removeTarget(e,r){this.Vi.Hr(r.targetId).forEach(i=>this.gi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.gi.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}di(){this.mi=new Set}Ai(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ie.forEach(this.gi,n=>{const i=be.fromPath(n);return this.pi(e,i).next(s=>{s||r.removeEntry(i,Ue.min())})}).next(()=>(this.mi=null,r.apply(e)))}updateLimboDocument(e,r){return this.pi(e,r).next(n=>{n?this.gi.delete(r.toString()):this.gi.add(r.toString())})}Ii(e){return 0}pi(e,r){return ie.or([()=>ie.resolve(this.Vi.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ri(e,r)])}}class xl{constructor(e,r){this.persistence=e,this.yi=new Gi(n=>ST(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=My(this,r)}static fi(e,r){return new xl(e,r)}di(){}Ai(e){return ie.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}pr(e){const r=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}br(e){let r=0;return this.yr(e,n=>{r++}).next(()=>r)}yr(e,r){return ie.forEach(this.yi,(n,i)=>this.Dr(e,n,i).next(s=>s?ie.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.si(e,a=>this.Dr(e,a,r).next(o=>{o||(n++,s.removeEntry(a,Ue.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.yi.set(r,e.currentSequenceNumber),ie.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.yi.set(n,e.currentSequenceNumber),ie.resolve()}removeReference(e,r,n){return this.yi.set(n,e.currentSequenceNumber),ie.resolve()}updateLimboDocument(e,r){return this.yi.set(r,e.currentSequenceNumber),ie.resolve()}Ii(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Ko(e.data.value)),r}Dr(e,r,n){return ie.or([()=>this.persistence.Ri(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.yi.get(r);return ie.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.ds=n,this.As=i}static Rs(e,r){let n=qe(),i=qe();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Ef(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yy{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return $E()?8:wT(HE())>0?6:4}()}initialize(e,r){this.ys=e,this.indexManager=r,this.Vs=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.ws(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.bs(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new Xy;return this.Ss(e,r,a).next(o=>{if(s.result=o,this.fs)return this.Ds(e,r,a,o.size)})}).next(()=>s.result)}Ds(e,r,n,i){return n.documentReadCount<this.gs?(fs()<=Je.DEBUG&&Se("QueryEngine","SDK will not create cache indexes for query:",hs(r),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),ie.resolve()):(fs()<=Je.DEBUG&&Se("QueryEngine","Query:",hs(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.ps*i?(fs()<=Je.DEBUG&&Se("QueryEngine","The SDK decides to create cache indexes for query:",hs(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,dn(r))):ie.resolve())}ws(e,r){if(W0(r))return ie.resolve(null);let n=dn(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=wu(r,null,"F"),n=dn(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=qe(...s);return this.ys.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(c=>{const u=this.vs(r,o);return this.Cs(r,u,a,c.readTime)?this.ws(e,wu(r,null,"F")):this.Fs(e,u,r,c)}))})))}bs(e,r,n,i){return W0(r)||i.isEqual(Ue.min())?ie.resolve(null):this.ys.getDocuments(e,n).next(s=>{const a=this.vs(r,s);return this.Cs(r,a,n,i)?ie.resolve(null):(fs()<=Je.DEBUG&&Se("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),hs(r)),this.Fs(e,a,r,vT(i,Va)).next(o=>o))})}vs(e,r){let n=new $t(Q1(e));return r.forEach((i,s)=>{sc(e,s)&&(n=n.add(s))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,r,n){return fs()<=Je.DEBUG&&Se("QueryEngine","Using full collection scan to execute query:",hs(r)),this.ys.getDocumentsMatchingQuery(e,r,ci.min(),n)}Fs(e,r,n,i){return this.ys.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tf="LocalStore",Qy=3e8;class Jy{constructor(e,r,n,i){this.persistence=e,this.Ms=r,this.serializer=i,this.xs=new St(Ke),this.Os=new Gi(s=>ff(s),hf),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(n)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Uy(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.xs))}}function Zy(t,e,r,n){return new Jy(t,e,r,n)}async function Tg(t,e){const r=We(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.Ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let c=qe();for(const u of i){a.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}for(const u of s){o.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}return r.localDocuments.getDocuments(n,c).next(u=>({ks:u,removedBatchIds:a,addedBatchIds:o}))})})}function ew(t,e){const r=We(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.Bs.newChangeBuffer({trackRemovals:!0});return function(o,c,u,f){const d=u.batch,p=d.keys();let g=ie.resolve();return p.forEach(v=>{g=g.next(()=>f.getEntry(c,v)).next(_=>{const E=u.docVersions.get(v);ot(E!==null,48541),_.version.compareTo(E)<0&&(d.applyToRemoteDocument(_,u),_.isValidDocument()&&(_.setReadTime(u.commitVersion),f.addEntry(_)))})}),g.next(()=>o.mutationQueue.removeMutationBatch(c,d))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let c=qe();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(c=c.add(o.batch.mutations[u].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function yg(t){const e=We(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ti.getLastRemoteSnapshotVersion(r))}function tw(t,e){const r=We(t),n=e.snapshotVersion;let i=r.xs;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.Bs.newChangeBuffer({trackRemovals:!0});i=r.xs;const o=[];e.targetChanges.forEach((f,d)=>{const p=i.get(d);if(!p)return;o.push(r.Ti.removeMatchingKeys(s,f.removedDocuments,d).next(()=>r.Ti.addMatchingKeys(s,f.addedDocuments,d)));let g=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?g=g.withResumeToken(lr.EMPTY_BYTE_STRING,Ue.min()).withLastLimboFreeSnapshotVersion(Ue.min()):f.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(f.resumeToken,n)),i=i.insert(d,g),function(_,E,L){return _.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=Qy?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0}(p,g,f)&&o.push(r.Ti.updateTargetData(s,g))});let c=Vn(),u=qe();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,f))}),o.push(rw(s,a,e.documentUpdates).next(f=>{c=f.qs,u=f.Qs})),!n.isEqual(Ue.min())){const f=r.Ti.getLastRemoteSnapshotVersion(s).next(d=>r.Ti.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(f)}return ie.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(r.xs=i,s))}function rw(t,e,r){let n=qe(),i=qe();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=Vn();return r.forEach((o,c)=>{const u=s.get(o);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(o)),c.isNoDocument()&&c.version.isEqual(Ue.min())?(e.removeEntry(o,c.readTime),a=a.insert(o,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),a=a.insert(o,c)):Se(Tf,"Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",c.version)}),{qs:a,Qs:i}})}function nw(t,e){const r=We(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=lf),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function iw(t,e){const r=We(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ti.getTargetData(n,e).next(s=>s?(i=s,ie.resolve(i)):r.Ti.allocateTargetId(n).next(a=>(i=new Qn(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ti.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.xs.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.xs=r.xs.insert(n.targetId,n),r.Os.set(e,n.targetId)),n})}async function Ru(t,e,r){const n=We(t),i=n.xs.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Ws(a))throw a;Se(Tf,`Failed to update sequence numbers for target ${e}: ${a}`)}n.xs=n.xs.remove(e),n.Os.delete(i.target)}function td(t,e,r){const n=We(t);let i=Ue.min(),s=qe();return n.persistence.runTransaction("Execute query","readwrite",a=>function(c,u,f){const d=We(c),p=d.Os.get(f);return p!==void 0?ie.resolve(d.xs.get(p)):d.Ti.getTargetData(u,f)}(n,a,dn(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ti.getMatchingKeysForTargetId(a,o.targetId).next(c=>{s=c})}).next(()=>n.Ms.getDocumentsMatchingQuery(a,e,r?i:Ue.min(),r?s:qe())).next(o=>(sw(n,GT(e),o),{documents:o,$s:s})))}function sw(t,e,r){let n=t.Ns.get(e)||Ue.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.Ns.set(e,n)}class rd{constructor(){this.activeTargetIds=QT()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class aw{constructor(){this.xo=new rd,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,r,n){this.Oo[e]=r}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new rd,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ow{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nd="ConnectivityMonitor";class id{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){Se(nd,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){Se(nd,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bo=null;function Pu(){return bo===null?bo=function(){return 268435456+Math.round(2147483648*Math.random())}():bo++,"0x"+bo.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jc="RestConnection",lw={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class cw{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Ko=r+"://"+e.host,this.Wo=`projects/${n}/databases/${i}`,this.Go=this.databaseId.database===hl?`project_id=${n}`:`project_id=${n}&database_id=${i}`}zo(e,r,n,i,s){const a=Pu(),o=this.jo(e,r.toUriEncodedString());Se(jc,`Sending RPC '${e}' ${a}:`,o,n);const c={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(c,i,s);const{host:u}=new URL(o),f=sf(u);return this.Jo(e,o,c,n,f).then(d=>(Se(jc,`Received RPC '${e}' ${a}: `,d),d),d=>{throw Ds(jc,`RPC '${e}' ${a} failed with error: `,d,"url: ",o,"request:",n),d})}Yo(e,r,n,i,s,a){return this.zo(e,r,n,i,s)}Ho(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Us}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,s)=>e[s]=i),n&&n.headers.forEach((i,s)=>e[s]=i)}jo(e,r){const n=lw[e];return`${this.Ko}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uw{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hr="WebChannelConnection";class fw extends cw{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,s){const a=Pu();return new Promise((o,c)=>{const u=new S1;u.setWithCredentials(!0),u.listenOnce(I1.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case zo.NO_ERROR:const d=u.getResponseJson();Se(hr,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(d)),o(d);break;case zo.TIMEOUT:Se(hr,`RPC '${e}' ${a} timed out`),c(new Oe(ce.DEADLINE_EXCEEDED,"Request time out"));break;case zo.HTTP_ERROR:const p=u.getStatus();if(Se(hr,`RPC '${e}' ${a} failed with status:`,p,"response text:",u.getResponseText()),p>0){let g=u.getResponseJson();Array.isArray(g)&&(g=g[0]);const v=g==null?void 0:g.error;if(v&&v.status&&v.message){const _=function(L){const V=L.toLowerCase().replace(/_/g,"-");return Object.values(ce).indexOf(V)>=0?V:ce.UNKNOWN}(v.status);c(new Oe(_,v.message))}else c(new Oe(ce.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new Oe(ce.UNAVAILABLE,"Connection failed."));break;default:Le(9055,{h_:e,streamId:a,P_:u.getLastErrorCode(),T_:u.getLastError()})}}finally{Se(hr,`RPC '${e}' ${a} completed.`)}});const f=JSON.stringify(i);Se(hr,`RPC '${e}' ${a} sending request:`,i),u.send(r,"POST",f,n,15)})}I_(e,r,n){const i=Pu(),s=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=P1(),o=R1(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Ho(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const f=s.join("");Se(hr,`Creating RPC '${e}' stream ${i}: ${f}`,c);const d=a.createWebChannel(f,c);this.E_(d);let p=!1,g=!1;const v=new uw({Zo:E=>{g?Se(hr,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(p||(Se(hr,`Opening RPC '${e}' stream ${i} transport.`),d.open(),p=!0),Se(hr,`RPC '${e}' stream ${i} sending:`,E),d.send(E))},Xo:()=>d.close()}),_=(E,L,V)=>{E.listen(L,N=>{try{V(N)}catch(U){setTimeout(()=>{throw U},0)}})};return _(d,la.EventType.OPEN,()=>{g||(Se(hr,`RPC '${e}' stream ${i} transport opened.`),v.__())}),_(d,la.EventType.CLOSE,()=>{g||(g=!0,Se(hr,`RPC '${e}' stream ${i} transport closed`),v.u_(),this.d_(d))}),_(d,la.EventType.ERROR,E=>{g||(g=!0,Ds(hr,`RPC '${e}' stream ${i} transport errored. Name:`,E.name,"Message:",E.message),v.u_(new Oe(ce.UNAVAILABLE,"The operation could not be completed")))}),_(d,la.EventType.MESSAGE,E=>{var L;if(!g){const V=E.data[0];ot(!!V,16349);const N=V,U=(N==null?void 0:N.error)||((L=N[0])===null||L===void 0?void 0:L.error);if(U){Se(hr,`RPC '${e}' stream ${i} received error:`,U);const re=U.status;let ue=function(T){const I=kt[T];if(I!==void 0)return cg(I)}(re),w=U.message;ue===void 0&&(ue=ce.INTERNAL,w="Unknown error status: "+re+" with message "+U.message),g=!0,v.u_(new Oe(ue,w)),d.close()}else Se(hr,`RPC '${e}' stream ${i} received:`,V),v.c_(V)}}),_(o,C1.STAT_EVENT,E=>{E.stat===_u.PROXY?Se(hr,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===_u.NOPROXY&&Se(hr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.a_()},0),v}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(r=>r===e)}}function Gc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cc(t){return new gy(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wg{constructor(e,r,n=1e3,i=1.5,s=6e4){this.xi=e,this.timerId=r,this.A_=n,this.R_=i,this.V_=s,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const r=Math.floor(this.m_+this.w_()),n=Math.max(0,Date.now()-this.g_),i=Math.max(0,r-n);i>0&&Se("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.m_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,i,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sd="PersistentStream";class Ag{constructor(e,r,n,i,s,a,o,c){this.xi=e,this.S_=n,this.D_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=c,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new wg(e,r)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,r){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():r&&r.code===ce.RESOURCE_EXHAUSTED?(Mn(r.toString()),Mn("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):r&&r.code===ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(r)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),r=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.v_===r&&this.z_(n,i)},n=>{e(()=>{const i=new Oe(ce.UNKNOWN,"Fetching auth token failed: "+n.message);return this.j_(i)})})}z_(e,r){const n=this.G_(this.v_);this.stream=this.H_(e,r),this.stream.e_(()=>{n(()=>this.listener.e_())}),this.stream.n_(()=>{n(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(i=>{n(()=>this.j_(i))}),this.stream.onMessage(i=>{n(()=>++this.M_==1?this.J_(i):this.onNext(i))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return Se(sd,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return r=>{this.xi.enqueueAndForget(()=>this.v_===e?r():(Se(sd,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class hw extends Ag{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}H_(e,r){return this.connection.I_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const r=vy(this.serializer,e),n=function(s){if(!("targetChange"in s))return Ue.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Ue.min():a.readTime?pn(a.readTime):Ue.min()}(e);return this.listener.Y_(r,n)}Z_(e){const r={};r.database=Cu(this.serializer),r.addTarget=function(s,a){let o;const c=a.target;if(o=yu(c)?{documents:Ty(s,c)}:{query:yy(s,c).gt},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=hg(s,a.resumeToken);const u=Au(s,a.expectedCount);u!==null&&(o.expectedCount=u)}else if(a.snapshotVersion.compareTo(Ue.min())>0){o.readTime=vl(s,a.snapshotVersion.toTimestamp());const u=Au(s,a.expectedCount);u!==null&&(o.expectedCount=u)}return o}(this.serializer,e);const n=Ay(this.serializer,e);n&&(r.labels=n),this.Q_(r)}X_(e){const r={};r.database=Cu(this.serializer),r.removeTarget=e,this.Q_(r)}}class dw extends Ag{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,r){return this.connection.I_("Write",e,r)}J_(e){return ot(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ot(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){ot(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const r=Ey(e.writeResults,e.commitTime),n=pn(e.commitTime);return this.listener.ra(n,r)}ia(){const e={};e.database=Cu(this.serializer),this.Q_(e)}ta(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>xy(this.serializer,n))};this.Q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{}class gw extends pw{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.sa=!1}oa(){if(this.sa)throw new Oe(ce.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,r,n,i){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.zo(e,Su(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Oe(ce.UNKNOWN,s.toString())})}Yo(e,r,n,i,s){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Yo(e,Su(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Oe(ce.UNKNOWN,a.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class mw{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Mn(r),this.ua=!1):Se("OnlineStateTracker",r)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ui="RemoteStore";class _w{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=s,this.Ra.No(a=>{n.enqueueAndForget(async()=>{Ki(this)&&(Se(Ui,"Restarting streams for network reachability change."),await async function(c){const u=We(c);u.da.add(4),await ro(u),u.Va.set("Unknown"),u.da.delete(4),await uc(u)}(this))})}),this.Va=new mw(n,i)}}async function uc(t){if(Ki(t))for(const e of t.Aa)await e(!0)}async function ro(t){for(const e of t.Aa)await e(!1)}function Sg(t,e){const r=We(t);r.Ea.has(e.targetId)||(r.Ea.set(e.targetId,e),Sf(r)?Af(r):$s(r).N_()&&wf(r,e))}function yf(t,e){const r=We(t),n=$s(r);r.Ea.delete(e),n.N_()&&Ig(r,e),r.Ea.size===0&&(n.N_()?n.k_():Ki(r)&&r.Va.set("Unknown"))}function wf(t,e){if(t.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ue.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}$s(t).Z_(e)}function Ig(t,e){t.ma.Ke(e),$s(t).X_(e)}function Af(t){t.ma=new fy({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>t.Ea.get(e)||null,Pt:()=>t.datastore.serializer.databaseId}),$s(t).start(),t.Va.ca()}function Sf(t){return Ki(t)&&!$s(t).O_()&&t.Ea.size>0}function Ki(t){return We(t).da.size===0}function Cg(t){t.ma=void 0}async function vw(t){t.Va.set("Online")}async function xw(t){t.Ea.forEach((e,r)=>{wf(t,e)})}async function Ew(t,e){Cg(t),Sf(t)?(t.Va.Pa(e),Af(t)):t.Va.set("Unknown")}async function Tw(t,e,r){if(t.Va.set("Online"),e instanceof fg&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.Ea.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.Ea.delete(o),i.ma.removeTarget(o))}(t,e)}catch(n){Se(Ui,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await El(t,n)}else if(e instanceof Yo?t.ma.Xe(e):e instanceof ug?t.ma.ot(e):t.ma.nt(e),!r.isEqual(Ue.min()))try{const n=await yg(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.ma.It(a);return o.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const f=s.Ea.get(u);f&&s.Ea.set(u,f.withResumeToken(c.resumeToken,a))}}),o.targetMismatches.forEach((c,u)=>{const f=s.Ea.get(c);if(!f)return;s.Ea.set(c,f.withResumeToken(lr.EMPTY_BYTE_STRING,f.snapshotVersion)),Ig(s,c);const d=new Qn(f.target,c,u,f.sequenceNumber);wf(s,d)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Se(Ui,"Failed to raise snapshot:",n),await El(t,n)}}async function El(t,e,r){if(!Ws(e))throw e;t.da.add(1),await ro(t),t.Va.set("Offline"),r||(r=()=>yg(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Se(Ui,"Retrying IndexedDB access"),await r(),t.da.delete(1),await uc(t)})}function Rg(t,e){return e().catch(r=>El(t,r,e))}async function fc(t){const e=We(t),r=di(e);let n=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:lf;for(;yw(e);)try{const i=await nw(e.localStore,n);if(i===null){e.Ia.length===0&&r.k_();break}n=i.batchId,ww(e,i)}catch(i){await El(e,i)}Pg(e)&&Fg(e)}function yw(t){return Ki(t)&&t.Ia.length<10}function ww(t,e){t.Ia.push(e);const r=di(t);r.N_()&&r.ea&&r.ta(e.mutations)}function Pg(t){return Ki(t)&&!di(t).O_()&&t.Ia.length>0}function Fg(t){di(t).start()}async function Aw(t){di(t).ia()}async function Sw(t){const e=di(t);for(const r of t.Ia)e.ta(r.mutations)}async function Iw(t,e,r){const n=t.Ia.shift(),i=gf.from(n,e,r);await Rg(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await fc(t)}async function Cw(t,e){e&&di(t).ea&&await async function(n,i){if(function(a){return cy(a)&&a!==ce.ABORTED}(i.code)){const s=n.Ia.shift();di(n).L_(),await Rg(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await fc(n)}}(t,e),Pg(t)&&Fg(t)}async function ad(t,e){const r=We(t);r.asyncQueue.verifyOperationInProgress(),Se(Ui,"RemoteStore received new credentials");const n=Ki(r);r.da.add(3),await ro(r),n&&r.Va.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.da.delete(3),await uc(r)}async function Rw(t,e){const r=We(t);e?(r.da.delete(2),await uc(r)):e||(r.da.add(2),await ro(r),r.Va.set("Unknown"))}function $s(t){return t.fa||(t.fa=function(r,n,i){const s=We(r);return s.oa(),new hw(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{e_:vw.bind(null,t),n_:xw.bind(null,t),i_:Ew.bind(null,t),Y_:Tw.bind(null,t)}),t.Aa.push(async e=>{e?(t.fa.L_(),Sf(t)?Af(t):t.Va.set("Unknown")):(await t.fa.stop(),Cg(t))})),t.fa}function di(t){return t.ga||(t.ga=function(r,n,i){const s=We(r);return s.oa(),new dw(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{e_:()=>Promise.resolve(),n_:Aw.bind(null,t),i_:Cw.bind(null,t),na:Sw.bind(null,t),ra:Iw.bind(null,t)}),t.Aa.push(async e=>{e?(t.ga.L_(),await fc(t)):(await t.ga.stop(),t.Ia.length>0&&(Se(Ui,`Stopping write stream with ${t.Ia.length} pending writes`),t.Ia=[]))})),t.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new ii,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new If(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Oe(ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Cf(t,e){if(Mn("AsyncQueue",`${e}: ${t}`),Ws(t))return new Oe(ce.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{static emptySet(e){return new Ss(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||be.comparator(r.key,n.key):(r,n)=>be.comparator(r.key,n.key),this.keyedMap=ca(),this.sortedSet=new St(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Ss)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Ss;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(){this.pa=new St(be.comparator)}track(e){const r=e.doc.key,n=this.pa.get(r);n?e.type!==0&&n.type===3?this.pa=this.pa.insert(r,e):e.type===3&&n.type!==1?this.pa=this.pa.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.pa=this.pa.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.pa=this.pa.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.pa=this.pa.remove(r):e.type===1&&n.type===2?this.pa=this.pa.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.pa=this.pa.insert(r,{type:2,doc:e.doc}):Le(63341,{Vt:e,ya:n}):this.pa=this.pa.insert(r,e)}wa(){const e=[];return this.pa.inorderTraversal((r,n)=>{e.push(n)}),e}}class Ls{constructor(e,r,n,i,s,a,o,c,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new Ls(e,r,Ss.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ic(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pw{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class Fw{constructor(){this.queries=ld(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=We(r),s=i.queries;i.queries=ld(),s.forEach((a,o)=>{for(const c of o.Sa)c.onError(n)})})(this,new Oe(ce.ABORTED,"Firestore shutting down"))}}function ld(){return new Gi(t=>Y1(t),ic)}async function Dw(t,e){const r=We(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.Da()&&e.va()&&(n=2):(s=new Pw,n=e.va()?0:1);try{switch(n){case 0:s.ba=await r.onListen(i,!0);break;case 1:s.ba=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=Cf(a,`Initialization of query '${hs(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.Sa.push(e),e.Fa(r.onlineState),s.ba&&e.Ma(s.ba)&&Rf(r)}async function Ow(t,e){const r=We(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?i=e.va()?0:1:!s.Da()&&e.va()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function bw(t,e){const r=We(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.Sa)o.Ma(i)&&(n=!0);a.ba=i}}n&&Rf(r)}function kw(t,e,r){const n=We(t),i=n.queries.get(e);if(i)for(const s of i.Sa)s.onError(r);n.queries.delete(e)}function Rf(t){t.Ca.forEach(e=>{e.next()})}var Fu,cd;(cd=Fu||(Fu={})).xa="default",cd.Cache="cache";class Nw{constructor(e,r,n){this.query=e,this.Oa=r,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=n||{}}Ma(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Ls(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Na?this.La(e)&&(this.Oa.next(e),r=!0):this.ka(e,this.onlineState)&&(this.qa(e),r=!0),this.Ba=e,r}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let r=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),r=!0),r}ka(e,r){if(!e.fromCache||!this.va())return!0;const n=r!=="Offline";return(!this.options.Qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}La(e){if(e.docChanges.length>0)return!0;const r=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}qa(e){e=Ls.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==Fu.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dg{constructor(e){this.key=e}}class Og{constructor(e){this.key=e}}class Lw{constructor(e,r){this.query=e,this.Ha=r,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=qe(),this.mutatedKeys=qe(),this.Za=Q1(e),this.Xa=new Ss(this.Za)}get eu(){return this.Ha}tu(e,r){const n=r?r.nu:new od,i=r?r.Xa:this.Xa;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,d)=>{const p=i.get(f),g=sc(this.query,d)?d:null,v=!!p&&this.mutatedKeys.has(p.key),_=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let E=!1;p&&g?p.data.isEqual(g.data)?v!==_&&(n.track({type:3,doc:g}),E=!0):this.ru(p,g)||(n.track({type:2,doc:g}),E=!0,(c&&this.Za(g,c)>0||u&&this.Za(g,u)<0)&&(o=!0)):!p&&g?(n.track({type:0,doc:g}),E=!0):p&&!g&&(n.track({type:1,doc:p}),E=!0,(c||u)&&(o=!0)),E&&(g?(a=a.add(g),s=_?s.add(f):s.delete(f)):(a=a.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{Xa:a,nu:n,Cs:o,mutatedKeys:s}}ru(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const a=e.nu.wa();a.sort((f,d)=>function(g,v){const _=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le(20277,{Vt:E})}};return _(g)-_(v)}(f.type,d.type)||this.Za(f.doc,d.doc)),this.iu(n),i=i!=null&&i;const o=r&&!i?this.su():[],c=this.Ya.size===0&&this.current&&!i?1:0,u=c!==this.Ja;return this.Ja=c,a.length!==0||u?{snapshot:new Ls(this.query,e.Xa,s,a,e.mutatedKeys,c===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),ou:o}:{ou:o}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new od,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(r=>this.Ha=this.Ha.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ha=this.Ha.delete(r)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=qe(),this.Xa.forEach(n=>{this._u(n.key)&&(this.Ya=this.Ya.add(n.key))});const r=[];return e.forEach(n=>{this.Ya.has(n)||r.push(new Og(n))}),this.Ya.forEach(n=>{e.has(n)||r.push(new Dg(n))}),r}au(e){this.Ha=e.$s,this.Ya=qe();const r=this.tu(e.documents);return this.applyChanges(r,!0)}uu(){return Ls.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const Pf="SyncEngine";class Mw{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class Vw{constructor(e){this.key=e,this.cu=!1}}class Bw{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.lu={},this.hu=new Gi(o=>Y1(o),ic),this.Pu=new Map,this.Tu=new Set,this.Iu=new St(be.comparator),this.Eu=new Map,this.du=new vf,this.Au={},this.Ru=new Map,this.Vu=Ns.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function Uw(t,e,r=!0){const n=Vg(t);let i;const s=n.hu.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.uu()):i=await bg(n,e,r,!0),i}async function Hw(t,e){const r=Vg(t);await bg(r,e,!0,!1)}async function bg(t,e,r,n){const i=await iw(t.localStore,dn(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await Ww(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&Sg(t.remoteStore,i),o}async function Ww(t,e,r,n,i){t.fu=(d,p,g)=>async function(_,E,L,V){let N=E.view.tu(L);N.Cs&&(N=await td(_.localStore,E.query,!1).then(({documents:w})=>E.view.tu(w,N)));const U=V&&V.targetChanges.get(E.targetId),re=V&&V.targetMismatches.get(E.targetId)!=null,ue=E.view.applyChanges(N,_.isPrimaryClient,U,re);return fd(_,E.targetId,ue.ou),ue.snapshot}(t,d,p,g);const s=await td(t.localStore,e,!0),a=new Lw(e,s.$s),o=a.tu(s.documents),c=to.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),u=a.applyChanges(o,t.isPrimaryClient,c);fd(t,r,u.ou);const f=new Mw(e,r,a);return t.hu.set(e,f),t.Pu.has(r)?t.Pu.get(r).push(e):t.Pu.set(r,[e]),u.snapshot}async function $w(t,e,r){const n=We(t),i=n.hu.get(e),s=n.Pu.get(i.targetId);if(s.length>1)return n.Pu.set(i.targetId,s.filter(a=>!ic(a,e))),void n.hu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Ru(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&yf(n.remoteStore,i.targetId),Du(n,i.targetId)}).catch(Hs)):(Du(n,i.targetId),await Ru(n.localStore,i.targetId,!0))}async function jw(t,e){const r=We(t),n=r.hu.get(e),i=r.Pu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),yf(r.remoteStore,n.targetId))}async function Gw(t,e,r){const n=Jw(t);try{const i=await function(a,o){const c=We(a),u=Wt.now(),f=o.reduce((g,v)=>g.add(v.key),qe());let d,p;return c.persistence.runTransaction("Locally write mutations","readwrite",g=>{let v=Vn(),_=qe();return c.Bs.getEntries(g,f).next(E=>{v=E,v.forEach((L,V)=>{V.isValidDocument()||(_=_.add(L))})}).next(()=>c.localDocuments.getOverlayedDocuments(g,v)).next(E=>{d=E;const L=[];for(const V of o){const N=iy(V,d.get(V.key).overlayedDocument);N!=null&&L.push(new zi(V.key,N,$1(N.value.mapValue),Fn.exists(!0)))}return c.mutationQueue.addMutationBatch(g,u,L,o)}).next(E=>{p=E;const L=E.applyToLocalDocumentSet(d,_);return c.documentOverlayCache.saveOverlays(g,E.batchId,L)})}).then(()=>({batchId:p.batchId,changes:Z1(d)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,c){let u=a.Au[a.currentUser.toKey()];u||(u=new St(Ke)),u=u.insert(o,c),a.Au[a.currentUser.toKey()]=u}(n,i.batchId,r),await no(n,i.changes),await fc(n.remoteStore)}catch(i){const s=Cf(i,"Failed to persist write");r.reject(s)}}async function kg(t,e){const r=We(t);try{const n=await tw(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Eu.get(s);a&&(ot(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.cu=!0:i.modifiedDocuments.size>0?ot(a.cu,14607):i.removedDocuments.size>0&&(ot(a.cu,42227),a.cu=!1))}),await no(r,n,e)}catch(n){await Hs(n)}}function ud(t,e,r){const n=We(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.hu.forEach((s,a)=>{const o=a.view.Fa(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const c=We(a);c.onlineState=o;let u=!1;c.queries.forEach((f,d)=>{for(const p of d.Sa)p.Fa(o)&&(u=!0)}),u&&Rf(c)}(n.eventManager,e),i.length&&n.lu.Y_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function zw(t,e,r){const n=We(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Eu.get(e),s=i&&i.key;if(s){let a=new St(be.comparator);a=a.insert(s,gr.newNoDocument(s,Ue.min()));const o=qe().add(s),c=new lc(Ue.min(),new Map,new St(Ke),a,o);await kg(n,c),n.Iu=n.Iu.remove(s),n.Eu.delete(e),Ff(n)}else await Ru(n.localStore,e,!1).then(()=>Du(n,e,r)).catch(Hs)}async function Kw(t,e){const r=We(t),n=e.batch.batchId;try{const i=await ew(r.localStore,e);Lg(r,n,null),Ng(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await no(r,i)}catch(i){await Hs(i)}}async function qw(t,e,r){const n=We(t);try{const i=await function(a,o){const c=We(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return c.mutationQueue.lookupMutationBatch(u,o).next(d=>(ot(d!==null,37113),f=d.keys(),c.mutationQueue.removeMutationBatch(u,d))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,f,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>c.localDocuments.getDocuments(u,f))})}(n.localStore,e);Lg(n,e,r),Ng(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await no(n,i)}catch(i){await Hs(i)}}function Ng(t,e){(t.Ru.get(e)||[]).forEach(r=>{r.resolve()}),t.Ru.delete(e)}function Lg(t,e,r){const n=We(t);let i=n.Au[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Au[n.currentUser.toKey()]=i}}function Du(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Pu.get(e))t.hu.delete(n),r&&t.lu.gu(n,r);t.Pu.delete(e),t.isPrimaryClient&&t.du.Hr(e).forEach(n=>{t.du.containsKey(n)||Mg(t,n)})}function Mg(t,e){t.Tu.delete(e.path.canonicalString());const r=t.Iu.get(e);r!==null&&(yf(t.remoteStore,r),t.Iu=t.Iu.remove(e),t.Eu.delete(r),Ff(t))}function fd(t,e,r){for(const n of r)n instanceof Dg?(t.du.addReference(n.key,e),Xw(t,n)):n instanceof Og?(Se(Pf,"Document no longer in limbo: "+n.key),t.du.removeReference(n.key,e),t.du.containsKey(n.key)||Mg(t,n.key)):Le(19791,{pu:n})}function Xw(t,e){const r=e.key,n=r.path.canonicalString();t.Iu.get(r)||t.Tu.has(n)||(Se(Pf,"New document in limbo: "+r),t.Tu.add(n),Ff(t))}function Ff(t){for(;t.Tu.size>0&&t.Iu.size<t.maxConcurrentLimboResolutions;){const e=t.Tu.values().next().value;t.Tu.delete(e);const r=new be(yt.fromString(e)),n=t.Vu.next();t.Eu.set(n,new Vw(r)),t.Iu=t.Iu.insert(r,n),Sg(t.remoteStore,new Qn(dn(df(r.path)),n,"TargetPurposeLimboResolution",ec.le))}}async function no(t,e,r){const n=We(t),i=[],s=[],a=[];n.hu.isEmpty()||(n.hu.forEach((o,c)=>{a.push(n.fu(c,e,r).then(u=>{var f;if((u||r)&&n.isPrimaryClient){const d=u?!u.fromCache:(f=r==null?void 0:r.targetChanges.get(c.targetId))===null||f===void 0?void 0:f.current;n.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(u){i.push(u);const d=Ef.Rs(c.targetId,u);s.push(d)}}))}),await Promise.all(a),n.lu.Y_(i),await async function(c,u){const f=We(c);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>ie.forEach(u,p=>ie.forEach(p.ds,g=>f.persistence.referenceDelegate.addReference(d,p.targetId,g)).next(()=>ie.forEach(p.As,g=>f.persistence.referenceDelegate.removeReference(d,p.targetId,g)))))}catch(d){if(!Ws(d))throw d;Se(Tf,"Failed to update sequence numbers: "+d)}for(const d of u){const p=d.targetId;if(!d.fromCache){const g=f.xs.get(p),v=g.snapshotVersion,_=g.withLastLimboFreeSnapshotVersion(v);f.xs=f.xs.insert(p,_)}}}(n.localStore,s))}async function Yw(t,e){const r=We(t);if(!r.currentUser.isEqual(e)){Se(Pf,"User change. New user:",e.toKey());const n=await Tg(r.localStore,e);r.currentUser=e,function(s,a){s.Ru.forEach(o=>{o.forEach(c=>{c.reject(new Oe(ce.CANCELLED,a))})}),s.Ru.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await no(r,n.ks)}}function Qw(t,e){const r=We(t),n=r.Eu.get(e);if(n&&n.cu)return qe().add(n.key);{let i=qe();const s=r.Pu.get(e);if(!s)return i;for(const a of s){const o=r.hu.get(a);i=i.unionWith(o.view.eu)}return i}}function Vg(t){const e=We(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=kg.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Qw.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=zw.bind(null,e),e.lu.Y_=bw.bind(null,e.eventManager),e.lu.gu=kw.bind(null,e.eventManager),e}function Jw(t){const e=We(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Kw.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=qw.bind(null,e),e}class Tl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=cc(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,r){return null}Cu(e,r){return null}Du(e){return Zy(this.persistence,new Yy,e.initialUser,this.serializer)}Su(e){return new Eg(xf.fi,this.serializer)}bu(e){return new aw}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Tl.provider={build:()=>new Tl};class Zw extends Tl{constructor(e){super(),this.cacheSizeBytes=e}vu(e,r){ot(this.persistence.referenceDelegate instanceof xl,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new Ny(n,e.asyncQueue,r)}Su(e){const r=this.cacheSizeBytes!==void 0?Pr.withCacheSize(this.cacheSizeBytes):Pr.DEFAULT;return new Eg(n=>xl.fi(n,r),this.serializer)}}class Ou{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>ud(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=Yw.bind(null,this.syncEngine),await Rw(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Fw}()}createDatastore(e){const r=cc(e.databaseInfo.databaseId),n=function(s){return new fw(s)}(e.databaseInfo);return function(s,a,o,c){return new gw(s,a,o,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new _w(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>ud(this.syncEngine,r,0),function(){return id.C()?new id:new ow}())}createSyncEngine(e,r){return function(i,s,a,o,c,u,f){const d=new Bw(i,s,a,o,c,u);return f&&(d.mu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=We(i);Se(Ui,"RemoteStore shutting down."),s.da.add(5),await ro(s),s.Ra.shutdown(),s.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Ou.provider={build:()=>new Ou};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):Mn("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pi="FirestoreClient";class tA{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=dr.UNAUTHENTICATED,this.clientId=b1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{Se(pi,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Se(pi,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ii;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Cf(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function zc(t,e){t.asyncQueue.verifyOperationInProgress(),Se(pi,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await Tg(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function hd(t,e){t.asyncQueue.verifyOperationInProgress();const r=await rA(t);Se(pi,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>ad(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>ad(e.remoteStore,i)),t._onlineComponents=e}async function rA(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Se(pi,"Using user provided OfflineComponentProvider");try{await zc(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===ce.FAILED_PRECONDITION||i.code===ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Ds("Error using user provided cache. Falling back to memory cache: "+r),await zc(t,new Tl)}}else Se(pi,"Using default OfflineComponentProvider"),await zc(t,new Zw(void 0));return t._offlineComponents}async function Bg(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Se(pi,"Using user provided OnlineComponentProvider"),await hd(t,t._uninitializedComponentsProvider._online)):(Se(pi,"Using default OnlineComponentProvider"),await hd(t,new Ou))),t._onlineComponents}function nA(t){return Bg(t).then(e=>e.syncEngine)}async function iA(t){const e=await Bg(t),r=e.eventManager;return r.onListen=Uw.bind(null,e.syncEngine),r.onUnlisten=$w.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=Hw.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=jw.bind(null,e.syncEngine),r}function sA(t,e,r={}){const n=new ii;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,c,u){const f=new eA({next:p=>{f.xu(),a.enqueueAndForget(()=>Ow(s,d));const g=p.docs.has(o);!g&&p.fromCache?u.reject(new Oe(ce.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&c&&c.source==="server"?u.reject(new Oe(ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),d=new Nw(df(o.path),f,{includeMetadataChanges:!0,Qa:!0});return Dw(s,d)}(await iA(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ug(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dd=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hg(t,e,r){if(!r)throw new Oe(ce.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function aA(t,e,r,n){if(e===!0&&n===!0)throw new Oe(ce.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function pd(t){if(!be.isDocumentKey(t))throw new Oe(ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function gd(t){if(be.isDocumentKey(t))throw new Oe(ce.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Df(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Le(12329,{type:typeof t})}function yl(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Oe(ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Df(t);throw new Oe(ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wg="firestore.googleapis.com",md=!0;class _d{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Oe(ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Wg,this.ssl=md}else this.host=e.host,this.ssl=(r=e.ssl)!==null&&r!==void 0?r:md;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=xg;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<by)throw new Oe(ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}aA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ug((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Oe(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Oe(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Oe(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class hc{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new _d({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Oe(ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Oe(ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new _d(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new cT;switch(n.type){case"firstParty":return new dT(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Oe(ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=dd.get(r);n&&(Se("ComponentProvider","Removing Datastore"),dd.delete(r),n.terminate())}(this),Promise.resolve()}}function oA(t,e,r,n={}){var i;t=yl(t,hc);const s=sf(e),a=t._getSettings(),o=Object.assign(Object.assign({},a),{emulatorOptions:t._getEmulatorOptions()}),c=`${e}:${r}`;s&&(LE(`https://${c}`),UE("Firestore",!0)),a.host!==Wg&&a.host!==c&&Ds("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u=Object.assign(Object.assign({},a),{host:c,ssl:s,emulatorOptions:n});if(!ll(u,o)&&(t._setSettings(u),n.mockUserToken)){let f,d;if(typeof n.mockUserToken=="string")f=n.mockUserToken,d=dr.MOCK_USER;else{f=ME(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const p=n.mockUserToken.sub||n.mockUserToken.user_id;if(!p)throw new Oe(ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new dr(p)}t._authCredentials=new uT(new D1(f,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Of(this.firestore,e,this._query)}}class Kr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new si(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Kr(this.firestore,e,this._key)}}class si extends Of{constructor(e,r,n){super(e,r,df(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Kr(this.firestore,null,new be(e))}withConverter(e){return new si(this.firestore,e,this._path)}}function lA(t,e,...r){if(t=Na(t),Hg("collection","path",e),t instanceof hc){const n=yt.fromString(e,...r);return gd(n),new si(t,null,n)}{if(!(t instanceof Kr||t instanceof si))throw new Oe(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(yt.fromString(e,...r));return gd(n),new si(t.firestore,null,n)}}function $g(t,e,...r){if(t=Na(t),arguments.length===1&&(e=b1.newId()),Hg("doc","path",e),t instanceof hc){const n=yt.fromString(e,...r);return pd(n),new Kr(t,null,new be(n))}{if(!(t instanceof Kr||t instanceof si))throw new Oe(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(yt.fromString(e,...r));return pd(n),new Kr(t.firestore,t instanceof si?t.converter:null,new be(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vd="AsyncQueue";class xd{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new wg(this,"async_queue_retry"),this.rc=()=>{const n=Gc();n&&Se(vd,"Visibility state changed to "+n.visibilityState),this.x_.b_()},this.sc=e;const r=Gc();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const r=Gc();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const r=new ii;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!Ws(e))throw e;Se(vd,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const r=this.sc.then(()=>(this.ec=!0,e().catch(n=>{throw this.Xu=n,this.ec=!1,Mn("INTERNAL UNHANDLED ERROR: ",Ed(n)),n}).then(n=>(this.ec=!1,n))));return this.sc=r,r}enqueueAfterDelay(e,r,n){this.oc(),this.nc.indexOf(e)>-1&&(r=0);const i=If.createAndSchedule(this,e,r,n,s=>this.uc(s));return this.Zu.push(i),i}oc(){this.Xu&&Le(47125,{cc:Ed(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const r of this.Zu)if(r.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Zu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const r=this.Zu.indexOf(e);this.Zu.splice(r,1)}}function Ed(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class bf extends hc{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new xd,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new xd(e),this._firestoreClient=void 0,await e}}}function cA(t,e){const r=typeof t=="object"?t:Y2(),n=typeof t=="string"?t:hl,i=G2(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=kE("firestore");s&&oA(i,...s)}return i}function jg(t){if(t._terminated)throw new Oe(ce.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||uA(t),t._firestoreClient}function uA(t){var e,r,n;const i=t._freezeSettings(),s=function(o,c,u,f){return new RT(o,c,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,Ug(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new tA(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(o){const c=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ms(lr.fromBase64String(e))}catch(r){throw new Oe(ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Ms(lr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Oe(ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new nr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Oe(ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Oe(ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ke(this._lat,e._lat)||Ke(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fA=/^__.*__$/;class hA{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new zi(e,this.data,this.fieldMask,r,this.fieldTransforms):new eo(e,this.data,r,this.fieldTransforms)}}function zg(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le(40011,{Ic:t})}}class Mf{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.Ec(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new Mf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.dc({path:n,Rc:!1});return i.Vc(e),i}mc(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.dc({path:n,Rc:!1});return i.Ec(),i}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return wl(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(zg(this.Ic)&&fA.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class dA{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||cc(e)}bc(e,r,n,i=!1){return new Mf({Ic:e,methodName:r,wc:n,path:nr.emptyPath(),Rc:!1,yc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function pA(t){const e=t._freezeSettings(),r=cc(t._databaseId);return new dA(t._databaseId,!!e.ignoreUndefinedProperties,r)}function gA(t,e,r,n,i,s={}){const a=t.bc(s.merge||s.mergeFields?2:0,e,r,i);Yg("Data must be an object, but it was:",a,n);const o=qg(n,a);let c,u;if(s.merge)c=new en(a.fieldMask),u=a.fieldTransforms;else if(s.mergeFields){const f=[];for(const d of s.mergeFields){const p=mA(e,d,r);if(!a.contains(p))throw new Oe(ce.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);vA(f,p)||f.push(p)}c=new en(f),u=a.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,u=a.fieldTransforms;return new hA(new jr(o),c,u)}function Kg(t,e){if(Xg(t=Na(t)))return Yg("Unsupported field value:",e,t),qg(t,e);if(t instanceof Gg)return function(n,i){if(!zg(i.Ic))throw i.gc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.gc(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let c=Kg(o,i.fc(a));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=Na(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return JT(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Wt.fromDate(n);return{timestampValue:vl(i.serializer,s)}}if(n instanceof Wt){const s=new Wt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:vl(i.serializer,s)}}if(n instanceof Nf)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Ms)return{bytesValue:hg(i.serializer,n._byteString)};if(n instanceof Kr){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.gc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:_f(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Lf)return function(a,o){return{mapValue:{fields:{[H1]:{stringValue:W1},[dl]:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw o.gc("VectorValues must only contain numeric values.");return pf(o.serializer,u)})}}}}}}(n,i);throw i.gc(`Unsupported field value: ${Df(n)}`)}(t,e)}function qg(t,e){const r={};return N1(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ji(t,(n,i)=>{const s=Kg(i,e.Ac(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function Xg(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Wt||t instanceof Nf||t instanceof Ms||t instanceof Kr||t instanceof Gg||t instanceof Lf)}function Yg(t,e,r){if(!Xg(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=Df(r);throw n==="an object"?e.gc(t+" a custom object"):e.gc(t+" "+n)}}function mA(t,e,r){if((e=Na(e))instanceof kf)return e._internalPath;if(typeof e=="string")return Qg(t,e);throw wl("Field path arguments must be of type string or ",t,!1,void 0,r)}const _A=new RegExp("[~\\*/\\[\\]]");function Qg(t,e,r){if(e.search(_A)>=0)throw wl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new kf(...e.split("."))._internalPath}catch{throw wl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function wl(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(s||a)&&(c+=" (found",s&&(c+=` in field ${n}`),a&&(c+=` in document ${i}`),c+=")"),new Oe(ce.INVALID_ARGUMENT,o+t+c)}function vA(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Kr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new xA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Zg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class xA extends Jg{data(){return super.data()}}function Zg(t,e){return typeof e=="string"?Qg(t,e):e instanceof kf?e._internalPath:e._delegate._internalPath}class EA{convertValue(e,r="none"){switch(hi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Pt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(fi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Le(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return ji(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,i;const s=(i=(n=(r=e.fields)===null||r===void 0?void 0:r[dl].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>Pt(a.doubleValue));return new Lf(s)}convertGeoPoint(e){return new Nf(Pt(e.latitude),Pt(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=rc(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Ba(e));default:return null}}convertTimestamp(e){const r=ui(e);return new Wt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=yt.fromString(e);ot(vg(n),9688,{name:e});const i=new Ua(n.get(1),n.get(3)),s=new be(n.popFirst(5));return i.isEqual(r)||Mn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TA(t,e,r){let n;return n=t?t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class em extends Jg{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new wA(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Zg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class wA extends em{data(e={}){return super.data(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AA(t){t=yl(t,Kr);const e=yl(t.firestore,bf);return sA(jg(e),t._key).then(r=>RA(e,t,r))}class SA extends EA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ms(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Kr(this.firestore,null,r)}}function IA(t,e){const r=yl(t.firestore,bf),n=$g(t),i=TA(t.converter,e);return CA(r,[gA(pA(t.firestore),"addDoc",n._key,i,t.converter!==null,{}).toMutation(n._key,Fn.exists(!1))]).then(()=>n)}function CA(t,e){return function(n,i){const s=new ii;return n.asyncQueue.enqueueAndForget(async()=>Gw(await nA(n),i,s)),s.promise}(jg(t),e)}function RA(t,e,r){const n=r.docs.get(e._key),i=new SA(t);return new em(t,i,e._key,n,new yA(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){Us=i})(X2),ul(new La("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new bf(new fT(n.getProvider("auth-internal")),new pT(a,n.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Oe(ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ua(u.options.projectId,f)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),As(S0,I0,e),As(S0,I0,"esm2017")})();const PA={apiKey:"AIzaSyBvshs7Bqem_j8pk3K_GZv9rhpt5VUR6qw",authDomain:"team-scheduler-5a7e1.firebaseapp.com",projectId:"team-scheduler-5a7e1",storageBucket:"team-scheduler-5a7e1.firebasestorage.app",messagingSenderId:"236438484699",appId:"1:236438484699:web:739868071555e7da563efe"},FA=T1(PA),tm=cA(FA),Al=xr([]),Sl=xr([]),ms=xr(null),Il=xr({}),Vf=xr({}),rm=xr(!1),nm=xr([]),DA=["Söndag","Måndag","Tisdag","Onsdag","Torsdag","Fredag","Lördag","Nästa Söndag"],bu=xr(""),im=xr("");function OA(t){t.trim()&&Al.value.push(t.trim())}function bA(t){t.trim()&&Sl.value.push(t.trim())}function kA(){if(!ms.value||Al.value.length===0){ms.value||(bu.value="Du måste välja antal lag");return}bu.value="";const t=[...Al.value].sort(()=>Math.random()-.5),e={};for(let r=0;r<ms.value;r++)e[`Lag ${r+1}`]=[];t.forEach((r,n)=>{const i=n%ms.value;e[`Lag ${i+1}`].push(r)}),Il.value=e,rm.value=!0,Vf.value={}}async function NA(){if(!ms.value||Sl.value.length===0)return;const t=["Söndag","Måndag","Tisdag","Onsdag","Torsdag","Fredag","Lördag","Söndag"],e=Object.keys(Il.value),r={},n=[];for(const a of t)for(const o of Sl.value)nm.value.some(u=>u.day===a&&u.activity===o)||n.push({day:a,activity:o});const i={};e.forEach(a=>i[a]=[]),n.forEach((a,o)=>{const c=e[o%e.length];i[c].push(a)});for(const a of t){r[a]={};for(const o of e)for(const c of i[o])c.day===a&&(r[a][c.activity]=o)}Vf.value=r;const s=await IA(lA(tm,"schedules"),{schedule:r,teams:Il.value});im.value=`${location.origin}${location.pathname}?schedule=${s.id}`}function Ei(){return{people:Al,activities:Sl,numberOfTeams:ms,teams:Il,schedule:Vf,hasGeneratedTeams:rm,blockedAssignments:nm,days:DA,teamError:bu,shareUrl:im,addPerson:OA,addActivity:bA,generateTeams:kA,generateSchedule:NA}}const LA={class:"space-y-4"},MA={class:"flex gap-2"},VA={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},BA={class:"truncate"},UA=["onClick"],HA=xi({__name:"PeopleInput",setup(t){const{people:e,addPerson:r}=Ei(),n=xr("");function i(){n.value.trim()&&(r(n.value),n.value="")}function s(a){e.value.splice(a,1)}return(a,o)=>(Ye(),Ze("div",LA,[Fe("div",MA,[Oa(Fe("input",{"onUpdate:modelValue":o[0]||(o[0]=c=>n.value=c),onKeyup:d1(i,["enter"]),placeholder:"Ange namn",class:"flex-1 px-3 py-2 rounded-lg bg-gray-300 dark:bg-gray-800 placeholder-gray-400 text-gray-600 dark:text-gray-300 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544),[[rf,n.value]]),Fe("button",{onClick:i,class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg shadow-md transition duration-200"}," Lägg till ")]),Fe("div",VA,[(Ye(!0),Ze(Ut,null,Pn(At(e),(c,u)=>(Ye(),Ze("div",{key:u,class:"bg-gray-300 dark:bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-sm text-gray-600 dark:text-gray-300 shadow-sm flex justify-between items-center"},[Fe("span",BA,zt(c),1),Fe("button",{onClick:f=>s(u),class:"text-red-400 hover:text-red-200 font-bold ml-4"},"×",8,UA)]))),128))])]))}}),WA={class:"space-y-4"},$A={class:"flex gap-2"},jA={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},GA={class:"truncate"},zA=["onClick"],KA=xi({__name:"ActivityInput",setup(t){const{activities:e,addActivity:r}=Ei(),n=xr("");function i(){n.value.trim()&&(r(n.value),n.value="")}function s(a){e.value.splice(a,1)}return(a,o)=>(Ye(),Ze("div",WA,[Fe("div",$A,[Oa(Fe("input",{"onUpdate:modelValue":o[0]||(o[0]=c=>n.value=c),onKeyup:d1(i,["enter"]),placeholder:"Ange aktivitet (Lunch, middag, diska osv.)",class:"flex-1 px-3 py-2 rounded-lg bg-gray-300 dark:bg-gray-800 text-gray-600 dark:text-gray-300 placeholder-gray-400 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-purple-500"},null,544),[[rf,n.value]]),Fe("button",{onClick:i,class:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg shadow-md transition duration-200"}," Lägg till ")]),Fe("div",jA,[(Ye(!0),Ze(Ut,null,Pn(At(e),(c,u)=>(Ye(),Ze("div",{key:u,class:"bg-gray-300 dark:bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-sm text-gray-600 dark:text-gray-300 shadow-sm flex justify-between items-center"},[Fe("span",GA,zt(c),1),Fe("button",{onClick:f=>s(u),class:"text-red-400 hover:text-red-200 font-bold ml-4"},"×",8,zA)]))),128))])]))}}),qA={class:"space-y-2"},XA={key:0,class:"text-red-500 text-sm mt-1"},YA=xi({__name:"TeamSelector",setup(t){const{numberOfTeams:e,teamError:r}=Ei();return(n,i)=>(Ye(),Ze("div",qA,[i[1]||(i[1]=Fe("label",{for:"teams",class:"block text-sm font-medium text-gray-600 dark:text-gray-300"},"Antal lag:",-1)),Oa(Fe("input",{id:"teams",type:"number","onUpdate:modelValue":i[0]||(i[0]=s=>ar(e)?e.value=s:null),min:"1",required:"",class:"w-full px-3 py-2 rounded-lg bg-gray-300 dark:bg-gray-800 text-gray-600 dark:text-gray-300 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-cyan-500"},null,512),[[rf,At(e),void 0,{number:!0}]]),At(r)?(Ye(),Ze("p",XA,zt(At(r)),1)):Mi("",!0)]))}}),QA={class:"flex flex-col items-center gap-6"},JA={key:0,class:"w-full max-w-lg"},ZA={class:"space-y-2"},eS={class:"block text-blue-800 dark:text-blue-300"},tS=["onClick"],rS={class:"text-sm text-gray-600 dark:text-gray-300"},nS=xi({__name:"GenerateButton",setup(t){const{hasGeneratedTeams:e,generateTeams:r,generateSchedule:n,teams:i}=Ei();function s(a){const o=prompt("Ange nytt namn för "+a,a);if(!o||o===a)return;const c={};for(const[u,f]of Object.entries(i.value))c[u===a?o:u]=f;i.value=c}return(a,o)=>(Ye(),Ze("div",QA,[Fe("button",{onClick:o[0]||(o[0]=(...c)=>At(r)&&At(r)(...c)),class:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg shadow-md transition duration-200"}," Generera lag "),At(e)?(Ye(),Ze("div",JA,[o[2]||(o[2]=Fe("h2",{class:"text-xl font-semibold text-center mb-4 text-gray-600 dark:text-gray-300"},"Lag",-1)),Fe("ul",ZA,[(Ye(!0),Ze(Ut,null,Pn(At(i),(c,u)=>(Ye(),Ze("li",{key:u,class:"bg-gray-300 dark:bg-gray-800 p-3 rounded-lg border border-gray-700 relative"},[Fe("strong",eS,zt(u),1),Fe("button",{onClick:f=>s(u),class:"absolute top-2 right-2 text-blue-600 hover:text-blue-400 text-sm underline"},"Byt namn",8,tS),Fe("span",rS,zt(c.join(", ")),1)]))),128))]),Fe("button",{onClick:o[1]||(o[1]=(...c)=>At(n)&&At(n)(...c)),class:"mt-6 w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-6 rounded-lg shadow-md transition duration-200"}," Generera schema ")])):Mi("",!0)]))}});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Cl={};Cl.version="0.18.5";var sm=1252,iS=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],am=function(t){iS.indexOf(t)!=-1&&(sm=t)};function sS(){am(1252)}var ja=function(t){am(t)};function aS(){ja(1200),sS()}var ko=function(e){return String.fromCharCode(e)},Td=function(e){return String.fromCharCode(e)},Rl,Jn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ga(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,c=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),a=(r&3)<<4|n>>4,i=t.charCodeAt(u++),o=(n&15)<<2|i>>6,c=i&63,isNaN(n)?o=c=64:isNaN(i)&&(c=64),e+=Jn.charAt(s)+Jn.charAt(a)+Jn.charAt(o)+Jn.charAt(c);return e}function Bn(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=Jn.indexOf(t.charAt(u++)),a=Jn.indexOf(t.charAt(u++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=Jn.indexOf(t.charAt(u++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),c=Jn.indexOf(t.charAt(u++)),i=(o&3)<<6|c,c!==64&&(e+=String.fromCharCode(i));return e}var nt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Wn=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Hi(t){return nt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function yd(t){return nt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Zr=function(e){return nt?Wn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function dc(t){if(typeof ArrayBuffer>"u")return Zr(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function io(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function oS(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var ir=nt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Wn(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function lS(t){for(var e=[],r=0,n=t.length+250,i=Hi(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Hi(65535),n=65530)}return e.push(i.slice(0,r)),ir(e)}var wa=/\u0000/g,No=/[\u0001-\u0006]/g;function Is(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function tn(t,e){var r=""+t;return r.length>=e?r:Ct("0",e-r.length)+r}function Bf(t,e){var r=""+t;return r.length>=e?r:Ct(" ",e-r.length)+r}function Pl(t,e){var r=""+t;return r.length>=e?r:r+Ct(" ",e-r.length)}function cS(t,e){var r=""+Math.round(t);return r.length>=e?r:Ct("0",e-r.length)+r}function uS(t,e){var r=""+t;return r.length>=e?r:Ct("0",e-r.length)+r}var wd=Math.pow(2,32);function os(t,e){if(t>wd||t<-wd)return cS(t,e);var r=Math.round(t);return uS(r,e)}function Fl(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Ad=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Kc=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function fS(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t}var Rt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Sd={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},hS={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Dl(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,c=1,u=0,f=0,d=Math.floor(i);u<e&&(d=Math.floor(i),o=d*a+s,f=d*u+c,!(i-d<5e-8));)i=1/(i-d),s=a,a=o,c=u,u=f;if(f>e&&(u>e?(f=c,o=s):(f=u,o=a)),!r)return[0,n*o,f];var p=Math.floor(n*o/f);return[p,n*o-p*f,f]}function Lo(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=xS(c,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var om=new Date(1899,11,31,0,0,0),dS=om.getTime(),pS=new Date(1900,2,1,0,0,0);function lm(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=pS&&(r+=24*60*60*1e3),(r-(dS+(t.getTimezoneOffset()-om.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Uf(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function gS(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function mS(t){var e=t<0?12:11,r=Uf(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function _S(t){var e=Uf(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function vS(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=mS(t):e===10?r=t.toFixed(10).substr(0,12):r=_S(t),Uf(gS(r.toUpperCase()))}function ku(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):vS(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return gi(14,lm(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function xS(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function ES(t,e,r,n){var i="",s=0,a=0,o=r.y,c,u=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,u=e.length;break;case 3:return Kc[r.m-1][1];case 5:return Kc[r.m-1][0];default:return Kc[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,u=e.length;break;case 3:return Ad[r.q][0];default:return Ad[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?tn(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=tn(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:c=o,u=1;break}var f=u>0?tn(c,u):"";return f}function Zn(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var cm=/%/g;function TS(t,e,r){var n=e.replace(cm,""),i=e.length-n.length;return Dn(t,n,r*Math.pow(10,2*i))+Ct("%",i)}function yS(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Dn(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function um(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+um(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,f){return c+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var fm=/# (\?+)( ?)\/( ?)(\d+)/;function wS(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Ct(" ",t[1].length+1+t[4].length):Bf(a,t[1].length)+t[2]+"/"+t[3]+tn(o,t[4].length))}function AS(t,e,r){return r+(e===0?"":""+e)+Ct(" ",t[1].length+2+t[4].length)}var hm=/^#*0*\.([0#]+)/,dm=/\).*[0#]/,pm=/\(###\) ###\\?-####/;function yr(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Id(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Cd(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function SS(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function IS(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Wr(t,e,r){if(t.charCodeAt(0)===40&&!e.match(dm)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Wr("n",n,r):"("+Wr("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return yS(t,e,r);if(e.indexOf("%")!==-1)return TS(t,e,r);if(e.indexOf("E")!==-1)return um(e,r);if(e.charCodeAt(0)===36)return"$"+Wr(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,c=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+os(c,e.length);if(e.match(/^[#?]+$/))return i=os(r,0),i==="0"&&(i=""),i.length>e.length?i:yr(e.substr(0,e.length-i.length))+i;if(s=e.match(fm))return wS(s,c,u);if(e.match(/^#+0+$/))return u+os(c,e.length-e.indexOf("0"));if(s=e.match(hm))return i=Id(r,s[1].length).replace(/^([^\.]+)$/,"$1."+yr(s[1])).replace(/\.$/,"."+yr(s[1])).replace(/\.(\d*)$/,function(v,_){return"."+_+Ct("0",yr(s[1]).length-_.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+Id(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Zn(os(c,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Wr(t,e,-r):Zn(""+(Math.floor(r)+SS(r,s[1].length)))+"."+tn(Cd(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Wr(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Is(Wr(t,e.replace(/[\\-]/g,""),r)),a=0,Is(Is(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(pm))return i=Wr(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Dl(c,Math.pow(10,a)-1,!1),i=""+u,f=Dn("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Pl(o[2],a),f.length<s[4].length&&(f=yr(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Dl(c,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Bf(o[1],a)+s[2]+"/"+s[3]+Pl(o[2],a):Ct(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=os(r,0),e.length<=i.length?i:yr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var d=e.indexOf(".")-a,p=e.length-i.length-d;return yr(e.substr(0,d)+i+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=Cd(r,s[1].length),r<0?"-"+Wr(t,e,-r):Zn(IS(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?tn(0,3-v.length):"")+v})+"."+tn(a,s[1].length);switch(e){case"###,##0.00":return Wr(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=Zn(os(c,0));return g!=="0"?u+g:"";case"###,###.00":return Wr(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Wr(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function CS(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Dn(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function RS(t,e,r){var n=e.replace(cm,""),i=e.length-n.length;return Dn(t,n,r*Math.pow(10,2*i))+Ct("%",i)}function gm(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+gm(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,f){return c+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function on(t,e,r){if(t.charCodeAt(0)===40&&!e.match(dm)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?on("n",n,r):"("+on("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return CS(t,e,r);if(e.indexOf("%")!==-1)return RS(t,e,r);if(e.indexOf("E")!==-1)return gm(e,r);if(e.charCodeAt(0)===36)return"$"+on(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,c=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+tn(c,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:yr(e.substr(0,e.length-i.length))+i;if(s=e.match(fm))return AS(s,c,u);if(e.match(/^#+0+$/))return u+tn(c,e.length-e.indexOf("0"));if(s=e.match(hm))return i=(""+r).replace(/^([^\.]+)$/,"$1."+yr(s[1])).replace(/\.$/,"."+yr(s[1])),i=i.replace(/\.(\d*)$/,function(v,_){return"."+_+Ct("0",yr(s[1]).length-_.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Zn(""+c);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+on(t,e,-r):Zn(""+r)+"."+Ct("0",s[1].length);if(s=e.match(/^#,#*,#0/))return on(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Is(on(t,e.replace(/[\\-]/g,""),r)),a=0,Is(Is(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(pm))return i=on(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Dl(c,Math.pow(10,a)-1,!1),i=""+u,f=Dn("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Pl(o[2],a),f.length<s[4].length&&(f=yr(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Dl(c,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Bf(o[1],a)+s[2]+"/"+s[3]+Pl(o[2],a):Ct(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:yr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var d=e.indexOf(".")-a,p=e.length-i.length-d;return yr(e.substr(0,d)+i+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+on(t,e,-r):Zn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?tn(0,3-v.length):"")+v})+"."+tn(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=Zn(""+c);return g!=="0"?u+g:"";default:if(e.match(/\.[0#?]*$/))return on(t,e.slice(0,e.lastIndexOf(".")),r)+yr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Dn(t,e,r){return(r|0)===r?on(t,e,r):Wr(t,e,r)}function PS(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var mm=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function _m(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Fl(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(mm))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function FS(t,e,r,n){for(var i=[],s="",a=0,o="",c="t",u,f,d,p="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Fl(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(d=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(d);i[i.length]={t:"t",v:s},++a;break;case"\\":var g=t.charAt(++a),v=g==="("||g===")"?g:"t";i[i.length]={t:v,v:g},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(u==null&&(u=Lo(e,r,t.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},c=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=Lo(e,r),u==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),i[i.length]={t:o,v:s},c=o;break;case"A":case"a":case"上":var _={t:o,v:o};if(u==null&&(u=Lo(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(_.v=u.H>=12?"P":"A"),_.t="T",p="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(_.v=u.H>=12?"PM":"AM"),_.t="T",a+=5,p="h"):t.substr(a,5).toUpperCase()==="上午/下午"?(u!=null&&(_.v=u.H>=12?"下午":"上午"),_.t="T",a+=5,p="h"):(_.t="t",++a),u==null&&_.t==="T")return"";i[i.length]=_,c=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(mm)){if(u==null&&(u=Lo(e,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",_m(t)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},c=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var E=0,L=0,V;for(a=i.length-1,c="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=p,c="h",E<1&&(E=1);break;case"s":(V=i[a].v.match(/\.0+$/))&&(L=Math.max(L,V[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":c=i[a].t;break;case"m":c==="s"&&(i[a].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[a].v.match(/[Hh]/)&&(E=1),E<2&&i[a].v.match(/[Mm]/)&&(E=2),E<3&&i[a].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var N="",U;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=ES(i[a].t.charCodeAt(0),i[a].v,u,L),i[a].t="t";break;case"n":case"?":for(U=a+1;i[U]!=null&&((o=i[U].t)==="?"||o==="D"||(o===" "||o==="t")&&i[U+1]!=null&&(i[U+1].t==="?"||i[U+1].t==="t"&&i[U+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[U].v==="/"||i[U].v===" "&&i[U+1]!=null&&i[U+1].t=="?"));)i[a].v+=i[U].v,i[U]={v:"",t:";"},++U;N+=i[a].v,a=U-1;break;case"G":i[a].t="t",i[a].v=ku(e,r);break}var re="",ue,w;if(N.length>0){N.charCodeAt(0)==40?(ue=e<0&&N.charCodeAt(0)===45?-e:e,w=Dn("n",N,ue)):(ue=e<0&&n>1?-e:e,w=Dn("n",N,ue),ue<0&&i[0]&&i[0].t=="t"&&(w=w.substr(1),i[0].v="-"+i[0].v)),U=w.length-1;var y=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){y=a;break}var T=i.length;if(y===i.length&&w.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(U>=i[a].v.length-1?(U-=i[a].v.length,i[a].v=w.substr(U+1,i[a].v.length)):U<0?i[a].v="":(i[a].v=w.substr(0,U+1),U=-1),i[a].t="t",T=a);U>=0&&T<i.length&&(i[T].v=w.substr(0,U+1)+i[T].v)}else if(y!==i.length&&w.indexOf("E")===-1){for(U=w.indexOf(".")-1,a=y;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(f=i[a].v.indexOf(".")>-1&&a===y?i[a].v.indexOf(".")-1:i[a].v.length-1,re=i[a].v.substr(f+1);f>=0;--f)U>=0&&(i[a].v.charAt(f)==="0"||i[a].v.charAt(f)==="#")&&(re=w.charAt(U--)+re);i[a].v=re,i[a].t="t",T=a}for(U>=0&&T<i.length&&(i[T].v=w.substr(0,U+1)+i[T].v),U=w.indexOf(".")+1,a=y;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==y)){for(f=i[a].v.indexOf(".")>-1&&a===y?i[a].v.indexOf(".")+1:0,re=i[a].v.substr(0,f);f<i[a].v.length;++f)U<w.length&&(re+=w.charAt(U++));i[a].v=re,i[a].t="t",T=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(ue=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Dn(i[a].t,i[a].v,ue),i[a].t="t");var I="";for(a=0;a!==i.length;++a)i[a]!=null&&(I+=i[a].v);return I}var Rd=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Pd(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function DS(t,e){var r=PS(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Rd),o=r[1].match(Rd);return Pd(e,a)?[n,r[0]]:Pd(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function gi(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Rt)[t],n==null&&(n=r.table&&r.table[Sd[t]]||Rt[Sd[t]]),n==null&&(n=hS[t]||"General");break}if(Fl(n,0))return ku(e,r);e instanceof Date&&(e=lm(e,r.date1904));var i=DS(n,e);if(Fl(i[1]))return ku(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return FS(i[1],e,r,i[0])}function vm(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Rt[r]==null){e<0&&(e=r);continue}if(Rt[r]==t){e=r;break}}e<0&&(e=391)}return Rt[e]=t,e}function pc(t){for(var e=0;e!=392;++e)t[e]!==void 0&&vm(t[e],e)}function gc(){Rt=fS()}var xm=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function OS(t){var e=typeof t=="number"?Rt[t]:t;return e=e.replace(xm,"(\\d+)"),new RegExp("^"+e+"$")}function bS(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,c=-1;(e.match(xm)||[]).forEach(function(d,p){var g=parseInt(r[p+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=g;break;case"d":s=g;break;case"h":a=g;break;case"s":c=g;break;case"m":a>=0?o=g:i=g;break}}),c>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&o==-1&&c==-1?u:n==-1&&i==-1&&s==-1?f:u+"T"+f}var kS=function(){var t={};t.version="1.2.0";function e(){for(var w=0,y=new Array(256),T=0;T!=256;++T)w=T,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,y[T]=w;return typeof Int32Array<"u"?new Int32Array(y):y}var r=e();function n(w){var y=0,T=0,I=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)P[I]=w[I];for(I=0;I!=256;++I)for(T=w[I],y=256+I;y<4096;y+=256)T=P[y]=T>>>8^w[T&255];var k=[];for(I=1;I!=16;++I)k[I-1]=typeof Int32Array<"u"?P.subarray(I*256,I*256+256):P.slice(I*256,I*256+256);return k}var i=n(r),s=i[0],a=i[1],o=i[2],c=i[3],u=i[4],f=i[5],d=i[6],p=i[7],g=i[8],v=i[9],_=i[10],E=i[11],L=i[12],V=i[13],N=i[14];function U(w,y){for(var T=y^-1,I=0,P=w.length;I<P;)T=T>>>8^r[(T^w.charCodeAt(I++))&255];return~T}function re(w,y){for(var T=y^-1,I=w.length-15,P=0;P<I;)T=N[w[P++]^T&255]^V[w[P++]^T>>8&255]^L[w[P++]^T>>16&255]^E[w[P++]^T>>>24]^_[w[P++]]^v[w[P++]]^g[w[P++]]^p[w[P++]]^d[w[P++]]^f[w[P++]]^u[w[P++]]^c[w[P++]]^o[w[P++]]^a[w[P++]]^s[w[P++]]^r[w[P++]];for(I+=15;P<I;)T=T>>>8^r[(T^w[P++])&255];return~T}function ue(w,y){for(var T=y^-1,I=0,P=w.length,k=0,R=0;I<P;)k=w.charCodeAt(I++),k<128?T=T>>>8^r[(T^k)&255]:k<2048?(T=T>>>8^r[(T^(192|k>>6&31))&255],T=T>>>8^r[(T^(128|k&63))&255]):k>=55296&&k<57344?(k=(k&1023)+64,R=w.charCodeAt(I++)&1023,T=T>>>8^r[(T^(240|k>>8&7))&255],T=T>>>8^r[(T^(128|k>>2&63))&255],T=T>>>8^r[(T^(128|R>>6&15|(k&3)<<4))&255],T=T>>>8^r[(T^(128|R&63))&255]):(T=T>>>8^r[(T^(224|k>>12&15))&255],T=T>>>8^r[(T^(128|k>>6&63))&255],T=T>>>8^r[(T^(128|k&63))&255]);return~T}return t.table=r,t.bstr=U,t.buf=re,t.str=ue,t}(),dt=function(){var e={};e.version="1.2.1";function r(x,F){for(var S=x.split("/"),C=F.split("/"),D=0,O=0,q=Math.min(S.length,C.length);D<q;++D){if(O=S[D].length-C[D].length)return O;if(S[D]!=C[D])return S[D]<C[D]?-1:1}return S.length-C.length}function n(x){if(x.charAt(x.length-1)=="/")return x.slice(0,-1).indexOf("/")===-1?x:n(x.slice(0,-1));var F=x.lastIndexOf("/");return F===-1?x:x.slice(0,F+1)}function i(x){if(x.charAt(x.length-1)=="/")return i(x.slice(0,-1));var F=x.lastIndexOf("/");return F===-1?x:x.slice(F+1)}function s(x,F){typeof F=="string"&&(F=new Date(F));var S=F.getHours();S=S<<6|F.getMinutes(),S=S<<5|F.getSeconds()>>>1,x.write_shift(2,S);var C=F.getFullYear()-1980;C=C<<4|F.getMonth()+1,C=C<<5|F.getDate(),x.write_shift(2,C)}function a(x){var F=x.read_shift(2)&65535,S=x.read_shift(2)&65535,C=new Date,D=S&31;S>>>=5;var O=S&15;S>>>=4,C.setMilliseconds(0),C.setFullYear(S+1980),C.setMonth(O-1),C.setDate(D);var q=F&31;F>>>=5;var Z=F&63;return F>>>=6,C.setHours(F),C.setMinutes(Z),C.setSeconds(q<<1),C}function o(x){Mr(x,0);for(var F={},S=0;x.l<=x.length-4;){var C=x.read_shift(2),D=x.read_shift(2),O=x.l+D,q={};switch(C){case 21589:S=x.read_shift(1),S&1&&(q.mtime=x.read_shift(4)),D>5&&(S&2&&(q.atime=x.read_shift(4)),S&4&&(q.ctime=x.read_shift(4))),q.mtime&&(q.mt=new Date(q.mtime*1e3));break}x.l=O,F[C]=q}return F}var c;function u(){return c||(c={})}function f(x,F){if(x[0]==80&&x[1]==75)return Xs(x,F);if((x[0]|32)==109&&(x[1]|32)==105)return ho(x,F);if(x.length<512)throw new Error("CFB file size "+x.length+" < 512");var S=3,C=512,D=0,O=0,q=0,Z=0,X=0,Y=[],Q=x.slice(0,512);Mr(Q,0);var le=d(Q);switch(S=le[0],S){case 3:C=512;break;case 4:C=4096;break;case 0:if(le[1]==0)return Xs(x,F);default:throw new Error("Major Version: Expected 3 or 4 saw "+S)}C!==512&&(Q=x.slice(0,C),Mr(Q,28));var ve=x.slice(0,C);p(Q,S);var ye=Q.read_shift(4,"i");if(S===3&&ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ye);Q.l+=4,q=Q.read_shift(4,"i"),Q.l+=4,Q.chk("00100000","Mini Stream Cutoff Size: "),Z=Q.read_shift(4,"i"),D=Q.read_shift(4,"i"),X=Q.read_shift(4,"i"),O=Q.read_shift(4,"i");for(var de=-1,Te=0;Te<109&&(de=Q.read_shift(4,"i"),!(de<0));++Te)Y[Te]=de;var Be=g(x,C);E(X,O,Be,C,Y);var pt=V(Be,q,Y,C);pt[q].name="!Directory",D>0&&Z!==R&&(pt[Z].name="!MiniFAT"),pt[Y[0]].name="!FAT",pt.fat_addrs=Y,pt.ssz=C;var lt={},Tt=[],yn=[],Si=[];N(q,pt,Be,Tt,D,lt,yn,Z),v(yn,Si,Tt),Tt.shift();var Gn={FileIndex:yn,FullPaths:Si};return F&&F.raw&&(Gn.raw={header:ve,sectors:Be}),Gn}function d(x){if(x[x.l]==80&&x[x.l+1]==75)return[0,0];x.chk($e,"Header Signature: "),x.l+=16;var F=x.read_shift(2,"u");return[x.read_shift(2,"u"),F]}function p(x,F){var S=9;switch(x.l+=2,S=x.read_shift(2)){case 9:if(F!=3)throw new Error("Sector Shift: Expected 9 saw "+S);break;case 12:if(F!=4)throw new Error("Sector Shift: Expected 12 saw "+S);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+S)}x.chk("0600","Mini Sector Shift: "),x.chk("000000000000","Reserved: ")}function g(x,F){for(var S=Math.ceil(x.length/F)-1,C=[],D=1;D<S;++D)C[D-1]=x.slice(D*F,(D+1)*F);return C[S-1]=x.slice(S*F),C}function v(x,F,S){for(var C=0,D=0,O=0,q=0,Z=0,X=S.length,Y=[],Q=[];C<X;++C)Y[C]=Q[C]=C,F[C]=S[C];for(;Z<Q.length;++Z)C=Q[Z],D=x[C].L,O=x[C].R,q=x[C].C,Y[C]===C&&(D!==-1&&Y[D]!==D&&(Y[C]=Y[D]),O!==-1&&Y[O]!==O&&(Y[C]=Y[O])),q!==-1&&(Y[q]=C),D!==-1&&C!=Y[C]&&(Y[D]=Y[C],Q.lastIndexOf(D)<Z&&Q.push(D)),O!==-1&&C!=Y[C]&&(Y[O]=Y[C],Q.lastIndexOf(O)<Z&&Q.push(O));for(C=1;C<X;++C)Y[C]===C&&(O!==-1&&Y[O]!==O?Y[C]=Y[O]:D!==-1&&Y[D]!==D&&(Y[C]=Y[D]));for(C=1;C<X;++C)if(x[C].type!==0){if(Z=C,Z!=Y[Z])do Z=Y[Z],F[C]=F[Z]+"/"+F[C];while(Z!==0&&Y[Z]!==-1&&Z!=Y[Z]);Y[C]=-1}for(F[0]+="/",C=1;C<X;++C)x[C].type!==2&&(F[C]+="/")}function _(x,F,S){for(var C=x.start,D=x.size,O=[],q=C;S&&D>0&&q>=0;)O.push(F.slice(q*k,q*k+k)),D-=k,q=bi(S,q*4);return O.length===0?ee(0):ir(O).slice(0,x.size)}function E(x,F,S,C,D){var O=R;if(x===R){if(F!==0)throw new Error("DIFAT chain shorter than expected")}else if(x!==-1){var q=S[x],Z=(C>>>2)-1;if(!q)return;for(var X=0;X<Z&&(O=bi(q,X*4))!==R;++X)D.push(O);E(bi(q,C-4),F-1,S,C,D)}}function L(x,F,S,C,D){var O=[],q=[];D||(D=[]);var Z=C-1,X=0,Y=0;for(X=F;X>=0;){D[X]=!0,O[O.length]=X,q.push(x[X]);var Q=S[Math.floor(X*4/C)];if(Y=X*4&Z,C<4+Y)throw new Error("FAT boundary crossed: "+X+" 4 "+C);if(!x[Q])break;X=bi(x[Q],Y)}return{nodes:O,data:Md([q])}}function V(x,F,S,C){var D=x.length,O=[],q=[],Z=[],X=[],Y=C-1,Q=0,le=0,ve=0,ye=0;for(Q=0;Q<D;++Q)if(Z=[],ve=Q+F,ve>=D&&(ve-=D),!q[ve]){X=[];var de=[];for(le=ve;le>=0;){de[le]=!0,q[le]=!0,Z[Z.length]=le,X.push(x[le]);var Te=S[Math.floor(le*4/C)];if(ye=le*4&Y,C<4+ye)throw new Error("FAT boundary crossed: "+le+" 4 "+C);if(!x[Te]||(le=bi(x[Te],ye),de[le]))break}O[ve]={nodes:Z,data:Md([X])}}return O}function N(x,F,S,C,D,O,q,Z){for(var X=0,Y=C.length?2:0,Q=F[x].data,le=0,ve=0,ye;le<Q.length;le+=128){var de=Q.slice(le,le+128);Mr(de,64),ve=de.read_shift(2),ye=Gf(de,0,ve-Y),C.push(ye);var Te={name:ye,type:de.read_shift(1),color:de.read_shift(1),L:de.read_shift(4,"i"),R:de.read_shift(4,"i"),C:de.read_shift(4,"i"),clsid:de.read_shift(16),state:de.read_shift(4,"i"),start:0,size:0},Be=de.read_shift(2)+de.read_shift(2)+de.read_shift(2)+de.read_shift(2);Be!==0&&(Te.ct=U(de,de.l-8));var pt=de.read_shift(2)+de.read_shift(2)+de.read_shift(2)+de.read_shift(2);pt!==0&&(Te.mt=U(de,de.l-8)),Te.start=de.read_shift(4,"i"),Te.size=de.read_shift(4,"i"),Te.size<0&&Te.start<0&&(Te.size=Te.type=0,Te.start=R,Te.name=""),Te.type===5?(X=Te.start,D>0&&X!==R&&(F[X].name="!StreamData")):Te.size>=4096?(Te.storage="fat",F[Te.start]===void 0&&(F[Te.start]=L(S,Te.start,F.fat_addrs,F.ssz)),F[Te.start].name=Te.name,Te.content=F[Te.start].data.slice(0,Te.size)):(Te.storage="minifat",Te.size<0?Te.size=0:X!==R&&Te.start!==R&&F[X]&&(Te.content=_(Te,F[X].data,(F[Z]||{}).data))),Te.content&&Mr(Te.content,0),O[ye]=Te,q.push(Te)}}function U(x,F){return new Date((Br(x,F+4)/1e7*Math.pow(2,32)+Br(x,F)/1e7-11644473600)*1e3)}function re(x,F){return u(),f(c.readFileSync(x),F)}function ue(x,F){var S=F&&F.type;switch(S||nt&&Buffer.isBuffer(x)&&(S="buffer"),S||"base64"){case"file":return re(x,F);case"base64":return f(Zr(Bn(x)),F);case"binary":return f(Zr(x),F)}return f(x,F)}function w(x,F){var S=F||{},C=S.root||"Root Entry";if(x.FullPaths||(x.FullPaths=[]),x.FileIndex||(x.FileIndex=[]),x.FullPaths.length!==x.FileIndex.length)throw new Error("inconsistent CFB structure");x.FullPaths.length===0&&(x.FullPaths[0]=C+"/",x.FileIndex[0]={name:C,type:5}),S.CLSID&&(x.FileIndex[0].clsid=S.CLSID),y(x)}function y(x){var F="Sh33tJ5";if(!dt.find(x,"/"+F)){var S=ee(4);S[0]=55,S[1]=S[3]=50,S[2]=54,x.FileIndex.push({name:F,type:2,content:S,size:4,L:69,R:69,C:69}),x.FullPaths.push(x.FullPaths[0]+F),T(x)}}function T(x,F){w(x);for(var S=!1,C=!1,D=x.FullPaths.length-1;D>=0;--D){var O=x.FileIndex[D];switch(O.type){case 0:C?S=!0:(x.FileIndex.pop(),x.FullPaths.pop());break;case 1:case 2:case 5:C=!0,isNaN(O.R*O.L*O.C)&&(S=!0),O.R>-1&&O.L>-1&&O.R==O.L&&(S=!0);break;default:S=!0;break}}if(!(!S&&!F)){var q=new Date(1987,1,19),Z=0,X=Object.create?Object.create(null):{},Y=[];for(D=0;D<x.FullPaths.length;++D)X[x.FullPaths[D]]=!0,x.FileIndex[D].type!==0&&Y.push([x.FullPaths[D],x.FileIndex[D]]);for(D=0;D<Y.length;++D){var Q=n(Y[D][0]);C=X[Q],C||(Y.push([Q,{name:i(Q).replace("/",""),type:1,clsid:Xe,ct:q,mt:q,content:null}]),X[Q]=!0)}for(Y.sort(function(ye,de){return r(ye[0],de[0])}),x.FullPaths=[],x.FileIndex=[],D=0;D<Y.length;++D)x.FullPaths[D]=Y[D][0],x.FileIndex[D]=Y[D][1];for(D=0;D<Y.length;++D){var le=x.FileIndex[D],ve=x.FullPaths[D];if(le.name=i(ve).replace("/",""),le.L=le.R=le.C=-(le.color=1),le.size=le.content?le.content.length:0,le.start=0,le.clsid=le.clsid||Xe,D===0)le.C=Y.length>1?1:-1,le.size=0,le.type=5;else if(ve.slice(-1)=="/"){for(Z=D+1;Z<Y.length&&n(x.FullPaths[Z])!=ve;++Z);for(le.C=Z>=Y.length?-1:Z,Z=D+1;Z<Y.length&&n(x.FullPaths[Z])!=n(ve);++Z);le.R=Z>=Y.length?-1:Z,le.type=1}else n(x.FullPaths[D+1]||"")==n(ve)&&(le.R=D+1),le.type=2}}}function I(x,F){var S=F||{};if(S.fileType=="mad")return Yt(x,S);switch(T(x),S.fileType){case"zip":return Ys(x,S)}var C=function(ye){for(var de=0,Te=0,Be=0;Be<ye.FileIndex.length;++Be){var pt=ye.FileIndex[Be];if(pt.content){var lt=pt.content.length;lt>0&&(lt<4096?de+=lt+63>>6:Te+=lt+511>>9)}}for(var Tt=ye.FullPaths.length+3>>2,yn=de+7>>3,Si=de+127>>7,Gn=yn+Te+Tt+Si,sn=Gn+127>>7,rs=sn<=109?0:Math.ceil((sn-109)/127);Gn+sn+rs+127>>7>sn;)rs=++sn<=109?0:Math.ceil((sn-109)/127);var br=[1,rs,sn,Si,Tt,Te,de,0];return ye.FileIndex[0].size=de<<6,br[7]=(ye.FileIndex[0].start=br[0]+br[1]+br[2]+br[3]+br[4]+br[5])+(br[6]+7>>3),br}(x),D=ee(C[7]<<9),O=0,q=0;{for(O=0;O<8;++O)D.write_shift(1,ke[O]);for(O=0;O<8;++O)D.write_shift(2,0);for(D.write_shift(2,62),D.write_shift(2,3),D.write_shift(2,65534),D.write_shift(2,9),D.write_shift(2,6),O=0;O<3;++O)D.write_shift(2,0);for(D.write_shift(4,0),D.write_shift(4,C[2]),D.write_shift(4,C[0]+C[1]+C[2]+C[3]-1),D.write_shift(4,0),D.write_shift(4,4096),D.write_shift(4,C[3]?C[0]+C[1]+C[2]-1:R),D.write_shift(4,C[3]),D.write_shift(-4,C[1]?C[0]-1:R),D.write_shift(4,C[1]),O=0;O<109;++O)D.write_shift(-4,O<C[2]?C[1]+O:-1)}if(C[1])for(q=0;q<C[1];++q){for(;O<236+q*127;++O)D.write_shift(-4,O<C[2]?C[1]+O:-1);D.write_shift(-4,q===C[1]-1?R:q+1)}var Z=function(ye){for(q+=ye;O<q-1;++O)D.write_shift(-4,O+1);ye&&(++O,D.write_shift(-4,R))};for(q=O=0,q+=C[1];O<q;++O)D.write_shift(-4,Ne.DIFSECT);for(q+=C[2];O<q;++O)D.write_shift(-4,Ne.FATSECT);Z(C[3]),Z(C[4]);for(var X=0,Y=0,Q=x.FileIndex[0];X<x.FileIndex.length;++X)Q=x.FileIndex[X],Q.content&&(Y=Q.content.length,!(Y<4096)&&(Q.start=q,Z(Y+511>>9)));for(Z(C[6]+7>>3);D.l&511;)D.write_shift(-4,Ne.ENDOFCHAIN);for(q=O=0,X=0;X<x.FileIndex.length;++X)Q=x.FileIndex[X],Q.content&&(Y=Q.content.length,!(!Y||Y>=4096)&&(Q.start=q,Z(Y+63>>6)));for(;D.l&511;)D.write_shift(-4,Ne.ENDOFCHAIN);for(O=0;O<C[4]<<2;++O){var le=x.FullPaths[O];if(!le||le.length===0){for(X=0;X<17;++X)D.write_shift(4,0);for(X=0;X<3;++X)D.write_shift(4,-1);for(X=0;X<12;++X)D.write_shift(4,0);continue}Q=x.FileIndex[O],O===0&&(Q.start=Q.size?Q.start-1:R);var ve=O===0&&S.root||Q.name;if(Y=2*(ve.length+1),D.write_shift(64,ve,"utf16le"),D.write_shift(2,Y),D.write_shift(1,Q.type),D.write_shift(1,Q.color),D.write_shift(-4,Q.L),D.write_shift(-4,Q.R),D.write_shift(-4,Q.C),Q.clsid)D.write_shift(16,Q.clsid,"hex");else for(X=0;X<4;++X)D.write_shift(4,0);D.write_shift(4,Q.state||0),D.write_shift(4,0),D.write_shift(4,0),D.write_shift(4,0),D.write_shift(4,0),D.write_shift(4,Q.start),D.write_shift(4,Q.size),D.write_shift(4,0)}for(O=1;O<x.FileIndex.length;++O)if(Q=x.FileIndex[O],Q.size>=4096)if(D.l=Q.start+1<<9,nt&&Buffer.isBuffer(Q.content))Q.content.copy(D,D.l,0,Q.size),D.l+=Q.size+511&-512;else{for(X=0;X<Q.size;++X)D.write_shift(1,Q.content[X]);for(;X&511;++X)D.write_shift(1,0)}for(O=1;O<x.FileIndex.length;++O)if(Q=x.FileIndex[O],Q.size>0&&Q.size<4096)if(nt&&Buffer.isBuffer(Q.content))Q.content.copy(D,D.l,0,Q.size),D.l+=Q.size+63&-64;else{for(X=0;X<Q.size;++X)D.write_shift(1,Q.content[X]);for(;X&63;++X)D.write_shift(1,0)}if(nt)D.l=D.length;else for(;D.l<D.length;)D.write_shift(1,0);return D}function P(x,F){var S=x.FullPaths.map(function(X){return X.toUpperCase()}),C=S.map(function(X){var Y=X.split("/");return Y[Y.length-(X.slice(-1)=="/"?2:1)]}),D=!1;F.charCodeAt(0)===47?(D=!0,F=S[0].slice(0,-1)+F):D=F.indexOf("/")!==-1;var O=F.toUpperCase(),q=D===!0?S.indexOf(O):C.indexOf(O);if(q!==-1)return x.FileIndex[q];var Z=!O.match(No);for(O=O.replace(wa,""),Z&&(O=O.replace(No,"!")),q=0;q<S.length;++q)if((Z?S[q].replace(No,"!"):S[q]).replace(wa,"")==O||(Z?C[q].replace(No,"!"):C[q]).replace(wa,"")==O)return x.FileIndex[q];return null}var k=64,R=-2,$e="d0cf11e0a1b11ae1",ke=[208,207,17,224,161,177,26,225],Xe="00000000000000000000000000000000",Ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:$e,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Xe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function He(x,F,S){u();var C=I(x,S);c.writeFileSync(F,C)}function it(x){for(var F=new Array(x.length),S=0;S<x.length;++S)F[S]=String.fromCharCode(x[S]);return F.join("")}function Ft(x,F){var S=I(x,F);switch(F&&F.type||"buffer"){case"file":return u(),c.writeFileSync(F.filename,S),S;case"binary":return typeof S=="string"?S:it(S);case"base64":return Ga(typeof S=="string"?S:it(S));case"buffer":if(nt)return Buffer.isBuffer(S)?S:Wn(S);case"array":return typeof S=="string"?Zr(S):S}return S}var wt;function M(x){try{var F=x.InflateRaw,S=new F;if(S._processChunk(new Uint8Array([3,0]),S._finishFlushFlag),S.bytesRead)wt=x;else throw new Error("zlib does not expose bytesRead")}catch(C){console.error("cannot use native zlib: "+(C.message||C))}}function G(x,F){if(!wt)return es(x,F);var S=wt.InflateRaw,C=new S,D=C._processChunk(x.slice(x.l),C._finishFlushFlag);return x.l+=C.bytesRead,D}function W(x){return wt?wt.deflateRawSync(x):Dt(x)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],we=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ce(x){var F=(x<<1|x<<11)&139536|(x<<5|x<<15)&558144;return(F>>16|F>>8|F)&255}for(var Ie=typeof Uint8Array<"u",me=Ie?new Uint8Array(256):[],et=0;et<256;++et)me[et]=Ce(et);function b(x,F){var S=me[x&255];return F<=8?S>>>8-F:(S=S<<8|me[x>>8&255],F<=16?S>>>16-F:(S=S<<8|me[x>>16&255],S>>>24-F))}function B(x,F){var S=F&7,C=F>>>3;return(x[C]|(S<=6?0:x[C+1]<<8))>>>S&3}function K(x,F){var S=F&7,C=F>>>3;return(x[C]|(S<=5?0:x[C+1]<<8))>>>S&7}function ae(x,F){var S=F&7,C=F>>>3;return(x[C]|(S<=4?0:x[C+1]<<8))>>>S&15}function te(x,F){var S=F&7,C=F>>>3;return(x[C]|(S<=3?0:x[C+1]<<8))>>>S&31}function z(x,F){var S=F&7,C=F>>>3;return(x[C]|(S<=1?0:x[C+1]<<8))>>>S&127}function pe(x,F,S){var C=F&7,D=F>>>3,O=(1<<S)-1,q=x[D]>>>C;return S<8-C||(q|=x[D+1]<<8-C,S<16-C)||(q|=x[D+2]<<16-C,S<24-C)||(q|=x[D+3]<<24-C),q&O}function he(x,F,S){var C=F&7,D=F>>>3;return C<=5?x[D]|=(S&7)<<C:(x[D]|=S<<C&255,x[D+1]=(S&7)>>8-C),F+3}function fe(x,F,S){var C=F&7,D=F>>>3;return S=(S&1)<<C,x[D]|=S,F+1}function oe(x,F,S){var C=F&7,D=F>>>3;return S<<=C,x[D]|=S&255,S>>>=8,x[D+1]=S,F+8}function Re(x,F,S){var C=F&7,D=F>>>3;return S<<=C,x[D]|=S&255,S>>>=8,x[D+1]=S&255,x[D+2]=S>>>8,F+16}function Ee(x,F){var S=x.length,C=2*S>F?2*S:F+5,D=0;if(S>=F)return x;if(nt){var O=yd(C);if(x.copy)x.copy(O);else for(;D<x.length;++D)O[D]=x[D];return O}else if(Ie){var q=new Uint8Array(C);if(q.set)q.set(x);else for(;D<S;++D)q[D]=x[D];return q}return x.length=C,x}function Ae(x){for(var F=new Array(x),S=0;S<x;++S)F[S]=0;return F}function De(x,F,S){var C=1,D=0,O=0,q=0,Z=0,X=x.length,Y=Ie?new Uint16Array(32):Ae(32);for(O=0;O<32;++O)Y[O]=0;for(O=X;O<S;++O)x[O]=0;X=x.length;var Q=Ie?new Uint16Array(X):Ae(X);for(O=0;O<X;++O)Y[D=x[O]]++,C<D&&(C=D),Q[O]=0;for(Y[0]=0,O=1;O<=C;++O)Y[O+16]=Z=Z+Y[O-1]<<1;for(O=0;O<X;++O)Z=x[O],Z!=0&&(Q[O]=Y[Z+16]++);var le=0;for(O=0;O<X;++O)if(le=x[O],le!=0)for(Z=b(Q[O],C)>>C-le,q=(1<<C+4-le)-1;q>=0;--q)F[Z|q<<le]=le&15|O<<4;return C}var Pe=Ie?new Uint16Array(512):Ae(512),Ve=Ie?new Uint16Array(32):Ae(32);if(!Ie){for(var je=0;je<512;++je)Pe[je]=0;for(je=0;je<32;++je)Ve[je]=0}(function(){for(var x=[],F=0;F<32;F++)x.push(5);De(x,Ve,32);var S=[];for(F=0;F<=143;F++)S.push(8);for(;F<=255;F++)S.push(9);for(;F<=279;F++)S.push(7);for(;F<=287;F++)S.push(8);De(S,Pe,288)})();var jt=function(){for(var F=Ie?new Uint8Array(32768):[],S=0,C=0;S<we.length-1;++S)for(;C<we[S+1];++C)F[C]=S;for(;C<32768;++C)F[C]=29;var D=Ie?new Uint8Array(259):[];for(S=0,C=0;S<ne.length-1;++S)for(;C<ne[S+1];++C)D[C]=S;function O(Z,X){for(var Y=0;Y<Z.length;){var Q=Math.min(65535,Z.length-Y),le=Y+Q==Z.length;for(X.write_shift(1,+le),X.write_shift(2,Q),X.write_shift(2,~Q&65535);Q-- >0;)X[X.l++]=Z[Y++]}return X.l}function q(Z,X){for(var Y=0,Q=0,le=Ie?new Uint16Array(32768):[];Q<Z.length;){var ve=Math.min(65535,Z.length-Q);if(ve<10){for(Y=he(X,Y,+(Q+ve==Z.length)),Y&7&&(Y+=8-(Y&7)),X.l=Y/8|0,X.write_shift(2,ve),X.write_shift(2,~ve&65535);ve-- >0;)X[X.l++]=Z[Q++];Y=X.l*8;continue}Y=he(X,Y,+(Q+ve==Z.length)+2);for(var ye=0;ve-- >0;){var de=Z[Q];ye=(ye<<5^de)&32767;var Te=-1,Be=0;if((Te=le[ye])&&(Te|=Q&-32768,Te>Q&&(Te-=32768),Te<Q))for(;Z[Te+Be]==Z[Q+Be]&&Be<250;)++Be;if(Be>2){de=D[Be],de<=22?Y=oe(X,Y,me[de+1]>>1)-1:(oe(X,Y,3),Y+=5,oe(X,Y,me[de-23]>>5),Y+=3);var pt=de<8?0:de-4>>2;pt>0&&(Re(X,Y,Be-ne[de]),Y+=pt),de=F[Q-Te],Y=oe(X,Y,me[de]>>3),Y-=3;var lt=de<4?0:de-2>>1;lt>0&&(Re(X,Y,Q-Te-we[de]),Y+=lt);for(var Tt=0;Tt<Be;++Tt)le[ye]=Q&32767,ye=(ye<<5^Z[Q])&32767,++Q;ve-=Be-1}else de<=143?de=de+48:Y=fe(X,Y,1),Y=oe(X,Y,me[de]),le[ye]=Q&32767,++Q}Y=oe(X,Y,0)-1}return X.l=(Y+7)/8|0,X.l}return function(X,Y){return X.length<8?O(X,Y):q(X,Y)}}();function Dt(x){var F=ee(50+Math.floor(x.length*1.1)),S=jt(x,F);return F.slice(0,S)}var Er=Ie?new Uint16Array(32768):Ae(32768),Vt=Ie?new Uint16Array(32768):Ae(32768),Xr=Ie?new Uint16Array(128):Ae(128),$n=1,Ot=1;function Cr(x,F){var S=te(x,F)+257;F+=5;var C=te(x,F)+1;F+=5;var D=ae(x,F)+4;F+=4;for(var O=0,q=Ie?new Uint8Array(19):Ae(19),Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],X=1,Y=Ie?new Uint8Array(8):Ae(8),Q=Ie?new Uint8Array(8):Ae(8),le=q.length,ve=0;ve<D;++ve)q[H[ve]]=O=K(x,F),X<O&&(X=O),Y[O]++,F+=3;var ye=0;for(Y[0]=0,ve=1;ve<=X;++ve)Q[ve]=ye=ye+Y[ve-1]<<1;for(ve=0;ve<le;++ve)(ye=q[ve])!=0&&(Z[ve]=Q[ye]++);var de=0;for(ve=0;ve<le;++ve)if(de=q[ve],de!=0){ye=me[Z[ve]]>>8-de;for(var Te=(1<<7-de)-1;Te>=0;--Te)Xr[ye|Te<<de]=de&7|ve<<3}var Be=[];for(X=1;Be.length<S+C;)switch(ye=Xr[z(x,F)],F+=ye&7,ye>>>=3){case 16:for(O=3+B(x,F),F+=2,ye=Be[Be.length-1];O-- >0;)Be.push(ye);break;case 17:for(O=3+K(x,F),F+=3;O-- >0;)Be.push(0);break;case 18:for(O=11+z(x,F),F+=7;O-- >0;)Be.push(0);break;default:Be.push(ye),X<ye&&(X=ye);break}var pt=Be.slice(0,S),lt=Be.slice(S);for(ve=S;ve<286;++ve)pt[ve]=0;for(ve=C;ve<30;++ve)lt[ve]=0;return $n=De(pt,Er,286),Ot=De(lt,Vt,30),F}function Zi(x,F){if(x[0]==3&&!(x[1]&3))return[Hi(F),2];for(var S=0,C=0,D=yd(F||1<<18),O=0,q=D.length>>>0,Z=0,X=0;(C&1)==0;){if(C=K(x,S),S+=3,C>>>1)C>>1==1?(Z=9,X=5):(S=Cr(x,S),Z=$n,X=Ot);else{S&7&&(S+=8-(S&7));var Y=x[S>>>3]|x[(S>>>3)+1]<<8;if(S+=32,Y>0)for(!F&&q<O+Y&&(D=Ee(D,O+Y),q=D.length);Y-- >0;)D[O++]=x[S>>>3],S+=8;continue}for(;;){!F&&q<O+32767&&(D=Ee(D,O+32767),q=D.length);var Q=pe(x,S,Z),le=C>>>1==1?Pe[Q]:Er[Q];if(S+=le&15,le>>>=4,(le>>>8&255)===0)D[O++]=le;else{if(le==256)break;le-=257;var ve=le<8?0:le-4>>2;ve>5&&(ve=0);var ye=O+ne[le];ve>0&&(ye+=pe(x,S,ve),S+=ve),Q=pe(x,S,X),le=C>>>1==1?Ve[Q]:Vt[Q],S+=le&15,le>>>=4;var de=le<4?0:le-2>>1,Te=we[le];for(de>0&&(Te+=pe(x,S,de),S+=de),!F&&q<ye&&(D=Ee(D,ye+100),q=D.length);O<ye;)D[O]=D[O-Te],++O}}}return F?[D,S+7>>>3]:[D.slice(0,O),S+7>>>3]}function es(x,F){var S=x.slice(x.l||0),C=Zi(S,F);return x.l+=C[1],C[0]}function qs(x,F){if(x)typeof console<"u"&&console.error(F);else throw new Error(F)}function Xs(x,F){var S=x;Mr(S,0);var C=[],D=[],O={FileIndex:C,FullPaths:D};w(O,{root:F.root});for(var q=S.length-4;(S[q]!=80||S[q+1]!=75||S[q+2]!=5||S[q+3]!=6)&&q>=0;)--q;S.l=q+4,S.l+=4;var Z=S.read_shift(2);S.l+=6;var X=S.read_shift(4);for(S.l=X,q=0;q<Z;++q){S.l+=20;var Y=S.read_shift(4),Q=S.read_shift(4),le=S.read_shift(2),ve=S.read_shift(2),ye=S.read_shift(2);S.l+=8;var de=S.read_shift(4),Te=o(S.slice(S.l+le,S.l+le+ve));S.l+=le+ve+ye;var Be=S.l;S.l=de+4,yi(S,Y,Q,O,Te),S.l=Be}return O}function yi(x,F,S,C,D){x.l+=2;var O=x.read_shift(2),q=x.read_shift(2),Z=a(x);if(O&8257)throw new Error("Unsupported ZIP encryption");for(var X=x.read_shift(4),Y=x.read_shift(4),Q=x.read_shift(4),le=x.read_shift(2),ve=x.read_shift(2),ye="",de=0;de<le;++de)ye+=String.fromCharCode(x[x.l++]);if(ve){var Te=o(x.slice(x.l,x.l+ve));(Te[21589]||{}).mt&&(Z=Te[21589].mt),((D||{})[21589]||{}).mt&&(Z=D[21589].mt)}x.l+=ve;var Be=x.slice(x.l,x.l+Y);switch(q){case 8:Be=G(x,Q);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+q)}var pt=!1;O&8&&(X=x.read_shift(4),X==134695760&&(X=x.read_shift(4),pt=!0),Y=x.read_shift(4),Q=x.read_shift(4)),Y!=F&&qs(pt,"Bad compressed size: "+F+" != "+Y),Q!=S&&qs(pt,"Bad uncompressed size: "+S+" != "+Q),Tn(C,ye,Be,{unsafe:!0,mt:Z})}function Ys(x,F){var S=F||{},C=[],D=[],O=ee(1),q=S.compression?8:0,Z=0,X=0,Y=0,Q=0,le=0,ve=x.FullPaths[0],ye=ve,de=x.FileIndex[0],Te=[],Be=0;for(X=1;X<x.FullPaths.length;++X)if(ye=x.FullPaths[X].slice(ve.length),de=x.FileIndex[X],!(!de.size||!de.content||ye=="Sh33tJ5")){var pt=Q,lt=ee(ye.length);for(Y=0;Y<ye.length;++Y)lt.write_shift(1,ye.charCodeAt(Y)&127);lt=lt.slice(0,lt.l),Te[le]=kS.buf(de.content,0);var Tt=de.content;q==8&&(Tt=W(Tt)),O=ee(30),O.write_shift(4,67324752),O.write_shift(2,20),O.write_shift(2,Z),O.write_shift(2,q),de.mt?s(O,de.mt):O.write_shift(4,0),O.write_shift(-4,Te[le]),O.write_shift(4,Tt.length),O.write_shift(4,de.content.length),O.write_shift(2,lt.length),O.write_shift(2,0),Q+=O.length,C.push(O),Q+=lt.length,C.push(lt),Q+=Tt.length,C.push(Tt),O=ee(46),O.write_shift(4,33639248),O.write_shift(2,0),O.write_shift(2,20),O.write_shift(2,Z),O.write_shift(2,q),O.write_shift(4,0),O.write_shift(-4,Te[le]),O.write_shift(4,Tt.length),O.write_shift(4,de.content.length),O.write_shift(2,lt.length),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(4,0),O.write_shift(4,pt),Be+=O.l,D.push(O),Be+=lt.length,D.push(lt),++le}return O=ee(22),O.write_shift(4,101010256),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,le),O.write_shift(2,le),O.write_shift(4,Be),O.write_shift(4,Q),O.write_shift(2,0),ir([ir(C),ir(D),O])}var jn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function En(x,F){if(x.ctype)return x.ctype;var S=x.name||"",C=S.match(/\.([^\.]+)$/);return C&&jn[C[1]]||F&&(C=(S=F).match(/[\.\\]([^\.\\])+$/),C&&jn[C[1]])?jn[C[1]]:"application/octet-stream"}function uo(x){for(var F=Ga(x),S=[],C=0;C<F.length;C+=76)S.push(F.slice(C,C+76));return S.join(`\r
`)+`\r
`}function ts(x){var F=x.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Y){var Q=Y.charCodeAt(0).toString(16).toUpperCase();return"="+(Q.length==1?"0"+Q:Q)});F=F.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),F.charAt(0)==`
`&&(F="=0D"+F.slice(1)),F=F.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var S=[],C=F.split(`\r
`),D=0;D<C.length;++D){var O=C[D];if(O.length==0){S.push("");continue}for(var q=0;q<O.length;){var Z=76,X=O.slice(q,q+Z);X.charAt(Z-1)=="="?Z--:X.charAt(Z-2)=="="?Z-=2:X.charAt(Z-3)=="="&&(Z-=3),X=O.slice(q,q+Z),q+=Z,q<O.length&&(X+="="),S.push(X)}}return S.join(`\r
`)}function fo(x){for(var F=[],S=0;S<x.length;++S){for(var C=x[S];S<=x.length&&C.charAt(C.length-1)=="=";)C=C.slice(0,C.length-1)+x[++S];F.push(C)}for(var D=0;D<F.length;++D)F[D]=F[D].replace(/[=][0-9A-Fa-f]{2}/g,function(O){return String.fromCharCode(parseInt(O.slice(1),16))});return Zr(F.join(`\r
`))}function wi(x,F,S){for(var C="",D="",O="",q,Z=0;Z<10;++Z){var X=F[Z];if(!X||X.match(/^\s*$/))break;var Y=X.match(/^(.*?):\s*([^\s].*)$/);if(Y)switch(Y[1].toLowerCase()){case"content-location":C=Y[2].trim();break;case"content-type":O=Y[2].trim();break;case"content-transfer-encoding":D=Y[2].trim();break}}switch(++Z,D.toLowerCase()){case"base64":q=Zr(Bn(F.slice(Z).join("")));break;case"quoted-printable":q=fo(F.slice(Z));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+D)}var Q=Tn(x,C.slice(S.length),q,{unsafe:!0});O&&(Q.ctype=O)}function ho(x,F){if(it(x.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var S=F&&F.root||"",C=(nt&&Buffer.isBuffer(x)?x.toString("binary"):it(x)).split(`\r
`),D=0,O="";for(D=0;D<C.length;++D)if(O=C[D],!!/^Content-Location:/i.test(O)&&(O=O.slice(O.indexOf("file")),S||(S=O.slice(0,O.lastIndexOf("/")+1)),O.slice(0,S.length)!=S))for(;S.length>0&&(S=S.slice(0,S.length-1),S=S.slice(0,S.lastIndexOf("/")+1),O.slice(0,S.length)!=S););var q=(C[1]||"").match(/boundary="(.*?)"/);if(!q)throw new Error("MAD cannot find boundary");var Z="--"+(q[1]||""),X=[],Y=[],Q={FileIndex:X,FullPaths:Y};w(Q);var le,ve=0;for(D=0;D<C.length;++D){var ye=C[D];ye!==Z&&ye!==Z+"--"||(ve++&&wi(Q,C.slice(le,D),S),le=D)}return Q}function Yt(x,F){var S=F||{},C=S.boundary||"SheetJS";C="------="+C;for(var D=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+C.slice(2)+'"',"","",""],O=x.FullPaths[0],q=O,Z=x.FileIndex[0],X=1;X<x.FullPaths.length;++X)if(q=x.FullPaths[X].slice(O.length),Z=x.FileIndex[X],!(!Z.size||!Z.content||q=="Sh33tJ5")){q=q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Be){return"_x"+Be.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Be){return"_u"+Be.charCodeAt(0).toString(16)+"_"});for(var Y=Z.content,Q=nt&&Buffer.isBuffer(Y)?Y.toString("binary"):it(Y),le=0,ve=Math.min(1024,Q.length),ye=0,de=0;de<=ve;++de)(ye=Q.charCodeAt(de))>=32&&ye<128&&++le;var Te=le>=ve*4/5;D.push(C),D.push("Content-Location: "+(S.root||"file:///C:/SheetJS/")+q),D.push("Content-Transfer-Encoding: "+(Te?"quoted-printable":"base64")),D.push("Content-Type: "+En(Z,q)),D.push(""),D.push(Te?ts(Q):uo(Q))}return D.push(C+`--\r
`),D.join(`\r
`)}function po(x){var F={};return w(F,x),F}function Tn(x,F,S,C){var D=C&&C.unsafe;D||w(x);var O=!D&&dt.find(x,F);if(!O){var q=x.FullPaths[0];F.slice(0,q.length)==q?q=F:(q.slice(-1)!="/"&&(q+="/"),q=(q+F).replace("//","/")),O={name:i(F),type:2},x.FileIndex.push(O),x.FullPaths.push(q),D||dt.utils.cfb_gc(x)}return O.content=S,O.size=S?S.length:0,C&&(C.CLSID&&(O.clsid=C.CLSID),C.mt&&(O.mt=C.mt),C.ct&&(O.ct=C.ct)),O}function Ai(x,F){w(x);var S=dt.find(x,F);if(S){for(var C=0;C<x.FileIndex.length;++C)if(x.FileIndex[C]==S)return x.FileIndex.splice(C,1),x.FullPaths.splice(C,1),!0}return!1}function Tc(x,F,S){w(x);var C=dt.find(x,F);if(C){for(var D=0;D<x.FileIndex.length;++D)if(x.FileIndex[D]==C)return x.FileIndex[D].name=i(S),x.FullPaths[D]=S,!0}return!1}function yc(x){T(x,!0)}return e.find=P,e.read=ue,e.parse=f,e.write=Ft,e.writeFile=He,e.utils={cfb_new:po,cfb_add:Tn,cfb_del:Ai,cfb_mov:Tc,cfb_gc:yc,ReadShift:Sa,CheckField:Mm,prep_blob:Mr,bconcat:ir,use_zlib:M,_deflateRaw:Dt,_inflateRaw:es,consts:Ne},e}();function NS(t){return typeof t=="string"?dc(t):Array.isArray(t)?oS(t):t}function so(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=dc(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Ka(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([NS(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=io(e)),o.write(e),o.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function cr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Fd(t,e){for(var r=[],n=cr(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function Hf(t){for(var e=[],r=cr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function mc(t){for(var e=[],r=cr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function LS(t){for(var e=[],r=cr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Ol=new Date(1899,11,30,0,0,0);function Dr(t,e){var r=t.getTime(),n=Ol.getTime()+(t.getTimezoneOffset()-Ol.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Em=new Date,MS=Ol.getTime()+(Em.getTimezoneOffset()-Ol.getTimezoneOffset())*6e4,Dd=Em.getTimezoneOffset();function Tm(t){var e=new Date;return e.setTime(t*24*60*60*1e3+MS),e.getTimezoneOffset()!==Dd&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Dd)*6e4),e}var Od=new Date("2017-02-19T19:06:09.000Z"),ym=isNaN(Od.getFullYear())?new Date("2/19/17"):Od,VS=ym.getFullYear()==2017;function Ir(t,e){var r=new Date(t);if(VS)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(ym.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function _c(t,e){if(nt&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Or(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Or(t[r]));return e}function Ct(t,e){for(var r="";r.length<e;)r+=t;return r}function On(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var BS=["january","february","march","april","may","june","july","august","september","october","november","december"];function za(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&BS.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}function ze(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return nt?n=Wn(r):n=lS(r),dt.utils.cfb_add(t,e,n)}dt.utils.cfb_add(t,e,r)}else t.file(e,r)}function Wf(){return dt.utils.cfb_new()}var Mt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,US={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},$f=Hf(US),jf=/[&<>'"]/g,HS=/[\u0000-\u0008\u000b-\u001f]/g;function ft(t){var e=t+"";return e.replace(jf,function(r){return $f[r]}).replace(HS,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function bd(t){return ft(t).replace(/ /g,"_x0020_")}var wm=/[\u0000-\u001f]/g;function WS(t){var e=t+"";return e.replace(jf,function(r){return $f[r]}).replace(/\n/g,"<br/>").replace(wm,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function $S(t){var e=t+"";return e.replace(jf,function(r){return $f[r]}).replace(wm,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function jS(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function GS(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function qc(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function kd(t){var e=Hi(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function Nd(t){return Wn(t,"binary").toString("utf8")}var Mo="foo bar bazâð£",Aa=nt&&(Nd(Mo)==qc(Mo)&&Nd||kd(Mo)==qc(Mo)&&kd)||qc,Ka=nt?function(t){return Wn(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},zS=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),Am=/(^\s|\s$|\n)/;function sr(t,e){return"<"+t+(e.match(Am)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function qa(t){return cr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function ge(t,e,r){return"<"+t+(r!=null?qa(r):"")+(e!=null?(e.match(Am)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Nu(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function KS(t,e){switch(typeof t){case"string":var r=ge("vt:lpwstr",ft(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ge((t|0)==t?"vt:i4":"vt:r8",ft(String(t)));case"boolean":return ge("vt:bool",t?"true":"false")}if(t instanceof Date)return ge("vt:filetime",Nu(t));throw new Error("Unable to serialize "+t)}var Kt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},js=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Vr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function qS(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function XS(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var Ld=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},Md=nt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Wn(e)})):Ld(t)}:Ld,Vd=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(fa(t,i)));return n.join("").replace(wa,"")},Gf=nt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(wa,""):Vd(t,e,r)}:Vd,Bd=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},Sm=nt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Bd(t,e,r)}:Bd,Ud=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(gs(t,i)));return n.join("")},ao=nt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):Ud(e,r,n)}:Ud,Im=function(t,e){var r=Br(t,e);return r>0?ao(t,e+4,e+4+r-1):""},Cm=Im,Rm=function(t,e){var r=Br(t,e);return r>0?ao(t,e+4,e+4+r-1):""},Pm=Rm,Fm=function(t,e){var r=2*Br(t,e);return r>0?ao(t,e+4,e+4+r-1):""},Dm=Fm,Om=function(e,r){var n=Br(e,r);return n>0?Gf(e,r+4,r+4+n):""},bm=Om,km=function(t,e){var r=Br(t,e);return r>0?ao(t,e+4,e+4+r):""},Nm=km,Lm=function(t,e){return qS(t,e)},bl=Lm,zf=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};nt&&(Cm=function(e,r){if(!Buffer.isBuffer(e))return Im(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Pm=function(e,r){if(!Buffer.isBuffer(e))return Rm(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Dm=function(e,r){if(!Buffer.isBuffer(e))return Fm(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},bm=function(e,r){if(!Buffer.isBuffer(e))return Om(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},Nm=function(e,r){if(!Buffer.isBuffer(e))return km(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},bl=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):Lm(e,r)},zf=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var gs=function(t,e){return t[e]},fa=function(t,e){return t[e+1]*256+t[e]},YS=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Br=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},bi=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},QS=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Sa(t,e){var r="",n,i,s=[],a,o,c,u;switch(e){case"dbcs":if(u=this.l,nt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(fa(this,u)),u+=2;t*=2;break;case"utf8":r=ao(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Gf(this,this.l,this.l+t);break;case"wstr":return Sa.call(this,t,"dbcs");case"lpstr-ansi":r=Cm(this,this.l),t=4+Br(this,this.l);break;case"lpstr-cp":r=Pm(this,this.l),t=4+Br(this,this.l);break;case"lpwstr":r=Dm(this,this.l),t=4+2*Br(this,this.l);break;case"lpp4":t=4+Br(this,this.l),r=bm(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Br(this,this.l),r=Nm(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=gs(this,this.l+t++))!==0;)s.push(ko(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=fa(this,this.l+t))!==0;)s.push(ko(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return a=gs(this,u),this.l=u+1,o=Sa.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(ko(fa(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return a=gs(this,u),this.l=u+1,o=Sa.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(ko(gs(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=gs(this,this.l),this.l++,n;case 2:return n=(e==="i"?YS:fa)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?bi:QS)(this,this.l),this.l+=4,n):(i=Br(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=bl(this,this.l):i=bl([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=Sm(this,this.l,t);break}}return this.l+=t,r}var JS=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},ZS=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},e4=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function t4(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)e4(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,JS(this,e,this.l);break;case 8:if(n=8,r==="f"){XS(this,e,this.l);break}case 16:break;case-4:n=4,ZS(this,e,this.l);break}return this.l+=n,this}function Mm(t,e){var r=Sm(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Mr(t,e){t.l=e,t.read_shift=Sa,t.chk=Mm,t.write_shift=t4}function xn(t,e){t.l+=e}function ee(t){var e=Hi(t);return Mr(e,0),e}function Fr(){var t=[],e=nt?256:2048,r=function(u){var f=ee(u);return Mr(f,0),f},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,e)))},a=function(){return i(),ir(t)},o=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function se(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=qP[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&zf(r)&&t.push(r)}}function Ia(t,e,r){var n=Or(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Hd(t,e,r){var n=Or(t);return n.s=Ia(n.s,e.s,r),n.e=Ia(n.e,e.s,r),n}function Ca(t,e){if(t.cRel&&t.c<0)for(t=Or(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Or(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ht(t);return!t.cRel&&t.cRel!=null&&(r=i4(r)),!t.rRel&&t.rRel!=null&&(r=r4(r)),r}function Xc(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+mr(t.s.c)+":"+(t.e.cRel?"":"$")+mr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+or(t.s.r)+":"+(t.e.rRel?"":"$")+or(t.e.r):Ca(t.s,e.biff)+":"+Ca(t.e,e.biff)}function Kf(t){return parseInt(n4(t),10)-1}function or(t){return""+(t+1)}function r4(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function n4(t){return t.replace(/\$(\d+)$/,"$1")}function qf(t){for(var e=s4(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function mr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function i4(t){return t.replace(/^([A-Z])/,"$$$1")}function s4(t){return t.replace(/^\$([A-Z])/,"$1")}function a4(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function qt(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function ht(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Hr(t){var e=t.indexOf(":");return e==-1?{s:qt(t),e:qt(t)}:{s:qt(t.slice(0,e)),e:qt(t.slice(e+1))}}function Nt(t,e){return typeof e>"u"||typeof e=="number"?Nt(t.s,t.e):(typeof t!="string"&&(t=ht(t)),typeof e!="string"&&(e=ht(e)),t==e?t:t+":"+e)}function Et(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function Wd(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=gi(t.z,r?Dr(e):e)}catch{}try{return t.w=gi((t.XF||{}).numFmtId||(r?14:0),r?Dr(e):e)}catch{return""+e}}function Un(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?oo[t.v]||t.v:e==null?Wd(t,t.v):Wd(t,e))}function qi(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function Vm(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?qt(n.origin):n.origin;a=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=Et(s["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(u.e.r=a=f.e.r+1)}for(var d=0;d!=e.length;++d)if(e[d]){if(!Array.isArray(e[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=e[d].length;++p)if(!(typeof e[d][p]>"u")){var g={v:e[d][p]},v=a+d,_=o+p;if(u.s.r>v&&(u.s.r=v),u.s.c>_&&(u.s.c=_),u.e.r<v&&(u.e.r=v),u.e.c<_&&(u.e.c=_),e[d][p]&&typeof e[d][p]=="object"&&!Array.isArray(e[d][p])&&!(e[d][p]instanceof Date))g=e[d][p];else if(Array.isArray(g.v)&&(g.f=e[d][p][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||Rt[14],n.cellDates?(g.t="d",g.w=gi(g.z,Dr(g.v))):(g.t="n",g.v=Dr(g.v),g.w=gi(g.z,g.v))):g.t="s";if(i)s[v]||(s[v]=[]),s[v][_]&&s[v][_].z&&(g.z=s[v][_].z),s[v][_]=g;else{var E=ht({c:_,r:v});s[E]&&s[E].z&&(g.z=s[E].z),s[E]=g}}}return u.s.c<1e7&&(s["!ref"]=Nt(u)),s}function Gs(t,e){return Vm(null,t,e)}function o4(t){return t.read_shift(4,"i")}function nn(t,e){return e||(e=ee(4)),e.write_shift(4,t),e}function _r(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Xt(t,e){var r=!1;return e==null&&(r=!0,e=ee(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function l4(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function c4(t,e){return e||(e=ee(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Xf(t,e){var r=t.l,n=t.read_shift(1),i=_r(t),s=[],a={t:i,h:i};if((n&1)!==0){for(var o=t.read_shift(4),c=0;c!=o;++c)s.push(l4(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function u4(t,e){var r=!1;return e==null&&(r=!0,e=ee(15+4*t.t.length)),e.write_shift(1,0),Xt(t.t,e),r?e.slice(0,e.l):e}var f4=Xf;function h4(t,e){var r=!1;return e==null&&(r=!0,e=ee(23+4*t.t.length)),e.write_shift(1,1),Xt(t.t,e),e.write_shift(4,1),c4({},e),r?e.slice(0,e.l):e}function qr(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Xi(t,e){return e==null&&(e=ee(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Yi(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Qi(t,e){return e==null&&(e=ee(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var d4=_r,Bm=Xt;function Yf(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function kl(t,e){var r=!1;return e==null&&(r=!0,e=ee(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var p4=_r,Lu=Yf,Qf=kl;function Um(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?bl([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):bi(e,0)>>2;return r?i/100:i}function Hm(t,e){e==null&&(e=ee(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function Wm(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function g4(t,e){return e||(e=ee(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Ji=Wm,zs=g4;function Ks(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Wi(t,e){return(e||ee(8)).write_shift(8,t,"f")}function m4(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var u=S4[i];u&&(e.rgb=Zd(u));break;case 2:e.rgb=Zd([a,o,c]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Nl(t,e){if(e||(e=ee(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function _4(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function v4(t,e){e||(e=ee(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}var $m=2,Lr=3,Vo=11,Ll=19,Bo=64,x4=65,E4=71,T4=4108,y4=4126,Zt=80,$d={1:{n:"CodePage",t:$m},2:{n:"Category",t:Zt},3:{n:"PresentationFormat",t:Zt},4:{n:"ByteCount",t:Lr},5:{n:"LineCount",t:Lr},6:{n:"ParagraphCount",t:Lr},7:{n:"SlideCount",t:Lr},8:{n:"NoteCount",t:Lr},9:{n:"HiddenCount",t:Lr},10:{n:"MultimediaClipCount",t:Lr},11:{n:"ScaleCrop",t:Vo},12:{n:"HeadingPairs",t:T4},13:{n:"TitlesOfParts",t:y4},14:{n:"Manager",t:Zt},15:{n:"Company",t:Zt},16:{n:"LinksUpToDate",t:Vo},17:{n:"CharacterCount",t:Lr},19:{n:"SharedDoc",t:Vo},22:{n:"HyperlinksChanged",t:Vo},23:{n:"AppVersion",t:Lr,p:"version"},24:{n:"DigSig",t:x4},26:{n:"ContentType",t:Zt},27:{n:"ContentStatus",t:Zt},28:{n:"Language",t:Zt},29:{n:"Version",t:Zt},255:{},2147483648:{n:"Locale",t:Ll},2147483651:{n:"Behavior",t:Ll},1919054434:{}},jd={1:{n:"CodePage",t:$m},2:{n:"Title",t:Zt},3:{n:"Subject",t:Zt},4:{n:"Author",t:Zt},5:{n:"Keywords",t:Zt},6:{n:"Comments",t:Zt},7:{n:"Template",t:Zt},8:{n:"LastAuthor",t:Zt},9:{n:"RevNumber",t:Zt},10:{n:"EditTime",t:Bo},11:{n:"LastPrinted",t:Bo},12:{n:"CreatedDate",t:Bo},13:{n:"ModifiedDate",t:Bo},14:{n:"PageCount",t:Lr},15:{n:"WordCount",t:Lr},16:{n:"CharCount",t:Lr},17:{n:"Thumbnail",t:E4},18:{n:"Application",t:Zt},19:{n:"DocSecurity",t:Lr},255:{},2147483648:{n:"Locale",t:Ll},2147483651:{n:"Behavior",t:Ll},1919054434:{}};function w4(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var A4=w4([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),S4=Or(A4),oo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},I4={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Uo={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function jm(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Gm(t,e){var r=LS(I4),n=[],i;n[n.length]=Mt,n[n.length]=ge("Types",null,{xmlns:Kt.CT,"xmlns:xsd":Kt.xsd,"xmlns:xsi":Kt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ge("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){t[c]&&t[c].length>0&&(i=t[c][0],n[n.length]=ge("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Uo[c][e.bookType]||Uo[c].xlsx}))},a=function(c){(t[c]||[]).forEach(function(u){n[n.length]=ge("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Uo[c][e.bookType]||Uo[c].xlsx})})},o=function(c){(t[c]||[]).forEach(function(u){n[n.length]=ge("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var rt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function zm(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Cs(t){var e=[Mt,ge("Relationships",null,{xmlns:Kt.RELS})];return cr(t["!id"]).forEach(function(r){e[e.length]=ge("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function ut(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[rt.HLINK,rt.XPATH,rt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}function C4(t){var e=[Mt];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Gd(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function R4(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function P4(t){var e=[Mt];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(Gd(t[r][0],t[r][1])),e.push(R4("",t[r][0]));return e.push(Gd("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function Km(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Cl.version+"</meta:generator></office:meta></office:document-meta>"}var Vi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Yc(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=ft(e),n[n.length]=r?ge(t,e,r):sr(t,e))}function qm(t,e){var r=e||{},n=[Mt,ge("cp:coreProperties",null,{"xmlns:cp":Kt.CORE_PROPS,"xmlns:dc":Kt.dc,"xmlns:dcterms":Kt.dcterms,"xmlns:dcmitype":Kt.dcmitype,"xmlns:xsi":Kt.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Yc("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Nu(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&Yc("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Nu(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Vi.length;++s){var a=Vi[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Yc(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Rs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Xm=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Ym(t){var e=[],r=ge;return t||(t={}),t.Application="SheetJS",e[e.length]=Mt,e[e.length]=ge("Properties",null,{xmlns:Kt.EXT_PROPS,"xmlns:vt":Kt.vt}),Rs.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=ft(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+ft(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function Qm(t){var e=[Mt,ge("Properties",null,{xmlns:Kt.CUST_PROPS,"xmlns:vt":Kt.vt})];if(!t)return e.join("");var r=1;return cr(t).forEach(function(i){++r,e[e.length]=ge("property",KS(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ft(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var zd={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function F4(t,e){var r=[];return cr(zd).map(function(n){for(var i=0;i<Vi.length;++i)if(Vi[i][1]==n)return Vi[i];for(i=0;i<Rs.length;++i)if(Rs[i][1]==n)return Rs[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(sr(zd[n[1]]||n[1],i))}}),ge("DocumentProperties",r.join(""),{xmlns:Vr.o})}function D4(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&cr(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<Vi.length;++a)if(s==Vi[a][1])return;for(a=0;a<Rs.length;++a)if(s==Rs[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),i.push(ge(bd(s),o,{"dt:dt":c}))}}),e&&cr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(ge(bd(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Vr.o+'">'+i.join("")+"</"+n+">"}function O4(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=ee(8);return a.write_shift(4,n),a.write_shift(4,i),a}function Kd(t,e){var r=ee(4),n=ee(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ee(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=O4(e);break;case 31:case 80:for(n=ee(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return ir([r,n])}var Jm=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function b4(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function qd(t,e,r){var n=ee(8),i=[],s=[],a=8,o=0,c=ee(8),u=ee(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),i.push(u),a+=8+c.length,!e){u=ee(8),u.write_shift(4,0),i.unshift(u);var f=[ee(4)];for(f[0].write_shift(4,t.length),o=0;o<t.length;++o){var d=t[o][0];for(c=ee(8+2*(d.length+1)+(d.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,d.length+1),c.write_shift(0,d,"dbcs");c.l!=c.length;)c.write_shift(1,0);f.push(c)}c=ir(f),s.unshift(c),a+=8+c.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(Jm.indexOf(t[o][0])>-1||Xm.indexOf(t[o][0])>-1)&&t[o][1]!=null){var p=t[o][1],g=0;if(e){g=+e[t[o][0]];var v=r[g];if(v.p=="version"&&typeof p=="string"){var _=p.split(".");p=(+_[0]<<16)+(+_[1]||0)}c=Kd(v.t,p)}else{var E=b4(p);E==-1&&(E=31,p=String(p)),c=Kd(E,p)}s.push(c),u=ee(8),u.write_shift(4,e?g:2+o),i.push(u),a+=8+c.length}var L=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,L),L+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),ir([n].concat(i).concat(s))}function Xd(t,e,r,n,i,s){var a=ee(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,dt.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var c=qd(t,r,n);if(o.push(c),i){var u=qd(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+c.length),o.push(u)}return ir(o)}function k4(t,e){e||(e=ee(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function N4(t,e){return t.read_shift(e)===1}function wr(t,e){return e||(e=ee(2)),e.write_shift(2,+!!t),e}function Zm(t){return t.read_shift(2,"u")}function $r(t,e){return e||(e=ee(2)),e.write_shift(2,t),e}function e_(t,e,r){return r||(r=ee(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function t_(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function L4(t){var e=t.t||"",r=ee(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=ee(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return ir(i)}function M4(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function V4(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):M4(t,n,r)}function B4(t,e,r){if(r.biff>5)return V4(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function r_(t,e,r){return r||(r=ee(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function Yd(t,e){e||(e=ee(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function U4(t){var e=ee(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),Yd(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&Yd(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)e.write_shift(1,n.charCodeAt(r+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function $i(t,e,r,n){return n||(n=ee(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function H4(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function W4(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function n_(t,e){return e||(e=ee(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function Jf(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ee(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function $4(t,e){var r=!e||e.biff==8,n=ee(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function j4(t,e){var r=!e||e.biff>=8?2:1,n=ee(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function G4(t,e){var r=ee(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=L4(t[i]);var s=ir([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function z4(){var t=ee(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function K4(t){var e=ee(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function q4(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=ee(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function X4(t,e,r,n){var i=ee(10);return $i(t,e,n,i),i.write_shift(4,r),i}function Y4(t,e,r,n,i){var s=!i||i.biff==8,a=ee(8+ +s+(1+s)*r.length);return $i(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function Q4(t,e,r,n){var i=r&&r.biff==5;n||(n=ee(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function J4(t,e){var r=e.biff==8||!e.biff?4:2,n=ee(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function Qd(t,e,r,n){var i=r&&r.biff==5;n||(n=ee(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function Z4(t){var e=ee(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function eI(t,e,r,n,i,s){var a=ee(8);return $i(t,e,n,a),e_(r,s,a),a}function tI(t,e,r,n){var i=ee(14);return $i(t,e,n,i),Wi(r,i),i}function rI(t,e,r){if(r.biff<8)return nI(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(H4(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function nI(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=t_(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function iI(t){var e=ee(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)n_(t[r],e);return e}function sI(t){var e=ee(24),r=qt(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return ir([e,U4(t[1])])}function aI(t){var e=t[1].Tooltip,r=ee(10+2*(e.length+1));r.write_shift(2,2048);var n=qt(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function oI(t){return t||(t=ee(4)),t.write_shift(2,1),t.write_shift(2,1),t}function lI(t,e,r){if(!r.cellStyles)return xn(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function cI(t,e){var r=ee(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function uI(t){for(var e=ee(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}function fI(t,e,r){var n=ee(15);return co(n,t,e),n.write_shift(8,r,"f"),n}function hI(t,e,r){var n=ee(9);return co(n,t,e),n.write_shift(2,r),n}var dI=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Hf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],f=Hi(1);switch(c.type){case"base64":f=Zr(Bn(o));break;case"binary":f=Zr(o);break;case"buffer":case"array":f=o;break}Mr(f,0);var d=f.read_shift(1),p=!!(d&136),g=!1,v=!1;switch(d){case 2:break;case 3:break;case 48:g=!0,p=!0;break;case 49:g=!0,p=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var _=0,E=521;d==2&&(_=f.read_shift(2)),f.l+=3,d!=2&&(_=f.read_shift(4)),_>1048576&&(_=1e6),d!=2&&(E=f.read_shift(2));var L=f.read_shift(2),V=c.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(V=t[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var N=[],U={},re=Math.min(f.length,d==2?521:E-10-(g?264:0)),ue=v?32:11;f.l<re&&f[f.l]!=13;)switch(U={},U.name=Rl.utils.decode(V,f.slice(f.l,f.l+ue)).replace(/[\u0000\r\n].*$/g,""),f.l+=ue,U.type=String.fromCharCode(f.read_shift(1)),d!=2&&!v&&(U.offset=f.read_shift(4)),U.len=f.read_shift(1),d==2&&(U.offset=f.read_shift(2)),U.dec=f.read_shift(1),U.name.length&&N.push(U),d!=2&&(f.l+=v?13:14),U.type){case"B":(!g||U.len!=8)&&c.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+U.type)}if(f[f.l]!==13&&(f.l=E-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=E;var w=0,y=0;for(u[0]=[],y=0;y!=N.length;++y)u[0][y]=N[y].name;for(;_-- >0;){if(f[f.l]===42){f.l+=L;continue}for(++f.l,u[++w]=[],y=0,y=0;y!=N.length;++y){var T=f.slice(f.l,f.l+N[y].len);f.l+=N[y].len,Mr(T,0);var I=Rl.utils.decode(V,T);switch(N[y].type){case"C":I.trim().length&&(u[w][y]=I.replace(/\s+$/,""));break;case"D":I.length===8?u[w][y]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):u[w][y]=I;break;case"F":u[w][y]=parseFloat(I.trim());break;case"+":case"I":u[w][y]=v?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":u[w][y]=!0;break;case"N":case"F":u[w][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[w][y]="##MEMO##"+(v?parseInt(I.trim(),10):T.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(u[w][y]=+I||0);break;case"@":u[w][y]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":u[w][y]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":u[w][y]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[w][y]=-T.read_shift(-8,"f");break;case"B":if(g&&N[y].len==8){u[w][y]=T.read_shift(8,"f");break}case"G":case"P":T.l+=N[y].len;break;case"0":if(N[y].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[y].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=N,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Gs(r(o,u),u);return f["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,f}function i(o,c){try{return qi(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,c){var u=c||{};if(+u.codepage>=0&&ja(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=Fr(),d=Hl(o,{header:1,raw:!0,cellDates:!0}),p=d[0],g=d.slice(1),v=o["!cols"]||[],_=0,E=0,L=0,V=1;for(_=0;_<p.length;++_){if(((v[_]||{}).DBF||{}).name){p[_]=v[_].DBF.name,++L;continue}if(p[_]!=null){if(++L,typeof p[_]=="number"&&(p[_]=p[_].toString(10)),typeof p[_]!="string")throw new Error("DBF Invalid column name "+p[_]+" |"+typeof p[_]+"|");if(p.indexOf(p[_])!==_){for(E=0;E<1024;++E)if(p.indexOf(p[_]+"_"+E)==-1){p[_]+="_"+E;break}}}}var N=Et(o["!ref"]),U=[],re=[],ue=[];for(_=0;_<=N.e.c-N.s.c;++_){var w="",y="",T=0,I=[];for(E=0;E<g.length;++E)g[E][_]!=null&&I.push(g[E][_]);if(I.length==0||p[_]==null){U[_]="?";continue}for(E=0;E<I.length;++E){switch(typeof I[E]){case"number":y="B";break;case"string":y="C";break;case"boolean":y="L";break;case"object":y=I[E]instanceof Date?"D":"C";break;default:y="C"}T=Math.max(T,String(I[E]).length),w=w&&w!=y?"C":y}T>250&&(T=250),y=((v[_]||{}).DBF||{}).type,y=="C"&&v[_].DBF.len>T&&(T=v[_].DBF.len),w=="B"&&y=="N"&&(w="N",ue[_]=v[_].DBF.dec,T=v[_].DBF.len),re[_]=w=="C"||y=="N"?T:s[w]||0,V+=re[_],U[_]=w}var P=f.next(32);for(P.write_shift(4,318902576),P.write_shift(4,g.length),P.write_shift(2,296+32*L),P.write_shift(2,V),_=0;_<4;++_)P.write_shift(4,0);for(P.write_shift(4,0|(+e[sm]||3)<<8),_=0,E=0;_<p.length;++_)if(p[_]!=null){var k=f.next(32),R=(p[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);k.write_shift(1,R,"sbcs"),k.write_shift(1,U[_]=="?"?"C":U[_],"sbcs"),k.write_shift(4,E),k.write_shift(1,re[_]||s[U[_]]||0),k.write_shift(1,ue[_]||0),k.write_shift(1,2),k.write_shift(4,0),k.write_shift(1,0),k.write_shift(4,0),k.write_shift(4,0),E+=re[_]||s[U[_]]||0}var $e=f.next(264);for($e.write_shift(4,13),_=0;_<65;++_)$e.write_shift(4,0);for(_=0;_<g.length;++_){var ke=f.next(V);for(ke.write_shift(1,0),E=0;E<p.length;++E)if(p[E]!=null)switch(U[E]){case"L":ke.write_shift(1,g[_][E]==null?63:g[_][E]?84:70);break;case"B":ke.write_shift(8,g[_][E]||0,"f");break;case"N":var Xe="0";for(typeof g[_][E]=="number"&&(Xe=g[_][E].toFixed(ue[E]||0)),L=0;L<re[E]-Xe.length;++L)ke.write_shift(1,32);ke.write_shift(1,Xe,"sbcs");break;case"D":g[_][E]?(ke.write_shift(4,("0000"+g[_][E].getFullYear()).slice(-4),"sbcs"),ke.write_shift(2,("00"+(g[_][E].getMonth()+1)).slice(-2),"sbcs"),ke.write_shift(2,("00"+g[_][E].getDate()).slice(-2),"sbcs")):ke.write_shift(8,"00000000","sbcs");break;case"C":var Ne=String(g[_][E]!=null?g[_][E]:"").slice(0,re[E]);for(ke.write_shift(1,Ne,"sbcs"),L=0;L<re[E]-Ne.length;++L)ke.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),pI=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+cr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,g){var v=t[g];return typeof v=="number"?Td(v):v},n=function(p,g,v){var _=g.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return _==59?p:Td(_)};t["|"]=254;function i(p,g){switch(g.type){case"base64":return s(Bn(p),g);case"binary":return s(p,g);case"buffer":return s(nt&&Buffer.isBuffer(p)?p.toString("binary"):io(p),g);case"array":return s(_c(p),g)}throw new Error("Unrecognized type "+g.type)}function s(p,g){var v=p.split(/[\n\r]+/),_=-1,E=-1,L=0,V=0,N=[],U=[],re=null,ue={},w=[],y=[],T=[],I=0,P;for(+g.codepage>=0&&ja(+g.codepage);L!==v.length;++L){I=0;var k=v[L].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),R=k.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),$e=R[0],ke;if(k.length>0)switch($e){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":R[1].charAt(0)=="P"&&U.push(k.slice(3).replace(/;;/g,";"));break;case"C":var Xe=!1,Ne=!1,He=!1,it=!1,Ft=-1,wt=-1;for(V=1;V<R.length;++V)switch(R[V].charAt(0)){case"A":break;case"X":E=parseInt(R[V].slice(1))-1,Ne=!0;break;case"Y":for(_=parseInt(R[V].slice(1))-1,Ne||(E=0),P=N.length;P<=_;++P)N[P]=[];break;case"K":ke=R[V].slice(1),ke.charAt(0)==='"'?ke=ke.slice(1,ke.length-1):ke==="TRUE"?ke=!0:ke==="FALSE"?ke=!1:isNaN(On(ke))?isNaN(za(ke).getDate())||(ke=Ir(ke)):(ke=On(ke),re!==null&&_m(re)&&(ke=Tm(ke))),Xe=!0;break;case"E":it=!0;var M=hC(R[V].slice(1),{r:_,c:E});N[_][E]=[N[_][E],M];break;case"S":He=!0,N[_][E]=[N[_][E],"S5S"];break;case"G":break;case"R":Ft=parseInt(R[V].slice(1))-1;break;case"C":wt=parseInt(R[V].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+k)}if(Xe&&(N[_][E]&&N[_][E].length==2?N[_][E][0]=ke:N[_][E]=ke,re=null),He){if(it)throw new Error("SYLK shared formula cannot have own formula");var G=Ft>-1&&N[Ft][wt];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");N[_][E][1]=dC(G[1],{r:_-Ft,c:E-wt})}break;case"F":var W=0;for(V=1;V<R.length;++V)switch(R[V].charAt(0)){case"X":E=parseInt(R[V].slice(1))-1,++W;break;case"Y":for(_=parseInt(R[V].slice(1))-1,P=N.length;P<=_;++P)N[P]=[];break;case"M":I=parseInt(R[V].slice(1))/20;break;case"F":break;case"G":break;case"P":re=U[parseInt(R[V].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=R[V].slice(1).split(" "),P=parseInt(T[0],10);P<=parseInt(T[1],10);++P)I=parseInt(T[2],10),y[P-1]=I===0?{hidden:!0}:{wch:I},Zf(y[P-1]);break;case"C":E=parseInt(R[V].slice(1))-1,y[E]||(y[E]={});break;case"R":_=parseInt(R[V].slice(1))-1,w[_]||(w[_]={}),I>0?(w[_].hpt=I,w[_].hpx=l_(I)):I===0&&(w[_].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+k)}W<1&&(re=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+k)}}return w.length>0&&(ue["!rows"]=w),y.length>0&&(ue["!cols"]=y),g&&g.sheetRows&&(N=N.slice(0,g.sheetRows)),[N,ue]}function a(p,g){var v=i(p,g),_=v[0],E=v[1],L=Gs(_,g);return cr(E).forEach(function(V){L[V]=E[V]}),L}function o(p,g){return qi(a(p,g),g)}function c(p,g,v,_){var E="C;Y"+(v+1)+";X"+(_+1)+";K";switch(p.t){case"n":E+=p.v||0,p.f&&!p.F&&(E+=";E"+th(p.f,{r:v,c:_}));break;case"b":E+=p.v?"TRUE":"FALSE";break;case"e":E+=p.w||p.v;break;case"d":E+='"'+(p.w||p.v)+'"';break;case"s":E+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function u(p,g){g.forEach(function(v,_){var E="F;W"+(_+1)+" "+(_+1)+" ";v.hidden?E+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Ml(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=Vl(v.wpx)),typeof v.wch=="number"&&(E+=Math.round(v.wch))),E.charAt(E.length-1)!=" "&&p.push(E)})}function f(p,g){g.forEach(function(v,_){var E="F;";v.hidden?E+="M0;":v.hpt?E+="M"+20*v.hpt+";":v.hpx&&(E+="M"+20*Bl(v.hpx)+";"),E.length>2&&p.push(E+"R"+(_+1))})}function d(p,g){var v=["ID;PWXL;N;E"],_=[],E=Et(p["!ref"]),L,V=Array.isArray(p),N=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),p["!cols"]&&u(v,p["!cols"]),p["!rows"]&&f(v,p["!rows"]),v.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var U=E.s.r;U<=E.e.r;++U)for(var re=E.s.c;re<=E.e.c;++re){var ue=ht({r:U,c:re});L=V?(p[U]||[])[re]:p[ue],!(!L||L.v==null&&(!L.f||L.F))&&_.push(c(L,p,U,re))}return v.join(N)+N+_.join(N)+N+"E"+N}return{to_workbook:o,to_sheet:a,from_sheet:d}}(),gI=function(){function t(s,a){switch(a.type){case"base64":return e(Bn(s),a);case"binary":return e(s,a);case"buffer":return e(nt&&Buffer.isBuffer(s)?s.toString("binary"):io(s),a);case"array":return e(_c(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),c=-1,u=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++c]=[],u=0;continue}if(!(c<0)){var p=o[f].trim().split(","),g=p[0],v=p[1];++f;for(var _=o[f]||"";(_.match(/["]/g)||[]).length&1&&f<o.length-1;)_+=`
`+o[++f];switch(_=_.trim(),+g){case-1:if(_==="BOT"){d[++c]=[],u=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?d[c][u]=!0:_==="FALSE"?d[c][u]=!1:isNaN(On(v))?isNaN(za(v).getDate())?d[c][u]=v:d[c][u]=Ir(v):d[c][u]=On(v),++u;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),d[c][u++]=_!==""?_:null;break}if(_==="EOD")break}}return a&&a.sheetRows&&(d=d.slice(0,a.sheetRows)),d}function r(s,a){return Gs(t(s,a),a)}function n(s,a){return qi(r(s,a),a)}var i=function(){var s=function(c,u,f,d,p){c.push(u),c.push(f+","+d),c.push('"'+p.replace(/"/g,'""')+'"')},a=function(c,u,f,d){c.push(u+","+f),c.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(c){var u=[],f=Et(c["!ref"]),d,p=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,f.e.r-f.s.r+1,""),s(u,"TUPLES",0,f.e.c-f.s.c+1,""),s(u,"DATA",0,0,"");for(var g=f.s.r;g<=f.e.r;++g){a(u,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var _=ht({r:g,c:v});if(d=p?(c[g]||[])[v]:c[_],!d){a(u,1,0,"");continue}switch(d.t){case"n":var E=d.w;!E&&d.v!=null&&(E=d.v),E==null?d.f&&!d.F?a(u,1,0,"="+d.f):a(u,1,0,""):a(u,0,E,"V");break;case"b":a(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=gi(d.z||Rt[14],Dr(Ir(d.v)))),a(u,0,d.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var L=`\r
`,V=u.join(L);return V}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),i_=function(){function t(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,p){for(var g=d.split(`
`),v=-1,_=-1,E=0,L=[];E!==g.length;++E){var V=g[E].trim().split(":");if(V[0]==="cell"){var N=qt(V[1]);if(L.length<=N.r)for(v=L.length;v<=N.r;++v)L[v]||(L[v]=[]);switch(v=N.r,_=N.c,V[2]){case"t":L[v][_]=t(V[3]);break;case"v":L[v][_]=+V[3];break;case"vtf":var U=V[V.length-1];case"vtc":switch(V[3]){case"nl":L[v][_]=!!+V[4];break;default:L[v][_]=+V[4];break}V[2]=="vtf"&&(L[v][_]=[L[v][_],U])}}}return p&&p.sheetRows&&(L=L.slice(0,p.sheetRows)),L}function n(d,p){return Gs(r(d,p),p)}function i(d,p){return qi(n(d,p),p)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var p=[],g=[],v,_="",E=Hr(d["!ref"]),L=Array.isArray(d),V=E.s.r;V<=E.e.r;++V)for(var N=E.s.c;N<=E.e.c;++N)if(_=ht({r:V,c:N}),v=L?(d[V]||[])[N]:d[_],!(!v||v.v==null||v.t==="z")){switch(g=["cell",_,"t"],v.t){case"s":case"str":g.push(e(v.v));break;case"n":v.f?(g[2]="vtf",g[3]="n",g[4]=v.v,g[5]=e(v.f)):(g[2]="v",g[3]=v.v);break;case"b":g[2]="vt"+(v.f?"f":"c"),g[3]="nl",g[4]=v.v?"1":"0",g[5]=e(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var U=Dr(Ir(v.v));g[2]="vtc",g[3]="nd",g[4]=""+U,g[5]=v.w||gi(v.z||Rt[14],U);break;case"e":continue}p.push(g.join(":"))}return p.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function f(d){return[s,a,o,a,u(d),c].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),mI=function(){function t(f,d,p,g,v){v.raw?d[p][g]=f:f===""||(f==="TRUE"?d[p][g]=!0:f==="FALSE"?d[p][g]=!1:isNaN(On(f))?isNaN(za(f).getDate())?d[p][g]=f:d[p][g]=Ir(f):d[p][g]=On(f))}function e(f,d){var p=d||{},g=[];if(!f||f.length===0)return g;for(var v=f.split(/[\r\n]/),_=v.length-1;_>=0&&v[_].length===0;)--_;for(var E=10,L=0,V=0;V<=_;++V)L=v[V].indexOf(" "),L==-1?L=v[V].length:L++,E=Math.max(E,L);for(V=0;V<=_;++V){g[V]=[];var N=0;for(t(v[V].slice(0,E).trim(),g,V,N,p),N=1;N<=(v[V].length-E)/10+1;++N)t(v[V].slice(E+(N-1)*10,E+N*10).trim(),g,V,N,p)}return p.sheetRows&&(g=g.slice(0,p.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var d={},p=!1,g=0,v=0;g<f.length;++g)(v=f.charCodeAt(g))==34?p=!p:!p&&v in r&&(d[v]=(d[v]||0)+1);v=[];for(g in d)Object.prototype.hasOwnProperty.call(d,g)&&v.push([d[g],g]);if(!v.length){d=n;for(g in d)Object.prototype.hasOwnProperty.call(d,g)&&v.push([d[g],g])}return v.sort(function(_,E){return _[0]-E[0]||n[_[1]]-n[E[1]]}),r[v.pop()[1]]||44}function s(f,d){var p=d||{},g="",v=p.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(g=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(g=f.charAt(4),f=f.slice(6)):g=i(f.slice(0,1024)):p&&p.FS?g=p.FS:g=i(f.slice(0,1024));var E=0,L=0,V=0,N=0,U=0,re=g.charCodeAt(0),ue=!1,w=0,y=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var T=p.dateNF!=null?OS(p.dateNF):null;function I(){var P=f.slice(N,U),k={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)k.t="z";else if(p.raw)k.t="s",k.v=P;else if(P.trim().length===0)k.t="s",k.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(k.t="s",k.v=P.slice(2,-1).replace(/""/g,'"')):pC(P)?(k.t="n",k.f=P.slice(1)):(k.t="s",k.v=P);else if(P=="TRUE")k.t="b",k.v=!0;else if(P=="FALSE")k.t="b",k.v=!1;else if(!isNaN(V=On(P)))k.t="n",p.cellText!==!1&&(k.w=P),k.v=V;else if(!isNaN(za(P).getDate())||T&&P.match(T)){k.z=p.dateNF||Rt[14];var R=0;T&&P.match(T)&&(P=bS(P,p.dateNF,P.match(T)||[]),R=1),p.cellDates?(k.t="d",k.v=Ir(P,R)):(k.t="n",k.v=Dr(Ir(P,R))),p.cellText!==!1&&(k.w=gi(k.z,k.v instanceof Date?Dr(k.v):k.v)),p.cellNF||delete k.z}else k.t="s",k.v=P;if(k.t=="z"||(p.dense?(v[E]||(v[E]=[]),v[E][L]=k):v[ht({c:L,r:E})]=k),N=U+1,y=f.charCodeAt(N),_.e.c<L&&(_.e.c=L),_.e.r<E&&(_.e.r=E),w==re)++L;else if(L=0,++E,p.sheetRows&&p.sheetRows<=E)return!0}e:for(;U<f.length;++U)switch(w=f.charCodeAt(U)){case 34:y===34&&(ue=!ue);break;case re:case 10:case 13:if(!ue&&I())break e;break}return U-N>0&&I(),v["!ref"]=Nt(_),v}function a(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,d):Gs(e(f,d),d)}function o(f,d){var p="",g=d.type=="string"?[0,0,0,0]:RF(f,d);switch(d.type){case"base64":p=Bn(f);break;case"binary":p=f;break;case"buffer":d.codepage==65001?p=f.toString("utf8"):d.codepage&&typeof Rl<"u"||(p=nt&&Buffer.isBuffer(f)?f.toString("binary"):io(f));break;case"array":p=_c(f);break;case"string":p=f;break;default:throw new Error("Unrecognized type "+d.type)}return g[0]==239&&g[1]==187&&g[2]==191?p=Aa(p.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?p=Aa(p):d.type=="binary"&&typeof Rl<"u",p.slice(0,19)=="socialcalc:version:"?i_.to_sheet(d.type=="string"?p:Aa(p),d):a(p,d)}function c(f,d){return qi(o(f,d),d)}function u(f){for(var d=[],p=Et(f["!ref"]),g,v=Array.isArray(f),_=p.s.r;_<=p.e.r;++_){for(var E=[],L=p.s.c;L<=p.e.c;++L){var V=ht({r:_,c:L});if(g=v?(f[_]||[])[L]:f[V],!g||g.v==null){E.push("          ");continue}for(var N=(g.w||(Un(g),g.w)||"").slice(0,10);N.length<10;)N+=" ";E.push(N+(L===0?" ":""))}d.push(E.join(""))}return d.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}(),Jd=function(){function t(M,G,W){if(M){Mr(M,M.l||0);for(var H=W.Enum||Ft;M.l<M.length;){var ne=M.read_shift(2),we=H[ne]||H[65535],Ce=M.read_shift(2),Ie=M.l+Ce,me=we.f&&we.f(M,Ce,W);if(M.l=Ie,G(me,we,ne))return}}}function e(M,G){switch(G.type){case"base64":return r(Zr(Bn(M)),G);case"binary":return r(Zr(M),G);case"buffer":case"array":return r(M,G)}throw"Unsupported type "+G.type}function r(M,G){if(!M)return M;var W=G||{},H=W.dense?[]:{},ne="Sheet1",we="",Ce=0,Ie={},me=[],et=[],b={s:{r:0,c:0},e:{r:0,c:0}},B=W.sheetRows||0;if(M[2]==0&&(M[3]==8||M[3]==9)&&M.length>=16&&M[14]==5&&M[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(M[2]==2)W.Enum=Ft,t(M,function(z,pe,he){switch(he){case 0:W.vers=z,z>=4096&&(W.qpro=!0);break;case 6:b=z;break;case 204:z&&(we=z);break;case 222:we=z;break;case 15:case 51:W.qpro||(z[1].v=z[1].v.slice(1));case 13:case 14:case 16:he==14&&(z[2]&112)==112&&(z[2]&15)>1&&(z[2]&15)<15&&(z[1].z=W.dateNF||Rt[14],W.cellDates&&(z[1].t="d",z[1].v=Tm(z[1].v))),W.qpro&&z[3]>Ce&&(H["!ref"]=Nt(b),Ie[ne]=H,me.push(ne),H=W.dense?[]:{},b={s:{r:0,c:0},e:{r:0,c:0}},Ce=z[3],ne=we||"Sheet"+(Ce+1),we="");var fe=W.dense?(H[z[0].r]||[])[z[0].c]:H[ht(z[0])];if(fe){fe.t=z[1].t,fe.v=z[1].v,z[1].z!=null&&(fe.z=z[1].z),z[1].f!=null&&(fe.f=z[1].f);break}W.dense?(H[z[0].r]||(H[z[0].r]=[]),H[z[0].r][z[0].c]=z[1]):H[ht(z[0])]=z[1];break}},W);else if(M[2]==26||M[2]==14)W.Enum=wt,M[2]==14&&(W.qpro=!0,M.l=0),t(M,function(z,pe,he){switch(he){case 204:ne=z;break;case 22:z[1].v=z[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(z[3]>Ce&&(H["!ref"]=Nt(b),Ie[ne]=H,me.push(ne),H=W.dense?[]:{},b={s:{r:0,c:0},e:{r:0,c:0}},Ce=z[3],ne="Sheet"+(Ce+1)),B>0&&z[0].r>=B)break;W.dense?(H[z[0].r]||(H[z[0].r]=[]),H[z[0].r][z[0].c]=z[1]):H[ht(z[0])]=z[1],b.e.c<z[0].c&&(b.e.c=z[0].c),b.e.r<z[0].r&&(b.e.r=z[0].r);break;case 27:z[14e3]&&(et[z[14e3][0]]=z[14e3][1]);break;case 1537:et[z[0]]=z[1],z[0]==Ce&&(ne=z[1]);break}},W);else throw new Error("Unrecognized LOTUS BOF "+M[2]);if(H["!ref"]=Nt(b),Ie[we||ne]=H,me.push(we||ne),!et.length)return{SheetNames:me,Sheets:Ie};for(var K={},ae=[],te=0;te<et.length;++te)Ie[me[te]]?(ae.push(et[te]||me[te]),K[et[te]]=Ie[et[te]]||Ie[me[te]]):(ae.push(et[te]),K[et[te]]={"!ref":"A1"});return{SheetNames:ae,Sheets:K}}function n(M,G){var W=G||{};if(+W.codepage>=0&&ja(+W.codepage),W.type=="string")throw new Error("Cannot write WK1 to JS string");var H=Fr(),ne=Et(M["!ref"]),we=Array.isArray(M),Ce=[];_e(H,0,s(1030)),_e(H,6,c(ne));for(var Ie=Math.min(ne.e.r,8191),me=ne.s.r;me<=Ie;++me)for(var et=or(me),b=ne.s.c;b<=ne.e.c;++b){me===ne.s.r&&(Ce[b]=mr(b));var B=Ce[b]+et,K=we?(M[me]||[])[b]:M[B];if(!(!K||K.t=="z"))if(K.t=="n")(K.v|0)==K.v&&K.v>=-32768&&K.v<=32767?_e(H,13,g(me,b,K.v)):_e(H,14,_(me,b,K.v));else{var ae=Un(K);_e(H,15,d(me,b,ae.slice(0,239)))}}return _e(H,1),H.end()}function i(M,G){var W=G||{};if(+W.codepage>=0&&ja(+W.codepage),W.type=="string")throw new Error("Cannot write WK3 to JS string");var H=Fr();_e(H,0,a(M));for(var ne=0,we=0;ne<M.SheetNames.length;++ne)(M.Sheets[M.SheetNames[ne]]||{})["!ref"]&&_e(H,27,it(M.SheetNames[ne],we++));var Ce=0;for(ne=0;ne<M.SheetNames.length;++ne){var Ie=M.Sheets[M.SheetNames[ne]];if(!(!Ie||!Ie["!ref"])){for(var me=Et(Ie["!ref"]),et=Array.isArray(Ie),b=[],B=Math.min(me.e.r,8191),K=me.s.r;K<=B;++K)for(var ae=or(K),te=me.s.c;te<=me.e.c;++te){K===me.s.r&&(b[te]=mr(te));var z=b[te]+ae,pe=et?(Ie[K]||[])[te]:Ie[z];if(!(!pe||pe.t=="z"))if(pe.t=="n")_e(H,23,I(K,te,Ce,pe.v));else{var he=Un(pe);_e(H,22,w(K,te,Ce,he.slice(0,239)))}}++Ce}}return _e(H,1),H.end()}function s(M){var G=ee(2);return G.write_shift(2,M),G}function a(M){var G=ee(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var W=0,H=0,ne=0,we=0;we<M.SheetNames.length;++we){var Ce=M.SheetNames[we],Ie=M.Sheets[Ce];if(!(!Ie||!Ie["!ref"])){++ne;var me=Hr(Ie["!ref"]);W<me.e.r&&(W=me.e.r),H<me.e.c&&(H=me.e.c)}}return W>8191&&(W=8191),G.write_shift(2,W),G.write_shift(1,ne),G.write_shift(1,H),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function o(M,G,W){var H={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&W.qpro?(H.s.c=M.read_shift(1),M.l++,H.s.r=M.read_shift(2),H.e.c=M.read_shift(1),M.l++,H.e.r=M.read_shift(2),H):(H.s.c=M.read_shift(2),H.s.r=M.read_shift(2),G==12&&W.qpro&&(M.l+=2),H.e.c=M.read_shift(2),H.e.r=M.read_shift(2),G==12&&W.qpro&&(M.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function c(M){var G=ee(8);return G.write_shift(2,M.s.c),G.write_shift(2,M.s.r),G.write_shift(2,M.e.c),G.write_shift(2,M.e.r),G}function u(M,G,W){var H=[{c:0,r:0},{t:"n",v:0},0,0];return W.qpro&&W.vers!=20768?(H[0].c=M.read_shift(1),H[3]=M.read_shift(1),H[0].r=M.read_shift(2),M.l+=2):(H[2]=M.read_shift(1),H[0].c=M.read_shift(2),H[0].r=M.read_shift(2)),H}function f(M,G,W){var H=M.l+G,ne=u(M,G,W);if(ne[1].t="s",W.vers==20768){M.l++;var we=M.read_shift(1);return ne[1].v=M.read_shift(we,"utf8"),ne}return W.qpro&&M.l++,ne[1].v=M.read_shift(H-M.l,"cstr"),ne}function d(M,G,W){var H=ee(7+W.length);H.write_shift(1,255),H.write_shift(2,G),H.write_shift(2,M),H.write_shift(1,39);for(var ne=0;ne<H.length;++ne){var we=W.charCodeAt(ne);H.write_shift(1,we>=128?95:we)}return H.write_shift(1,0),H}function p(M,G,W){var H=u(M,G,W);return H[1].v=M.read_shift(2,"i"),H}function g(M,G,W){var H=ee(7);return H.write_shift(1,255),H.write_shift(2,G),H.write_shift(2,M),H.write_shift(2,W,"i"),H}function v(M,G,W){var H=u(M,G,W);return H[1].v=M.read_shift(8,"f"),H}function _(M,G,W){var H=ee(13);return H.write_shift(1,255),H.write_shift(2,G),H.write_shift(2,M),H.write_shift(8,W,"f"),H}function E(M,G,W){var H=M.l+G,ne=u(M,G,W);if(ne[1].v=M.read_shift(8,"f"),W.qpro)M.l=H;else{var we=M.read_shift(2);U(M.slice(M.l,M.l+we),ne),M.l+=we}return ne}function L(M,G,W){var H=G&32768;return G&=-32769,G=(H?M:0)+(G>=8192?G-16384:G),(H?"":"$")+(W?mr(G):or(G))}var V={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function U(M,G){Mr(M,0);for(var W=[],H=0,ne="",we="",Ce="",Ie="";M.l<M.length;){var me=M[M.l++];switch(me){case 0:W.push(M.read_shift(8,"f"));break;case 1:we=L(G[0].c,M.read_shift(2),!0),ne=L(G[0].r,M.read_shift(2),!1),W.push(we+ne);break;case 2:{var et=L(G[0].c,M.read_shift(2),!0),b=L(G[0].r,M.read_shift(2),!1);we=L(G[0].c,M.read_shift(2),!0),ne=L(G[0].r,M.read_shift(2),!1),W.push(et+b+":"+we+ne)}break;case 3:if(M.l<M.length){console.error("WK1 premature formula end");return}break;case 4:W.push("("+W.pop()+")");break;case 5:W.push(M.read_shift(2));break;case 6:{for(var B="";me=M[M.l++];)B+=String.fromCharCode(me);W.push('"'+B.replace(/"/g,'""')+'"')}break;case 8:W.push("-"+W.pop());break;case 23:W.push("+"+W.pop());break;case 22:W.push("NOT("+W.pop()+")");break;case 20:case 21:Ie=W.pop(),Ce=W.pop(),W.push(["AND","OR"][me-20]+"("+Ce+","+Ie+")");break;default:if(me<32&&N[me])Ie=W.pop(),Ce=W.pop(),W.push(Ce+N[me]+Ie);else if(V[me]){if(H=V[me][1],H==69&&(H=M[M.l++]),H>W.length){console.error("WK1 bad formula parse 0x"+me.toString(16)+":|"+W.join("|")+"|");return}var K=W.slice(-H);W.length-=H,W.push(V[me][0]+"("+K.join(",")+")")}else return me<=7?console.error("WK1 invalid opcode "+me.toString(16)):me<=24?console.error("WK1 unsupported op "+me.toString(16)):me<=30?console.error("WK1 invalid opcode "+me.toString(16)):me<=115?console.error("WK1 unsupported function opcode "+me.toString(16)):console.error("WK1 unrecognized opcode "+me.toString(16))}}W.length==1?G[1].f=""+W[0]:console.error("WK1 bad formula parse |"+W.join("|")+"|")}function re(M){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=M.read_shift(2),G[3]=M[M.l++],G[0].c=M[M.l++],G}function ue(M,G){var W=re(M);return W[1].t="s",W[1].v=M.read_shift(G-4,"cstr"),W}function w(M,G,W,H){var ne=ee(6+H.length);ne.write_shift(2,M),ne.write_shift(1,W),ne.write_shift(1,G),ne.write_shift(1,39);for(var we=0;we<H.length;++we){var Ce=H.charCodeAt(we);ne.write_shift(1,Ce>=128?95:Ce)}return ne.write_shift(1,0),ne}function y(M,G){var W=re(M);W[1].v=M.read_shift(2);var H=W[1].v>>1;if(W[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return W[1].v=H,W}function T(M,G){var W=re(M),H=M.read_shift(4),ne=M.read_shift(4),we=M.read_shift(2);if(we==65535)return H===0&&ne===3221225472?(W[1].t="e",W[1].v=15):H===0&&ne===3489660928?(W[1].t="e",W[1].v=42):W[1].v=0,W;var Ce=we&32768;return we=(we&32767)-16446,W[1].v=(1-Ce*2)*(ne*Math.pow(2,we+32)+H*Math.pow(2,we)),W}function I(M,G,W,H){var ne=ee(14);if(ne.write_shift(2,M),ne.write_shift(1,W),ne.write_shift(1,G),H==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var we=0,Ce=0,Ie=0,me=0;return H<0&&(we=1,H=-H),Ce=Math.log2(H)|0,H/=Math.pow(2,Ce-31),me=H>>>0,(me&2147483648)==0&&(H/=2,++Ce,me=H>>>0),H-=me,me|=2147483648,me>>>=0,H*=Math.pow(2,32),Ie=H>>>0,ne.write_shift(4,Ie),ne.write_shift(4,me),Ce+=16383+(we?32768:0),ne.write_shift(2,Ce),ne}function P(M,G){var W=T(M);return M.l+=G-14,W}function k(M,G){var W=re(M),H=M.read_shift(4);return W[1].v=H>>6,W}function R(M,G){var W=re(M),H=M.read_shift(8,"f");return W[1].v=H,W}function $e(M,G){var W=R(M);return M.l+=G-10,W}function ke(M,G){return M[M.l+G-1]==0?M.read_shift(G,"cstr"):""}function Xe(M,G){var W=M[M.l++];W>G-1&&(W=G-1);for(var H="";H.length<W;)H+=String.fromCharCode(M[M.l++]);return H}function Ne(M,G,W){if(!(!W.qpro||G<21)){var H=M.read_shift(1);M.l+=17,M.l+=1,M.l+=2;var ne=M.read_shift(G-21,"cstr");return[H,ne]}}function He(M,G){for(var W={},H=M.l+G;M.l<H;){var ne=M.read_shift(2);if(ne==14e3){for(W[ne]=[0,""],W[ne][0]=M.read_shift(2);M[M.l];)W[ne][1]+=String.fromCharCode(M[M.l]),M.l++;M.l++}}return W}function it(M,G){var W=ee(5+M.length);W.write_shift(2,14e3),W.write_shift(2,G);for(var H=0;H<M.length;++H){var ne=M.charCodeAt(H);W[W.l++]=ne>127?95:ne}return W[W.l++]=0,W}var Ft={0:{n:"BOF",f:Zm},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ke},222:{n:"SHEETNAMELP",f:Xe},65535:{n:""}},wt={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:ue},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:y},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:He},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:k},38:{n:"??"},39:{n:"NUMBER27",f:R},40:{n:"FORMULA28",f:$e},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ke},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}(),_I=/^\s|\s$|[\t\n\r]/;function s_(t,e){if(!e.bookSST)return"";var r=[Mt];r[r.length]=ge("sst",null,{xmlns:js[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(_I)&&(s+=' xml:space="preserve"'),s+=">"+ft(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function vI(t){return[t.read_shift(4),t.read_shift(4)]}function xI(t,e){return e||(e=ee(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var EI=u4;function TI(t){var e=Fr();se(e,159,xI(t));for(var r=0;r<t.length;++r)se(e,19,EI(t[r]));return se(e,160),e.end()}function yI(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function a_(t){var e=0,r,n=yI(t),i=n.length+1,s,a,o,c,u;for(r=Hi(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=(e&16384)===0?0:1,c=e<<1&32767,u=o|c,e=u^a;return e^52811}var wI=function(){function t(i,s){switch(s.type){case"base64":return e(Bn(i),s);case"binary":return e(i,s);case"buffer":return e(nt&&Buffer.isBuffer(i)?i.toString("binary"):io(i),s);case"array":return e(_c(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var p=/\\\w+\b/g,g=0,v,_=-1;v=p.exec(f);){switch(v[0]){case"\\cell":var E=f.slice(g,p.lastIndex-v[0].length);if(E[0]==" "&&(E=E.slice(1)),++_,E.length){var L={v:E,t:"s"};Array.isArray(o)?o[d][_]=L:o[ht({r:d,c:_})]=L}break}g=p.lastIndex}_>u.e.c&&(u.e.c=_)}),o["!ref"]=Nt(u),o}function r(i,s){return qi(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=Et(i["!ref"]),o,c=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var d=ht({r:u,c:f});o=c?(i[u]||[])[f]:i[d],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Un(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function Zd(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}var AI=6,bn=AI;function Ml(t){return Math.floor((t+Math.round(128/bn)/256)*bn)}function Vl(t){return Math.floor((t-5)/bn*100+.5)/100}function Mu(t){return Math.round((t*bn+5)/bn*256)/256}function Zf(t){t.width?(t.wpx=Ml(t.width),t.wch=Vl(t.wpx),t.MDW=bn):t.wpx?(t.wch=Vl(t.wpx),t.width=Mu(t.wch),t.MDW=bn):typeof t.wch=="number"&&(t.width=Mu(t.wch),t.wpx=Ml(t.width),t.MDW=bn),t.customWidth&&delete t.customWidth}var SI=96,o_=SI;function Bl(t){return t*96/o_}function l_(t){return t*o_/96}function II(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=ge("numFmt",null,{numFmtId:n,formatCode:ft(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=ge("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function CI(t){var e=[];return e[e.length]=ge("cellXfs",null),t.forEach(function(r){e[e.length]=ge("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=ge("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function c_(t,e){var r=[Mt,ge("styleSheet",null,{xmlns:js[0],"xmlns:vt":Kt.vt})],n;return t.SSF&&(n=II(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=CI(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function RI(t,e){var r=t.read_shift(2),n=_r(t);return[r,n]}function PI(t,e,r){r||(r=ee(6+4*e.length)),r.write_shift(2,t),Xt(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function FI(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=_4(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=m4(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=_r(t),n}function DI(t,e){e||(e=ee(25+4*32)),e.write_shift(2,t.sz*20),v4(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Nl(t.color,e);var n=0;return n=2,e.write_shift(1,n),Xt(t.name,e),e.length>e.l?e.slice(0,e.l):e}var OI=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Qc,bI=xn;function ep(t,e){e||(e=ee(4*3+8*7+16*1)),Qc||(Qc=Hf(OI));var r=Qc[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Nl({auto:1},e),Nl({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function kI(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function u_(t,e,r){r||(r=ee(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function aa(t,e){return e||(e=ee(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var NI=xn;function LI(t,e){return e||(e=ee(51)),e.write_shift(1,0),aa(null,e),aa(null,e),aa(null,e),aa(null,e),aa(null,e),e.length>e.l?e.slice(0,e.l):e}function MI(t,e){return e||(e=ee(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),kl(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function VI(t,e,r){var n=ee(2052);return n.write_shift(4,t),kl(e,n),kl(r,n),n.length>n.l?n.slice(0,n.l):n}function BI(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(se(t,615,nn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&se(t,44,PI(i,e[i]))}),se(t,616))}}function UI(t){var e=1;se(t,611,nn(e)),se(t,43,DI({sz:12,color:{theme:1},name:"Calibri",family:2})),se(t,612)}function HI(t){var e=2;se(t,603,nn(e)),se(t,45,ep({patternType:"none"})),se(t,45,ep({patternType:"gray125"})),se(t,604)}function WI(t){var e=1;se(t,613,nn(e)),se(t,46,LI()),se(t,614)}function $I(t){var e=1;se(t,626,nn(e)),se(t,47,u_({numFmtId:0},65535)),se(t,627)}function jI(t,e){se(t,617,nn(e.length)),e.forEach(function(r){se(t,47,u_(r,0))}),se(t,618)}function GI(t){var e=1;se(t,619,nn(e)),se(t,48,MI({xfId:0,name:"Normal"})),se(t,620)}function zI(t){var e=0;se(t,505,nn(e)),se(t,506)}function KI(t){var e=0;se(t,508,VI(e,"TableStyleMedium9","PivotStyleMedium4")),se(t,509)}function qI(t,e){var r=Fr();return se(r,278),BI(r,t.SSF),UI(r),HI(r),WI(r),$I(r),jI(r,e.cellXfs),GI(r),zI(r),KI(r),se(r,279),r.end()}function f_(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Mt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function XI(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:_r(t)}}function YI(t){var e=ee(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Xt(t.name,e),e.slice(0,e.l)}function QI(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function JI(t){var e=ee(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function ZI(t,e){var r=ee(8+2*e.length);return r.write_shift(4,t),Xt(e,r),r.slice(0,r.l)}function eC(t){return t.l+=4,t.read_shift(4)!=0}function tC(t,e){var r=ee(8);return r.write_shift(4,t),r.write_shift(4,1),r}function rC(){var t=Fr();return se(t,332),se(t,334,nn(1)),se(t,335,YI({name:"XLDAPR",version:12e4,flags:3496657072})),se(t,336),se(t,339,ZI(1,"XLDAPR")),se(t,52),se(t,35,nn(514)),se(t,4096,nn(0)),se(t,4097,$r(1)),se(t,36),se(t,53),se(t,340),se(t,337,tC(1)),se(t,51,JI([[1,0]])),se(t,338),se(t,333),t.end()}function h_(){var t=[Mt];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function nC(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ht(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}var _s=1024;function d_(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[ge("xml",null,{"xmlns:v":Vr.v,"xmlns:o":Vr.o,"xmlns:x":Vr.x,"xmlns:mv":Vr.mv}).replace(/\/>/,">"),ge("o:shapelayout",ge("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),ge("v:shapetype",[ge("v:stroke",null,{joinstyle:"miter"}),ge("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];_s<t*1e3;)_s+=1e3;return e.forEach(function(s){var a=qt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?ge("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=ge("v:fill",c,o),f={on:"t",obscured:"t"};++_s,i=i.concat(["<v:shape"+qa({id:"_x0000_s"+_s,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,ge("v:shadow",null,f),ge("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",sr("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),sr("x:AutoFill","False"),sr("x:Row",String(a.r)),sr("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function p_(t){var e=[Mt,ge("comments",null,{xmlns:js[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=ft(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(i=r.indexOf(ft(c.a))),s.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(sr("t",ft(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(sr("t",ft(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function iC(t,e,r){var n=[Mt,ge("ThreadedComments",null,{xmlns:Kt.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var c={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=c.id:c.parentId=s,a.ID=c.id,a.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(ge("threadedComment",sr("text",a.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function sC(t){var e=[Mt,ge("personList",null,{xmlns:Kt.TCMNT,"xmlns:x":js[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(ge("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function aC(t){var e={};e.iauthor=t.read_shift(4);var r=Ji(t);return e.rfx=r.s,e.ref=ht(r.s),t.l+=16,e}function oC(t,e){return e==null&&(e=ee(36)),e.write_shift(4,t[1].iauthor),zs(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var lC=_r;function cC(t){return Xt(t.slice(0,54))}function uC(t){var e=Fr(),r=[];return se(e,628),se(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),se(e,632,cC(i.a)))})}),se(e,631),se(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:qt(n[0]),e:qt(n[0])};se(e,635,oC([s,i])),i.t&&i.t.length>0&&se(e,637,h4(i)),se(e,636),delete i.iauthor})}),se(e,634),se(e,629),e.end()}function fC(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&dt.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var g_=["xlsb","xlsm","xlam","biff8","xla"],hC=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=e.c:--f,c?u+=e.r:--u,i+(o?"":"$")+mr(f)+(c?"":"$")+or(u)}return function(i,s){return e=s,i.replace(t,r)}}(),eh=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,th=function(){return function(e,r){return e.replace(eh,function(n,i,s,a,o,c){var u=qf(a)-(s?0:r.c),f=Kf(c)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",p=u==0?"":s?u+1:"["+u+"]";return i+"R"+d+"C"+p})}}();function dC(t,e){return t.replace(eh,function(r,n,i,s,a,o){return n+(i=="$"?i+s:mr(qf(s)+e.c))+(a=="$"?a+o:or(Kf(o)+e.r))})}function pC(t){return t.length!=1}function bt(t){t.l+=1}function mi(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function m_(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return __(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=mi(t),o=mi(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function __(t){var e=mi(t),r=mi(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function gC(t,e,r){if(r.biff<8)return __(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=mi(t),a=mi(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function v_(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return mC(t);var n=t.read_shift(r&&r.biff==12?4:2),i=mi(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function mC(t){var e=mi(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function _C(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function vC(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return xC(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function xC(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function EC(t,e,r){var n=(t[t.l++]&96)>>5,i=m_(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function TC(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=m_(t,s,r);return[n,i,a]}function yC(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function wC(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function AC(t,e,r){var n=(t[t.l++]&96)>>5,i=gC(t,e-1,r);return[n,i]}function SC(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function tp(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function IC(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function CC(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function RC(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function PC(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function FC(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function x_(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function DC(t){return t.read_shift(2),x_(t)}function OC(t){return t.read_shift(2),x_(t)}function bC(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=v_(t,0,r);return[n,i]}function kC(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=vC(t,0,r);return[n,i]}function NC(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=v_(t,0,r);return[n,i,s]}function LC(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[LR[i],y_[i],n]}function MC(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:VC(t);return[i,(s[0]===0?y_:NR)[s[1]]]}function VC(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function BC(t,e,r){t.l+=r&&r.biff==2?3:4}function UC(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function HC(t){return t.l++,oo[t.read_shift(1)]}function WC(t){return t.l++,t.read_shift(2)}function $C(t){return t.l++,t.read_shift(1)!==0}function jC(t){return t.l++,Ks(t)}function GC(t,e,r){return t.l++,t_(t,e-1,r)}function zC(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=N4(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=oo[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Ks(t);break;case 2:r[1]=B4(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function KC(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Ji:W4)(t));return i}function qC(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=zC(t,r.biff);return a}function XC(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function YC(t,e,r){if(r.biff==5)return QC(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function QC(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function JC(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function ZC(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function eR(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function tR(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var rR=xn,nR=xn,iR=xn;function lo(t,e,r){return t.l+=2,[_C(t)]}function rh(t){return t.l+=6,[]}var sR=lo,aR=rh,oR=rh,lR=lo;function E_(t){return t.l+=2,[Zm(t),t.read_shift(2)&1]}var cR=lo,uR=E_,fR=rh,hR=lo,dR=lo,pR=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function gR(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=pR[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function mR(t){return t.l+=2,[t.read_shift(4)]}function _R(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function vR(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function xR(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function ER(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function TR(t){return t.l+=4,[0,0]}var rp={1:{n:"PtgExp",f:UC},2:{n:"PtgTbl",f:iR},3:{n:"PtgAdd",f:bt},4:{n:"PtgSub",f:bt},5:{n:"PtgMul",f:bt},6:{n:"PtgDiv",f:bt},7:{n:"PtgPower",f:bt},8:{n:"PtgConcat",f:bt},9:{n:"PtgLt",f:bt},10:{n:"PtgLe",f:bt},11:{n:"PtgEq",f:bt},12:{n:"PtgGe",f:bt},13:{n:"PtgGt",f:bt},14:{n:"PtgNe",f:bt},15:{n:"PtgIsect",f:bt},16:{n:"PtgUnion",f:bt},17:{n:"PtgRange",f:bt},18:{n:"PtgUplus",f:bt},19:{n:"PtgUminus",f:bt},20:{n:"PtgPercent",f:bt},21:{n:"PtgParen",f:bt},22:{n:"PtgMissArg",f:bt},23:{n:"PtgStr",f:GC},26:{n:"PtgSheet",f:_R},27:{n:"PtgEndSheet",f:vR},28:{n:"PtgErr",f:HC},29:{n:"PtgBool",f:$C},30:{n:"PtgInt",f:WC},31:{n:"PtgNum",f:jC},32:{n:"PtgArray",f:SC},33:{n:"PtgFunc",f:LC},34:{n:"PtgFuncVar",f:MC},35:{n:"PtgName",f:XC},36:{n:"PtgRef",f:bC},37:{n:"PtgArea",f:EC},38:{n:"PtgMemArea",f:JC},39:{n:"PtgMemErr",f:rR},40:{n:"PtgMemNoMem",f:nR},41:{n:"PtgMemFunc",f:ZC},42:{n:"PtgRefErr",f:eR},43:{n:"PtgAreaErr",f:yC},44:{n:"PtgRefN",f:kC},45:{n:"PtgAreaN",f:AC},46:{n:"PtgMemAreaN",f:xR},47:{n:"PtgMemNoMemN",f:ER},57:{n:"PtgNameX",f:YC},58:{n:"PtgRef3d",f:NC},59:{n:"PtgArea3d",f:TC},60:{n:"PtgRefErr3d",f:tR},61:{n:"PtgAreaErr3d",f:wC},255:{}},yR={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},wR={1:{n:"PtgElfLel",f:E_},2:{n:"PtgElfRw",f:hR},3:{n:"PtgElfCol",f:sR},6:{n:"PtgElfRwV",f:dR},7:{n:"PtgElfColV",f:lR},10:{n:"PtgElfRadical",f:cR},11:{n:"PtgElfRadicalS",f:fR},13:{n:"PtgElfColS",f:aR},15:{n:"PtgElfColSV",f:oR},16:{n:"PtgElfRadicalLel",f:uR},25:{n:"PtgList",f:gR},29:{n:"PtgSxName",f:mR},255:{}},AR={0:{n:"PtgAttrNoop",f:TR},1:{n:"PtgAttrSemi",f:FC},2:{n:"PtgAttrIf",f:RC},4:{n:"PtgAttrChoose",f:IC},8:{n:"PtgAttrGoto",f:CC},16:{n:"PtgAttrSum",f:BC},32:{n:"PtgAttrBaxcel",f:tp},33:{n:"PtgAttrBaxcel",f:tp},64:{n:"PtgAttrSpace",f:DC},65:{n:"PtgAttrSpaceSemi",f:OC},128:{n:"PtgAttrIfError",f:PC},255:{}};function SR(t,e,r,n){if(n.biff<8)return xn(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=qC(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=KC(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(xn(t,e)),s}function IR(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=rp[s]||rp[yR[s]],(s===24||s===25)&&(i=(s===24?wR:AR)[t[t.l+1]]),!i||!i.f?xn(t,e):a.push([i.n,i.f(t,e,r)]);return a}function CR(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var RR={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function PR(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function T_(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function np(t,e,r){var n=T_(t,e,r);return n=="#REF"?n:PR(n,r)}function Vs(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],c,u,f,d=0,p=0,g,v="";if(!t[0]||!t[0][0])return"";for(var _=-1,E="",L=0,V=t[0].length;L<V;++L){var N=t[0][L];switch(N[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),_>=0){switch(t[0][_][1][0]){case 0:E=Ct(" ",t[0][_][1][1]);break;case 1:E=Ct("\r",t[0][_][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][_][1][0])}u=u+E,_=-1}o.push(u+RR[N[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Ia(N[1][1],a,i),o.push(Ca(f,s));break;case"PtgRefN":f=r?Ia(N[1][1],r,i):N[1][1],o.push(Ca(f,s));break;case"PtgRef3d":d=N[1][1],f=Ia(N[1][2],a,i),v=np(n,d,i),o.push(v+"!"+Ca(f,s));break;case"PtgFunc":case"PtgFuncVar":var U=N[1][0],re=N[1][1];U||(U=0),U&=127;var ue=U==0?[]:o.slice(-U);o.length-=U,re==="User"&&(re=ue.shift()),o.push(re+"("+ue.join(",")+")");break;case"PtgBool":o.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(N[1]);break;case"PtgNum":o.push(String(N[1]));break;case"PtgStr":o.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(N[1]);break;case"PtgAreaN":g=Hd(N[1][1],r?{s:r}:a,i),o.push(Xc(g,i));break;case"PtgArea":g=Hd(N[1][1],a,i),o.push(Xc(g,i));break;case"PtgArea3d":d=N[1][1],g=N[1][2],v=np(n,d,i),o.push(v+"!"+Xc(g,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=N[1][2];var w=(n.names||[])[p-1]||(n[0]||[])[p],y=w?w.Name:"SH33TJSNAME"+String(p);y&&y.slice(0,6)=="_xlfn."&&!i.xlfn&&(y=y.slice(6)),o.push(y);break;case"PtgNameX":var T=N[1][1];p=N[1][2];var I;if(i.biff<=5)T<0&&(T=-T),n[T]&&(I=n[T][p]);else{var P="";if(((n[T]||[])[0]||[])[0]==14849||(((n[T]||[])[0]||[])[0]==1025?n[T][p]&&n[T][p].itab>0&&(P=n.SheetNames[n[T][p].itab-1]+"!"):P=n.SheetNames[p-1]+"!"),n[T]&&n[T][p])P+=n[T][p].Name;else if(n[0]&&n[0][p])P+=n[0][p].Name;else{var k=(T_(n,T,i)||"").split(";;");k[p-1]?P=k[p-1]:P+="SH33TJSERRX"}o.push(P);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var R="(",$e=")";if(_>=0){switch(E="",t[0][_][1][0]){case 2:R=Ct(" ",t[0][_][1][1])+R;break;case 3:R=Ct("\r",t[0][_][1][1])+R;break;case 4:$e=Ct(" ",t[0][_][1][1])+$e;break;case 5:$e=Ct("\r",t[0][_][1][1])+$e;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][_][1][0])}_=-1}o.push(R+o.pop()+$e);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:N[1][1],r:N[1][0]};var ke={c:r.c,r:r.r};if(n.sharedf[ht(f)]){var Xe=n.sharedf[ht(f)];o.push(Vs(Xe,a,ke,n,i))}else{var Ne=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(Vs(u[1],a,ke,n,i)),Ne=!0;break}Ne||o.push(N[1])}break;case"PtgArray":o.push("{"+CR(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=L;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var He=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&_>=0&&He.indexOf(t[0][L][0])==-1){N=t[0][_];var it=!0;switch(N[1][0]){case 4:it=!1;case 0:E=Ct(" ",N[1][1]);break;case 5:it=!1;case 1:E=Ct("\r",N[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}o.push((it?E:"")+o.pop()+(it?"":E)),_=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function FR(t){if(t==null){var e=ee(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Wi(t);return Wi(0)}function DR(t,e,r,n,i){var s=$i(e,r,i),a=FR(t.v),o=ee(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=ee(t.bf.length),f=0;f<t.bf.length;++f)u[f]=t.bf[f];var d=ir([s,a,o,u]);return d}function vc(t,e,r){var n=t.read_shift(4),i=IR(t,n,r),s=t.read_shift(4),a=s>0?SR(t,s,i,r):null;return[i,a]}var OR=vc,xc=vc,bR=vc,kR=vc,NR={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},y_={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},LR={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function MR(t){var e="of:="+t.replace(eh,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function VR(t){return t.replace(/\./,"!")}var Ra=typeof Map<"u";function nh(t,e,r){var n=0,i=t.length;if(r){if(Ra?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Ra?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(Ra?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function Ec(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(bn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Vl(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Mu(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function w_(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Ti(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){vm(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function BR(t,e,r){if(t&&t["!ref"]){var n=Et(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function UR(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Nt(t[r])+'"/>';return e+"</mergeCells>"}function HR(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[r];try{e.Workbook&&(c=e.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,a.codeName=Ka(ft(c))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),o=(o||"")+ge("outlinePr",null,u)}!s&&!o||(i[i.length]=ge("sheetPr",o,a))}var WR=["objects","scenarios","selectLockedCells","selectUnlockedCells"],$R=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function jR(t){var e={sheet:1};return WR.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),$R.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=a_(t.password).toString(16).toUpperCase()),ge("sheetProtection",null,e)}function GR(t){return w_(t),ge("pageMargins",null,t)}function zR(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=ge("col",null,Ec(i,n)));return r[r.length]="</cols>",r.join("")}function KR(t,e,r,n){var i=typeof t.ref=="string"?t.ref:Nt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=Hr(i);a.s.r==a.e.r&&(a.e.r=Hr(e["!ref"]).e.r,i=Nt(a));for(var o=0;o<s.length;++o){var c=s[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ge("autoFilter",null,{ref:i})}function qR(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ge("sheetViews",ge("sheetView",null,i),{})}function XR(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=oo[t.v];break;case"d":n&&n.cellDates?i=Ir(t.v,-1).toISOString():(t=Or(t),t.t="n",i=""+(t.v=Dr(Ir(t.v)))),typeof t.z>"u"&&(t.z=Rt[14]);break;default:i=t.v;break}var o=sr("v",ft(i)),c={r:e},u=Ti(n.cellXfs,t,n);switch(u!==0&&(c.s=u),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=sr("v",""+nh(n.Strings,t.v,n.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var f=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=ge("f",ft(t.f),f)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(c.cm=1),ge("c",o,c)}function YR(t,e,r,n){var i=[],s=[],a=Et(t["!ref"]),o="",c,u="",f=[],d=0,p=0,g=t["!rows"],v=Array.isArray(t),_={r:u},E,L=-1;for(p=a.s.c;p<=a.e.c;++p)f[p]=mr(p);for(d=a.s.r;d<=a.e.r;++d){for(s=[],u=or(d),p=a.s.c;p<=a.e.c;++p){c=f[p]+u;var V=v?(t[d]||[])[p]:t[c];V!==void 0&&(o=XR(V,c,t,e))!=null&&s.push(o)}(s.length>0||g&&g[d])&&(_={r:u},g&&g[d]&&(E=g[d],E.hidden&&(_.hidden=1),L=-1,E.hpx?L=Bl(E.hpx):E.hpt&&(L=E.hpt),L>-1&&(_.ht=L,_.customHeight=1),E.level&&(_.outlineLevel=E.level)),i[i.length]=ge("row",s.join(""),_))}if(g)for(;d<g.length;++d)g&&g[d]&&(_={r:d+1},E=g[d],E.hidden&&(_.hidden=1),L=-1,E.hpx?L=Bl(E.hpx):E.hpt&&(L=E.hpt),L>-1&&(_.ht=L,_.customHeight=1),E.level&&(_.outlineLevel=E.level),i[i.length]=ge("row","",_));return i.join("")}function A_(t,e,r,n){var i=[Mt,ge("worksheet",null,{xmlns:js[0],"xmlns:r":Kt.r})],s=r.SheetNames[t],a=0,o="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",f=Et(u);if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=Nt(f)}n||(n={}),c["!comments"]=[];var d=[];HR(c,r,t,e,i),i[i.length]=ge("dimension",null,{ref:u}),i[i.length]=qR(c,e,t,r),e.sheetFormat&&(i[i.length]=ge("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(i[i.length]=zR(c,c["!cols"])),i[a=i.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=YR(c,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),c["!protect"]&&(i[i.length]=jR(c["!protect"])),c["!autofilter"]!=null&&(i[i.length]=KR(c["!autofilter"],c,r,t)),c["!merges"]!=null&&c["!merges"].length>0&&(i[i.length]=UR(c["!merges"]));var p=-1,g,v=-1;return c["!links"].length>0&&(i[i.length]="<hyperlinks>",c["!links"].forEach(function(_){_[1].Target&&(g={ref:_[0]},_[1].Target.charAt(0)!="#"&&(v=ut(n,-1,ft(_[1].Target).replace(/#.*$/,""),rt.HLINK),g["r:id"]="rId"+v),(p=_[1].Target.indexOf("#"))>-1&&(g.location=ft(_[1].Target.slice(p+1))),_[1].Tooltip&&(g.tooltip=ft(_[1].Tooltip)),i[i.length]=ge("hyperlink",null,g))}),i[i.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(i[i.length]=GR(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=sr("ignoredErrors",ge("ignoredError",null,{numberStoredAsText:1,sqref:u}))),d.length>0&&(v=ut(n,-1,"../drawings/drawing"+(t+1)+".xml",rt.DRAW),i[i.length]=ge("drawing",null,{"r:id":"rId"+v}),c["!drawing"]=d),c["!comments"].length>0&&(v=ut(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",rt.VML),i[i.length]=ge("legacyDrawing",null,{"r:id":"rId"+v}),c["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function QR(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function JR(t,e,r){var n=ee(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=Bl(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:t,c:0},f=0;f<16;++f)if(!(e.s.c>f+1<<10||e.e.c<f<<10)){for(var d=-1,p=-1,g=f<<10;g<f+1<<10;++g){u.c=g;var v=Array.isArray(r)?(r[u.r]||[])[u.c]:r[ht(u)];v&&(d<0&&(d=g),p=g)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,p))}var _=n.l;return n.l=c,n.write_shift(4,o),n.l=_,n.length>n.l?n.slice(0,n.l):n}function ZR(t,e,r,n){var i=JR(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&se(t,0,i)}var e3=Ji,t3=zs;function r3(){}function n3(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=d4(t),r}function i3(t,e,r){r==null&&(r=ee(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Nl({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Bm(t,r),r.slice(0,r.l)}function s3(t){var e=qr(t);return[e]}function a3(t,e,r){return r==null&&(r=ee(8)),Xi(e,r)}function o3(t){var e=Yi(t);return[e]}function l3(t,e,r){return r==null&&(r=ee(4)),Qi(e,r)}function c3(t){var e=qr(t),r=t.read_shift(1);return[e,r,"b"]}function u3(t,e,r){return r==null&&(r=ee(9)),Xi(e,r),r.write_shift(1,t.v?1:0),r}function f3(t){var e=Yi(t),r=t.read_shift(1);return[e,r,"b"]}function h3(t,e,r){return r==null&&(r=ee(5)),Qi(e,r),r.write_shift(1,t.v?1:0),r}function d3(t){var e=qr(t),r=t.read_shift(1);return[e,r,"e"]}function p3(t,e,r){return r==null&&(r=ee(9)),Xi(e,r),r.write_shift(1,t.v),r}function g3(t){var e=Yi(t),r=t.read_shift(1);return[e,r,"e"]}function m3(t,e,r){return r==null&&(r=ee(8)),Qi(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function _3(t){var e=qr(t),r=t.read_shift(4);return[e,r,"s"]}function v3(t,e,r){return r==null&&(r=ee(12)),Xi(e,r),r.write_shift(4,e.v),r}function x3(t){var e=Yi(t),r=t.read_shift(4);return[e,r,"s"]}function E3(t,e,r){return r==null&&(r=ee(8)),Qi(e,r),r.write_shift(4,e.v),r}function T3(t){var e=qr(t),r=Ks(t);return[e,r,"n"]}function y3(t,e,r){return r==null&&(r=ee(16)),Xi(e,r),Wi(t.v,r),r}function w3(t){var e=Yi(t),r=Ks(t);return[e,r,"n"]}function A3(t,e,r){return r==null&&(r=ee(12)),Qi(e,r),Wi(t.v,r),r}function S3(t){var e=qr(t),r=Um(t);return[e,r,"n"]}function I3(t,e,r){return r==null&&(r=ee(12)),Xi(e,r),Hm(t.v,r),r}function C3(t){var e=Yi(t),r=Um(t);return[e,r,"n"]}function R3(t,e,r){return r==null&&(r=ee(8)),Qi(e,r),Hm(t.v,r),r}function P3(t){var e=qr(t),r=Xf(t);return[e,r,"is"]}function F3(t){var e=qr(t),r=_r(t);return[e,r,"str"]}function D3(t,e,r){return r==null&&(r=ee(12+4*t.v.length)),Xi(e,r),Xt(t.v,r),r.length>r.l?r.slice(0,r.l):r}function O3(t){var e=Yi(t),r=_r(t);return[e,r,"str"]}function b3(t,e,r){return r==null&&(r=ee(8+4*t.v.length)),Qi(e,r),Xt(t.v,r),r.length>r.l?r.slice(0,r.l):r}function k3(t,e,r){var n=t.l+e,i=qr(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=xc(t,n-t.l,r);a[3]=Vs(o,null,i,r.supbooks,r)}else t.l=n;return a}function N3(t,e,r){var n=t.l+e,i=qr(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=xc(t,n-t.l,r);a[3]=Vs(o,null,i,r.supbooks,r)}else t.l=n;return a}function L3(t,e,r){var n=t.l+e,i=qr(t);i.r=r["!row"];var s=Ks(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=xc(t,n-t.l,r);a[3]=Vs(o,null,i,r.supbooks,r)}else t.l=n;return a}function M3(t,e,r){var n=t.l+e,i=qr(t);i.r=r["!row"];var s=_r(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=xc(t,n-t.l,r);a[3]=Vs(o,null,i,r.supbooks,r)}else t.l=n;return a}var V3=Ji,B3=zs;function U3(t,e){return e==null&&(e=ee(4)),e.write_shift(4,t),e}function H3(t,e){var r=t.l+e,n=Ji(t),i=Yf(t),s=_r(t),a=_r(t),o=_r(t);t.l=r;var c={rfx:n,relId:i,loc:s,display:o};return a&&(c.Tooltip=a),c}function W3(t,e){var r=ee(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));zs({s:qt(t[0]),e:qt(t[0])},r),Qf("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return Xt(i||"",r),Xt(t[1].Tooltip||"",r),Xt("",r),r.slice(0,r.l)}function $3(){}function j3(t,e,r){var n=t.l+e,i=Wm(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=OR(t,n-t.l,r);a[1]=o}else t.l=n;return a}function G3(t,e,r){var n=t.l+e,i=Ji(t),s=[i];if(r.cellFormula){var a=kR(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function z3(t,e,r){r==null&&(r=ee(18));var n=Ec(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var S_=["left","right","top","bottom","header","footer"];function K3(t){var e={};return S_.forEach(function(r){e[r]=Ks(t)}),e}function q3(t,e){return e==null&&(e=ee(6*8)),w_(t),S_.forEach(function(r){Wi(t[r],e)}),e}function X3(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function Y3(t,e,r){r==null&&(r=ee(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Q3(t){var e=ee(24);return e.write_shift(4,4),e.write_shift(4,1),zs(t,e),e}function J3(t,e){return e==null&&(e=ee(16*4+2)),e.write_shift(2,t.password?a_(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function Z3(){}function eP(){}function tP(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Or(e),e.z=e.z||Rt[14],e.v=Dr(Ir(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var c={r,c:n};switch(c.s=Ti(i.cellXfs,e,i),e.l&&s["!links"].push([ht(c),e.l]),e.c&&s["!comments"].push([ht(c),e.c]),e.t){case"s":case"str":return i.bookSST?(o=nh(i.Strings,e.v,i.revStrings),c.t="s",c.v=o,a?se(t,18,E3(e,c)):se(t,7,v3(e,c))):(c.t="str",a?se(t,17,b3(e,c)):se(t,6,D3(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?se(t,13,R3(e,c)):se(t,2,I3(e,c)):a?se(t,16,A3(e,c)):se(t,5,y3(e,c)),!0;case"b":return c.t="b",a?se(t,15,h3(e,c)):se(t,4,u3(e,c)),!0;case"e":return c.t="e",a?se(t,14,m3(e,c)):se(t,3,p3(e,c)),!0}return a?se(t,12,l3(e,c)):se(t,1,a3(e,c)),!0}function rP(t,e,r,n){var i=Et(e["!ref"]||"A1"),s,a="",o=[];se(t,145);var c=Array.isArray(e),u=i.e.r;e["!rows"]&&(u=Math.max(i.e.r,e["!rows"].length-1));for(var f=i.s.r;f<=u;++f){a=or(f),ZR(t,e,i,f);var d=!1;if(f<=i.e.r)for(var p=i.s.c;p<=i.e.c;++p){f===i.s.r&&(o[p]=mr(p)),s=o[p]+a;var g=c?(e[f]||[])[p]:e[s];if(!g){d=!1;continue}d=tP(t,g,f,p,n,e,d)}}se(t,146)}function nP(t,e){!e||!e["!merges"]||(se(t,177,U3(e["!merges"].length)),e["!merges"].forEach(function(r){se(t,176,B3(r))}),se(t,178))}function iP(t,e){!e||!e["!cols"]||(se(t,390),e["!cols"].forEach(function(r,n){r&&se(t,60,z3(n,r))}),se(t,391))}function sP(t,e){!e||!e["!ref"]||(se(t,648),se(t,649,Q3(Et(e["!ref"]))),se(t,650))}function aP(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=ut(r,-1,n[1].Target.replace(/#.*$/,""),rt.HLINK);se(t,494,W3(n,i))}}),delete e["!links"]}function oP(t,e,r,n){if(e["!comments"].length>0){var i=ut(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",rt.VML);se(t,551,Qf("rId"+i)),e["!legacy"]=i}}function lP(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:Nt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Hr(s);o.s.r==o.e.r&&(o.e.r=Hr(e["!ref"]).e.r,s=Nt(o));for(var c=0;c<a.length;++c){var u=a[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),se(t,161,zs(Et(s))),se(t,162)}}function cP(t,e,r){se(t,133),se(t,137,Y3(e,r)),se(t,138),se(t,134)}function uP(t,e){e["!protect"]&&se(t,535,J3(e["!protect"]))}function fP(t,e,r,n){var i=Fr(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var c=Et(a["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],se(i,129),(r.vbaraw||a["!outline"])&&se(i,147,i3(o,a["!outline"])),se(i,148,t3(c)),cP(i,a,r.Workbook),iP(i,a),rP(i,a,t,e),uP(i,a),lP(i,a,r,t),nP(i,a),aP(i,a,n),a["!margins"]&&se(i,476,q3(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&sP(i,a),oP(i,a,t,n),se(i,130),i.end()}function hP(t,e){t.l+=10;var r=_r(t);return{name:r}}var dP=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function pP(t){return!t.Workbook||!t.Workbook.WBProps?"false":GS(t.Workbook.WBProps.date1904)?"true":"false"}var gP="][*?/\\".split("");function I_(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return gP.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function mP(t,e,r){t.forEach(function(n,i){I_(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function _P(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];mP(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)BR(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}function C_(t){var e=[Mt];e[e.length]=ge("workbook",null,{xmlns:js[0],"xmlns:r":Kt.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(dP.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=ge("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:ft(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=ge("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(e[e.length]=ge("definedName",ft(o.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function vP(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Lu(t),r.name=_r(t),r}function xP(t,e){return e||(e=ee(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Qf(t.strRelID,e),Xt(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function EP(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?_r(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function TP(t,e){e||(e=ee(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),Bm(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function yP(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=p4(t),a=bR(t,0,r),o=Yf(t);t.l=n;var c={Name:s,Ptg:a};return i<268435455&&(c.Sheet=i),o&&(c.Comment=o),c}function wP(t,e){se(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};se(t,156,xP(i))}se(t,144)}function AP(t,e){e||(e=ee(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Xt("SheetJS",e),Xt(Cl.version,e),Xt(Cl.version,e),Xt("7262",e),e.length>e.l?e.slice(0,e.l):e}function SP(t,e){e||(e=ee(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function IP(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(se(t,135),se(t,158,SP(i)),se(t,136))}}function CP(t,e){var r=Fr();return se(r,131),se(r,128,AP()),se(r,153,TP(t.Workbook&&t.Workbook.WBProps||null)),IP(r,t),wP(r,t),se(r,132),r.end()}function RP(t,e,r){return(e.slice(-4)===".bin"?CP:C_)(t)}function PP(t,e,r,n,i){return(e.slice(-4)===".bin"?fP:A_)(t,r,n,i)}function FP(t,e,r){return(e.slice(-4)===".bin"?qI:c_)(t,r)}function DP(t,e,r){return(e.slice(-4)===".bin"?TI:s_)(t,r)}function OP(t,e,r){return(e.slice(-4)===".bin"?uC:p_)(t)}function bP(t){return(t.slice(-4)===".bin"?rC:h_)()}function kP(t,e){var r=[];return t.Props&&r.push(F4(t.Props,e)),t.Custprops&&r.push(D4(t.Props,t.Custprops)),r.join("")}function NP(){return""}function LP(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(ge("NumberFormat",null,{"ss:Format":ft(Rt[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(ge("Style",s.join(""),a))}),ge("Styles",r.join(""))}function R_(t){return ge("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+th(t.Ref,{r:0,c:0})})}function MP(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(R_(i)))}return ge("Names",r.join(""))}function VP(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(R_(o)))}return s.join("")}function BP(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(ge("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(ge("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(ge("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(ge("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(sr("ProtectContents","True")),t["!protect"].objects&&i.push(sr("ProtectObjects","True")),t["!protect"].scenarios&&i.push(sr("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(sr("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(sr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":ge("WorksheetOptions",i.join(""),{xmlns:Vr.x})}function UP(t){return t.map(function(e){var r=jS(e.t||""),n=ge("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ge("Comment",n,{"ss:Author":e.a})}).join("")}function HP(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+ft(th(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var c=qt(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==a.r?"":"["+(c.r-a.r)+"]")+"C"+(c.c==a.c?"":"["+(c.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=ft(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=ft(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=a.c||u[f].s.r!=a.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var d="",p="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",p=String(t.v);break;case"b":d="Boolean",p=t.v?"1":"0";break;case"e":d="Error",p=oo[t.v];break;case"d":d="DateTime",p=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Rt[14]);break;case"s":d="String",p=$S(t.v||"");break}var g=Ti(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+g),o["ss:Index"]=a.c+1;var v=t.v!=null?p:"",_=t.t=="z"?"":'<Data ss:Type="'+d+'">'+v+"</Data>";return(t.c||[]).length>0&&(_+=UP(t.c)),ge("Cell",_,o)}function WP(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=l_(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function $P(t,e,r,n){if(!t["!ref"])return"";var i=Et(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(E,L){Zf(E);var V=!!E.width,N=Ec(L,E),U={"ss:Index":L+1};V&&(U["ss:Width"]=Ml(N.width)),E.hidden&&(U["ss:Hidden"]="1"),o.push(ge("Column",null,U))});for(var c=Array.isArray(t),u=i.s.r;u<=i.e.r;++u){for(var f=[WP(u,(t["!rows"]||[])[u])],d=i.s.c;d<=i.e.c;++d){var p=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>d)&&!(s[a].s.r>u)&&!(s[a].e.c<d)&&!(s[a].e.r<u)){(s[a].s.c!=d||s[a].s.r!=u)&&(p=!0);break}if(!p){var g={r:u,c:d},v=ht(g),_=c?(t[u]||[])[d]:t[v];f.push(HP(_,v,t,e,r,n,g))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function jP(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?VP(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?$P(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(BP(s,e,t,r)),n.join("")}function GP(t,e){e||(e={}),t.SSF||(t.SSF=Or(Rt)),t.SSF&&(gc(),pc(t.SSF),e.revssf=mc(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Ti(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(kP(t,e)),r.push(NP()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(ge("Worksheet",jP(n,e,t),{"ss:Name":ft(t.SheetNames[n])}));return r[2]=LP(t,e),r[3]=MP(t),Mt+ge("Workbook",r.join(""),{xmlns:Vr.ss,"xmlns:o":Vr.o,"xmlns:x":Vr.x,"xmlns:ss":Vr.ss,"xmlns:dt":Vr.dt,"xmlns:html":Vr.html})}var Jc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function zP(t,e){var r=[],n=[],i=[],s=0,a,o=Fd($d,"n"),c=Fd(jd,"n");if(t.Props)for(a=cr(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(c,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=cr(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(c,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)Jm.indexOf(i[s][0])>-1||Xm.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&dt.utils.cfb_add(e,"/SummaryInformation",Xd(n,Jc.SI,c,jd)),(r.length||u.length)&&dt.utils.cfb_add(e,"/DocumentSummaryInformation",Xd(r,Jc.DSI,o,$d,u.length?u:null,Jc.UDI))}function KP(t,e){var r=e||{},n=dt.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return dt.utils.cfb_add(n,i,P_(t,r)),r.biff==8&&(t.Props||t.Custprops)&&zP(t,n),r.biff==8&&t.vbaraw&&fC(n,dt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var qP={0:{f:QR},1:{f:s3},2:{f:S3},3:{f:d3},4:{f:c3},5:{f:T3},6:{f:F3},7:{f:_3},8:{f:M3},9:{f:L3},10:{f:k3},11:{f:N3},12:{f:o3},13:{f:C3},14:{f:g3},15:{f:f3},16:{f:w3},17:{f:O3},18:{f:x3},19:{f:Xf},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:yP},40:{},42:{},43:{f:FI},44:{f:RI},45:{f:bI},46:{f:NI},47:{f:kI},48:{},49:{f:o4},50:{},51:{f:QI},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:lI},62:{f:P3},63:{f:nC},64:{f:Z3},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:xn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:X3},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:n3},148:{f:e3,p:16},151:{f:$3},152:{},153:{f:EP},154:{},155:{},156:{f:vP},157:{},158:{},159:{T:1,f:vI},160:{T:-1},161:{T:1,f:Ji},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:V3},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:XI},336:{T:-1},337:{f:eC,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Lu},357:{},358:{},359:{},360:{T:1},361:{},362:{f:rI},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:j3},427:{f:G3},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:K3},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:r3},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:H3},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Lu},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:lC},633:{T:1},634:{T:-1},635:{T:1,f:aC},636:{T:-1},637:{f:f4},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:hP},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:eP},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function _e(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&zf(r)&&t.push(r)}}function XP(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return _e(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,c=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var f=t.next(4);for(f.write_shift(2,s),f.write_shift(2,u),t.push(r.slice(c,c+u)),c+=u;c<i;){for(f=t.next(4),f.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;f.write_shift(2,u),t.push(r.slice(c,c+u)),c+=u}}}function co(t,e,r){return t||(t=ee(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function YP(t,e,r,n){var i=ee(9);return co(i,t,e),e_(r,n||"b",i),i}function QP(t,e,r){var n=ee(8+2*r.length);return co(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function JP(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Dr(Ir(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?_e(t,2,hI(r,n,i)):_e(t,3,fI(r,n,i));return;case"b":case"e":_e(t,5,YP(r,n,e.v,e.t));return;case"s":case"str":_e(t,4,QP(r,n,(e.v||"").slice(0,255)));return}_e(t,1,co(null,r,n))}function ZP(t,e,r,n){var i=Array.isArray(e),s=Et(e["!ref"]||"A1"),a,o="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Nt(s)}for(var u=s.s.r;u<=s.e.r;++u){o=or(u);for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(c[f]=mr(f)),a=c[f]+o;var d=i?(e[u]||[])[f]:e[a];d&&JP(t,d,u,f)}}}function eF(t,e){for(var r=e||{},n=Fr(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return _e(n,r.biff==4?1033:r.biff==3?521:9,Jf(t,16,r)),ZP(n,t.Sheets[t.SheetNames[i]],i,r),_e(n,10),n.end()}function tF(t,e,r){_e(t,49,q4({sz:12,name:"Arial"},r))}function rF(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&_e(t,1054,Q4(i,e[i],r))})}function nF(t,e){var r=ee(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),_e(t,2151,r),r=ee(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),n_(Et(e["!ref"]||"A1"),r),r.write_shift(4,4),_e(t,2152,r)}function iF(t,e){for(var r=0;r<16;++r)_e(t,224,Qd({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){_e(t,224,Qd(n,0,e))})}function sF(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];_e(t,440,sI(n)),n[1].Tooltip&&_e(t,2048,aI(n))}delete e["!links"]}function aF(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&_e(t,125,cI(Ec(i,n),i))})}}function oF(t,e,r,n,i){var s=16+Ti(i.cellXfs,e,i);if(e.v==null&&!e.bf){_e(t,513,$i(r,n,s));return}if(e.bf)_e(t,6,DR(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Dr(Ir(e.v)):e.v;_e(t,515,tI(r,n,a,s));break;case"b":case"e":_e(t,517,eI(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=nh(i.Strings,e.v,i.revStrings);_e(t,253,X4(r,n,o,s))}else _e(t,516,Y4(r,n,(e.v||"").slice(0,255),s,i));break;default:_e(t,513,$i(r,n,s))}}function lF(t,e,r){var n=Fr(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},c=Array.isArray(s),u=e.biff==8,f,d="",p=[],g=Et(s["!ref"]||"A1"),v=u?65536:16384;if(g.e.c>255||g.e.r>=v){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,v-1)}_e(n,2057,Jf(r,16,e)),_e(n,13,$r(1)),_e(n,12,$r(100)),_e(n,15,wr(!0)),_e(n,17,wr(!1)),_e(n,16,Wi(.001)),_e(n,95,wr(!0)),_e(n,42,wr(!1)),_e(n,43,wr(!1)),_e(n,130,$r(1)),_e(n,128,Z4()),_e(n,131,wr(!1)),_e(n,132,wr(!1)),u&&aF(n,s["!cols"]),_e(n,512,J4(g,e)),u&&(s["!links"]=[]);for(var _=g.s.r;_<=g.e.r;++_){d=or(_);for(var E=g.s.c;E<=g.e.c;++E){_===g.s.r&&(p[E]=mr(E)),f=p[E]+d;var L=c?(s[_]||[])[E]:s[f];L&&(oF(n,L,_,E,e),u&&L.l&&s["!links"].push([f,L.l]))}}var V=o.CodeName||o.name||i;return u&&_e(n,574,K4((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&_e(n,229,iI(s["!merges"])),u&&sF(n,s),_e(n,442,r_(V)),u&&nF(n,s),_e(n,10),n.end()}function cF(t,e,r){var n=Fr(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,c=r.biff==5;if(_e(n,2057,Jf(t,5,r)),r.bookType=="xla"&&_e(n,135),_e(n,225,o?$r(1200):null),_e(n,193,k4(2)),c&&_e(n,191),c&&_e(n,192),_e(n,226),_e(n,92,$4("SheetJS",r)),_e(n,66,$r(o?1200:1252)),o&&_e(n,353,$r(0)),o&&_e(n,448),_e(n,317,uI(t.SheetNames.length)),o&&t.vbaraw&&_e(n,211),o&&t.vbaraw){var u=a.CodeName||"ThisWorkbook";_e(n,442,r_(u))}_e(n,156,$r(17)),_e(n,25,wr(!1)),_e(n,18,wr(!1)),_e(n,19,$r(0)),o&&_e(n,431,wr(!1)),o&&_e(n,444,$r(0)),_e(n,61,z4()),_e(n,64,wr(!1)),_e(n,141,$r(0)),_e(n,34,wr(pP(t)=="true")),_e(n,14,wr(!0)),o&&_e(n,439,wr(!1)),_e(n,218,$r(0)),tF(n,t,r),rF(n,t.SSF,r),iF(n,r),o&&_e(n,352,wr(!1));var f=n.end(),d=Fr();o&&_e(d,140,oI()),o&&r.Strings&&XP(d,252,G4(r.Strings)),_e(d,10);var p=d.end(),g=Fr(),v=0,_=0;for(_=0;_<t.SheetNames.length;++_)v+=(o?12:11)+(o?2:1)*t.SheetNames[_].length;var E=f.length+v+p.length;for(_=0;_<t.SheetNames.length;++_){var L=s[_]||{};_e(g,133,j4({pos:E,hs:L.Hidden||0,dt:0,name:t.SheetNames[_]},r)),E+=e[_].length}var V=g.end();if(v!=V.length)throw new Error("BS8 "+v+" != "+V.length);var N=[];return f.length&&N.push(f),V.length&&N.push(V),p.length&&N.push(p),ir(N)}function uF(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Or(Rt)),t&&t.SSF&&(gc(),pc(t.SSF),r.revssf=mc(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ih(r),r.cellXfs=[],Ti(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=lF(i,r,t);return n.unshift(cF(t,n,r)),ir(n)}function P_(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Hr(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return uF(t,e);case 4:case 3:case 2:return eF(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function fF(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,c=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>a)&&!(i[u].e.r<r||i[u].e.c<a)){if(i[u].s.r<r||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,c=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var f=ht({r,c:a}),d=n.dense?(t[r]||[])[a]:t[f],p=d&&d.v!=null&&(d.h||WS(d.w||(Un(d),d.w)||""))||"",g={};o>1&&(g.rowspan=o),c>1&&(g.colspan=c),n.editable?p='<span contenteditable="true">'+p+"</span>":d&&(g["data-t"]=d&&d.t||"z",d.v!=null&&(g["data-v"]=d.v),d.z!=null&&(g["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+d.l.Target+'">'+p+"</a>")),g.id=(n.id||"sjs")+"-"+f,s.push(ge("td",p,g))}}var v="<tr>";return v+s.join("")+"</tr>"}var hF='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',dF="</body></html>";function pF(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function F_(t,e){var r=e||{},n=r.header!=null?r.header:hF,i=r.footer!=null?r.footer:dF,s=[n],a=Hr(t["!ref"]);r.dense=Array.isArray(t),s.push(pF(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(fF(t,a,o,r));return s.push("</table>"+i),s.join("")}function D_(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?qt(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var f=Hr(t["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),i==-1&&(u.e.r=i=f.e.r+1)}var d=[],p=0,g=t["!rows"]||(t["!rows"]=[]),v=0,_=0,E=0,L=0,V=0,N=0;for(t["!cols"]||(t["!cols"]=[]);v<o.length&&_<c;++v){var U=o[v];if(ip(U)){if(n.display)continue;g[_]={hidden:!0}}var re=U.children;for(E=L=0;E<re.length;++E){var ue=re[E];if(!(n.display&&ip(ue))){var w=ue.hasAttribute("data-v")?ue.getAttribute("data-v"):ue.hasAttribute("v")?ue.getAttribute("v"):zS(ue.innerHTML),y=ue.getAttribute("data-z")||ue.getAttribute("z");for(p=0;p<d.length;++p){var T=d[p];T.s.c==L+s&&T.s.r<_+i&&_+i<=T.e.r&&(L=T.e.c+1-s,p=-1)}N=+ue.getAttribute("colspan")||1,((V=+ue.getAttribute("rowspan")||1)>1||N>1)&&d.push({s:{r:_+i,c:L+s},e:{r:_+i+(V||1)-1,c:L+s+(N||1)-1}});var I={t:"s",v:w},P=ue.getAttribute("data-t")||ue.getAttribute("t")||"";w!=null&&(w.length==0?I.t=P||"z":n.raw||w.trim().length==0||P=="s"||(w==="TRUE"?I={t:"b",v:!0}:w==="FALSE"?I={t:"b",v:!1}:isNaN(On(w))?isNaN(za(w).getDate())||(I={t:"d",v:Ir(w)},n.cellDates||(I={t:"n",v:Dr(I.v)}),I.z=n.dateNF||Rt[14]):I={t:"n",v:On(w)})),I.z===void 0&&y!=null&&(I.z=y);var k="",R=ue.getElementsByTagName("A");if(R&&R.length)for(var $e=0;$e<R.length&&!(R[$e].hasAttribute("href")&&(k=R[$e].getAttribute("href"),k.charAt(0)!="#"));++$e);k&&k.charAt(0)!="#"&&(I.l={Target:k}),n.dense?(t[_+i]||(t[_+i]=[]),t[_+i][L+s]=I):t[ht({c:L+s,r:_+i})]=I,u.e.c<L+s&&(u.e.c=L+s),L+=N}}++_}return d.length&&(t["!merges"]=(t["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,_-1+i),t["!ref"]=Nt(u),_>=c&&(t["!fullref"]=Nt((u.e.r=o.length-v+_-1+i,u))),t}function O_(t,e){var r=e||{},n=r.dense?[]:{};return D_(n,t,e)}function gF(t,e){return qi(O_(t,e),e)}function ip(t){var e="",r=mF(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function mF(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var _F=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+qa({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Mt+e}}(),sp=function(){var t=function(s){return ft(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var c=[];c.push('      <table:table table:name="'+ft(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,d=Hr(s["!ref"]||"A1"),p=s["!merges"]||[],g=0,v=Array.isArray(s);if(s["!cols"])for(f=0;f<=d.e.c;++f)c.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var _="",E=s["!rows"]||[];for(u=0;u<d.s.r;++u)_=E[u]?' table:style-name="ro'+E[u].ods+'"':"",c.push("        <table:table-row"+_+`></table:table-row>
`);for(;u<=d.e.r;++u){for(_=E[u]?' table:style-name="ro'+E[u].ods+'"':"",c.push("        <table:table-row"+_+`>
`),f=0;f<d.s.c;++f)c.push(e);for(;f<=d.e.c;++f){var L=!1,V={},N="";for(g=0;g!=p.length;++g)if(!(p[g].s.c>f)&&!(p[g].s.r>u)&&!(p[g].e.c<f)&&!(p[g].e.r<u)){(p[g].s.c!=f||p[g].s.r!=u)&&(L=!0),V["table:number-columns-spanned"]=p[g].e.c-p[g].s.c+1,V["table:number-rows-spanned"]=p[g].e.r-p[g].s.r+1;break}if(L){c.push(r);continue}var U=ht({r:u,c:f}),re=v?(s[u]||[])[f]:s[U];if(re&&re.f&&(V["table:formula"]=ft(MR(re.f)),re.F&&re.F.slice(0,U.length)==U)){var ue=Hr(re.F);V["table:number-matrix-columns-spanned"]=ue.e.c-ue.s.c+1,V["table:number-matrix-rows-spanned"]=ue.e.r-ue.s.r+1}if(!re){c.push(e);continue}switch(re.t){case"b":N=re.v?"TRUE":"FALSE",V["office:value-type"]="boolean",V["office:boolean-value"]=re.v?"true":"false";break;case"n":N=re.w||String(re.v||0),V["office:value-type"]="float",V["office:value"]=re.v||0;break;case"s":case"str":N=re.v==null?"":re.v,V["office:value-type"]="string";break;case"d":N=re.w||Ir(re.v).toISOString(),V["office:value-type"]="date",V["office:date-value"]=Ir(re.v).toISOString(),V["table:style-name"]="ce1";break;default:c.push(e);continue}var w=t(N);if(re.l&&re.l.Target){var y=re.l.Target;y=y.charAt(0)=="#"?"#"+VR(y.slice(1)):y,y.charAt(0)!="#"&&!y.match(/^\w+:/)&&(y="../"+y),w=ge("text:a",w,{"xlink:href":y.replace(/&/g,"&amp;")})}c.push("          "+ge("table:table-cell",ge("text:p",w,{}),V)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var d=u["!cols"][f];if(d.width==null&&d.wpx==null&&d.wch==null)continue;Zf(d),d.ods=o;var p=u["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),s.push(`  </style:style>
`),++o}}});var c=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=c;var d=u["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var c=[Mt],u=qa({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=qa({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+f+`>
`),c.push(Km().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),i(c,a),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var d=0;d!=a.SheetNames.length;++d)c.push(n(a.Sheets[a.SheetNames[d]],a,d));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function b_(t,e){if(e.bookType=="fods")return sp(t,e);var r=Wf(),n="",i=[],s=[];return n="mimetype",ze(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ze(r,n,sp(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",ze(r,n,_F(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",ze(r,n,Mt+Km()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",ze(r,n,P4(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ze(r,n,C4(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ul(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function vF(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Zr(Ka(t))}function xF(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function _i(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function EF(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function Xa(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function ct(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Ps(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Bt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=Xa(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var c=r[0];t[r[0]++]>=128;);o=t.slice(c,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Xa(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:o,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function Jt(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(ct(n*8+i.type)),i.type==2&&e.push(ct(i.data.length)),e.push(i.data))})}),_i(e)}function Qr(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=Xa(t,n),s=Bt(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:Ps(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=Bt(o.data),u=Ps(c[3][0].data);a.messages.push({meta:c,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(a.merge=Ps(s[3][0].data)>>>0>0),r.push(a)}return r}function ls(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:ct(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:ct(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:ct(a.data.length)}],n[2].push({data:Jt(a.meta),type:2})});var s=Jt(n);e.push(ct(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),_i(e)}function TF(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Xa(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var c=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[_i(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(i.push(i[0].slice(-c)),u-=c;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-c,-c+u))}}var f=_i(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Jr(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(TF(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return _i(e)}function cs(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=ct(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return _i(e)}function Zc(t,e){var r=new Uint8Array(32),n=Ul(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,EF(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function eu(t,e){var r=new Uint8Array(32),n=Ul(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function qn(t){var e=Bt(t);return Xa(e[1][0].data)}function yF(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&Ps(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=Ul(t[7][0].data),f=0,d=[],p=Ul(t[4][0].data),g=0,v=[],_=0;_<e.length;++_){if(e[_]==null){u.setUint16(_*2,65535,!0),p.setUint16(_*2,65535);continue}u.setUint16(_*2,f,!0),p.setUint16(_*2,g,!0);var E,L;switch(typeof e[_]){case"string":E=Zc({t:"s",v:e[_]},r),L=eu({t:"s",v:e[_]},r);break;case"number":E=Zc({t:"n",v:e[_]},r),L=eu({t:"n",v:e[_]},r);break;case"boolean":E=Zc({t:"b",v:e[_]},r),L=eu({t:"b",v:e[_]},r);break;default:throw new Error("Unsupported value "+e[_])}d.push(E),f+=E.length,v.push(L),g+=L.length,++c}for(t[2][0].data=ct(c);_<t[7][0].data.length/2;++_)u.setUint16(_*2,65535,!0),p.setUint16(_*2,65535,!0);return t[6][0].data=_i(d),t[3][0].data=_i(v),c}function wF(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Hr(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Nt(n)));var s=Hl(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(G){return G.forEach(function(W){typeof W=="string"&&a.push(W)})});var o={},c=[],u=dt.read(e.numbers,{type:"base64"});u.FileIndex.map(function(G,W){return[G,u.FullPaths[W]]}).forEach(function(G){var W=G[0],H=G[1];if(W.type==2&&W.name.match(/\.iwa/)){var ne=W.content,we=Jr(ne),Ce=Qr(we);Ce.forEach(function(Ie){c.push(Ie.id),o[Ie.id]={deps:[],location:H,type:Ps(Ie.messages[0].meta[1][0].data)}})}}),c.sort(function(G,W){return G-W});var f=c.filter(function(G){return G>1}).map(function(G){return[G,ct(G)]});u.FileIndex.map(function(G,W){return[G,u.FullPaths[W]]}).forEach(function(G){var W=G[0];if(G[1],!!W.name.match(/\.iwa/)){var H=Qr(Jr(W.content));H.forEach(function(ne){ne.messages.forEach(function(we){f.forEach(function(Ce){ne.messages.some(function(Ie){return Ps(Ie.meta[1][0].data)!=11006&&xF(Ie.data,Ce[1])})&&o[Ce[0]].deps.push(ne.id)})})})}});for(var d=dt.find(u,o[1].location),p=Qr(Jr(d.content)),g,v=0;v<p.length;++v){var _=p[v];_.id==1&&(g=_)}var E=qn(Bt(g.messages[0].data)[1][0].data);for(d=dt.find(u,o[E].location),p=Qr(Jr(d.content)),v=0;v<p.length;++v)_=p[v],_.id==E&&(g=_);for(E=qn(Bt(g.messages[0].data)[2][0].data),d=dt.find(u,o[E].location),p=Qr(Jr(d.content)),v=0;v<p.length;++v)_=p[v],_.id==E&&(g=_);for(E=qn(Bt(g.messages[0].data)[2][0].data),d=dt.find(u,o[E].location),p=Qr(Jr(d.content)),v=0;v<p.length;++v)_=p[v],_.id==E&&(g=_);var L=Bt(g.messages[0].data);{L[6][0].data=ct(n.e.r+1),L[7][0].data=ct(n.e.c+1);var V=qn(L[46][0].data),N=dt.find(u,o[V].location),U=Qr(Jr(N.content));{for(var re=0;re<U.length&&U[re].id!=V;++re);if(U[re].id!=V)throw"Bad ColumnRowUIDMapArchive";var ue=Bt(U[re].messages[0].data);ue[1]=[],ue[2]=[],ue[3]=[];for(var w=0;w<=n.e.c;++w){var y=[];y[1]=y[2]=[{type:0,data:ct(w+420690)}],ue[1].push({type:2,data:Jt(y)}),ue[2].push({type:0,data:ct(w)}),ue[3].push({type:0,data:ct(w)})}ue[4]=[],ue[5]=[],ue[6]=[];for(var T=0;T<=n.e.r;++T)y=[],y[1]=y[2]=[{type:0,data:ct(T+726270)}],ue[4].push({type:2,data:Jt(y)}),ue[5].push({type:0,data:ct(T)}),ue[6].push({type:0,data:ct(T)});U[re].messages[0].data=Jt(ue)}N.content=cs(ls(U)),N.size=N.content.length,delete L[46];var I=Bt(L[4][0].data);{I[7][0].data=ct(n.e.r+1);var P=Bt(I[1][0].data),k=qn(P[2][0].data);N=dt.find(u,o[k].location),U=Qr(Jr(N.content));{if(U[0].id!=k)throw"Bad HeaderStorageBucket";var R=Bt(U[0].messages[0].data);for(T=0;T<s.length;++T){var $e=Bt(R[2][0].data);$e[1][0].data=ct(T),$e[4][0].data=ct(s[T].length),R[2][T]={type:R[2][0].type,data:Jt($e)}}U[0].messages[0].data=Jt(R)}N.content=cs(ls(U)),N.size=N.content.length;var ke=qn(I[2][0].data);N=dt.find(u,o[ke].location),U=Qr(Jr(N.content));{if(U[0].id!=ke)throw"Bad HeaderStorageBucket";for(R=Bt(U[0].messages[0].data),w=0;w<=n.e.c;++w)$e=Bt(R[2][0].data),$e[1][0].data=ct(w),$e[4][0].data=ct(n.e.r+1),R[2][w]={type:R[2][0].type,data:Jt($e)};U[0].messages[0].data=Jt(R)}N.content=cs(ls(U)),N.size=N.content.length;var Xe=qn(I[4][0].data);(function(){for(var G=dt.find(u,o[Xe].location),W=Qr(Jr(G.content)),H,ne=0;ne<W.length;++ne){var we=W[ne];we.id==Xe&&(H=we)}var Ce=Bt(H.messages[0].data);{Ce[3]=[];var Ie=[];a.forEach(function(b,B){Ie[1]=[{type:0,data:ct(B)}],Ie[2]=[{type:0,data:ct(1)}],Ie[3]=[{type:2,data:vF(b)}],Ce[3].push({type:2,data:Jt(Ie)})})}H.messages[0].data=Jt(Ce);var me=ls(W),et=cs(me);G.content=et,G.size=G.content.length})();var Ne=Bt(I[3][0].data);{var He=Ne[1][0];delete Ne[2];var it=Bt(He.data);{var Ft=qn(it[2][0].data);(function(){for(var G=dt.find(u,o[Ft].location),W=Qr(Jr(G.content)),H,ne=0;ne<W.length;++ne){var we=W[ne];we.id==Ft&&(H=we)}var Ce=Bt(H.messages[0].data);{delete Ce[6],delete Ne[7];var Ie=new Uint8Array(Ce[5][0].data);Ce[5]=[];for(var me=0,et=0;et<=n.e.r;++et){var b=Bt(Ie);me+=yF(b,s[et],a),b[1][0].data=ct(et),Ce[5].push({data:Jt(b),type:2})}Ce[1]=[{type:0,data:ct(n.e.c+1)}],Ce[2]=[{type:0,data:ct(n.e.r+1)}],Ce[3]=[{type:0,data:ct(me)}],Ce[4]=[{type:0,data:ct(n.e.r+1)}]}H.messages[0].data=Jt(Ce);var B=ls(W),K=cs(B);G.content=K,G.size=G.content.length})()}He.data=Jt(it)}I[3][0].data=Jt(Ne)}L[4][0].data=Jt(I)}g.messages[0].data=Jt(L);var wt=ls(p),M=cs(wt);return d.content=M,d.size=d.content.length,u}function AF(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function ih(t){AF([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function SF(t,e){return e.bookType=="ods"?b_(t,e):e.bookType=="numbers"?wF(t,e):e.bookType=="xlsb"?IF(t,e):CF(t,e)}function IF(t,e){_s=1024,t&&!t.SSF&&(t.SSF=Or(Rt)),t&&t.SSF&&(gc(),pc(t.SSF),e.revssf=mc(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Ra?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=g_.indexOf(e.bookType)>-1,i=jm();ih(e=e||{});var s=Wf(),a="",o=0;if(e.cellXfs=[],Ti(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",ze(s,a,qm(t.Props,e)),i.coreprops.push(a),ut(e.rels,2,a,rt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(t.SheetNames[u]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,ze(s,a,Ym(t.Props)),i.extprops.push(a),ut(e.rels,3,a,rt.EXT_PROPS),t.Custprops!==t.Props&&cr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",ze(s,a,Qm(t.Custprops)),i.custprops.push(a),ut(e.rels,4,a,rt.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var f={"!id":{}},d=t.Sheets[t.SheetNames[o-1]],p=(d||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,ze(s,a,PP(o-1,a,e,t,f)),i.sheets.push(a),ut(e.wbrels,-1,"worksheets/sheet"+o+"."+r,rt.WS[0])}if(d){var g=d["!comments"],v=!1,_="";g&&g.length>0&&(_="xl/comments"+o+"."+r,ze(s,_,OP(g,_)),i.comments.push(_),ut(f,-1,"../comments"+o+"."+r,rt.CMNT),v=!0),d["!legacy"]&&v&&ze(s,"xl/drawings/vmlDrawing"+o+".vml",d_(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&ze(s,zm(a),Cs(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,ze(s,a,DP(e.Strings,a,e)),i.strs.push(a),ut(e.wbrels,-1,"sharedStrings."+r,rt.SST)),a="xl/workbook."+r,ze(s,a,RP(t,a)),i.workbooks.push(a),ut(e.rels,1,a,rt.WB),a="xl/theme/theme1.xml",ze(s,a,f_(t.Themes,e)),i.themes.push(a),ut(e.wbrels,-1,"theme/theme1.xml",rt.THEME),a="xl/styles."+r,ze(s,a,FP(t,a,e)),i.styles.push(a),ut(e.wbrels,-1,"styles."+r,rt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",ze(s,a,t.vbaraw),i.vba.push(a),ut(e.wbrels,-1,"vbaProject.bin",rt.VBA)),a="xl/metadata."+r,ze(s,a,bP(a)),i.metadata.push(a),ut(e.wbrels,-1,"metadata."+r,rt.XLMETA),ze(s,"[Content_Types].xml",Gm(i,e)),ze(s,"_rels/.rels",Cs(e.rels)),ze(s,"xl/_rels/workbook."+r+".rels",Cs(e.wbrels)),delete e.revssf,delete e.ssf,s}function CF(t,e){_s=1024,t&&!t.SSF&&(t.SSF=Or(Rt)),t&&t.SSF&&(gc(),pc(t.SSF),e.revssf=mc(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Ra?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=g_.indexOf(e.bookType)>-1,i=jm();ih(e=e||{});var s=Wf(),a="",o=0;if(e.cellXfs=[],Ti(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",ze(s,a,qm(t.Props,e)),i.coreprops.push(a),ut(e.rels,2,a,rt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(t.SheetNames[u]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,ze(s,a,Ym(t.Props)),i.extprops.push(a),ut(e.rels,3,a,rt.EXT_PROPS),t.Custprops!==t.Props&&cr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",ze(s,a,Qm(t.Custprops)),i.custprops.push(a),ut(e.rels,4,a,rt.CUST_PROPS));var f=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var d={"!id":{}},p=t.Sheets[t.SheetNames[o-1]],g=(p||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,ze(s,a,A_(o-1,e,t,d)),i.sheets.push(a),ut(e.wbrels,-1,"worksheets/sheet"+o+"."+r,rt.WS[0])}if(p){var v=p["!comments"],_=!1,E="";if(v&&v.length>0){var L=!1;v.forEach(function(V){V[1].forEach(function(N){N.T==!0&&(L=!0)})}),L&&(E="xl/threadedComments/threadedComment"+o+"."+r,ze(s,E,iC(v,f,e)),i.threadedcomments.push(E),ut(d,-1,"../threadedComments/threadedComment"+o+"."+r,rt.TCMNT)),E="xl/comments"+o+"."+r,ze(s,E,p_(v)),i.comments.push(E),ut(d,-1,"../comments"+o+"."+r,rt.CMNT),_=!0}p["!legacy"]&&_&&ze(s,"xl/drawings/vmlDrawing"+o+".vml",d_(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}d["!id"].rId1&&ze(s,zm(a),Cs(d))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,ze(s,a,s_(e.Strings,e)),i.strs.push(a),ut(e.wbrels,-1,"sharedStrings."+r,rt.SST)),a="xl/workbook."+r,ze(s,a,C_(t)),i.workbooks.push(a),ut(e.rels,1,a,rt.WB),a="xl/theme/theme1.xml",ze(s,a,f_(t.Themes,e)),i.themes.push(a),ut(e.wbrels,-1,"theme/theme1.xml",rt.THEME),a="xl/styles."+r,ze(s,a,c_(t,e)),i.styles.push(a),ut(e.wbrels,-1,"styles."+r,rt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",ze(s,a,t.vbaraw),i.vba.push(a),ut(e.wbrels,-1,"vbaProject.bin",rt.VBA)),a="xl/metadata."+r,ze(s,a,h_()),i.metadata.push(a),ut(e.wbrels,-1,"metadata."+r,rt.XLMETA),f.length>1&&(a="xl/persons/person.xml",ze(s,a,sC(f)),i.people.push(a),ut(e.wbrels,-1,"persons/person.xml",rt.PEOPLE)),ze(s,"[Content_Types].xml",Gm(i,e)),ze(s,"_rels/.rels",Cs(e.rels)),ze(s,"xl/_rels/workbook."+r+".rels",Cs(e.wbrels)),delete e.revssf,delete e.ssf,s}function RF(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Bn(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function k_(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return so(e.file,dt.write(t,{type:nt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return dt.write(t,e)}function PF(t,e){var r=Or(e||{}),n=SF(t,r);return FF(n,r)}function FF(t,e){var r={},n=nt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?dt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(dc(i))}return e.password&&typeof encrypt_agile<"u"?k_(encrypt_agile(i,e.password),e):e.type==="file"?so(e.file,i):e.type=="string"?Aa(i):i}function DF(t,e){var r=e||{},n=KP(t,r);return k_(n,r)}function ln(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Ga(Ka(n));case"binary":return Ka(n);case"string":return t;case"file":return so(e.file,n,"utf8");case"buffer":return nt?Wn(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ln(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function OF(t,e){switch(e.type){case"base64":return Ga(t);case"binary":return t;case"string":return t;case"file":return so(e.file,t,"binary");case"buffer":return nt?Wn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Ho(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Ga(r):e.type=="string"?Aa(r):r;case"file":return so(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function N_(t,e){aS(),_P(t);var r=Or(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=N_(t,r);return r.type="array",dc(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ln(GP(t,r),r);case"slk":case"sylk":return ln(pI.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return ln(F_(t.Sheets[t.SheetNames[i]],r),r);case"txt":return OF(L_(t.Sheets[t.SheetNames[i]],r),r);case"csv":return ln(sh(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return ln(gI.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return Ho(dI.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return ln(mI.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return ln(wI.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return ln(i_.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return ln(b_(t,r),r);case"wk1":return Ho(Jd.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return Ho(Jd.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Ho(P_(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),DF(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return PF(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function bF(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function kF(t,e,r){var n={};return n.type="file",n.file=e,bF(n),N_(t,n)}function NF(t,e,r,n,i,s,a,o){var c=or(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,p=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!a||t[r])for(var g=e.s.c;g<=e.e.c;++g){var v=a?t[r][g]:t[n[g]+c];if(v===void 0||v.t===void 0){if(u===void 0)continue;s[g]!=null&&(p[s[g]]=u);continue}var _=v.v;switch(v.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[g]!=null){if(_==null)if(v.t=="e"&&_===null)p[s[g]]=null;else if(u!==void 0)p[s[g]]=u;else if(f&&_===null)p[s[g]]=null;else continue;else p[s[g]]=f&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?_:Un(v,_,o);_!=null&&(d=!1)}}return{row:p,isempty:d}}function Hl(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},f=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":c=Et(f);break;case"number":c=Et(t["!ref"]),c.s.r=f;break;default:c=f}n>0&&(i=0);var d=or(c.s.r),p=[],g=[],v=0,_=0,E=Array.isArray(t),L=c.s.r,V=0,N={};E&&!t[L]&&(t[L]=[]);var U=u.skipHidden&&t["!cols"]||[],re=u.skipHidden&&t["!rows"]||[];for(V=c.s.c;V<=c.e.c;++V)if(!(U[V]||{}).hidden)switch(p[V]=mr(V),r=E?t[L][V]:t[p[V]+d],n){case 1:s[V]=V-c.s.c;break;case 2:s[V]=p[V];break;case 3:s[V]=u.header[V-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Un(r,null,u),_=N[a]||0,!_)N[a]=1;else{do o=a+"_"+_++;while(N[o]);N[a]=_,N[o]=1}s[V]=o}for(L=c.s.r+i;L<=c.e.r;++L)if(!(re[L]||{}).hidden){var ue=NF(t,c,L,p,n,s,E,u);(ue.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(g[v++]=ue.row)}return g.length=v,g}var ap=/"/g;function LF(t,e,r,n,i,s,a,o){for(var c=!0,u=[],f="",d=or(r),p=e.s.c;p<=e.e.c;++p)if(n[p]){var g=o.dense?(t[r]||[])[p]:t[n[p]+d];if(g==null)f="";else if(g.v!=null){c=!1,f=""+(o.rawNumbers&&g.t=="n"?g.v:Un(g,null,o));for(var v=0,_=0;v!==f.length;++v)if((_=f.charCodeAt(v))===i||_===s||_===34||o.forceQuotes){f='"'+f.replace(ap,'""')+'"';break}f=="ID"&&(f='"ID"')}else g.f!=null&&!g.F?(c=!1,f="="+g.f,f.indexOf(",")>=0&&(f='"'+f.replace(ap,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&c?null:u.join(a)}function sh(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=Et(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),f="",d=[];n.dense=Array.isArray(t);for(var p=n.skipHidden&&t["!cols"]||[],g=n.skipHidden&&t["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(p[v]||{}).hidden||(d[v]=mr(v));for(var _=0,E=i.s.r;E<=i.e.r;++E)(g[E]||{}).hidden||(f=LF(t,i,E,d,a,c,s,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((_++?o:"")+f)));return delete n.dense,r.join("")}function L_(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=sh(t,e);return r}function MF(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=Et(t["!ref"]),s="",a=[],o,c=[],u=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=mr(o);for(var f=i.s.r;f<=i.e.r;++f)for(s=or(f),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=u?(t[f]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function M_(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?qt(n.origin):n.origin;a=c.r,o=c.c}var u,f={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var d=Et(s["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),a==-1&&(a=d.e.r+1,f.e.r=a+e.length-1+i)}else a==-1&&(a=0,f.e.r=e.length-1+i);var p=n.header||[],g=0;e.forEach(function(_,E){cr(_).forEach(function(L){(g=p.indexOf(L))==-1&&(p[g=p.length]=L);var V=_[L],N="z",U="",re=ht({c:o+g,r:a+E+i});u=Ya(s,re),V&&typeof V=="object"&&!(V instanceof Date)?s[re]=V:(typeof V=="number"?N="n":typeof V=="boolean"?N="b":typeof V=="string"?N="s":V instanceof Date?(N="d",n.cellDates||(N="n",V=Dr(V)),U=n.dateNF||Rt[14]):V===null&&n.nullError&&(N="e",V=0),u?(u.t=N,u.v=V,delete u.w,delete u.R,U&&(u.z=U)):s[re]=u={t:N,v:V},U&&(u.z=U))})}),f.e.c=Math.max(f.e.c,o+p.length-1);var v=or(a);if(i)for(g=0;g<p.length;++g)s[mr(g+o)+v]={t:"s",v:p[g]};return s["!ref"]=Nt(f),s}function VF(t,e){return M_(null,t,e)}function Ya(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=qt(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Ya(t,ht(e)):Ya(t,ht({r:e,c:r||0}))}function BF(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function UF(){return{SheetNames:[],Sheets:{}}}function HF(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(I_(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function WF(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=BF(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function $F(t,e){return t.z=e,t}function V_(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function jF(t,e,r){return V_(t,"#"+e,r)}function GF(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function zF(t,e,r,n){for(var i=typeof e!="string"?e:Et(e),s=typeof e=="string"?e:Nt(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var c=Ya(t,a,o);c.t="n",c.F=s,delete c.v,a==i.s.r&&o==i.s.c&&(c.f=r,n&&(c.D=!0))}return t}var tu={encode_col:mr,encode_row:or,encode_cell:ht,encode_range:Nt,decode_col:qf,decode_row:Kf,split_cell:a4,decode_cell:qt,decode_range:Hr,format_cell:Un,sheet_add_aoa:Vm,sheet_add_json:M_,sheet_add_dom:D_,aoa_to_sheet:Gs,json_to_sheet:VF,table_to_sheet:O_,table_to_book:gF,sheet_to_csv:sh,sheet_to_txt:L_,sheet_to_json:Hl,sheet_to_html:F_,sheet_to_formulae:MF,sheet_to_row_object_array:Hl,sheet_get_cell:Ya,book_new:UF,book_append_sheet:HF,book_set_sheet_visibility:WF,cell_set_number_format:$F,cell_set_hyperlink:V_,cell_set_internal_link:jF,cell_add_comment:GF,sheet_set_array_formula:zF,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const KF={key:0,class:"w-full mt-10"},qF={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},XF={class:"text-lg font-bold text-blue-800 dark:text-blue-300 mb-2"},YF={class:"text-sm text-gray-600 dark:text-gray-300 pl-4 list-disc"},QF={class:"mt-4 flex flex-wrap justify-between items-center"},JF={key:0,class:"flex items-center bg-gray-100 dark:bg-gray-800 rounded-full px-3 py-1"},ZF=["href"],e6={key:0,class:"text-green-600 text-sm"},op=xi({__name:"WeeklySchedule",setup(t){const{activities:e,schedule:r,teams:n,shareUrl:i}=Ei();function s(u){return n.value[u]||[]}const a=xr(!1);function o(){i.value&&navigator.clipboard.writeText(i.value).then(()=>{a.value=!0,setTimeout(()=>a.value=!1,2e3)})}function c(){const u=tu.book_new(),f=[],d=Object.keys(r.value),p=e.value,g=["Aktivitet",...d];f[0]=g,p.forEach((L,V)=>{const N=[L];d.forEach(U=>{const re=r.value[U][L];N.push(re??"--------------------")}),f[V+1]=N});const v=f.length+2;let _=1;Object.entries(n.value).forEach(([L,V])=>{f[v]=f[v]||[],f[v][_]=L,f[v+1]=f[v+1]||[],V.forEach((N,U)=>{f[v+1+U]=f[v+1+U]||[],f[v+1+U][_]=N}),_+=2});const E=tu.aoa_to_sheet(f);E["!cols"]=[{wch:30}],tu.book_append_sheet(u,E,"Schema + Lag"),kF(u,"veckoschema_spanien.xlsx")}return(u,f)=>Object.keys(At(r)).length?(Ye(),Ze("div",KF,[f[0]||(f[0]=Fe("h2",{class:"text-2xl font-semibold text-center mb-4 text-gray-600 dark:text-gray-300"},"Veckoschema",-1)),Fe("div",qF,[(Ye(!0),Ze(Ut,null,Pn(At(r),(d,p)=>(Ye(),Ze("div",{key:p,class:"bg-gray-300 dark:bg-gray-800 border border-gray-700 rounded-lg p-4 shadow-md"},[Fe("h3",XF,zt(p),1),Fe("ul",YF,[(Ye(!0),Ze(Ut,null,Pn(d,(g,v)=>(Ye(),Ze("li",{key:v},[c1(zt(v)+": ",1),Fe("span",null,zt(g)+" ("+zt(s(g).join(", "))+") ",1)]))),128))])]))),128))]),Fe("div",QF,[At(i)?(Ye(),Ze("div",JF,[Fe("a",{href:At(i),target:"_blank",title:"Delningslänk",class:"text-sm truncate max-w-[200px] text-gray-800 dark:text-white hover:underline"},zt(At(i)),9,ZF),Fe("button",{onClick:o,class:"ml-2 text-blue-600 hover:text-blue-800"}," 📋 "),a.value?(Ye(),Ze("span",e6,"Länk kopierad!")):Mi("",!0)])):Mi("",!0),Fe("button",{onClick:c,class:"bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-lg shadow-md"}," Exportera till Excel ")])])):Mi("",!0)}}),t6={class:"my-6"},r6={class:"flex gap-4 items-center mb-2"},n6={key:0,class:"text-sm text-gray-600 dark:text-gray-300"},i6={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},s6={class:"truncate"},a6=["onClick"],o6=xi({__name:"BlockActivity",setup(t){const{activities:e,blockedAssignments:r,days:n}=Ei(),i=xr(""),s=xr("");function a(){i.value&&s.value&&(r.value.push({day:i.value,activity:s.value}),i.value="",s.value="")}function o(c){r.value.splice(c,1)}return(c,u)=>(Ye(),Ze("div",t6,[u[5]||(u[5]=Fe("h2",{class:"text-lg font-semibold text-gray-800 dark:text-white mb-2"},"Blockera aktivitet",-1)),Fe("div",r6,[Oa(Fe("select",{"onUpdate:modelValue":u[0]||(u[0]=f=>i.value=f),class:"bg-gray-300 dark:bg-gray-800 border border-gray-400 dark:border-gray-600 text-gray-600 dark:text-gray-300 px-3 py-2 rounded-md"},[u[2]||(u[2]=Fe("option",{disabled:"",value:""},"Välj dag",-1)),(Ye(!0),Ze(Ut,null,Pn(At(n),f=>(Ye(),Ze("option",{key:f},zt(f),1))),128))],512),[[u0,i.value]]),Oa(Fe("select",{"onUpdate:modelValue":u[1]||(u[1]=f=>s.value=f),class:"bg-gray-300 dark:bg-gray-800 border border-gray-400 dark:border-gray-600 text-gray-600 dark:text-gray-300 px-3 py-2 rounded-md"},[u[3]||(u[3]=Fe("option",{disabled:"",value:""},"Välj aktivitet",-1)),(Ye(!0),Ze(Ut,null,Pn(At(e),f=>(Ye(),Ze("option",{key:f},zt(f),1))),128))],512),[[u0,s.value]]),Fe("button",{onClick:a,class:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-md"},"Lägg till")]),At(r).length?(Ye(),Ze("div",n6,[u[4]||(u[4]=Fe("p",{class:"mb-1 font-medium"},"Blockerade aktiviteter:",-1)),Fe("div",i6,[(Ye(!0),Ze(Ut,null,Pn(At(r),(f,d)=>(Ye(),Ze("div",{key:d,class:"bg-gray-300 dark:bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-sm text-gray-600 dark:text-gray-300 shadow-sm flex justify-between items-center"},[Fe("span",s6,zt(f.day)+" – "+zt(f.activity),1),Fe("button",{onClick:p=>o(d),class:"text-red-400 hover:text-red-200 font-bold ml-4"},"×",8,a6)]))),128))])])):Mi("",!0)]))}}),l6={class:"space-y-2"},c6={class:"block text-blue-800 dark:text-blue-300"},u6={class:"text-sm text-gray-600 dark:text-gray-300"},f6=xi({__name:"GeneratedTeams",setup(t){const{teams:e}=Ei();return(r,n)=>(Ye(),Ze(Ut,null,[n[0]||(n[0]=Fe("h2",{class:"text-xl font-semibold text-center mb-4 text-gray-600 dark:text-gray-300"},"Lag",-1)),Fe("ul",l6,[(Ye(!0),Ze(Ut,null,Pn(At(e),(i,s)=>(Ye(),Ze("li",{key:s,class:"bg-gray-300 dark:bg-gray-800 p-3 rounded-lg border border-gray-700 relative"},[Fe("strong",c6,zt(s),1),Fe("span",u6,zt(i.join(", ")),1)]))),128))])],64))}}),h6={class:"min-h-screen p-6 sm:p-10 max-w-4xl mx-auto space-y-10 transition-colors duration-300"},d6={class:"absolute top-4 right-4"},p6={key:0,class:"space-y-6"},g6={key:1,class:"flex flex-col items-center space-y-6"},m6={key:0,class:"w-full max-w-lg"},_6=xi({__name:"App",setup(t){const{schedule:e,teams:r,hasGeneratedTeams:n,activities:i,people:s,blockedAssignments:a}=Ei(),o=xr(!1),c=xr(!1);Hp(()=>{const f=localStorage.getItem("theme");f==="dark"?o.value=!0:f==="light"?o.value=!1:o.value=window.matchMedia("(prefers-color-scheme: dark)").matches;const p=new URLSearchParams(location.search).get("schedule");p&&AA($g(tm,"schedules",p)).then(E=>{if(E.exists()){const L=E.data();e.value=L.schedule,r.value=L.teams,n.value=!0,c.value=!0}});const g=localStorage.getItem("savedActivities"),v=localStorage.getItem("savedPeople"),_=localStorage.getItem("savedblockedAssignments");g&&(i.value=JSON.parse(g)),v&&(s.value=JSON.parse(v)),_&&(a.value=JSON.parse(_))});function u(){o.value=!o.value,localStorage.setItem("theme",o.value?"dark":"light")}return ki(o,f=>{document.documentElement.classList.toggle("dark",f)},{immediate:!0}),ki(i,f=>{localStorage.setItem("savedActivities",JSON.stringify(f))},{deep:!0}),ki(s,f=>{localStorage.setItem("savedPeople",JSON.stringify(f))},{deep:!0}),ki(a,f=>{localStorage.setItem("savedblockedAssignments",JSON.stringify(f))},{deep:!0}),(f,d)=>(Ye(),Ze("main",h6,[Fe("div",d6,[Fe("div",{class:"relative w-14 h-8 rounded-full cursor-pointer bg-gray-300 dark:bg-gray-700 transition duration-300",onClick:u},[Fe("div",{class:zl(["absolute top-1 left-1 w-6 h-6 rounded-full bg-white flex items-center justify-center text-sm transition-all duration-300",{"translate-x-6":o.value}])},[Fe("span",null,zt(o.value?"🌙":"☀️"),1)],2)])]),d[0]||(d[0]=Fe("header",{class:"text-center"},[Fe("h1",{class:"text-3xl sm:text-4xl font-bold tracking-tight mb-2 text-gray-600 dark:text-gray-300"},"Schemaläggare"),Fe("p",{class:"text-sm text-gray-600 dark:text-gray-300"},"Skapa slumpmässiga lag och generera ett veckoschema")],-1)),c.value?(Ye(),Ze("section",g6,[At(n)?(Ye(),Ze("div",m6,[er(f6)])):Mi("",!0),er(op)])):(Ye(),Ze("section",p6,[er(HA),er(KA),er(o6),er(YA),er(nS),er(op)]))]))}});TE(_6).mount("#app");
